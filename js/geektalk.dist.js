/* =========================================================
 * bootstrap-modal.js v2.0.0
 * http://twitter.github.com/bootstrap/javascript.html#modals
 * =========================================================
 * Copyright 2012 Twitter, Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * ========================================================= */!function(a){function c(){var b=this,c=setTimeout(function(){b.$element.off(a.support.transition.end),d.call(b)},500);this.$element.one(a.support.transition.end,function(){clearTimeout(c),d.call(b)})}function d(a){this.$element.hide().trigger("hidden"),e.call(this)}function e(b){var c=this,d=this.$element.hasClass("fade")?"fade":"";if(this.isShown&&this.options.backdrop){var e=a.support.transition&&d;this.$backdrop=a('<div class="modal-backdrop '+d+'" />').appendTo(document.body),this.options.backdrop!="static"&&this.$backdrop.click(a.proxy(this.hide,this)),e&&this.$backdrop[0].offsetWidth,this.$backdrop.addClass("in"),e?this.$backdrop.one(a.support.transition.end,b):b()}else!this.isShown&&this.$backdrop?(this.$backdrop.removeClass("in"),a.support.transition&&this.$element.hasClass("fade")?this.$backdrop.one(a.support.transition.end,a.proxy(f,this)):f.call(this)):b&&b()}function f(){this.$backdrop.remove(),this.$backdrop=null}function g(){var b=this;this.isShown&&this.options.keyboard?a(document).on("keyup.dismiss.modal",function(a){a.which==27&&b.hide()}):this.isShown||a(document).off("keyup.dismiss.modal")}"use strict";var b=function(b,c){this.options=a.extend({},a.fn.modal.defaults,c),this.$element=a(b).delegate('[data-dismiss="modal"]',"click.dismiss.modal",a.proxy(this.hide,this))};b.prototype={constructor:b,toggle:function(){return this[this.isShown?"hide":"show"]()},show:function(){var b=this;if(this.isShown)return;a("body").addClass("modal-open"),this.isShown=!0,this.$element.trigger("show"),g.call(this),e.call(this,function(){var c=a.support.transition&&b.$element.hasClass("fade");!b.$element.parent().length&&b.$element.appendTo(document.body),b.$element.show(),c&&b.$element[0].offsetWidth,b.$element.addClass("in"),c?b.$element.one(a.support.transition.end,function(){b.$element.trigger("shown")}):b.$element.trigger("shown")})},hide:function(b){b&&b.preventDefault();if(!this.isShown)return;var e=this;this.isShown=!1,a("body").removeClass("modal-open"),g.call(this),this.$element.trigger("hide").removeClass("in"),a.support.transition&&this.$element.hasClass("fade")?c.call(this):d.call(this)}},a.fn.modal=function(c){return this.each(function(){var d=a(this),e=d.data("modal"),f=typeof c=="object"&&c;e||d.data("modal",e=new b(this,f)),typeof c=="string"?e[c]():e.show()})},a.fn.modal.defaults={backdrop:!0,keyboard:!0},a.fn.modal.Constructor=b,a(function(){a("body").on("click.modal.data-api",'[data-toggle="modal"]',function(b){var c=a(this),d,e=a(c.attr("data-target")||(d=c.attr("href"))&&d.replace(/.*(?=#[^\s]+$)/,"")),f=e.data("modal")?"toggle":a.extend({},e.data(),c.data());b.preventDefault(),e.modal(f)})})}(window.jQuery);(function(){function e(a){var b=-1,c=a.length,d=[];while(++b<c)d.push(a[b]);return d}function f(a){return Array.prototype.slice.call(a)}function i(){return this}function j(a,b,c){return function(){var d=c.apply(b,arguments);return arguments.length?a:d}}function k(a){return a!=null&&!isNaN(a)}function l(a){return a.length}function m(a){return a==null}function n(a){return a.replace(/(^\s+)|(\s+$)/g,"").replace(/\s+/g," ")}function q(){}function r(){function c(){var b=a,c=-1,d=b.length,e;while(++c<d)(e=b[c].on)&&e.apply(this,arguments)}var a=[],b={};return c.on=function(d,e){var f,g;if(arguments.length<2)return(f=b[d])&&f.on;if(f=b[d])f.on=null,a=a.slice(0,g=a.indexOf(f)).concat(a.slice(g+1)),delete b[d];return e&&a.push(b[d]={on:e}),c},c}function u(a,b){return b-(a?1+Math.floor(Math.log(a+Math.pow(10,1+Math.floor(Math.log(a)/Math.LN10)-b))/Math.LN10):1)}function v(a){return a+""}function w(a){var b=a.lastIndexOf("."),c=b>=0?a.substring(b):(b=a.length,""),d=[];while(b>0)d.push(a.substring(b-=3,b+3));return d.reverse().join(",")+c}function y(a,b){return{scale:Math.pow(10,(8-b)*3),symbol:a}}function D(a){return function(b){return b<=0?0:b>=1?1:a(b)}}function E(a){return function(b){return 1-a(1-b)}}function F(a){return function(b){return.5*(b<.5?a(2*b):2-a(2-2*b))}}function G(a){return a}function H(a){return function(b){return Math.pow(b,a)}}function I(a){return 1-Math.cos(a*Math.PI/2)}function J(a){return Math.pow(2,10*(a-1))}function K(a){return 1-Math.sqrt(1-a*a)}function L(a,b){var c;return arguments.length<2&&(b=.45),arguments.length<1?(a=1,c=b/4):c=b/(2*Math.PI)*Math.asin(1/a),function(d){return 1+a*Math.pow(2,10*-d)*Math.sin((d-c)*2*Math.PI/b)}}function M(a){return a||(a=1.70158),function(b){return b*b*((a+1)*b-a)}}function N(a){return a<1/2.75?7.5625*a*a:a<2/2.75?7.5625*(a-=1.5/2.75)*a+.75:a<2.5/2.75?7.5625*(a-=2.25/2.75)*a+.9375:7.5625*(a-=2.625/2.75)*a+.984375}function O(){d3.event.stopPropagation(),d3.event.preventDefault()}function Q(a){return a=="transform"?d3.interpolateTransform:d3.interpolate}function R(a,b){return b=b-(a=+a)?1/(b-a):0,function(c){return(c-a)*b}}function S(a,b){return b=b-(a=+a)?1/(b-a):0,function(c){return Math.max(0,Math.min(1,(c-a)*b))}}function T(a,b,c){return new U(a,b,c)}function U(a,b,c){this.r=a,this.g=b,this.b=c}function V(a){return a<16?"0"+Math.max(0,a).toString(16):Math.min(255,a).toString(16)}function W(a,b,c){var d=0,e=0,f=0,g,h,i;g=/([a-z]+)\((.*)\)/i.exec(a);if(g){h=g[2].split(",");switch(g[1]){case"hsl":return c(parseFloat(h[0]),parseFloat(h[1])/100,parseFloat(h[2])/100);case"rgb":return b(Y(h[0]),Y(h[1]),Y(h[2]))}}return(i=Z[a])?b(i.r,i.g,i.b):(a!=null&&a.charAt(0)==="#"&&(a.length===4?(d=a.charAt(1),d+=d,e=a.charAt(2),e+=e,f=a.charAt(3),f+=f):a.length===7&&(d=a.substring(1,3),e=a.substring(3,5),f=a.substring(5,7)),d=parseInt(d,16),e=parseInt(e,16),f=parseInt(f,16)),b(d,e,f))}function X(a,b,c){var d=Math.min(a/=255,b/=255,c/=255),e=Math.max(a,b,c),f=e-d,g,h,i=(e+d)/2;return f?(h=i<.5?f/(e+d):f/(2-e-d),a==e?g=(b-c)/f+(b<c?6:0):b==e?g=(c-a)/f+2:g=(a-b)/f+4,g*=60):h=g=0,_(g,h,i)}function Y(a){var b=parseFloat(a);return a.charAt(a.length-1)==="%"?Math.round(b*2.55):b}function _(a,b,c){return new ba(a,b,c)}function ba(a,b,c){this.h=a,this.s=b,this.l=c}function bb(a,b,c){function f(a){return a>360?a-=360:a<0&&(a+=360),a<60?d+(e-d)*a/60:a<180?e:a<240?d+(e-d)*(240-a)/60:d}function g(a){return Math.round(f(a)*255)}var d,e;return a%=360,a<0&&(a+=360),b=b<0?0:b>1?1:b,c=c<0?0:c>1?1:c,e=c<=.5?c*(1+b):c+b-c*b,d=2*c-e,T(g(a+120),g(a),g(a-120))}function bc(a){return h(a,bf),a}function bg(a){return function(){return bd(a,this)}}function bh(a){return function(){return be(a,this)}}function bj(a,b){function f(){if(b=this.classList)return b.add(a);var b=this.className,d=b.baseVal!=null,e=d?b.baseVal:b;c.lastIndex=0,c.test(e)||(e=n(e+" "+a),d?b.baseVal=e:this.className=e)}function g(){if(b=this.classList)return b.remove(a);var b=this.className,d=b.baseVal!=null,e=d?b.baseVal:b;e=n(e.replace(c," ")),d?b.baseVal=e:this.className=e}function h(){(b.apply(this,arguments)?f:g).call(this)}var c=new RegExp("(^|\\s+)"+d3.requote(a)+"(\\s+|$)","g");if(arguments.length<2){var d=this.node();if(e=d.classList)return e.contains(a);var e=d.className;return c.lastIndex=0,c.test(e.baseVal!=null?e.baseVal:e)}return this.each(typeof b=="function"?h:b?f:g)}function bk(a){return{__data__:a}}function bl(a){return arguments.length||(a=d3.ascending),function(b,c){return a(b&&b.__data__,c&&c.__data__)}}function bn(a){return h(a,bo),a}function bp(a,b,c){h(a,bt);var d={},e=d3.dispatch("start","end"),f=bw;return a.id=b,a.time=c,a.tween=function(b,c){return arguments.length<2?d[b]:(c==null?delete d[b]:d[b]=c,a)},a.ease=function(b){return arguments.length?(f=typeof b=="function"?b:d3.ease.apply(d3,arguments),a):f},a.each=function(b,c){return arguments.length<2?bx.call(a,b):(e.on(b,c),a)},d3.timer(function(g){return a.each(function(h,i,j){function p(a){if(o.active>b)return r();o.active=b;for(var f in d)(f=d[f].call(l,h,i))&&k.push(f);return e.start.call(l,h,i),q(a)||d3.timer(q,0,c),1}function q(a){if(o.active!==b)return r();var c=(a-m)/n,d=f(c),g=k.length;while(g>0)k[--g].call(l,d);if(c>=1)return r(),bv=b,e.end.call(l,h,i),bv=0,1}function r(){return--o.count||delete l.__transition__,1}var k=[],l=this,m=a[j][i].delay,n=a[j][i].duration,o=l.__transition__||(l.__transition__={active:0,count:0});++o.count,m<=g?p(g):d3.timer(p,m,c)}),1},0,c),a}function br(a,b,c){return c!=""&&bq}function bs(a,b){function d(a,d,e){var f=b.call(this,a,d);return f==null?e!=""&&bq:e!=f&&c(e,f)}function e(a,d,e){return e!=b&&c(e,b)}var c=Q(a);return typeof b=="function"?d:b==null?br:(b+="",e)}function bx(a){for(var b=0,c=this.length;b<c;b++)for(var d=this[b],e=0,f=d.length;e<f;e++){var g=d[e];g&&a.call(g=g.node,g.__data__,e,b)}return this}function bB(){var a,b=Date.now(),c=by;while(c)a=b-c.then,a>=c.delay&&(c.flush=c.callback(a)),c=c.next;var d=bC()-b;d>24?(isFinite(d)&&(clearTimeout(bA),bA=setTimeout(bB,d)),bz=0):(bz=1,bD(bB))}function bC(){var a=null,b=by,c=Infinity;while(b)b.flush?b=a?a.next=b.next:by=b.next:(c=Math.min(c,b.then+b.delay),b=(a=b).next);return c}function bE(a){var b=[a.a,a.b],c=[a.c,a.d],d=bG(b),e=bF(b,c),f=bG(bH(c,b,-e))||0;b[0]*c[1]<c[0]*b[1]&&(b[0]*=-1,b[1]*=-1,d*=-1,e*=-1),this.rotate=(d?Math.atan2(b[1],b[0]):Math.atan2(-c[0],c[1]))*bK,this.translate=[a.e,a.f],this.scale=[d,f],this.skew=f?Math.atan2(e,f)*bK:0}function bF(a,b){return a[0]*b[0]+a[1]*b[1]}function bG(a){var b=Math.sqrt(bF(a,a));return b&&(a[0]/=b,a[1]/=b),b}function bH(a,b,c){return a[0]+=c*b[0],a[1]+=c*b[1],a}function bL(){}function bM(a){var b=a[0],c=a[a.length-1];return b<c?[b,c]:[c,b]}function bN(a){return a.rangeExtent?a.rangeExtent():bM(a.range())}function bO(a,b){var c=0,d=a.length-1,e=a[c],f=a[d],g;f<e&&(g=c,c=d,d=g,g=e,e=f,f=g);if(g=f-e)b=b(g),a[c]=b.floor(e),a[d]=b.ceil(f);return a}function bP(){return Math}function bQ(a,b,c,d){function g(){var g=a.length==2?bW:bX,i=d?S:R;return e=g(a,b,i,c),f=g(b,a,i,d3.interpolate),h}function h(a){return e(a)}var e,f;return h.invert=function(a){return f(a)},h.domain=function(b){return arguments.length?(a=b.map(Number),g()):a},h.range=function(a){return arguments.length?(b=a,g()):b},h.rangeRound=function(a){return h.range(a).interpolate(d3.interpolateRound)},h.clamp=function(a){return arguments.length?(d=a,g()):d},h.interpolate=function(a){return arguments.length?(c=a,g()):c},h.ticks=function(b){return bU(a,b)},h.tickFormat=function(b){return bV(a,b)},h.nice=function(){return bO(a,bS),g()},h.copy=function(){return bQ(a,b,c,d)},g()}function bR(a,b){return d3.rebind(a,b,"range","rangeRound","interpolate","clamp")}function bS(a){return a=Math.pow(10,Math.round(Math.log(a)/Math.LN10)-1),{floor:function(b){return Math.floor(b/a)*a},ceil:function(b){return Math.ceil(b/a)*a}}}function bT(a,b){var c=bM(a),d=c[1]-c[0],e=Math.pow(10,Math.floor(Math.log(d/b)/Math.LN10)),f=b/d*e;return f<=.15?e*=10:f<=.35?e*=5:f<=.75&&(e*=2),c[0]=Math.ceil(c[0]/e)*e,c[1]=Math.floor(c[1]/e)*e+e*.5,c[2]=e,c}function bU(a,b){return d3.range.apply(d3,bT(a,b))}function bV(a,b){return d3.format(",."+Math.max(0,-Math.floor(Math.log(bT(a,b)[2])/Math.LN10+.01))+"f")}function bW(a,b,c,d){var e=c(a[0],a[1]),f=d(b[0],b[1]);return function(a){return f(e(a))}}function bX(a,b,c,d){var e=[],f=[],g=0,h=a.length;while(++g<h)e.push(c(a[g-1],a[g])),f.push(d(b[g-1],b[g]));return function(b){var c=d3.bisect(a,b,1,a.length-1)-1;return f[c](e[c](b))}}function bY(a,b){function d(c){return a(b(c))}var c=b.pow;return d.invert=function(b){return c(a.invert(b))},d.domain=function(e){return arguments.length?(b=e[0]<0?b_:b$,c=b.pow,a.domain(e.map(b)),d):a.domain().map(c)},d.nice=function(){return a.domain(bO(a.domain(),bP)),d},d.ticks=function(){var d=bM(a.domain()),e=[];if(d.every(isFinite)){var f=Math.floor(d[0]),g=Math.ceil(d[1]),h=c(d[0]),i=c(d[1]);if(b===b_){e.push(c(f));for(;f++<g;)for(var j=9;j>0;j--)e.push(c(f)*j)}else{for(;f<g;f++)for(var j=1;j<10;j++)e.push(c(f)*j);e.push(c(f))}for(f=0;e[f]<h;f++);for(g=e.length;e[g-1]>i;g--);e=e.slice(f,g)}return e},d.tickFormat=function(a,e){arguments.length<2&&(e=bZ);if(arguments.length<1)return e;var f=a/d.ticks().length,g=b===b_?(h=-1e-12,Math.floor):(h=1e-12,Math.ceil),h;return function(a){return a/c(g(b(a)+h))<f?e(a):""}},d.copy=function(){return bY(a.copy(),b)},bR(d,a)}function b$(a){return Math.log(a)/Math.LN10}function b_(a){return-Math.log(-a)/Math.LN10}function ca(a,b){function e(b){return a(c(b))}var c=cb(b),d=cb(1/b);return e.invert=function(b){return d(a.invert(b))},e.domain=function(b){return arguments.length?(a.domain(b.map(c)),e):a.domain().map(d)},e.ticks=function(a){return bU(e.domain(),a)},e.tickFormat=function(a){return bV(e.domain(),a)},e.nice=function(){return e.domain(bO(e.domain(),bS))},e.exponent=function(a){if(!arguments.length)return b;var f=e.domain();return c=cb(b=a),d=cb(1/b),e.domain(f)},e.copy=function(){return ca(a.copy(),b)},bR(e,a)}function cb(a){return function(b){return b<0?-Math.pow(-b,a):Math.pow(b,a)}}function cc(a,b){function f(b){return d[((c[b]||(c[b]=a.push(b)))-1)%d.length]}function g(b,c){return d3.range(a.length).map(function(a){return b+c*a})}var c,d,e;return f.domain=function(d){if(!arguments.length)return a;a=[],c={};var e=-1,g=d.length,h;while(++e<g)c[h=d[e]]||(c[h]=a.push(h));return f[b.t](b.x,b.p)},f.range=function(a){return arguments.length?(d=a,e=0,b={t:"range",x:a},f):d},f.rangePoints=function(c,h){arguments.length<2&&(h=0);var i=c[0],j=c[1],k=(j-i)/(a.length-1+h);return d=g(a.length<2?(i+j)/2:i+k*h/2,k),e=0,b={t:"rangePoints",x:c,p:h},f},f.rangeBands=function(c,h){arguments.length<2&&(h=0);var i=c[0],j=c[1],k=(j-i)/(a.length+h);return d=g(i+k*h,k),e=k*(1-h),b={t:"rangeBands",x:c,p:h},f},f.rangeRoundBands=function(c,h){arguments.length<2&&(h=0);var i=c[0],j=c[1],k=Math.floor((j-i)/(a.length+h));return d=g(i+Math.round((j-i-(a.length-h)*k)/2),k),e=Math.round(k*(1-h)),b={t:"rangeRoundBands",x:c,p:h},f},f.rangeBand=function(){return e},f.rangeExtent=function(){return b.x},f.copy=function(){return cc(a,b)},f.domain(a)}function ch(a,b){function d(){var d=0,f=a.length,g=b.length;c=[];while(++d<g)c[d-1]=d3.quantile(a,d/g);return e}function e(a){return isNaN(a=+a)?NaN:b[d3.bisect(c,a)]}var c;return e.domain=function(b){return arguments.length?(a=b.filter(function(a){return!isNaN(a)}).sort(d3.ascending),d()):a},e.range=function(a){return arguments.length?(b=a,d()):b},e.quantiles=function(){return c},e.copy=function(){return ch(a,b)},d()}function ci(a,b,c){function f(b){return c[Math.max(0,Math.min(e,Math.floor(d*(b-a))))]}function g(){return d=c.length/(b-a),e=c.length-1,f}var d,e;return f.domain=function(c){return arguments.length?(a=+c[0],b=+c[c.length-1],g()):[a,b]},f.range=function(a){return arguments.length?(c=a,g()):c},f.copy=function(){return ci(a,b,c)},g()}function cl(a){return a.innerRadius}function cm(a){return a.outerRadius}function cn(a){return a.startAngle}function co(a){return a.endAngle}function cp(a){function g(d){return d.length<1?null:"M"+e(a(cq(this,d,b,c)),f)}var b=cr,c=cs,d="linear",e=ct[d],f=.7;return g.x=function(a){return arguments.length?(b=a,g):b},g.y=function(a){return arguments.length?(c=a,g):c},g.interpolate=function(a){return arguments.length?(e=ct[d=a],g):d},g.tension=function(a){return arguments.length?(f=a,g):f},g}function cq(a,b,c,d){var e=[],f=-1,g=b.length,h=typeof c=="function",i=typeof d=="function",j;if(h&&i)while(++f<g)e.push([c.call(a,j=b[f],f),d.call(a,j,f)]);else if(h)while(++f<g)e.push([c.call(a,b[f],f),d]);else if(i)while(++f<g)e.push([c,d.call(a,b[f],f)]);else while(++f<g)e.push([c,d]);return e}function cr(a){return a[0]}function cs(a){return a[1]}function cu(a){var b=0,c=a.length,d=a[0],e=[d[0],",",d[1]];while(++b<c)e.push("L",(d=a[b])[0],",",d[1]);return e.join("")}function cv(a){var b=0,c=a.length,d=a[0],e=[d[0],",",d[1]];while(++b<c)e.push("V",(d=a[b])[1],"H",d[0]);return e.join("")}function cw(a){var b=0,c=a.length,d=a[0],e=[d[0],",",d[1]];while(++b<c)e.push("H",(d=a[b])[0],"V",d[1]);return e.join("")}function cx(a,b){return a.length<4?cu(a):a[1]+cA(a.slice(1,a.length-1),cB(a,b))}function cy(a,b){return a.length<3?cu(a):a[0]+cA((a.push(a[0]),a),cB([a[a.length-2]].concat(a,[a[1]]),b))}function cz(a,b,c){return a.length<3?cu(a):a[0]+cA(a,cB(a,b))}function cA(a,b){if(b.length<1||a.length!=b.length&&a.length!=b.length+2)return cu(a);var c=a.length!=b.length,d="",e=a[0],f=a[1],g=b[0],h=g,i=1;c&&(d+="Q"+(f[0]-g[0]*2/3)+","+(f[1]-g[1]*2/3)+","+f[0]+","+f[1],e=a[1],i=2);if(b.length>1){h=b[1],f=a[i],i++,d+="C"+(e[0]+g[0])+","+(e[1]+g[1])+","+(f[0]-h[0])+","+(f[1]-h[1])+","+f[0]+","+f[1];for(var j=2;j<b.length;j++,i++)f=a[i],h=b[j],d+="S"+(f[0]-h[0])+","+(f[1]-h[1])+","+f[0]+","+f[1]}if(c){var k=a[i];d+="Q"+(f[0]+h[0]*2/3)+","+(f[1]+h[1]*2/3)+","+k[0]+","+k[1]}return d}function cB(a,b){var c=[],d=(1-b)/2,e,f=a[0],g=a[1],h=1,i=a.length;while(++h<i)e=f,f=g,g=a[h],c.push([d*(g[0]-e[0]),d*(g[1]-e[1])]);return c}function cC(a){if(a.length<3)return cu(a);var b=1,c=a.length,d=a[0],e=d[0],f=d[1],g=[e,e,e,(d=a[1])[0]],h=[f,f,f,d[1]],i=[e,",",f];cK(i,g,h);while(++b<c)d=a[b],g.shift(),g.push(d[0]),h.shift(),h.push(d[1]),cK(i,g,h);b=-1;while(++b<2)g.shift(),g.push(d[0]),h.shift(),h.push(d[1]),cK(i,g,h);return i.join("")}function cD(a){if(a.length<4)return cu(a);var b=[],c=-1,d=a.length,e,f=[0],g=[0];while(++c<3)e=a[c],f.push(e[0]),g.push(e[1]);b.push(cG(cJ,f)+","+cG(cJ,g)),--c;while(++c<d)e=a[c],f.shift(),f.push(e[0]),g.shift(),g.push(e[1]),cK(b,f,g);return b.join("")}function cE(a){var b,c=-1,d=a.length,e=d+4,f,g=[],h=[];while(++c<4)f=a[c%d],g.push(f[0]),h.push(f[1]);b=[cG(cJ,g),",",cG(cJ,h)],--c;while(++c<e)f=a[c%d],g.shift(),g.push(f[0]),h.shift(),h.push(f[1]),cK(b,g,h);return b.join("")}function cF(a,b){var c=a.length-1,d=a[0][0],e=a[0][1],f=a[c][0]-d,g=a[c][1]-e,h=-1,i,j;while(++h<=c)i=a[h],j=h/c,i[0]=b*i[0]+(1-b)*(d+j*f),i[1]=b*i[1]+(1-b)*(e+j*g);return cC(a)}function cG(a,b){return a[0]*b[0]+a[1]*b[1]+a[2]*b[2]+a[3]*b[3]}function cK(a,b,c){a.push("C",cG(cH,b),",",cG(cH,c),",",cG(cI,b),",",cG(cI,c),",",cG(cJ,b),",",cG(cJ,c))}function cL(a,b){return(b[1]-a[1])/(b[0]-a[0])}function cM(a){var b=0,c=a.length-1,d=[],e=a[0],f=a[1],g=d[0]=cL(e,f);while(++b<c)d[b]=g+(g=cL(e=f,f=a[b+1]));return d[b]=g,d}function cN(a){var b=[],c,d,e,f,g=cM(a),h=-1,i=a.length-1;while(++h<i)c=cL(a[h],a[h+1]),Math.abs(c)<1e-6?g[h]=g[h+1]=0:(d=g[h]/c,e=g[h+1]/c,f=d*d+e*e,f>9&&(f=c*3/Math.sqrt(f),g[h]=f*d,g[h+1]=f*e));h=-1;while(++h<=i)f=(a[Math.min(i,h+1)][0]-a[Math.max(0,h-1)][0])/(6*(1+g[h]*g[h])),b.push([f||0,g[h]*f||0]);return b}function cO(a){return a.length<3?cu(a):a[0]+cA(a,cN(a))}function cP(a){var b,c=-1,d=a.length,e,f;while(++c<d)b=a[c],e=b[0],f=b[1]+cj,b[0]=e*Math.cos(f),b[1]=e*Math.sin(f);return a}function cQ(a){function j(f){if(f.length<1)return null;var j=cq(this,f,b,d),k=cq(this,f,b===c?cR(j):c,d===e?cS(j):e);return"M"+g(a(k),i)+"L"+h(a(j.reverse()),i)+"Z"}var b=cr,c=cr,d=0,e=cs,f,g,h,i=.7;return j.x=function(a){return arguments.length?(b=c=a,j):c},j.x0=function(a){return arguments.length?(b=a,j):b},j.x1=function(a){return arguments.length?(c=a,j):c},j.y=function(a){return arguments.length?(d=e=a,j):e},j.y0=function(a){return arguments.length?(d=a,j):d},j.y1=function(a){return arguments.length?(e=a,j):e},j.interpolate=function(a){return arguments.length?(g=ct[f=a],h=g.reverse||g,j):f},j.tension=function(a){return arguments.length?(i=a,j):i},j.interpolate("linear")}function cR(a){return function(b,c){return a[c][0]}}function cS(a){return function(b,c){return a[c][1]}}function cT(a){return a.source}function cU(a){return a.target}function cV(a){return a.radius}function cW(a){return a.startAngle}function cX(a){return a.endAngle}function cY(a){return[a.x,a.y]}function cZ(a){return function(){var b=a.apply(this,arguments),c=b[0],d=b[1]+cj;return[c*Math.cos(d),c*Math.sin(d)]}}function c_(a,b){var c=(a.ownerSVGElement||a).createSVGPoint();if(c$<0&&(window.scrollX||window.scrollY)){var d=d3.select(document.body).append("svg").style("position","absolute").style("top",0).style("left",0),e=d[0][0].getScreenCTM();c$=!e.f&&!e.e,d.remove()}return c$?(c.x=b.pageX,c.y=b.pageY):(c.x=b.clientX,c.y=b.clientY),c=c.matrixTransform(a.getScreenCTM().inverse()),[c.x,c.y]}function da(){return 64}function db(){return"circle"}function df(a,b){a.attr("transform",function(a){return"translate("+b(a)+",0)"})}function dg(a,b){a.attr("transform",function(a){return"translate(0,"+b(a)+")"})}function dh(a,b,c){e=[];if(c&&b.length>1){var d=bM(a.domain()),e,f=-1,g=b.length,h=(b[1]-b[0])/++c,i,j;while(++f<g)for(i=c;--i>0;)(j=+b[f]-i*h)>=d[0]&&e.push(j);for(--f,i=0;++i<c&&(j=+b[f]+i*h)<d[1];)e.push(j)}return e}function dt(a,b){a.select(".extent").attr("x",b[0][0]),a.selectAll(".n,.s,.w,.nw,.sw").attr("x",b[0][0]-2),a.selectAll(".e,.ne,.se").attr("x",b[1][0]-3),a.selectAll(".extent,.n,.s").attr("width",b[1][0]-b[0][0])}function du(a,b){a.select(".extent").attr("y",b[0][1]),a.selectAll(".n,.e,.w,.nw,.ne").attr("y",b[0][1]-3),a.selectAll(".s,.se,.sw").attr("y",b[1][1]-4),a.selectAll(".extent,.e,.w").attr("height",b[1][1]-b[0][1])}function dv(){d3.event.keyCode==32&&dk&&!dp&&(dr=null,ds[0]-=dn[1][0],ds[1]-=dn[1][1],dp=2,O())}function dw(){d3.event.keyCode==32&&dp==2&&(ds[0]+=dn[1][0],ds[1]+=dn[1][1],dp=0,O())}function dx(){if(ds){var a=d3.svg.mouse(dk),b=d3.select(dk);dp||(d3.event.altKey?(dr||(dr=[(dn[0][0]+dn[1][0])/2,(dn[0][1]+dn[1][1])/2]),ds[0]=dn[+(a[0]<dr[0])][0],ds[1]=dn[+(a[1]<dr[1])][1]):dr=null),dl&&(dy(a,dl,0),dt(b,dn)),dm&&(dy(a,dm,1),du(b,dn)),dj("brush")}}function dy(a,b,c){var d=bN(b),e=d[0],f=d[1],g=ds[c],h=dn[1][c]-dn[0][c],i,j;dp&&(e-=g,f-=h+g),i=Math.max(e,Math.min(f,a[c])),dp?j=(i+=g)+h:(dr&&(g=Math.max(e,Math.min(f,2*dr[c]-i))),g<i?(j=i,i=g):j=g),dn[0][c]=i,dn[1][c]=j}function dz(){ds&&(dx(),d3.select(dk).selectAll(".resize").style("pointer-events",di.empty()?"none":"all"),dj("brushend"),di=dj=dk=dl=dm=dn=dp=dq=dr=ds=null,O())}function dI(a){var b=dJ(),c=d3.event,d=d3.event={type:a};b&&(d.x=b[0]+dF[0],d.y=b[1]+dF[1],d.dx=b[0]-dG[0],d.dy=b[1]-dG[1],dH|=d.dx|d.dy,dG=b);try{dB[a].apply(dD,dE)}finally{d3.event=c}c.stopPropagation(),c.preventDefault()}function dJ(){var a=dD.parentNode,b=d3.event.changedTouches;return a&&(b?d3.svg.touches(a,b)[0]:d3.svg.mouse(a))}function dK(){if(!dD)return;var a=dD.parentNode;if(!a)return dL();dI("drag"),O()}function dL(){if(!dD)return;dI("dragend"),dH&&(O(),dH=d3.event.target===dC),dB=dC=dD=dE=dF=dG=null}function dM(){dH&&(O(),dH=0)}function dZ(a){return[a[0]-dS[0],a[1]-dS[1],dS[2]]}function d$(){dN||(dN=d3.select("body").append("div").style("visibility","hidden").style("top",0).style("height",0).style("width",0).style("overflow-y","scroll").append("div").style("height","2000px").node().parentNode);var a=d3.event,b;try{dN.scrollTop=1e3,dN.dispatchEvent(a),b=1e3-dN.scrollTop}catch(c){b=a.wheelDelta||-a.detail*5}return b*.005}function d_(){var a=d3.svg.touches(dW),b=-1,c=a.length,d;while(++b<c)dQ[(d=a[b]).identifier]=dZ(d);return a}function ea(){var a=d3.svg.touches(dW);switch(a.length){case 1:var b=a[0];ee(dS[2],b,dQ[b.identifier]);break;case 2:var c=a[0],d=a[1],e=[(c[0]+d[0])/2,(c[1]+d[1])/2],f=dQ[c.identifier],g=dQ[d.identifier],h=[(f[0]+g[0])/2,(f[1]+g[1])/2,f[2]];ee(Math.log(d3.event.scale)/Math.LN2+f[2],e,h)}}function eb(){dP=null,dO&&(dY=1,ee(dS[2],d3.svg.mouse(dW),dO))}function ec(){dO&&(dY&&(O(),dY=dV===d3.event.target),dS=dT=dU=dV=dW=dX=dO=null)}function ed(){dY&&(O(),dY=0)}function ee(a,b,c){function l(a,b,c){a.domain(a.range().map(function(f){return a.invert((f-c)*d/e+b)}))}a=eg(a,2);var d=Math.pow(2,dS[2]),e=Math.pow(2,a),f=Math.pow(2,(dS[2]=a)-c[2]),g=dS[0],h=dS[1],i=dS[0]=eg(b[0]-c[0]*f,0,e),j=dS[1]=eg(b[1]-c[1]*f,1,e),k=d3.event;d3.event={scale:e,translate:[i,j],transform:function(a,b){a&&l(a,g,i),b&&l(b,h,j)}};try{dU.apply(dW,dX)}finally{d3.event=k}k.preventDefault()}function eg(a,b,c){var d=dT[b],e=d[0],f=d[1];return arguments.length===3?Math.max(f*(f===Infinity?-Infinity:1/c-1),Math.min(e===-Infinity?Infinity:e,a/c))*c:Math.max(e,Math.min(f,a))}Date.now||(Date.now=function(){return+(new Date)});try{document.createElement("div").style.setProperty("opacity",0,"")}catch(a){var b=CSSStyleDeclaration.prototype,c=b.setProperty;b.setProperty=function(a,b,d){c.call(this,a,b+"",d)}}d3={version:"2.6.1"};var d=f;try{d(document.documentElement.childNodes)[0].nodeType}catch(g){d=e}var h=[].__proto__?function(a,b){a.__proto__=b}:function(a,b){for(var c in b)a[c]=b[c]};d3.functor=function(a){return typeof a=="function"?a:function(){return a}},d3.rebind=function(a,b){var c=1,d=arguments.length,e;while(++c<d)a[e=arguments[c]]=j(a,b,b[e]);return a},d3.ascending=function(a,b){return a<b?-1:a>b?1:a>=b?0:NaN},d3.descending=function(a,b){return b<a?-1:b>a?1:b>=a?0:NaN},d3.mean=function(a,b){var c=a.length,d,e=0,f=-1,g=0;if(arguments.length===1)while(++f<c)k(d=a[f])&&(e+=(d-e)/++g);else while(++f<c)k(d=b.call(a,a[f],f))&&(e+=(d-e)/++g);return g?e:undefined},d3.median=function(a,b){return arguments.length>1&&(a=a.map(b)),a=a.filter(k),a.length?d3.quantile(a.sort(d3.ascending),.5):undefined},d3.min=function(a,b){var c=-1,d=a.length,e,f;if(arguments.length===1){while(++c<d&&((e=a[c])==null||e!=e))e=undefined;while(++c<d)(f=a[c])!=null&&e>f&&(e=f)}else{while(++c<d&&((e=b.call(a,a[c],c))==null||e!=e))e=undefined;while(++c<d)(f=b.call(a,a[c],c))!=null&&e>f&&(e=f)}return e},d3.max=function(a,b){var c=-1,d=a.length,e,f;if(arguments.length===1){while(++c<d&&((e=a[c])==null||e!=e))e=undefined;while(++c<d)(f=a[c])!=null&&f>e&&(e=f)}else{while(++c<d&&((e=b.call(a,a[c],c))==null||e!=e))e=undefined;while(++c<d)(f=b.call(a,a[c],c))!=null&&f>e&&(e=f)}return e},d3.extent=function(a,b){var c=-1,d=a.length,e,f,g;if(arguments.length===1){while(++c<d&&((e=g=a[c])==null||e!=e))e=g=undefined;while(++c<d)(f=a[c])!=null&&(e>f&&(e=f),g<f&&(g=f))}else{while(++c<d&&((e=g=b.call(a,a[c],c))==null||e!=e))e=undefined;while(++c<d)(f=b.call(a,a[c],c))!=null&&(e>f&&(e=f),g<f&&(g=f))}return[e,g]},d3.random={normal:function(a,b){return arguments.length<2&&(b=1),arguments.length<1&&(a=0),function(){var c,d,e;do c=Math.random()*2-1,d=Math.random()*2-1,e=c*c+d*d;while(!e||e>1);return a+b*c*Math.sqrt(-2*Math.log(e)/e)}}},d3.sum=function(a,b){var c=0,d=a.length,e,f=-1;if(arguments.length===1)while(++f<d)isNaN(e=+a[f])||(c+=e);else while(++f<d)isNaN(e=+b.call(a,a[f],f))||(c+=e);return c},d3.quantile=function(a,b){var c=(a.length-1)*b+1,d=Math.floor(c),e=a[d-1],f=c-d;return f?e+f*(a[d]-e):e},d3.transpose=function(a){return d3.zip.apply(d3,a)},d3.zip=function(){if(!(e=arguments.length))return[];for(var a=-1,b=d3.min(arguments,l),c=new Array(b);++a<b;)for(var d=-1,e,f=c[a]=new Array(e);++d<e;)f[d]=arguments[d][a];return c},d3.bisectLeft=function(a,b,c,d){arguments.length<3&&(c=0),arguments.length<4&&(d=a.length);while(c<d){var e=c+d>>1;a[e]<b?c=e+1:d=e}return c},d3.bisect=d3.bisectRight=function(a,b,c,d){arguments.length<3&&(c=0),arguments.length<4&&(d=a.length);while(c<d){var e=c+d>>1;b<a[e]?d=e:c=e+1}return c},d3.first=function(a,b){var c=0,d=a.length,e=a[0],f;arguments.length===1&&(b=d3.ascending);while(++c<d)b.call(a,e,f=a[c])>0&&(e=f);return e},d3.last=function(a,b){var c=0,d=a.length,e=a[0],f;arguments.length===1&&(b=d3.ascending);while(++c<d)b.call(a,e,f=a[c])<=0&&(e=f);return e},d3.nest=function(){function f(c,g){if(g>=b.length)return e?e.call(a,c):d?c.sort(d):c;var h=-1,i=c.length,j=b[g++],k,l,m={};while(++h<i)(k=j(l=c[h]))in m?m[k].push(l):m[k]=[l];for(k in m)m[k]=f(m[k],g);return m}function g(a,d){if(d>=b.length)return a;var e=[],f=c[d++],h;for(h in a)e.push({key:h,values:g(a[h],d)});return f&&e.sort(function(a,b){return f(a.key,b.key)}),e}var a={},b=[],c=[],d,e;return a.map=function(a){return f(a,0)},a.entries=function(a){return g(f(a,0),0)},a.key=function(c){return b.push(c),a},a.sortKeys=function(d){return c[b.length-1]=d,a},a.sortValues=function(b){return d=b,a},a.rollup=function(b){return e=b,a},a},d3.keys=function(a){var b=[];for(var c in a)b.push(c);return b},d3.values=function(a){var b=[];for(var c in a)b.push(a[c]);return b},d3.entries=function(a){var b=[];for(var c in a)b.push({key:c,value:a[c]});return b},d3.permute=function(a,b){var c=[],d=-1,e=b.length;while(++d<e)c[d]=a[b[d]];return c},d3.merge=function(a){return Array.prototype.concat.apply([],a)},d3.split=function(a,b){var c=[],d=[],e,f=-1,g=a.length;arguments.length<2&&(b=m);while(++f<g)b.call(d,e=a[f],f)?d=[]:(d.length||c.push(d),d.push(e));return c},d3.range=function(a,b,c){arguments.length<3&&(c=1,arguments.length<2&&(b=a,a=0));if((b-a)/c==Infinity)throw new Error("infinite range");var d=[],e=-1,f;if(c<0)while((f=a+c*++e)>b)d.push(f);else while((f=a+c*++e)<b)d.push(f);return d},d3.requote=function(a){return a.replace(o,"\\$&")};var o=/[\\\^\$\*\+\?\|\[\]\(\)\.\{\}]/g;d3.round=function(a,b){return b?Math.round(a*Math.pow(10,b))*Math.pow(10,-b):Math.round(a)},d3.xhr=function(a,b,c){var d=new XMLHttpRequest;arguments.length<3?c=b:b&&d.overrideMimeType&&d.overrideMimeType(b),d.open("GET",a,!0),d.onreadystatechange=function(){d.readyState===4&&c(d.status<300?d:null)},d.send(null)},d3.text=function(a,b,c){function d(a){c(a&&a.responseText)}arguments.length<3&&(c=b,b=null),d3.xhr(a,b,d)},d3.json=function(a,b){d3.text(a,"application/json",function(a){b(a?JSON.parse(a):null)})},d3.html=function(a,b){d3.text(a,"text/html",function(a){if(a!=null){var c=document.createRange();c.selectNode(document.body),a=c.createContextualFragment(a)}b(a)})},d3.xml=function(a,b,c){function d(a){c(a&&a.responseXML)}arguments.length<3&&(c=b,b=null),d3.xhr(a,b,d)};var p={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};d3.ns={prefix:p,qualify:function(a){var b=a.indexOf(":");return b<0?a in p?{space:p[a],local:a}:a:{space:p[a.substring(0,b)],local:a.substring(b+1)}}},d3.dispatch=function(){var a=new q,b=-1,c=arguments.length;while(++b<c)a[arguments[b]]=r();return a},q.prototype.on=function(a,b){var c=a.indexOf("."),d="";return c>0&&(d=a.substring(c+1),a=a.substring(0,c)),arguments.length<2?this[a].on(d):(this[a].on(d,b),this)},d3.format=function(a){var b=s.exec(a),c=b[1]||" ",d=b[3]||"",e=b[5],f=+b[6],g=b[7],h=b[8],i=b[9],j=1,k="",l=!1;h&&(h=+h.substring(1)),e&&(c="0",g&&(f-=Math.floor((f-1)/4)));switch(i){case"n":g=!0,i="g";break;case"%":j=100,k="%",i="f";break;case"p":j=100,k="%",i="r";break;case"d":l=!0,h=0;break;case"s":j=-1,i="r"}return i=="r"&&!h&&(i="g"),i=t[i]||v,function(a){if(l&&a%1)return"";var b=a<0&&(a=-a)?"−":d;if(j<0){var m=d3.formatPrefix(a,h);a*=m.scale,k=m.symbol}else a*=j;a=i(a,h);if(e){var n=a.length+b.length;n<f&&(a=(new Array(f-n+1)).join(c)+a),g&&(a=w(a)),a=b+a}else{g&&(a=w(a)),a=b+a;var n=a.length;n<f&&(a=(new Array(f-n+1)).join(c)+a)}return a+k}};var s=/(?:([^{])?([<>=^]))?([+\- ])?(#)?(0)?([0-9]+)?(,)?(\.[0-9]+)?([a-zA-Z%])?/,t={g:function(a,b){return a.toPrecision(b)},e:function(a,b){return a.toExponential(b)},f:function(a,b){return a.toFixed(b)},r:function(a,b){return d3.round(a,b=u(a,b)).toFixed(Math.max(0,Math.min(20,b)))}},x=["y","z","a","f","p","n","μ","m","","k","M","G","T","P","E","Z","Y"].map(y);d3.formatPrefix=function(a,b){var c=0;return a&&(a<0&&(a*=-1),b&&(a=d3.round(a,u(a,b))),c=1+Math.floor(1e-12+Math.log(a)/Math.LN10),c=Math.max(-24,Math.min(24,Math.floor((c<=0?c+1:c-1)/3)*3))),x[8+c/3]};var z=H(2),A=H(3),B={linear:function(){return G},poly:H,quad:function(){return z},cubic:function(){return A},sin:function(){return I},exp:function(){return J},circle:function(){return K},elastic:L,back:M,bounce:function(){return N}},C={"in":function(a){return a},out:E,"in-out":F,"out-in":function(a){return F(E(a))}};d3.ease=function(a){var b=a.indexOf("-"),c=b>=0?a.substring(0,b):a,d=b>=0?a.substring(b+1):"in";return D(C[d](B[c].apply(null,Array.prototype.slice.call(arguments,1))))},d3.event=null,d3.interpolate=function(a,b){var c=d3.interpolators.length,d;while(--c>=0&&!(d=d3.interpolators[c](a,b)));return d},d3.interpolateNumber=function(a,b){return b-=a,function(c){return a+b*c}},d3.interpolateRound=function(a,b){return b-=a,function(c){return Math.round(a+b*c)}},d3.interpolateString=function(a,b){var c,d,e,f=0,g=0,h=[],i=[],j,k;P.lastIndex=0;for(d=0;c=P.exec(b);++d)c.index&&h.push(b.substring(f,g=c.index)),i.push({i:h.length,x:c[0]}),h.push(null),f=P.lastIndex;f<b.length&&h.push(b.substring(f));for(d=0,j=i.length;(c=P.exec(a))&&d<j;++d){k=i[d];if(k.x==c[0]){if(k.i)if(h[k.i+1]==null){h[k.i-1]+=k.x,h.splice(k.i,1);for(e=d+1;e<j;++e)i[e].i--}else{h[k.i-1]+=k.x+h[k.i+1],h.splice(k.i,2);for(e=d+1;e<j;++e)i[e].i-=2}else if(h[k.i+1]==null)h[k.i]=k.x;else{h[k.i]=k.x+h[k.i+1],h.splice(k.i+1,1);for(e=d+1;e<j;++e)i[e].i--}i.splice(d,1),j--,d--}else k.x=d3.interpolateNumber(parseFloat(c[0]),parseFloat(k.x))}while(d<j)k=i.pop(),h[k.i+1]==null?h[k.i]=k.x:(h[k.i]=k.x+h[k.i+1],h.splice(k.i+1,1)),j--;return h.length===1?h[0]==null?i[0].x:function(){return b}:function(a){for(d=0;d<j;++d)h[(k=i[d]).i]=k.x(a);return h.join("")}},d3.interpolateTransform=function(a,b){return d3.interpolateString(d3.transform(a)+"",d3.transform(b)+"")},d3.interpolateRgb=function(a,b){a=d3.rgb(a),b=d3.rgb(b);var c=a.r,d=a.g,e=a.b,f=b.r-c,g=b.g-d,h=b.b-e;return function(a){return"#"+V(Math.round(c+f*a))+V(Math.round(d+g*a))+V(Math.round(e+h*a))}},d3.interpolateHsl=function(a,b){a=d3.hsl(a),b=d3.hsl(b);var c=a.h,d=a.s,e=a.l,f=b.h-c,g=b.s-d,h=b.l-e;return function(a){return bb(c+f*a,d+g*a,e+h*a).toString()}},d3.interpolateArray=function(a,b){var c=[],d=[],e=a.length,f=b.length,g=Math.min(a.length,b.length),h;for(h=0;h<g;++h)c.push(d3.interpolate(a[h],b[h]));for(;h<e;++h)d[h]=a[h];for(;h<f;++h)d[h]=b[h];return function(a){for(h=0;h<g;++h)d[h]=c[h](a);return d}},d3.interpolateObject=function(a,b){var c={},d={},e;for(e in a)e in b?c[e]=Q(e)(a[e],b[e]):d[e]=a[e];for(e in b)e in a||(d[e]=b[e]);return function(a){for(e in c)d[e]=c[e](a);return d}};var P=/[-+]?(?:\d*\.?\d+)(?:[eE][-+]?\d+)?/g;d3.interpolators=[d3.interpolateObject,function(a,b){return b instanceof Array&&d3.interpolateArray(a,b)},function(a,b){return(typeof a=="string"||typeof b=="string")&&d3.interpolateString(a+"",b+"")},function(a,b){return(typeof b=="string"?b in Z||/^(#|rgb\(|hsl\()/.test(b):b instanceof U||b instanceof ba)&&d3.interpolateRgb(a,b)},function(a,b){return!isNaN(a=+a)&&!isNaN(b=+b)&&d3.interpolateNumber(a,b)}],d3.rgb=function(a,b,c){return arguments.length===1?a instanceof U?T(a.r,a.g,a.b):W(""+a,T,bb):T(~~a,~~b,~~c)},U.prototype.brighter=function(a){a=Math.pow(.7,arguments.length?a:1);var b=this.r,c=this.g,d=this.b,e=30;return!b&&!c&&!d?T(e,e,e):(b&&b<e&&(b=e),c&&c<e&&(c=e),d&&d<e&&(d=e),T(Math.min(255,Math.floor(b/a)),Math.min(255,Math.floor(c/a)),Math.min(255,Math.floor(d/a))))},U.prototype.darker=function(a){return a=Math.pow(.7,arguments.length?a:1),T(Math.floor(a*this.r),Math.floor(a*this.g),Math.floor(a*this.b))},U.prototype.hsl=function(){return X(this.r,this.g,this.b)},U.prototype.toString=function(){return"#"+V(this.r)+V(this.g)+V(this.b)};var Z={aliceblue:"#f0f8ff",antiquewhite:"#faebd7",aqua:"#00ffff",aquamarine:"#7fffd4",azure:"#f0ffff",beige:"#f5f5dc",bisque:"#ffe4c4",black:"#000000",blanchedalmond:"#ffebcd",blue:"#0000ff",blueviolet:"#8a2be2",brown:"#a52a2a",burlywood:"#deb887",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",cornflowerblue:"#6495ed",cornsilk:"#fff8dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkgray:"#a9a9a9",darkgreen:"#006400",darkgrey:"#a9a9a9",darkkhaki:"#bdb76b",darkmagenta:"#8b008b",darkolivegreen:"#556b2f",darkorange:"#ff8c00",darkorchid:"#9932cc",darkred:"#8b0000",darksalmon:"#e9967a",darkseagreen:"#8fbc8f",darkslateblue:"#483d8b",darkslategray:"#2f4f4f",darkslategrey
:"#2f4f4f",darkturquoise:"#00ced1",darkviolet:"#9400d3",deeppink:"#ff1493",deepskyblue:"#00bfff",dimgray:"#696969",dimgrey:"#696969",dodgerblue:"#1e90ff",firebrick:"#b22222",floralwhite:"#fffaf0",forestgreen:"#228b22",fuchsia:"#ff00ff",gainsboro:"#dcdcdc",ghostwhite:"#f8f8ff",gold:"#ffd700",goldenrod:"#daa520",gray:"#808080",green:"#008000",greenyellow:"#adff2f",grey:"#808080",honeydew:"#f0fff0",hotpink:"#ff69b4",indianred:"#cd5c5c",indigo:"#4b0082",ivory:"#fffff0",khaki:"#f0e68c",lavender:"#e6e6fa",lavenderblush:"#fff0f5",lawngreen:"#7cfc00",lemonchiffon:"#fffacd",lightblue:"#add8e6",lightcoral:"#f08080",lightcyan:"#e0ffff",lightgoldenrodyellow:"#fafad2",lightgray:"#d3d3d3",lightgreen:"#90ee90",lightgrey:"#d3d3d3",lightpink:"#ffb6c1",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",lightskyblue:"#87cefa",lightslategray:"#778899",lightslategrey:"#778899",lightsteelblue:"#b0c4de",lightyellow:"#ffffe0",lime:"#00ff00",limegreen:"#32cd32",linen:"#faf0e6",magenta:"#ff00ff",maroon:"#800000",mediumaquamarine:"#66cdaa",mediumblue:"#0000cd",mediumorchid:"#ba55d3",mediumpurple:"#9370db",mediumseagreen:"#3cb371",mediumslateblue:"#7b68ee",mediumspringgreen:"#00fa9a",mediumturquoise:"#48d1cc",mediumvioletred:"#c71585",midnightblue:"#191970",mintcream:"#f5fffa",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",navajowhite:"#ffdead",navy:"#000080",oldlace:"#fdf5e6",olive:"#808000",olivedrab:"#6b8e23",orange:"#ffa500",orangered:"#ff4500",orchid:"#da70d6",palegoldenrod:"#eee8aa",palegreen:"#98fb98",paleturquoise:"#afeeee",palevioletred:"#db7093",papayawhip:"#ffefd5",peachpuff:"#ffdab9",peru:"#cd853f",pink:"#ffc0cb",plum:"#dda0dd",powderblue:"#b0e0e6",purple:"#800080",red:"#ff0000",rosybrown:"#bc8f8f",royalblue:"#4169e1",saddlebrown:"#8b4513",salmon:"#fa8072",sandybrown:"#f4a460",seagreen:"#2e8b57",seashell:"#fff5ee",sienna:"#a0522d",silver:"#c0c0c0",skyblue:"#87ceeb",slateblue:"#6a5acd",slategray:"#708090",slategrey:"#708090",snow:"#fffafa",springgreen:"#00ff7f",steelblue:"#4682b4",tan:"#d2b48c",teal:"#008080",thistle:"#d8bfd8",tomato:"#ff6347",turquoise:"#40e0d0",violet:"#ee82ee",wheat:"#f5deb3",white:"#ffffff",whitesmoke:"#f5f5f5",yellow:"#ffff00",yellowgreen:"#9acd32"};for(var $ in Z)Z[$]=W(Z[$],T,bb);d3.hsl=function(a,b,c){return arguments.length===1?a instanceof ba?_(a.h,a.s,a.l):W(""+a,X,_):_(+a,+b,+c)},ba.prototype.brighter=function(a){return a=Math.pow(.7,arguments.length?a:1),_(this.h,this.s,this.l/a)},ba.prototype.darker=function(a){return a=Math.pow(.7,arguments.length?a:1),_(this.h,this.s,a*this.l)},ba.prototype.rgb=function(){return bb(this.h,this.s,this.l)},ba.prototype.toString=function(){return this.rgb().toString()};var bd=function(a,b){return b.querySelector(a)},be=function(a,b){return b.querySelectorAll(a)};typeof Sizzle=="function"&&(bd=function(a,b){return Sizzle(a,b)[0]},be=function(a,b){return Sizzle.uniqueSort(Sizzle(a,b))});var bf=[];d3.selection=function(){return bm},d3.selection.prototype=bf,bf.select=function(a){var b=[],c,d,e,f;typeof a!="function"&&(a=bg(a));for(var g=-1,h=this.length;++g<h;){b.push(c=[]),c.parentNode=(e=this[g]).parentNode;for(var i=-1,j=e.length;++i<j;)(f=e[i])?(c.push(d=a.call(f,f.__data__,i)),d&&"__data__"in f&&(d.__data__=f.__data__)):c.push(null)}return bc(b)},bf.selectAll=function(a){var b=[],c,e;typeof a!="function"&&(a=bh(a));for(var f=-1,g=this.length;++f<g;)for(var h=this[f],i=-1,j=h.length;++i<j;)if(e=h[i])b.push(c=d(a.call(e,e.__data__,i))),c.parentNode=e;return bc(b)},bf.attr=function(a,b){function d(){this.removeAttribute(a)}function e(){this.removeAttributeNS(a.space,a.local)}function f(){this.setAttribute(a,b)}function g(){this.setAttributeNS(a.space,a.local,b)}function h(){var c=b.apply(this,arguments);c==null?this.removeAttribute(a):this.setAttribute(a,c)}function i(){var c=b.apply(this,arguments);c==null?this.removeAttributeNS(a.space,a.local):this.setAttributeNS(a.space,a.local,c)}a=d3.ns.qualify(a);if(arguments.length<2){var c=this.node();return a.local?c.getAttributeNS(a.space,a.local):c.getAttribute(a)}return this.each(b==null?a.local?e:d:typeof b=="function"?a.local?i:h:a.local?g:f)},bf.classed=function(a,b){var c=a.split(bi),d=c.length,e=-1;if(arguments.length>1){while(++e<d)bj.call(this,c[e],b);return this}while(++e<d)if(!bj.call(this,c[e]))return!1;return!0};var bi=/\s+/g;bf.style=function(a,b,c){function d(){this.style.removeProperty(a)}function e(){this.style.setProperty(a,b,c)}function f(){var d=b.apply(this,arguments);d==null?this.style.removeProperty(a):this.style.setProperty(a,d,c)}return arguments.length<3&&(c=""),arguments.length<2?window.getComputedStyle(this.node(),null).getPropertyValue(a):this.each(b==null?d:typeof b=="function"?f:e)},bf.property=function(a,b){function c(){delete this[a]}function d(){this[a]=b}function e(){var c=b.apply(this,arguments);c==null?delete this[a]:this[a]=c}return arguments.length<2?this.node()[a]:this.each(b==null?c:typeof b=="function"?e:d)},bf.text=function(a){return arguments.length<1?this.node().textContent:this.each(typeof a=="function"?function(){this.textContent=a.apply(this,arguments)}:function(){this.textContent=a})},bf.html=function(a){return arguments.length<1?this.node().innerHTML:this.each(typeof a=="function"?function(){this.innerHTML=a.apply(this,arguments)}:function(){this.innerHTML=a})},bf.append=function(a){function b(){return this.appendChild(document.createElementNS(this.namespaceURI,a))}function c(){return this.appendChild(document.createElementNS(a.space,a.local))}return a=d3.ns.qualify(a),this.select(a.local?c:b)},bf.insert=function(a,b){function c(){return this.insertBefore(document.createElementNS(this.namespaceURI,a),bd(b,this))}function d(){return this.insertBefore(document.createElementNS(a.space,a.local),bd(b,this))}return a=d3.ns.qualify(a),this.select(a.local?d:c)},bf.remove=function(){return this.each(function(){var a=this.parentNode;a&&a.removeChild(this)})},bf.data=function(a,b){function f(a,f){var g,h=a.length,i=f.length,j=Math.min(h,i),k=Math.max(h,i),l=[],m=[],n=[],o,p;if(b){var q={},r=[],s,t=f.length;for(g=-1;++g<h;)s=b.call(o=a[g],o.__data__,g),s in q?n[t++]=o:q[s]=o,r.push(s);for(g=-1;++g<i;)o=q[s=b.call(f,p=f[g],g)],o?(o.__data__=p,l[g]=o,m[g]=n[g]=null):(m[g]=bk(p),l[g]=n[g]=null),delete q[s];for(g=-1;++g<h;)r[g]in q&&(n[g]=a[g])}else{for(g=-1;++g<j;)o=a[g],p=f[g],o?(o.__data__=p,l[g]=o,m[g]=n[g]=null):(m[g]=bk(p),l[g]=n[g]=null);for(;g<i;++g)m[g]=bk(f[g]),l[g]=n[g]=null;for(;g<k;++g)n[g]=a[g],m[g]=l[g]=null}m.update=l,m.parentNode=l.parentNode=n.parentNode=a.parentNode,c.push(m),d.push(l),e.push(n)}var c=[],d=[],e=[],g=-1,h=this.length,i;if(typeof a=="function")while(++g<h)f(i=this[g],a.call(i,i.parentNode.__data__,g));else while(++g<h)f(i=this[g],a);var j=bc(d);return j.enter=function(){return bn(c)},j.exit=function(){return bc(e)},j},bf.filter=function(a){var b=[],c,d,e;for(var f=0,g=this.length;f<g;f++){b.push(c=[]),c.parentNode=(d=this[f]).parentNode;for(var h=0,i=d.length;h<i;h++)(e=d[h])&&a.call(e,e.__data__,h)&&c.push(e)}return bc(b)},bf.map=function(a){return this.each(function(){this.__data__=a.apply(this,arguments)})},bf.sort=function(a){a=bl.apply(this,arguments);for(var b=0,c=this.length;b<c;b++)for(var d=this[b].sort(a),e=1,f=d.length,g=d[0];e<f;e++){var h=d[e];h&&(g&&g.parentNode.insertBefore(h,g.nextSibling),g=h)}return this},bf.on=function(a,b,c){arguments.length<3&&(c=!1);var d="__on"+a,e=a.indexOf(".");return e>0&&(a=a.substring(0,e)),arguments.length<2?(e=this.node()[d])&&e._:this.each(function(e,f){function h(a){var c=d3.event;d3.event=a;try{b.call(g,g.__data__,f)}finally{d3.event=c}}var g=this;g[d]&&g.removeEventListener(a,g[d],c),b&&g.addEventListener(a,g[d]=h,c),h._=b})},bf.each=function(a){for(var b=-1,c=this.length;++b<c;)for(var d=this[b],e=-1,f=d.length;++e<f;){var g=d[e];g&&a.call(g,g.__data__,e,b)}return this},bf.call=function(a){return a.apply(this,(arguments[0]=this,arguments)),this},bf.empty=function(){return!this.node()},bf.node=function(a){for(var b=0,c=this.length;b<c;b++)for(var d=this[b],e=0,f=d.length;e<f;e++){var g=d[e];if(g)return g}return null},bf.transition=function(){var a=[],b,c;for(var d=-1,e=this.length;++d<e;){a.push(b=[]);for(var f=this[d],g=-1,h=f.length;++g<h;)b.push((c=f[g])?{node:c,delay:0,duration:250}:null)}return bp(a,bv||++bu,Date.now())};var bm=bc([[document]]);bm[0].parentNode=document.documentElement,d3.select=function(a){return typeof a=="string"?bm.select(a):bc([[a]])},d3.selectAll=function(a){return typeof a=="string"?bm.selectAll(a):bc([d(a)])};var bo=[];bo.append=bf.append,bo.insert=bf.insert,bo.empty=bf.empty,bo.node=bf.node,bo.select=function(a){var b=[],c,d,e,f,g;for(var h=-1,i=this.length;++h<i;){e=(f=this[h]).update,b.push(c=[]),c.parentNode=f.parentNode;for(var j=-1,k=f.length;++j<k;)(g=f[j])?(c.push(e[j]=d=a.call(f.parentNode,g.__data__,j)),d.__data__=g.__data__):c.push(null)}return bc(b)};var bq={},bt=[],bu=0,bv=0,bw=d3.ease("cubic-in-out");bt.call=bf.call,d3.transition=function(){return bm.transition()},d3.transition.prototype=bt,bt.select=function(a){var b=[],c,d,e;typeof a!="function"&&(a=bg(a));for(var f=-1,g=this.length;++f<g;){b.push(c=[]);for(var h=this[f],i=-1,j=h.length;++i<j;)(e=h[i])&&(d=a.call(e.node,e.node.__data__,i))?("__data__"in e.node&&(d.__data__=e.node.__data__),c.push({node:d,delay:e.delay,duration:e.duration})):c.push(null)}return bp(b,this.id,this.time).ease(this.ease())},bt.selectAll=function(a){var b=[],c,d,e;typeof a!="function"&&(a=bh(a));for(var f=-1,g=this.length;++f<g;)for(var h=this[f],i=-1,j=h.length;++i<j;)if(e=h[i]){d=a.call(e.node,e.node.__data__,i),b.push(c=[]);for(var k=-1,l=d.length;++k<l;)c.push({node:d[k],delay:e.delay,duration:e.duration})}return bp(b,this.id,this.time).ease(this.ease())},bt.attr=function(a,b){return this.attrTween(a,bs(a,b))},bt.attrTween=function(a,b){function d(a,d){var e=b.call(this,a,d,this.getAttribute(c));return e===bq?(this.removeAttribute(c),null):e&&function(a){this.setAttribute(c,e(a))}}function e(a,d){var e=b.call(this,a,d,this.getAttributeNS(c.space,c.local));return e===bq?(this.removeAttributeNS(c.space,c.local),null):e&&function(a){this.setAttributeNS(c.space,c.local,e(a))}}var c=d3.ns.qualify(a);return this.tween("attr."+a,c.local?e:d)},bt.style=function(a,b,c){return arguments.length<3&&(c=""),this.styleTween(a,bs(a,b),c)},bt.styleTween=function(a,b,c){return arguments.length<3&&(c=""),this.tween("style."+a,function(d,e){var f=b.call(this,d,e,window.getComputedStyle(this,null).getPropertyValue(a));return f===bq?(this.style.removeProperty(a),null):f&&function(b){this.style.setProperty(a,f(b),c)}})},bt.text=function(a){return this.tween("text",function(b,c){this.textContent=typeof a=="function"?a.call(this,b,c):a})},bt.remove=function(){return this.each("end",function(){var a;!this.__transition__&&(a=this.parentNode)&&a.removeChild(this)})},bt.delay=function(a){var b=this;return b.each(typeof a=="function"?function(c,d,e){b[e][d].delay=+a.apply(this,arguments)}:(a=+a,function(c,d,e){b[e][d].delay=a}))},bt.duration=function(a){var b=this;return b.each(typeof a=="function"?function(c,d,e){b[e][d].duration=+a.apply(this,arguments)}:(a=+a,function(c,d,e){b[e][d].duration=a}))},bt.transition=function(){return this.select(i)};var by=null,bz,bA;d3.timer=function(a,b,c){var d=!1,e,f=by;if(arguments.length<3){if(arguments.length<2)b=0;else if(!isFinite(b))return;c=Date.now()}while(f){if(f.callback===a){f.then=c,f.delay=b,d=!0;break}e=f,f=f.next}d||(by={callback:a,then:c,delay:b,next:by}),bz||(bA=clearTimeout(bA),bz=1,bD(bB))},d3.timer.flush=function(){var a,b=Date.now(),c=by;while(c)a=b-c.then,c.delay||(c.flush=c.callback(a)),c=c.next;bC()};var bD=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(a){setTimeout(a,17)};d3.transform=function(a){bI.setAttribute("transform",a);var b=bI.transform.baseVal.consolidate();return new bE(b?b.matrix:bJ)},bE.prototype.toString=function(){return"translate("+this.translate+")rotate("+this.rotate+")skewX("+this.skew+")scale("+this.scale+")"};var bI=document.createElementNS(d3.ns.prefix.svg,"g"),bJ={a:1,b:0,c:0,d:1,e:0,f:0},bK=180/Math.PI;d3.scale={},d3.scale.linear=function(){return bQ([0,1],[0,1],d3.interpolate,!1)},d3.scale.log=function(){return bY(d3.scale.linear(),b$)};var bZ=d3.format(".0e");b$.pow=function(a){return Math.pow(10,a)},b_.pow=function(a){return-Math.pow(10,-a)},d3.scale.pow=function(){return ca(d3.scale.linear(),1)},d3.scale.sqrt=function(){return d3.scale.pow().exponent(.5)},d3.scale.ordinal=function(){return cc([],{t:"range",x:[]})},d3.scale.category10=function(){return d3.scale.ordinal().range(cd)},d3.scale.category20=function(){return d3.scale.ordinal().range(ce)},d3.scale.category20b=function(){return d3.scale.ordinal().range(cf)},d3.scale.category20c=function(){return d3.scale.ordinal().range(cg)};var cd=["#1f77b4","#ff7f0e","#2ca02c","#d62728","#9467bd","#8c564b","#e377c2","#7f7f7f","#bcbd22","#17becf"],ce=["#1f77b4","#aec7e8","#ff7f0e","#ffbb78","#2ca02c","#98df8a","#d62728","#ff9896","#9467bd","#c5b0d5","#8c564b","#c49c94","#e377c2","#f7b6d2","#7f7f7f","#c7c7c7","#bcbd22","#dbdb8d","#17becf","#9edae5"],cf=["#393b79","#5254a3","#6b6ecf","#9c9ede","#637939","#8ca252","#b5cf6b","#cedb9c","#8c6d31","#bd9e39","#e7ba52","#e7cb94","#843c39","#ad494a","#d6616b","#e7969c","#7b4173","#a55194","#ce6dbd","#de9ed6"],cg=["#3182bd","#6baed6","#9ecae1","#c6dbef","#e6550d","#fd8d3c","#fdae6b","#fdd0a2","#31a354","#74c476","#a1d99b","#c7e9c0","#756bb1","#9e9ac8","#bcbddc","#dadaeb","#636363","#969696","#bdbdbd","#d9d9d9"];d3.scale.quantile=function(){return ch([],[])},d3.scale.quantize=function(){return ci(0,1,[0,1])},d3.svg={},d3.svg.arc=function(){function e(){var e=a.apply(this,arguments),f=b.apply(this,arguments),g=c.apply(this,arguments)+cj,h=d.apply(this,arguments)+cj,i=(h<g&&(i=g,g=h,h=i),h-g),j=i<Math.PI?"0":"1",k=Math.cos(g),l=Math.sin(g),m=Math.cos(h),n=Math.sin(h);return i>=ck?e?"M0,"+f+"A"+f+","+f+" 0 1,1 0,"+ -f+"A"+f+","+f+" 0 1,1 0,"+f+"M0,"+e+"A"+e+","+e+" 0 1,0 0,"+ -e+"A"+e+","+e+" 0 1,0 0,"+e+"Z":"M0,"+f+"A"+f+","+f+" 0 1,1 0,"+ -f+"A"+f+","+f+" 0 1,1 0,"+f+"Z":e?"M"+f*k+","+f*l+"A"+f+","+f+" 0 "+j+",1 "+f*m+","+f*n+"L"+e*m+","+e*n+"A"+e+","+e+" 0 "+j+",0 "+e*k+","+e*l+"Z":"M"+f*k+","+f*l+"A"+f+","+f+" 0 "+j+",1 "+f*m+","+f*n+"L0,0"+"Z"}var a=cl,b=cm,c=cn,d=co;return e.innerRadius=function(b){return arguments.length?(a=d3.functor(b),e):a},e.outerRadius=function(a){return arguments.length?(b=d3.functor(a),e):b},e.startAngle=function(a){return arguments.length?(c=d3.functor(a),e):c},e.endAngle=function(a){return arguments.length?(d=d3.functor(a),e):d},e.centroid=function(){var e=(a.apply(this,arguments)+b.apply(this,arguments))/2,f=(c.apply(this,arguments)+d.apply(this,arguments))/2+cj;return[Math.cos(f)*e,Math.sin(f)*e]},e};var cj=-Math.PI/2,ck=2*Math.PI-1e-6;d3.svg.line=function(){return cp(Object)};var ct={linear:cu,"step-before":cv,"step-after":cw,basis:cC,"basis-open":cD,"basis-closed":cE,bundle:cF,cardinal:cz,"cardinal-open":cx,"cardinal-closed":cy,monotone:cO},cH=[0,2/3,1/3,0],cI=[0,1/3,2/3,0],cJ=[0,1/6,2/3,1/6];d3.svg.line.radial=function(){var a=cp(cP);return a.radius=a.x,delete a.x,a.angle=a.y,delete a.y,a},cv.reverse=cw,cw.reverse=cv,d3.svg.area=function(){return cQ(Object)},d3.svg.area.radial=function(){var a=cQ(cP);return a.radius=a.x,delete a.x,a.innerRadius=a.x0,delete a.x0,a.outerRadius=a.x1,delete a.x1,a.angle=a.y,delete a.y,a.startAngle=a.y0,delete a.y0,a.endAngle=a.y1,delete a.y1,a},d3.svg.chord=function(){function f(c,d){var e=g(this,a,c,d),f=g(this,b,c,d);return"M"+e.p0+i(e.r,e.p1)+(h(e,f)?j(e.r,e.p1,e.r,e.p0):j(e.r,e.p1,f.r,f.p0)+i(f.r,f.p1)+j(f.r,f.p1,e.r,e.p0))+"Z"}function g(a,b,f,g){var h=b.call(a,f,g),i=c.call(a,h,g),j=d.call(a,h,g)+cj,k=e.call(a,h,g)+cj;return{r:i,a0:j,a1:k,p0:[i*Math.cos(j),i*Math.sin(j)],p1:[i*Math.cos(k),i*Math.sin(k)]}}function h(a,b){return a.a0==b.a0&&a.a1==b.a1}function i(a,b){return"A"+a+","+a+" 0 0,1 "+b}function j(a,b,c,d){return"Q 0,0 "+d}var a=cT,b=cU,c=cV,d=cn,e=co;return f.radius=function(a){return arguments.length?(c=d3.functor(a),f):c},f.source=function(b){return arguments.length?(a=d3.functor(b),f):a},f.target=function(a){return arguments.length?(b=d3.functor(a),f):b},f.startAngle=function(a){return arguments.length?(d=d3.functor(a),f):d},f.endAngle=function(a){return arguments.length?(e=d3.functor(a),f):e},f},d3.svg.diagonal=function(){function d(d,e){var f=a.call(this,d,e),g=b.call(this,d,e),h=(f.y+g.y)/2,i=[f,{x:f.x,y:h},{x:g.x,y:h},g];return i=i.map(c),"M"+i[0]+"C"+i[1]+" "+i[2]+" "+i[3]}var a=cT,b=cU,c=cY;return d.source=function(b){return arguments.length?(a=d3.functor(b),d):a},d.target=function(a){return arguments.length?(b=d3.functor(a),d):b},d.projection=function(a){return arguments.length?(c=a,d):c},d},d3.svg.diagonal.radial=function(){var a=d3.svg.diagonal(),b=cY,c=a.projection;return a.projection=function(a){return arguments.length?c(cZ(b=a)):b},a},d3.svg.mouse=function(a){return c_(a,d3.event)};var c$=/WebKit/.test(navigator.userAgent)?-1:0;d3.svg.touches=function(a,b){return arguments.length<2&&(b=d3.event.touches),b?d(b).map(function(b){var c=c_(a,b);return c.identifier=b.identifier,c}):[]},d3.svg.symbol=function(){function c(c,d){return(dc[a.call(this,c,d)]||dc.circle)(b.call(this,c,d))}var a=db,b=da;return c.type=function(b){return arguments.length?(a=d3.functor(b),c):a},c.size=function(a){return arguments.length?(b=d3.functor(a),c):b},c};var dc={circle:function(a){var b=Math.sqrt(a/Math.PI);return"M0,"+b+"A"+b+","+b+" 0 1,1 0,"+ -b+"A"+b+","+b+" 0 1,1 0,"+b+"Z"},cross:function(a){var b=Math.sqrt(a/5)/2;return"M"+ -3*b+","+ -b+"H"+ -b+"V"+ -3*b+"H"+b+"V"+ -b+"H"+3*b+"V"+b+"H"+b+"V"+3*b+"H"+ -b+"V"+b+"H"+ -3*b+"Z"},diamond:function(a){var b=Math.sqrt(a/(2*de)),c=b*de;return"M0,"+ -b+"L"+c+",0"+" 0,"+b+" "+ -c+",0"+"Z"},square:function(a){var b=Math.sqrt(a)/2;return"M"+ -b+","+ -b+"L"+b+","+ -b+" "+b+","+b+" "+ -b+","+b+"Z"},"triangle-down":function(a){var b=Math.sqrt(a/dd),c=b*dd/2;return"M0,"+c+"L"+b+","+ -c+" "+ -b+","+ -c+"Z"},"triangle-up":function(a){var b=Math.sqrt(a/dd),c=b*dd/2;return"M0,"+ -c+"L"+b+","+c+" "+ -b+","+c+"Z"}};d3.svg.symbolTypes=d3.keys(dc);var dd=Math.sqrt(3),de=Math.tan(30*Math.PI/180);d3.svg.axis=function(){function j(j){j.each(function(k,l,m){var n=d3.select(this),o=j.delay?function(a){var b=bv;try{return bv=j.id,a.transition().delay(j[m][l].delay).duration(j[m][l].duration).ease(j.ease())}finally{bv=b}}:Object,p=a.ticks?a.ticks.apply(a,g):a.domain(),q=h==null?a.tickFormat?a.tickFormat.apply(a,g):String:h,r=dh(a,p,i),s=n.selectAll(".minor").data(r,String),t=s.enter().insert("line","g").attr("class","tick minor").style("opacity",1e-6),u=o(s.exit()).style("opacity",1e-6).remove(),v=o(s).style("opacity",1),w=n.selectAll("g").data(p,String),x=w.enter().insert("g","path").style("opacity",1e-6),y=o(w.exit()).style("opacity",1e-6).remove(),z=o(w).style("opacity",1),A,B=bN(a),C=n.selectAll(".domain").data([0]),D=C.enter().append("path").attr("class","domain"),E=o(C),F=a.copy(),G=this.__chart__||F;this.__chart__=F,x.append("line").attr("class","tick"),x.append("text"),z.select("text").text(q);switch(b){case"bottom":A=df,v.attr("x2",0).attr("y2",d),z.select("line").attr("x2",0).attr("y2",c),z.select("text").attr("x",0).attr("y",Math.max(c,0)+f).attr("dy",".71em").attr("text-anchor","middle"),E.attr("d","M"+B[0]+","+e+"V0H"+B[1]+"V"+e);break;case"top":A=df,v.attr("x2",0).attr("y2",-d),z.select("line").attr("x2",0).attr("y2",-c),z.select("text").attr("x",0).attr("y",-(Math.max(c,0)+f)).attr("dy","0em").attr("text-anchor","middle"),E.attr("d","M"+B[0]+","+ -e+"V0H"+B[1]+"V"+ -e);break;case"left":A=dg,v.attr("x2",-d).attr("y2",0),z.select("line").attr("x2",-c).attr("y2",0),z.select("text").attr("x",-(Math.max(c,0)+f)).attr("y",0).attr("dy",".32em").attr("text-anchor","end"),E.attr("d","M"+ -e+","+B[0]+"H0V"+B[1]+"H"+ -e);break;case"right":A=dg,v.attr("x2",d).attr("y2",0),z.select("line").attr("x2",c).attr("y2",0),z.select("text").attr("x",Math.max(c,0)+f).attr("y",0).attr("dy",".32em").attr("text-anchor","start"),E.attr("d","M"+e+","+B[0]+"H0V"+B[1]+"H"+e)}if(a.ticks)x.call(A,G),z.call(A,F),y.call(A,F),t.call(A,G),v.call(A,F),u.call(A,F);else{var H=F.rangeBand()/2,I=function(a){return F(a)+H};x.call(A,I),z.call(A,I)}})}var a=d3.scale.linear(),b="bottom",c=6,d=6,e=6,f=3,g=[10],h,i=0;return j.scale=function(b){return arguments.length?(a=b,j):a},j.orient=function(a){return arguments.length?(b=a,j):b},j.ticks=function(){return arguments.length?(g=arguments,j):g},j.tickFormat=function(a){return arguments.length?(h=a,j):h},j.tickSize=function(a,b,f){if(!arguments.length)return c;var g=arguments.length-1;return c=+a,d=g>1?+b:c,e=g>0?+arguments[g]:c,j},j.tickPadding=function(a){return arguments.length?(f=+a,j):f},j.tickSubdivide=function(a){return arguments.length?(i=+a,j):i},j},d3.svg.brush=function(){function e(a){var g=b&&c?["n","e","s","w","nw","ne","se","sw"]:b?["e","w"]:c?["n","s"]:[];a.each(function(){var a=d3.select(this).on("mousedown.brush",f),h=a.selectAll(".background").data([,]),i=a.selectAll(".extent").data([,]),j=a.selectAll(".resize").data(g,String),k;h.enter().append("rect").attr("class","background").style("visibility","hidden").style("pointer-events","all").style("cursor","crosshair"),i.enter().append("rect").attr("class","extent").style("cursor","move"),j.enter().append("rect").attr("class",function(a){return"resize "+a}).attr("width",6).attr("height",6).style("visibility","hidden").style("pointer-events",e.empty()?"none":"all").style("cursor",function(a){return dA[a]}),j.exit().remove(),b&&(k=bN(b),h.attr("x",k[0]).attr("width",k[1]-k[0]),dt(a,d)),c&&(k=bN(c),h.attr("y",k[0]).attr("height",k[1]-k[0]),du(a,d))})}function f(){var a=d3.select(d3.event.target);di=e,dk=this,dn=d,ds=d3.svg.mouse(dk),(dp=a.classed("extent"))?(ds[0]=d[0][0]-ds[0],ds[1]=d[0][1]-ds[1]):a.classed("resize")?(dq=d3.event.target.__data__,ds[0]=d[+/w$/.test(dq)][0],ds[1]=d[+/^n/.test(dq)][1]):d3.event.altKey&&(dr=ds.slice()),dl=!/^(n|s)$/.test(dq)&&b,dm=!/^(e|w)$/.test(dq)&&c,dj=g(this,arguments),dj("brushstart"),dx(),O()}function g(b,c){return function(d){var f=d3.event;try{d3.event={type:d,target:e},a[d].apply(b,c)}finally{d3.event=f}}}var a=d3.dispatch("brushstart","brush","brushend"),b,c,d=[[0,0],[0,0]];return e.x=function(a){return arguments.length?(b=a,e):b},e.y=function(a){return arguments.length?(c=a,e):c},e.extent=function(a){var f,g,h,i,j;return arguments.length?(b&&(f=a[0],g=a[1],c&&(f=f[0],g=g[0]),b.invert&&(f=b(f),g=b(g)),g<f&&(j=f,f=g,g=j),d[0][0]=f,d[1][0]=g),c&&(h=a[0],i=a[1],b&&(h=h[1],i=i[1]),c.invert&&(h=c(h),i=c(i)),i<h&&(j=h,h=i,i=j),d[0][1]=h,d[1][1]=i),e):(b&&(f=d[0][0],g=d[1][0],b.invert&&(f=b.invert(f),g=b.invert(g)),g<f&&(j=f,f=g,g=j)),c&&(h=d[0][1],i=d[1][1],c.invert&&(h=c.invert(h),i=c.invert(i)),i<h&&(j=h,h=i,i=j)),b&&c?[[f,h],[g,i]]:b?[f,g]:c&&[h,i])},e.clear=function(){return d[0][0]=d[0][1]=d[1][0]=d[1][1]=0,e},e.empty=function(){return b&&d[0][0]===d[1][0]||c&&d[0][1]===d[1][1]},d3.select(window).on("mousemove.brush",dx).on("mouseup.brush",dz).on("keydown.brush",dv).on("keyup.brush",dw),d3.rebind(e,a,"on")};var di,dj,dk,dl,dm,dn,dp,dq,dr,ds,dA={n:"ns-resize",e:"ew-resize",s:"ns-resize",w:"ew-resize",nw:"nwse-resize",ne:"nesw-resize",se:"nwse-resize",sw:"nesw-resize"};d3.behavior={},d3.behavior.drag=function(){function c(){this.on("mousedown.drag",e).on("touchstart.drag",e),d3.select(window).on("mousemove.drag",dK).on("touchmove.drag",dK).on("mouseup.drag",dL,!0).on("touchend.drag",dL,!0).on("click.drag",dM,!0)}function d(){dB=a,dC=d3.event.target,dD=this,dE=arguments,dG=dJ(),b?(dF=b.apply(dD,dE),dF=[dF.x-dG[0],dF.y-dG[1]]):dF=[0,0],dH=0}function e(){d.apply(this,arguments),dI("dragstart")}var a=d3.dispatch("drag","dragstart","dragend"),b=null;return c.origin=function(a){return arguments.length?(b=a,c):b},d3.rebind(c,a,"on")};var dB,dC,dD,dE,dF,dG,dH;d3.behavior.zoom=function(){function d(){this.on("mousedown.zoom",f).on("mousewheel.zoom",g).on("DOMMouseScroll.zoom",g).on("dblclick.zoom",h).on("touchstart.zoom",i),d3.select(window).on("mousemove.zoom",eb).on("mouseup.zoom",ec).on("touchmove.zoom",ea).on("touchend.zoom",d_).on("click.zoom",ed,!0)}function e(){dS=a,dT=c,dU=b.zoom,dV=d3.event.target,dW=this,dX=arguments}function f(){e.apply(this,arguments),dO=dZ(d3.svg.mouse(dW)),dY=0,d3.event.preventDefault(),window.focus()}function g(){e.apply(this,arguments),dP||(dP=dZ(d3.svg.mouse(dW))),ee(d$()+a[2],d3.svg.mouse(dW),dP)}function h(){e.apply(this,arguments);var b=d3.svg.mouse(dW);ee(d3.event.shiftKey?Math.ceil(a[2]-1):Math.floor(a[2]+1),b,dZ(b))}function i(){e.apply(this,arguments);var b=d_(),c,d=Date.now();b.length===1&&d-dR<300&&ee(1+Math.floor(a[2]),c=b[0],dQ[c.identifier]),dR=d}var a=[0,0,0],b=d3.dispatch("zoom"),c=ef;return d.extent=function(a){return arguments.length?(c=a==null?ef:a,d):c},d3.rebind(d,b,"on")};var dN,dO,dP,dQ={},dR=0,dS,dT,dU,dV,dW,dX,dY,ef=[[-Infinity,Infinity],[-Infinity,Infinity],[-Infinity,Infinity]]})(),function(){function c(a){var b=0,c=0;for(;;){if(a(b,c))return[b,c];b===0?(b=c+1,c=0):(b-=1,c+=1)}}function d(a,b,c,d){var e,f,g,h,i,j,k;return e=d[a],f=e[0],g=e[1],e=d[b],h=e[0],i=e[1],e=d[c],j=e[0],k=e[1],(k-g)*(h-f)-(i-g)*(j-f)>0}function e(a,b,c){return(c[0]-b[0])*(a[1]-b[1])<(c[1]-b[1])*(a[0]-b[0])}function f(a,b,c,d){var e=a[0],f=b[0],g=c[0],h=d[0],i=a[1],j=b[1],k=c[1],l=d[1],m=e-g,n=f-e,o=h-g,p=i-k,q=j-i,r=l-k,s=(o*p-r*m)/(r*n-o*q);return[e+s*n,i+s*q]}function h(a,b){var c={list:a.map(function(a,b){return{index:b,x:a[0],y:a[1]}}).sort(function(a,b){return a.y<b.y?-1:a.y>b.y?1:a.x<b.x?-1:a.x>b.x?1:0}),bottomSite:null},d={list:[],leftEnd:null,rightEnd:null,init:function(){d.leftEnd=d.createHalfEdge(null,"l"),d.rightEnd=d.createHalfEdge(null,"l"),d.leftEnd.r=d.rightEnd,d.rightEnd.l=d.leftEnd,d.list.unshift(d.leftEnd,d.rightEnd)},createHalfEdge:function(a,b){return{edge:a,side:b,vertex:null,l:null,r:null}},insert:function(a,b){b.l=a,b.r=a.r,a.r.l=b,a.r=b},leftBound:function(a){var b=d.leftEnd;do b=b.r;while(b!=d.rightEnd&&e.rightOf(b,a));return b=b.l,b},del:function(a){a.l.r=a.r,a.r.l=a.l,a.edge=null},right:function(a){return a.r},left:function(a){return a.l},leftRegion:function(a){return a.edge==null?c.bottomSite:a.edge.region[a.side]},rightRegion:function(a){return a.edge==null?c.bottomSite:a.edge.region[g[a.side]]}},e={bisect:function(a,b){var c={region:{l:a,r:b},ep:{l:null,r:null}},d=b.x-a.x,e=b.y-a.y,f=d>0?d:-d,g=e>0?e:-e;return c.c=a.x*d+a.y*e+(d*d+e*e)*.5,f>g?(c.a=1,c.b=e/d,c.c/=d):(c.b=1,c.a=d/e,c.c/=e),c},intersect:function(a,b){var c=a.edge,d=b.edge;if(!c||!d||c.region.r==d.region.r)return null;var e=c.a*d.b-c.b*d.a;if(Math.abs(e)<1e-10)return null;var f=(c.c*d.b-d.c*c.b)/e,g=(d.c*c.a-c.c*d.a)/e,h=c.region.r,i=d.region.r,j,k;h.y<i.y||h.y==i.y&&h.x<i.x?(j=a,k=c):(j=b,k=d);var l=f>=k.region.r.x;return l&&j.side==="l"||!l&&j.side==="r"?null:{x:f,y:g}},rightOf:function(a,b){var c=a.edge,d=c.region.r,e=b.x>d.x;if(e&&a.side==="l")return 1;if(!e&&a.side==="r")return 0;if(c.a===1){var f=b.y-d.y,g=b.x-d.x,h=0,i=0;!e&&c.b<0||e&&c.b>=0?i=h=f>=c.b*g:(i=b.x+b.y*c.b>c.c,c.b<0&&(i=!i),i||(h=1));if(!h){var j=d.x-c.region.l.x;i=c.b*(g*g-f*f)<j*f*(1+2*g/j+c.b*c.b),c.b<0&&(i=!i)}}else{var k=c.c-c.a*b.x,l=b.y-k,m=b.x-d.x,n=k-d.y;i=l*l>m*m+n*n}return a.side==="l"?i:!i},endPoint:function(a,c,d){a.ep[c]=d;if(!a.ep[g[c]])return;b(a)},distance:function(a,b){var c=a.x-b.x,d=a.y-b.y;return Math.sqrt(c*c+d*d)}},f={list:[],insert:function(a,b,c){a.vertex=b,a.ystar=b.y+c;for(var d=0,e=f.list,g=e.length;d<g;d++){var h=e[d];if(a.ystar>h.ystar||a.ystar==h.ystar&&b.x>h.vertex.x)continue;break}e.splice(d,0,a)},del:function(a){for(var b=0,c=f.list,d=c.length;b<d&&c[b]!=a;++b);c.splice(b,1)},empty:function(){return f.list.length===0},nextEvent:function(a){for(var b=0,c=f.list,d=c.length;b<d;++b)if(c[b]==a)return c[b+1];return null},min:function(){var a=f.list[0];return{x:a.vertex.x,y:a.ystar}},extractMin:function(){return f.list.shift()}};d.init(),c.bottomSite=c.list.shift();var h=c.list.shift(),i,j,k,l,m,n,o,p,q,r,s,t,u;for(;;){f.empty()||(i=f.min());if(h&&(f.empty()||h.y<i.y||h.y==i.y&&h.x<i.x))j=d.leftBound(h),k=d.right(j),o=d.rightRegion(j),t=e.bisect(o,h),n=d.createHalfEdge(t,"l"),d.insert(j,n),r=e.intersect(j,n),r&&(f.del(j),f.insert(j,r,e.distance(r,h))),j=n,n=d.createHalfEdge(t,"r"),d.insert(j,n),r=e.intersect(n,k),r&&f.insert(n,r,e.distance(r,h)),h=c.list.shift();else{if(!!f.empty())break;j=f.extractMin(),l=d.left(j),k=d.right(j),m=d.right(k),o=d.leftRegion(j),p=d.rightRegion(k),s=j.vertex,e.endPoint(j.edge,j.side,s),e.endPoint(k.edge,k.side,s),d.del(j),f.del(k),d.del(k),u="l",o.y>p.y&&(q=o,o=p,p=q,u="r"),t=e.bisect(o,p),n=d.createHalfEdge(t,u),d.insert(l,n),e.endPoint(t,g[u],s),r=e.intersect(l,n),r&&(f.del(l),f.insert(l,r,e.distance(r,o))),r=e.intersect(n,m),r&&f.insert(n,r,e.distance(r,o))}}for(j=d.right(d.leftEnd);j!=d.rightEnd;j=d.right(j))b(j.edge)}function i(){return{leaf:!0,nodes:[],point:null}}function j(a,b,c,d,e,f){if(!a(b,c,d,e,f)){var g=(c+e)*.5,h=(d+f)*.5,i=b.nodes;i[0]&&j(a,i[0],c,d,g,h),i[1]&&j(a,i[1],g,d,e,h),i[2]&&j(a,i[2],c,h,g,f),i[3]&&j(a,i[3],g,h,e,f)}}function k(a){return{x:a[0],y:a[1]}}d3.geom={},d3.geom.contour=function(d,e){var f=e||c(d),g=[],h=f[0],i=f[1],j=0,k=0,l=NaN,m=NaN,n=0;do n=0,d(h-1,i-1)&&(n+=1),d(h,i-1)&&(n+=2),d(h-1,i)&&(n+=4),d(h,i)&&(n+=8),n===6?(j=m===-1?-1:1,k=0):n===9?(j=0,k=l===1?-1:1):(j=a[n],k=b[n]),j!=l&&k!=m&&(g.push([h,i]),l=j,m=k),h+=j,i+=k;while(f[0]!=h||f[1]!=i);return g};var a=[1,0,1,1,-1,0,-1,1,0,0,0,0,-1,0,-1,NaN],b=[0,-1,0,0,0,-1,0,0,1,-1,1,1,0,-1,0,NaN];d3.geom.hull=function(a){if(a.length<3)return[];var b=a.length,c=b-1,e=[],f=[],g,h,i=0,j,k,l,m,n,o,p,q;for(g=1;g<b;++g)a[g][1]<a[i][1]?i=g:a[g][1]==a[i][1]&&(i=a[g][0]<a[i][0]?g:i);for(g=0;g<b;++g){if(g===i)continue;k=a[g][1]-a[i][1],j=a[g][0]-a[i][0],e.push({angle:Math.atan2(k,j),index:g})}e.sort(function(a,b){return a.angle-b.angle}),p=e[0].angle,o=e[0].index,n=0;for(g=1;g<c;++g)h=e[g].index,p==e[g].angle?(j=a[o][0]-a[i][0],k=a[o][1]-a[i][1],l=a[h][0]-a[i][0],m=a[h][1]-a[i][1],j*j+k*k>=l*l+m*m?e[g].index=-1:(e[n].index=-1,p=e[g].angle,n=g,o=h)):(p=e[g].angle,n=g,o=h);f.push(i);for(g=0,h=0;g<2;++h)e[h].index!==-1&&(f.push(e[h].index),g++);q=f.length;for(;h<c;++h){if(e[h].index===-1)continue;while(!d(f[q-2],f[q-1],e[h].index,a))--q;f[q++]=e[h].index}var r=[];for(g=0;g<q;++g)r.push(a[f[g]]);return r},d3.geom.polygon=function(a){return a.area=function(){var b=0,c=a.length,d=a[c-1][0]*a[0][1],e=a[c-1][1]*a[0][0];while(++b<c)d+=a[b-1][0]*a[b][1],e+=a[b-1][1]*a[b][0];return(e-d)*.5},a.centroid=function(b){var c=-1,d=a.length-1,e=0,f=0,g,h,i;arguments.length||(b=-1/(6*a.area()));while(++c<d)g=a[c],h=a[c+1],i=g[0]*h[1]-h[0]*g[1],e+=(g[0]+h[0])*i,f+=(g[1]+h[1])*i;return[e*b,f*b]},a.clip=function(b){var c,d=-1,g=a.length,h,i,j=a[g-1],k,l,m;while(++d<g){c=b.slice(),b.length=0,k=a[d],l=c[(i=c.length)-1],h=-1;while(++h<i)m=c[h],e(m,j,k)?(e(l,j,k)||b.push(f(l,m,j,k)),b.push(m)):e(l,j,k)&&b.push(f(l,m,j,k)),l=m;j=k}return b},a},d3.geom.voronoi=function(a){var b=a.map(function(){return[]});return h(a,function(a){var c,d,e,f,g,h;a.a===1&&a.b>=0?(c=a.ep.r,d=a.ep.l):(c=a.ep.l,d=a.ep.r),a.a===1?(g=c?c.y:-1e6,e=a.c-a.b*g,h=d?d.y:1e6,f=a.c-a.b*h):(e=c?c.x:-1e6,g=a.c-a.a*e,f=d?d.x:1e6,h=a.c-a.a*f);var i=[e,g],j=[f,h];b[a.region.l.index].push(i,j),b[a.region.r.index].push(i,j)}),b.map(function(b,c){var d=a[c][0],e=a[c][1];return b.forEach(function(a){a.angle=Math.atan2(a[0]-d,a[1]-e)}),b.sort(function(a,b){return a.angle-b.angle}).filter(function(a,c){return!c||a.angle-b[c-1].angle>1e-10})})};var g={l:"r",r:"l"};d3.geom.delaunay=function(a){var b=a.map(function(){return[]}),c=[];return h(a,function(c){b[c.region.l.index].push(a[c.region.r.index])}),b.forEach(function(b,d){var e=a[d],f=e[0],g=e[1];b.forEach(function(a){a.angle=Math.atan2(a[0]-f,a[1]-g)}),b.sort(function(a,b){return a.angle-b.angle});for(var h=0,i=b.length-1;h<i;h++)c.push([e,b[h],b[h+1]])}),c},d3.geom.quadtree=function(a,b,c,d,e){function n(a,b,c,d,e,f){if(isNaN(b.x)||isNaN(b.y))return;if(a.leaf){var g=a.point;g?Math.abs(g.x-b.x)+Math.abs(g.y-b.y)<.01?o(a,b,c,d,e,f):(a.point=null,o(a,g,c,d,e,f),o(a,b,c,d,e,f)):a.point=b}else o(a,b,c,d,e,f)}function o(a,b,c,d,e,f){var g=(c+e)*.5,h=(d+f)*.5,j=b.x>=g,k=b.y>=h,l=(k<<1)+j;a.leaf=!1,a=a.nodes[l]||(a.nodes[l]=i()),j?c=g:e=g,k?d=h:f=h,n(a,b,c,d,e,f)}var f,g=-1,h=a.length;h&&isNaN(a[0].x)&&(a=a.map(k));if(arguments.length<5)if(arguments.length===3)e=d=c,c=b;else{b=c=Infinity,d=e=-Infinity;while(++g<h)f=a[g],f.x<b&&(b=f.x),f.y<c&&(c=f.y),f.x>d&&(d=f.x),f.y>e&&(e=f.y);var l=d-b,m=e-c;l>m?e=c+l:d=b+m}var p=i();return p.add=function(a){n(p,a,b,c,d,e)},p.visit=function(a){j(a,p,b,c,d,e)},a.forEach(p
.add),p}}(),function(){function a(a){var b=a.source,d=a.target,e=c(b,d),f=[b];while(b!==e)b=b.parent,f.push(b);var g=f.length;while(d!==e)f.splice(g,0,d),d=d.parent;return f}function b(a){var b=[],c=a.parent;while(c!=null)b.push(a),a=c,c=c.parent;return b.push(a),b}function c(a,c){if(a===c)return a;var d=b(a),e=b(c),f=d.pop(),g=e.pop(),h=null;while(f===g)h=f,f=d.pop(),g=e.pop();return h}function g(a){a.fixed|=2}function h(a){a!==f&&(a.fixed&=1)}function i(){j(),f.fixed&=1,e=f=null}function j(){f.px=d3.event.x,f.py=d3.event.y,e.resume()}function k(a,b,c){var d=0,e=0;a.charge=0;if(!a.leaf){var f=a.nodes,g=f.length,h=-1,i;while(++h<g){i=f[h];if(i==null)continue;k(i,b,c),a.charge+=i.charge,d+=i.charge*i.cx,e+=i.charge*i.cy}}if(a.point){a.leaf||(a.point.x+=Math.random()-.5,a.point.y+=Math.random()-.5);var j=b*c[a.point.index];a.charge+=a.pointCharge=j,d+=j*a.point.x,e+=j*a.point.y}a.cx=d/a.charge,a.cy=e/a.charge}function l(a){return 20}function m(a){return 1}function o(a){return a.x}function p(a){return a.y}function q(a,b,c){a.y0=b,a.y=c}function t(a){var b=1,c=0,d=a[0][1],e,f=a.length;for(;b<f;++b)(e=a[b][1])>d&&(c=b,d=e);return c}function u(a){return a.reduce(v,0)}function v(a,b){return a+b[1]}function w(a,b){return x(a,Math.ceil(Math.log(b.length)/Math.LN2+1))}function x(a,b){var c=-1,d=+a[0],e=(a[1]-d)/b,f=[];while(++c<=b)f[c]=e*c+d;return f}function y(a){return[d3.min(a),d3.max(a)]}function z(a,b){return d3.rebind(a,b,"sort","children","value"),a.links=D,a.nodes=function(b){return E=!0,(a.nodes=a)(b)},a}function A(a){return a.children}function B(a){return a.value}function C(a,b){return b.value-a.value}function D(a){return d3.merge(a.map(function(a){return(a.children||[]).map(function(b){return{source:a,target:b}})}))}function F(a,b){return a.value-b.value}function G(a,b){var c=a._pack_next;a._pack_next=b,b._pack_prev=a,b._pack_next=c,c._pack_prev=b}function H(a,b){a._pack_next=b,b._pack_prev=a}function I(a,b){var c=b.x-a.x,d=b.y-a.y,e=a.r+b.r;return e*e-c*c-d*d>.001}function J(a){function l(a){b=Math.min(a.x-a.r,b),c=Math.max(a.x+a.r,c),d=Math.min(a.y-a.r,d),e=Math.max(a.y+a.r,e)}var b=Infinity,c=-Infinity,d=Infinity,e=-Infinity,f=a.length,g,h,i,j,k;a.forEach(K),g=a[0],g.x=-g.r,g.y=0,l(g);if(f>1){h=a[1],h.x=h.r,h.y=0,l(h);if(f>2){i=a[2],O(g,h,i),l(i),G(g,i),g._pack_prev=i,G(i,h),h=g._pack_next;for(var m=3;m<f;m++){O(g,h,i=a[m]);var n=0,o=1,p=1;for(j=h._pack_next;j!==h;j=j._pack_next,o++)if(I(j,i)){n=1;break}if(n==1)for(k=g._pack_prev;k!==j._pack_prev;k=k._pack_prev,p++)if(I(k,i)){p<o&&(n=-1,j=k);break}n==0?(G(g,i),h=i,l(i)):n>0?(H(g,j),h=j,m--):(H(j,h),g=j,m--)}}}var q=(b+c)/2,r=(d+e)/2,s=0;for(var m=0;m<f;m++){var t=a[m];t.x-=q,t.y-=r,s=Math.max(s,t.r+Math.sqrt(t.x*t.x+t.y*t.y))}return a.forEach(L),s}function K(a){a._pack_next=a._pack_prev=a}function L(a){delete a._pack_next,delete a._pack_prev}function M(a){var b=a.children;b&&b.length?(b.forEach(M),a.r=J(b)):a.r=Math.sqrt(a.value)}function N(a,b,c,d){var e=a.children;a.x=b+=d*a.x,a.y=c+=d*a.y,a.r*=d;if(e){var f=-1,g=e.length;while(++f<g)N(e[f],b,c,d)}}function O(a,b,c){var d=a.r+c.r,e=b.x-a.x,f=b.y-a.y;if(d&&(e||f)){var g=b.r+c.r,h=Math.sqrt(e*e+f*f),i=Math.max(-1,Math.min(1,(d*d+h*h-g*g)/(2*d*h))),j=Math.acos(i),k=i*(d/=h),l=Math.sin(j)*d;c.x=a.x+k*e+l*f,c.y=a.y+k*f-l*e}else c.x=a.x+d,c.y=a.y}function P(a){return 1+d3.max(a,function(a){return a.y})}function Q(a){return a.reduce(function(a,b){return a+b.x},0)/a.length}function R(a){var b=a.children;return b&&b.length?R(b[0]):a}function S(a){var b=a.children,c;return b&&(c=b.length)?S(b[c-1]):a}function T(a,b){return a.parent==b.parent?1:2}function U(a){var b=a.children;return b&&b.length?b[0]:a._tree.thread}function V(a){var b=a.children,c;return b&&(c=b.length)?b[c-1]:a._tree.thread}function W(a,b){var c=a.children;if(c&&(e=c.length)){var d,e,f=-1;while(++f<e)b(d=W(c[f],b),a)>0&&(a=d)}return a}function X(a,b){return a.x-b.x}function Y(a,b){return b.x-a.x}function Z(a,b){return a.depth-b.depth}function $(a,b){function c(a,d){var e=a.children;if(e&&(i=e.length)){var f,g=null,h=-1,i;while(++h<i)f=e[h],c(f,g),g=f}b(a,d)}c(a,null)}function _(a){var b=0,c=0,d=a.children,e=d.length,f;while(--e>=0)f=d[e]._tree,f.prelim+=b,f.mod+=b,b+=f.shift+(c+=f.change)}function ba(a,b,c){a=a._tree,b=b._tree;var d=c/(b.number-a.number);a.change+=d,b.change-=d,b.shift+=c,b.prelim+=c,b.mod+=c}function bb(a,b,c){return a._tree.ancestor.parent==b.parent?a._tree.ancestor:c}function bc(a){return{x:a.x,y:a.y,dx:a.dx,dy:a.dy}}function bd(a,b){var c=a.x+b[3],d=a.y+b[0],e=a.dx-b[1]-b[3],f=a.dy-b[0]-b[2];return e<0&&(c+=e/2,e=0),f<0&&(d+=f/2,f=0),{x:c,y:d,dx:e,dy:f}}d3.layout={},d3.layout.bundle=function(){return function(b){var c=[],d=-1,e=b.length;while(++d<e)c.push(a(b[d]));return c}},d3.layout.chord=function(){function j(){var a={},j=[],l=d3.range(e),m=[],n,o,p,q,r;b=[],c=[],n=0,q=-1;while(++q<e){o=0,r=-1;while(++r<e)o+=d[q][r];j.push(o),m.push(d3.range(e)),n+=o}g&&l.sort(function(a,b){return g(j[a],j[b])}),h&&m.forEach(function(a,b){a.sort(function(a,c){return h(d[b][a],d[b][c])})}),n=(2*Math.PI-f*e)/n,o=0,q=-1;while(++q<e){p=o,r=-1;while(++r<e){var s=l[q],t=m[s][r],u=d[s][t],v=o,w=o+=u*n;a[s+"-"+t]={index:s,subindex:t,startAngle:v,endAngle:w,value:u}}c.push({index:s,startAngle:p,endAngle:o,value:(o-p)/n}),o+=f}q=-1;while(++q<e){r=q-1;while(++r<e){var x=a[q+"-"+r],y=a[r+"-"+q];(x.value||y.value)&&b.push(x.value<y.value?{source:y,target:x}:{source:x,target:y})}}i&&k()}function k(){b.sort(function(a,b){return i((a.source.value+a.target.value)/2,(b.source.value+b.target.value)/2)})}var a={},b,c,d,e,f=0,g,h,i;return a.matrix=function(f){return arguments.length?(e=(d=f)&&d.length,b=c=null,a):d},a.padding=function(d){return arguments.length?(f=d,b=c=null,a):f},a.sortGroups=function(d){return arguments.length?(g=d,b=c=null,a):g},a.sortSubgroups=function(c){return arguments.length?(h=c,b=null,a):h},a.sortChords=function(c){return arguments.length?(i=c,b&&k(),a):i},a.chords=function(){return b||j(),b},a.groups=function(){return c||j(),c},a},d3.layout.force=function(){function A(a){return function(b,c,d,e,f){if(b.point!==a){var g=b.cx-a.x,h=b.cy-a.y,i=1/Math.sqrt(g*g+h*h);if((e-c)*i<t){var j=b.charge*i*i;return a.px-=g*j,a.py-=h*j,!0}if(b.point&&isFinite(i)){var j=b.pointCharge*i*i;a.px-=g*j,a.py-=h*j}}return!b.charge}}function B(){var a=v.length,d=w.length,e,f,g,h,i,j,l,m,p;for(f=0;f<d;++f){g=w[f],h=g.source,i=g.target,m=i.x-h.x,p=i.y-h.y;if(j=m*m+p*p)j=n*y[f]*((j=Math.sqrt(j))-x[f])/j,m*=j,p*=j,i.x-=m*(l=h.weight/(i.weight+h.weight)),i.y-=p*l,h.x+=m*(l=1-l),h.y+=p*l}if(l=n*s){m=c[0]/2,p=c[1]/2,f=-1;if(l)while(++f<a)g=v[f],g.x+=(m-g.x)*l,g.y+=(p-g.y)*l}if(r){k(e=d3.geom.quadtree(v),n,z),f=-1;while(++f<a)(g=v[f]).fixed||e.visit(A(g))}f=-1;while(++f<a)g=v[f],g.fixed?(g.x=g.px,g.y=g.py):(g.x-=(g.px-(g.px=g.x))*o,g.y-=(g.py-(g.py=g.y))*o);return b.tick({type:"tick",alpha:n}),(n*=.99)<.005}function C(b){g(f=b),e=a}var a={},b=d3.dispatch("tick"),c=[1,1],d,n,o=.9,p=l,q=m,r=-30,s=.1,t=.8,u,v=[],w=[],x,y,z;return a.nodes=function(b){return arguments.length?(v=b,a):v},a.links=function(b){return arguments.length?(w=b,a):w},a.size=function(b){return arguments.length?(c=b,a):c},a.linkDistance=function(b){return arguments.length?(p=d3.functor(b),a):p},a.distance=a.linkDistance,a.linkStrength=function(b){return arguments.length?(q=d3.functor(b),a):q},a.friction=function(b){return arguments.length?(o=b,a):o},a.charge=function(b){return arguments.length?(r=typeof b=="function"?b:+b,a):r},a.gravity=function(b){return arguments.length?(s=b,a):s},a.theta=function(b){return arguments.length?(t=b,a):t},a.start=function(){function k(a,c){var d=l(b),e=-1,f=d.length,g;while(++e<f)if(!isNaN(g=d[e][a]))return g;return Math.random()*c}function l(){if(!i){i=[];for(d=0;d<e;++d)i[d]=[];for(d=0;d<f;++d){var a=w[d];i[a.source.index].push(a.target),i[a.target.index].push(a.source)}}return i[b]}var b,d,e=v.length,f=w.length,g=c[0],h=c[1],i,j;for(b=0;b<e;++b)(j=v[b]).index=b,j.weight=0;x=[],y=[];for(b=0;b<f;++b)j=w[b],typeof j.source=="number"&&(j.source=v[j.source]),typeof j.target=="number"&&(j.target=v[j.target]),x[b]=p.call(this,j,b),y[b]=q.call(this,j,b),++j.source.weight,++j.target.weight;for(b=0;b<e;++b)j=v[b],isNaN(j.x)&&(j.x=k("x",g)),isNaN(j.y)&&(j.y=k("y",h)),isNaN(j.px)&&(j.px=j.x),isNaN(j.py)&&(j.py=j.y);z=[];if(typeof r=="function")for(b=0;b<e;++b)z[b]=+r.call(this,v[b],b);else for(b=0;b<e;++b)z[b]=r;return a.resume()},a.resume=function(){return n=.1,d3.timer(B),a},a.stop=function(){return n=0,a},a.drag=function(){d||(d=d3.behavior.drag().origin(Object).on("dragstart",C).on("drag",j).on("dragend",i)),this.on("mouseover.force",g).on("mouseout.force",h).call(d)},d3.rebind(a,b,"on")};var e,f;d3.layout.partition=function(){function c(a,b,d,e){var f=a.children;a.x=b,a.y=a.depth*e,a.dx=d,a.dy=e;if(f&&(h=f.length)){var g=-1,h,i,j;d=a.value?d/a.value:0;while(++g<h)c(i=f[g],b,j=i.value*d,e),b+=j}}function d(a){var b=a.children,c=0;if(b&&(f=b.length)){var e=-1,f;while(++e<f)c=Math.max(c,d(b[e]))}return 1+c}function e(e,f){var g=a.call(this,e,f);return c(g[0],0,b[0],b[1]/d(g[0])),g}var a=d3.layout.hierarchy(),b=[1,1];return e.size=function(a){return arguments.length?(b=a,e):b},z(e,a)},d3.layout.pie=function(){function f(g,h){var i=g.map(function(b,c){return+a.call(f,b,c)}),j=+(typeof c=="function"?c.apply(this,arguments):c),k=((typeof e=="function"?e.apply(this,arguments):e)-c)/d3.sum(i),l=d3.range(g.length);b!=null&&l.sort(b===n?function(a,b){return i[b]-i[a]}:function(a,c){return b(g[a],g[c])});var m=l.map(function(a){return{data:g[a],value:d=i[a],startAngle:j,endAngle:j+=d*k}});return g.map(function(a,b){return m[l[b]]})}var a=Number,b=n,c=0,e=2*Math.PI;return f.value=function(b){return arguments.length?(a=b,f):a},f.sort=function(a){return arguments.length?(b=a,f):b},f.startAngle=function(a){return arguments.length?(c=a,f):c},f.endAngle=function(a){return arguments.length?(e=a,f):e},f};var n={};d3.layout.stack=function(){function g(h,i){var j=h.map(function(b,c){return a.call(g,b,c)}),k=j.map(function(a,b){return a.map(function(a,b){return[e.call(g,a,b),f.call(g,a,b)]})}),l=b.call(g,k,i);j=d3.permute(j,l),k=d3.permute(k,l);var m=c.call(g,k,i),n=j.length,o=j[0].length,p,q,r;for(q=0;q<o;++q){d.call(g,j[0][q],r=m[q],k[0][q][1]);for(p=1;p<n;++p)d.call(g,j[p][q],r+=k[p-1][q][1],k[p][q][1])}return h}var a=Object,b=r["default"],c=s.zero,d=q,e=o,f=p;return g.values=function(b){return arguments.length?(a=b,g):a},g.order=function(a){return arguments.length?(b=typeof a=="function"?a:r[a],g):b},g.offset=function(a){return arguments.length?(c=typeof a=="function"?a:s[a],g):c},g.x=function(a){return arguments.length?(e=a,g):e},g.y=function(a){return arguments.length?(f=a,g):f},g.out=function(a){return arguments.length?(d=a,g):d},g};var r={"inside-out":function(a){var b=a.length,c,d,e=a.map(t),f=a.map(u),g=d3.range(b).sort(function(a,b){return e[a]-e[b]}),h=0,i=0,j=[],k=[];for(c=0;c<b;++c)d=g[c],h<i?(h+=f[d],j.push(d)):(i+=f[d],k.push(d));return k.reverse().concat(j)},reverse:function(a){return d3.range(a.length).reverse()},"default":function(a){return d3.range(a.length)}},s={silhouette:function(a){var b=a.length,c=a[0].length,d=[],e=0,f,g,h,i=[];for(g=0;g<c;++g){for(f=0,h=0;f<b;f++)h+=a[f][g][1];h>e&&(e=h),d.push(h)}for(g=0;g<c;++g)i[g]=(e-d[g])/2;return i},wiggle:function(a){var b=a.length,c=a[0],d=c.length,e=0,f,g,h,i,j,k,l,m,n,o=[];o[0]=m=n=0;for(g=1;g<d;++g){for(f=0,i=0;f<b;++f)i+=a[f][g][1];for(f=0,j=0,l=c[g][0]-c[g-1][0];f<b;++f){for(h=0,k=(a[f][g][1]-a[f][g-1][1])/(2*l);h<f;++h)k+=(a[h][g][1]-a[h][g-1][1])/l;j+=k*a[f][g][1]}o[g]=m-=i?j/i*l:0,m<n&&(n=m)}for(g=0;g<d;++g)o[g]-=n;return o},expand:function(a){var b=a.length,c=a[0].length,d=1/b,e,f,g,h=[];for(f=0;f<c;++f){for(e=0,g=0;e<b;e++)g+=a[e][f][1];if(g)for(e=0;e<b;e++)a[e][f][1]/=g;else for(e=0;e<b;e++)a[e][f][1]=d}for(f=0;f<c;++f)h[f]=0;return h},zero:function(a){var b=-1,c=a[0].length,d=[];while(++b<c)d[b]=0;return d}};d3.layout.histogram=function(){function e(e,f){var g=[],h=e.map(b,this),i=c.call(this,h,f),j=d.call(this,i,h,f),k,f=-1,l=h.length,m=j.length-1,n=a?1:1/l,o;while(++f<m)k=g[f]=[],k.dx=j[f+1]-(k.x=j[f]),k.y=0;f=-1;while(++f<l)o=h[f],o>=i[0]&&o<=i[1]&&(k=g[d3.bisect(j,o,1,m)-1],k.y+=n,k.push(e[f]));return g}var a=!0,b=Number,c=y,d=w;return e.value=function(a){return arguments.length?(b=a,e):b},e.range=function(a){return arguments.length?(c=d3.functor(a),e):c},e.bins=function(a){return arguments.length?(d=typeof a=="number"?function(b){return x(b,a)}:d3.functor(a),e):d},e.frequency=function(b){return arguments.length?(a=!!b,e):a},e},d3.layout.hierarchy=function(){function e(f,h,i){var j=b.call(g,f,h),k=E?f:{data:f};k.depth=h,i.push(k);if(j&&(m=j.length)){var l=-1,m,n=k.children=[],o=0,p=h+1;while(++l<m)d=e(j[l],p,i),d.parent=k,n.push(d),o+=d.value;a&&n.sort(a),c&&(k.value=o)}else c&&(k.value=+c.call(g,f,h)||0);return k}function f(a,b){var d=a.children,e=0;if(d&&(i=d.length)){var h=-1,i,j=b+1;while(++h<i)e+=f(d[h],j)}else c&&(e=+c.call(g,E?a:a.data,b)||0);return c&&(a.value=e),e}function g(a){var b=[];return e(a,0,b),b}var a=C,b=A,c=B;return g.sort=function(b){return arguments.length?(a=b,g):a},g.children=function(a){return arguments.length?(b=a,g):b},g.value=function(a){return arguments.length?(c=a,g):c},g.revalue=function(a){return f(a,0),a},g};var E=!1;d3.layout.pack=function(){function c(c,d){var e=a.call(this,c,d),f=e[0];f.x=0,f.y=0,M(f);var g=b[0],h=b[1],i=1/Math.max(2*f.r/g,2*f.r/h);return N(f,g/2,h/2,i),e}var a=d3.layout.hierarchy().sort(F),b=[1,1];return c.size=function(a){return arguments.length?(b=a,c):b},z(c,a)},d3.layout.cluster=function(){function d(d,e){var f=a.call(this,d,e),g=f[0],h,i=0,j,k;$(g,function(a){var c=a.children;c&&c.length?(a.x=Q(c),a.y=P(c)):(a.x=h?i+=b(a,h):0,a.y=0,h=a)});var l=R(g),m=S(g),n=l.x-b(l,m)/2,o=m.x+b(m,l)/2;return $(g,function(a){a.x=(a.x-n)/(o-n)*c[0],a.y=(1-a.y/g.y)*c[1]}),f}var a=d3.layout.hierarchy().sort(null).value(null),b=T,c=[1,1];return d.separation=function(a){return arguments.length?(b=a,d):b},d.size=function(a){return arguments.length?(c=a,d):c},z(d,a)},d3.layout.tree=function(){function d(d,e){function h(a,c){var d=a.children,e=a._tree;if(d&&(f=d.length)){var f,g=d[0],i,k=g,l,m=-1;while(++m<f)l=d[m],h(l,i),k=j(l,i,k),i=l;_(a);var n=.5*(g._tree.prelim+l._tree.prelim);c?(e.prelim=c._tree.prelim+b(a,c),e.mod=e.prelim-n):e.prelim=n}else c&&(e.prelim=c._tree.prelim+b(a,c))}function i(a,b){a.x=a._tree.prelim+b;var c=a.children;if(c&&(e=c.length)){var d=-1,e;b+=a._tree.mod;while(++d<e)i(c[d],b)}}function j(a,c,d){if(c){var e=a,f=a,g=c,h=a.parent.children[0],i=e._tree.mod,j=f._tree.mod,k=g._tree.mod,l=h._tree.mod,m;while(g=V(g),e=U(e),g&&e)h=U(h),f=V(f),f._tree.ancestor=a,m=g._tree.prelim+k-e._tree.prelim-i+b(g,e),m>0&&(ba(bb(g,a,d),a,m),i+=m,j+=m),k+=g._tree.mod,i+=e._tree.mod,l+=h._tree.mod,j+=f._tree.mod;g&&!V(f)&&(f._tree.thread=g,f._tree.mod+=k-j),e&&!U(h)&&(h._tree.thread=e,h._tree.mod+=i-l,d=a)}return d}var f=a.call(this,d,e),g=f[0];$(g,function(a,b){a._tree={ancestor:a,prelim:0,mod:0,change:0,shift:0,number:b?b._tree.number+1:0}}),h(g),i(g,-g._tree.prelim);var k=W(g,Y),l=W(g,X),m=W(g,Z),n=k.x-b(k,l)/2,o=l.x+b(l,k)/2,p=m.depth||1;return $(g,function(a){a.x=(a.x-n)/(o-n)*c[0],a.y=a.depth/p*c[1],delete a._tree}),f}var a=d3.layout.hierarchy().sort(null).value(null),b=T,c=[1,1];return d.separation=function(a){return arguments.length?(b=a,d):b},d.size=function(a){return arguments.length?(c=a,d):c},z(d,a)},d3.layout.treemap=function(){function i(a,b){var c=-1,d=a.length,e,f;while(++c<d)f=(e=a[c]).value*(b<0?0:b),e.area=isNaN(f)||f<=0?0:f}function j(a){var b=a.children;if(b&&b.length){var c=e(a),d=[],f=b.slice(),g,h=Infinity,k,n=Math.min(c.dx,c.dy),o;i(f,c.dx*c.dy/a.value),d.area=0;while((o=f.length)>0)d.push(g=f[o-1]),d.area+=g.area,(k=l(d,n))<=h?(f.pop(),h=k):(d.area-=d.pop().area,m(d,n,c,!1),n=Math.min(c.dx,c.dy),d.length=d.area=0,h=Infinity);d.length&&(m(d,n,c,!0),d.length=d.area=0),b.forEach(j)}}function k(a){var b=a.children;if(b&&b.length){var c=e(a),d=b.slice(),f,g=[];i(d,c.dx*c.dy/a.value),g.area=0;while(f=d.pop())g.push(f),g.area+=f.area,f.z!=null&&(m(g,f.z?c.dx:c.dy,c,!d.length),g.length=g.area=0);b.forEach(k)}}function l(a,b){var c=a.area,d,e=0,f=Infinity,g=-1,i=a.length;while(++g<i){if(!(d=a[g].area))continue;d<f&&(f=d),d>e&&(e=d)}return c*=c,b*=b,c?Math.max(b*e*h/c,c/(b*f*h)):Infinity}function m(a,c,d,e){var f=-1,g=a.length,h=d.x,i=d.y,j=c?b(a.area/c):0,k;if(c==d.dx){if(e||j>d.dy)j=j?d.dy:0;while(++f<g)k=a[f],k.x=h,k.y=i,k.dy=j,h+=k.dx=j?b(k.area/j):0;k.z=!0,k.dx+=d.x+d.dx-h,d.y+=j,d.dy-=j}else{if(e||j>d.dx)j=j?d.dx:0;while(++f<g)k=a[f],k.x=h,k.y=i,k.dx=j,i+=k.dy=j?b(k.area/j):0;k.z=!1,k.dy+=d.y+d.dy-i,d.x+=j,d.dx-=j}}function n(b){var d=g||a(b),e=d[0];return e.x=0,e.y=0,e.dx=c[0],e.dy=c[1],g&&a.revalue(e),i([e],e.dx*e.dy/e.value),(g?k:j)(e),f&&(g=d),d}var a=d3.layout.hierarchy(),b=Math.round,c=[1,1],d=null,e=bc,f=!1,g,h=.5*(1+Math.sqrt(5));return n.size=function(a){return arguments.length?(c=a,n):c},n.padding=function(a){function b(b){var c=a.call(n,b,b.depth);return c==null?bc(b):bd(b,typeof c=="number"?[c,c,c,c]:c)}function c(b){return bd(b,a)}if(!arguments.length)return d;var f;return e=(d=a)==null?bc:(f=typeof a)==="function"?b:f==="number"?(a=[a,a,a,a],c):c,n},n.round=function(a){return arguments.length?(b=a?Math.round:Number,n):b!=Number},n.sticky=function(a){return arguments.length?(f=a,g=null,n):f},n.ratio=function(a){return arguments.length?(h=a,n):h},z(n,a)}}();(function(){typeof console=="undefined"&&(console={log:function(){}});var y={"extends":function(a,c){c.prototype=new a},stackCounterLimit:1E3,stackCounter:0};y.recur=function(a){y.stackCounter===y.stackCounterLimit?(y.stackCounter=0,setTimeout(a,0)):(y.stackCounter++,a())};y.clone=function(a){return JSON.parse(JSON.stringify(a))};y.shuffle=function(a){for(var c,e,h=a.length;h;c=parseInt(Math.random()*h),e=a[--h],a[h]=a[c],a[c]=e);return a};y.include=function(a,c,e){for(var h=a.length-1;h>=0;h--){var k=
!1,k=e==null?a[h]===c:e(a[h],c)===0;if(k===!0)return!0}return!1};y.remove=function(a,c){for(var e=[],h=0;h<a.length;h++)a[h]!==c&&e.push(a[h]);return e};y.repeat=function(a,c,e,h,k){arguments.length===4&&(k={});a<c?(k._i=a,e(function(j,e){y.recur(function(){y.repeat(a+1,c,j,h,e)})},k)):h(k)};y.meanwhile=function(a,c,e,h){arguments.length===3&&(h={});h._stack_counter==null&&(h._stack_counter=0);a===!0?c(function(a,c,h){h._stack_counter%40==39?(h._stack_counter+=1,setTimeout(function(){y.neanwhile(a,
c,e,h)},0)):(h._stack_counter+=1,y.meanwhile(a,c,e,h))},h):e(h)};y.seq=function(){var a=arguments;return function(c){y.repeat(0,a.length,function(c,h){var k=arguments.callee;a[h._i](function(){c(k,h)})},function(){c()})}};y.partition=function(a,c){for(var e=a.length%c,h=[],k=0;k<e;k++)h.push(null);e=[];for(k=0;k<a.length;k++)h.push(a[k]),h.length%c==0&&(e.push(h),h=[]);return e};y.keys=function(a){var c=[],e;for(e in a)c.push(e);return c};y.iso8601=function(a){function c(a){return a<10?"0"+a:a}return a.getUTCFullYear()+
"-"+c(a.getUTCMonth()+1)+"-"+c(a.getUTCDate())+"T"+c(a.getUTCHours())+":"+c(a.getUTCMinutes())+":"+c(a.getUTCSeconds())+"Z"};y.parseStrictISO8601=function(a){var c=a.match(RegExp("([0-9]{4})(-([0-9]{2})(-([0-9]{2})(T([0-9]{2}):([0-9]{2})(:([0-9]{2})(.([0-9]+))?)?(Z|(([-+])([0-9]{2}):([0-9]{2})))?)?)?)?")),a=0,e=new Date(c[1],0,1);if(c[3])e.setMonth(c[3]-1);else throw"missing ISO8061 component";if(c[5])e.setDate(c[5]);else throw"missing ISO8061 component";if(c[7])e.setHours(c[7]);else throw"missing ISO8061 component";
if(c[8])e.setMinutes(c[8]);else throw"missing ISO8061 component";if(c[10])e.setSeconds(c[10]);else throw"missing ISO8061 component";c[12]&&e.setMilliseconds(Number("0."+c[12])*1E3);c[14]&&(a=Number(c[16])*60+Number(c[17]),a*=c[15]=="-"?1:-1);a-=e.getTimezoneOffset();c=new Date;c.setTime(Number(Number(e)+a*6E4));return c};y.parseISO8601=function(a){var c=a.match(RegExp("([0-9]{4})(-([0-9]{2})(-([0-9]{2})(T([0-9]{2}):([0-9]{2})(:([0-9]{2})(.([0-9]+))?)?(Z|(([-+])([0-9]{2}):([0-9]{2})))?)?)?)?")),a=
0,e=new Date(c[1],0,1);c[3]&&e.setMonth(c[3]-1);c[5]&&e.setDate(c[5]);c[7]&&e.setHours(c[7]);c[8]&&e.setMinutes(c[8]);c[10]&&e.setSeconds(c[10]);c[12]&&e.setMilliseconds(Number("0."+c[12])*1E3);c[14]&&(a=Number(c[16])*60+Number(c[17]),a*=c[15]=="-"?1:-1);a-=e.getTimezoneOffset();c=new Date;c.setTime(Number(Number(e)+a*6E4));return c};y.parseISO8601Components=function(a){var a=a.match(RegExp("([0-9]{4})(-([0-9]{2}))(-([0-9]{2}))(T([0-9]{2}):([0-9]{2})(:([0-9]{2}))?(.([0-9]+))?)?(Z|([-+])([0-9]{2})(:([0-9]{2}))?)?")),
c,e,h,k,j,i,g,r;c=Number(a[1]);e=a[3]-1;h=Number(a[5]);k=Number(a[7]);j=Number(a[8]);i=Number(a[10]);a[12]&&(g=Number("0."+a[12])*1E3);a[13]==="Z"?r=0:a[14]?(r=0,a[17]&&(r=Number(a[17])),r+=Number(a[15])*60,r*=a[14]=="-"?-1:1):a[14]==null&&a[11]&&(r=Number(a[12])*60);return{year:isNaN(c)?null:c,month:isNaN(e)?null:e,date:isNaN(h)?null:h,hours:isNaN(k)?null:k,minutes:isNaN(j)?null:j,seconds:isNaN(i)?null:i,millisecs:isNaN(g)?null:g,timezone:isNaN(r)?null:r}};y.compareDateComponents=function(a,c){var e=
y.parseISO8601Components(a),h=y.parseISO8601Components(c);if(e.timezone==null&&h.timezone==null||e.timezone!=null&&h.timezone!=null)return e=y.parseISO8601(a),h=y.parseISO8601(c),e.getTime()==h.getTime()?0:e.getTime()<h.getTime()?-1:1;else if(e.timezone!=null&&h.timezone==null){var e=y.parseISO8601(a),h=y.parseISO8601(c),e=e.getTime(),h=h.getTime(),k=50400;return e<h&&e<h+k?-1:e>h&&e>h-k?1:null}else return e=y.parseISO8601(a),h=y.parseISO8601(c),e=e.getTime(),h=h.getTime(),k=50400,e<h&&e+k<h?-1:e>
h&&e+k>h?1:null};y.lexicalFormLiteral=function(a,c){var e=a.value,h=a.lang,k=a.type,j=null;if(e!=null&&k!=null&&typeof k!="string"){e=k.value;if(e==null)e=k.suffix,k=c.namespaces[k.prefix],a.type=k+e,e=k+e;j=e.indexOf("hexBinary")!=-1?'"'+a.value.toLowerCase()+'"^^<'+e+">":'"'+a.value+'"^^<'+e+">"}else j=h==null&&k==null?'"'+e+'"':k==null?'"'+e+'"@'+h:k.indexOf("hexBinary")!=-1?'"'+a.value.toLowerCase()+'"^^<'+k+">":'"'+a.value+'"^^<'+k+">";return j};y.lexicalFormBaseUri=function(a,c){var e=null;
if(a.value==null)var e=a.prefix,h=a.suffix,k=c.namespaces[e],e=k!=null?k+h:e+":"+h;else e=a.value;if(e===null)return null;else e.indexOf(":")==-1&&(e=(c.base||"")+e);return e};y.lexicalFormTerm=function(a,c){if(a.token==="uri")return{uri:y.lexicalFormBaseUri(a,c)};else if(a.token==="literal")return{literal:y.lexicalFormLiteral(a,c)};else if(a.token==="blank")return{blank:"_:"+a.value};else throw"Error, cannot get lexical form of unknown token: "+a.token;};y.normalizeUnicodeLiterals=function(a){for(var c=
a.match(/\\u[0-9abcdefABCDEF]{4,4}/g)||[],e={},h=0;h<c.length;h++)e[c[h]]==null&&(e[c[h]]=!0,a=a.replace(RegExp("\\"+c[h],"g"),eval("'"+c[h]+"'")));return a};y.hashTerm=function(a){try{if(a==null)return"";if(a.token==="uri")return"u"+a.value;else if(a.token==="blank")return"b"+a.value;else if(a.token==="literal"){var c="l"+a.value;c+=a.type||"";c+=a.lang||"";return c}}catch(e){if(typeof a==="object"){c="";for(p in a)c=c+p+a[p];return c}return a}};var K={Tree:function(a){if(arguments.length!=0)this.order=
a,this.root=this._allocateNode(),this.root.isLeaf=!0,this.root.level=0,this._diskWrite(this.root),this._updateRootNode(this.root),this.comparator=function(a,e){return a<e?-1:a>e?1:0},this.merger=null}};K.Tree.prototype._allocateNode=function(){return new K.Node};K.Tree.prototype._diskWrite=function(){};K.Tree.prototype._diskRead=function(a){return a};K.Tree.prototype._diskDelete=function(){};K.Tree.prototype._updateRootNode=function(a){return a};K.Tree.prototype.clear=function(){this.root=this._allocateNode();
this.root.isLeaf=!0;this.root.level=0;this._updateRootNode(this.root)};K.Tree.prototype.search=function(a,c){for(var e=!0,h=this.root;e;){for(var k=0;k<h.numberActives&&this.comparator(a,h.keys[k].key)===1;)k++;if(k<h.numberActives&&this.comparator(h.keys[k].key,a)===0)return c!=null&&c==!0?!0:h.keys[k].data;else h.isLeaf===!0?e=!1:h=this._diskRead(h.children[k])}return null};K.Tree.prototype.walk=function(a){this._walk(a,this.root)};K.Tree.prototype._walk=function(a,c){if(c.isLeaf)for(var e=0;e<
c.numberActives;e++)a(c.keys[e]);else{for(e=0;e<c.numberActives;e++)this._walk(a,this._diskRead(c.children[e])),a(c.keys[e]);this._walk(a,this._diskRead(c.children[c.numberActives]))}};K.Tree.prototype.walkNodes=function(a){this._walkNodes(a,this.root)};K.Tree.prototype._walkNodes=function(a,c){if(c.isLeaf)a(c);else{a(c);for(var e=0;e<c.numberActives;e++)this._walkNodes(a,this._diskRead(c.children[e]));this._walkNodes(a,this._diskRead(c.children[c.numberActives]))}};K.Tree.prototype._splitChild=function(a,
c,e){var h=this._allocateNode();h.isLeaf=e.isLeaf;h.level=e.level;h.numberActives=this.order-1;var k=e.keys[this.order-1];e.keys[this.order-1]=null;for(var j=0;j<this.order-1;j++)h.keys[j]=e.keys[j+this.order],e.keys[j+this.order]=null,e.isLeaf||(h.children[j]=e.children[j+this.order],e.children[j+this.order]=null);e.isLeaf||(h.children[j]=e.children[j+this.order],e.children[j+this.order]=null);e.numberActives=this.order-1;for(j=a.numberActives+1;j>c+1;j--)a.children[j]=a.children[j-1];a.children[c+
1]=h;for(j=a.numberActives;j>c;j--)a.keys[j]=a.keys[j-1];a.keys[c]=k;a.numberActives++;this._diskWrite(h);this._diskWrite(a);this._diskWrite(e)};K.Tree.prototype.insert=function(a,c){if(this.root.numberActives===2*this.order-1){var e=this._allocateNode();e.isLeaf=!1;e.level=this.root.level+1;e.numberActives=0;e.children[0]=this.root;this._splitChild(e,0,this.root);this.root=e;this._updateRootNode(this.root);this._insertNonFull(e,a,c)}else this._insertNonFull(this.root,a,c)};K.Tree.prototype._insertNonFull=
function(a,c,e){for(var h=a.numberActives-1;!a.isLeaf;){for(;h>=0&&this.comparator(c,a.keys[h].key)===-1;)h--;h++;var k=this._diskRead(a.children[h]);k.numberActives===2*this.order-1&&(this._splitChild(a,h,k),this.comparator(c,a.keys[h].key)===1&&h++);a=this._diskRead(a.children[h]);h=a.numberActives-1}for(;h>=0&&this.comparator(c,a.keys[h].key)===-1;)a.keys[h+1]=a.keys[h],h--;a.keys[h+1]={key:c,data:e};a.numberActives++;this._diskWrite(a)};K.Tree.prototype["delete"]=function(a){for(var c=this.root,
e=null,h=!0,k=null,j=null,i=null,g=!0;g===!0;){for(g=!1;h===!0;){r=0;if(c.numberActives===0)return!1;for(;r<c.numberActives&&this.comparator(a,c.keys[r].key)===1;)r++;k=r;r<c.numberActives&&this.comparator(a,c.keys[r].key)===0&&(h=!1);if(h===!0){if(c.isLeaf===!0)return!1;e=c;c=this._diskRead(c.children[r]);if(c===null)return!1;k===e.numberActives?(j=this._diskRead(e.children[k-1]),i=null):k===0?(j=null,i=this._diskRead(e.children[1])):(j=this._diskRead(e.children[k-1]),i=this._diskRead(e.children[k+
1]));c.numberActives===this.order-1&&e!=null&&(i!=null&&i.numberActives>this.order-1?this._moveKey(e,r,-1):j!=null&&j.numberActives>this.order-1?this._moveKey(e,r,1):j!=null&&j.numberActives===this.order-1?c=this._mergeSiblings(e,r,-1):i!=null&&i.numberActives===this.order-1&&(c=this._mergeSiblings(e,r,1)))}}if(c.isLeaf&&c.numberActives>this.order-1)return this._deleteKeyFromNode(c,k),!0;if(c.isLeaf&&c===this.root)return this._deleteKeyFromNode(c,k),!0;if(c.isLeaf===!1)if(e=r=null,(r=this._diskRead(c.children[k])).numberActives>
this.order-1)a=this._getMaxKeyPos(r),a=a.node.keys[a.index],c.keys[k]=a,this._diskWrite(c),c=r,a=a.key,h=g=!0;else if((r=this._diskRead(c.children[k+1])).numberActives>this.order-1)a=this._getMinKeyPos(r),a=a.node.keys[a.index],c.keys[k]=a,this._diskWrite(c),c=r,a=a.key,h=g=!0;else if((r=this._diskRead(c.children[k])).numberActives===this.order-1&&(e=this._diskRead(c.children[k+1])).numberActives===this.order-1){h=this._mergeNodes(r,c.keys[k],e);c.children[k]=h;k++;for(var r=k;r<c.numberActives;r++)c.children[r]=
c.children[r+1],c.keys[r-1]=c.keys[r];c.children[r]=null;c.keys[r-1]=null;c.numberActives--;if(c.numberActives===0&&this.root===c)this.root=h;this._diskWrite(c);c=h;h=g=!0}c.isLeaf&&c.numberActives>this.order-1&&h===!1&&this._deleteKeyFromNode(c,k);if(g===!1)return!0}};K.Tree.prototype._moveKey=function(a,c,e){e===1&&c--;var h=this._diskRead(a.children[c]),k=this._diskRead(a.children[c+1]);if(e==-1){h.keys[h.numberActives]=a.keys[c];h.children[h.numberActives+1]=k.children[0];k.children[0]=null;h.numberActives++;
a.keys[c]=k.keys[0];for(e=1;e<k.numberActives;e++)k.keys[e-1]=k.keys[e],k.children[e-1]=k.children[e];k.children[k.numberActives-1]=k.children[k.numberActives];k.numberActives--}else{k.children[k.numberActives+1]=k.children[k.numberActives];for(e=k.numberActives;e>0;e--)k.children[e]=k.children[e-1],k.keys[e]=k.keys[e-1];k.keys[0]=null;k.children[0]=null;k.children[0]=h.children[h.numberActives];k.keys[0]=a.keys[c];k.numberActives++;h.children[h.numberActives]=null;a.keys[c]=h.keys[h.numberActives-
1];h.keys[h.numberActives-1]=null;h.numberActives--}this._diskWrite(h);this._diskWrite(k);this._diskWrite(a)};K.Tree.prototype._mergeSiblings=function(a,c){var e,h,k;c===a.numberActives?(c--,h=this._diskRead(a.children[a.numberActives-1]),k=this._diskRead(a.children[a.numberActives])):(h=this._diskRead(a.children[c]),k=this._diskRead(a.children[c+1]));var j=this._allocateNode();j.isLeaf=h.isLeaf;j.level=h.level;for(e=0;e<this.order-1;e++)j.keys[e]=h.keys[e],j.children[e]=h.children[e];j.keys[this.order-
1]=a.keys[c];j.children[this.order-1]=h.children[this.order-1];for(e=0;e<this.order-1;e++)j.keys[e+this.order]=k.keys[e],j.children[e+this.order]=k.children[e];j.children[2*this.order-1]=k.children[this.order-1];a.children[c]=j;for(e=c;e<a.numberActives;e++)a.keys[e]=a.keys[e+1],a.children[e+1]=a.children[e+2];j.numberActives=h.numberActives+k.numberActives+1;a.numberActives--;for(e=a.numberActives;e<2*this.order-1;e++)a.keys[e]=null;if(a.numberActives===0&&this.root===a)this.root=j,j.isLeaf=j.level?
!1:!0;this._diskWrite(j);this.root===j&&this._updateRootNode(this.root);this._diskWrite(a);this._diskDelete(h);this._diskDelete(k);return j};K.Tree.prototype._deleteKeyFromNode=function(a,c){var e=2*this.order-1;if(a.numberActives<e)e=a.numberActives;var h;if(a.isLeaf===!1)return!1;for(h=c;h<e-1;h++)a.keys[h]=a.keys[h+1];a.keys.pop();a.numberActives--;this._diskWrite(a);return!0};K.Tree.prototype._mergeNodes=function(a,c,e){var h,k;h=this._allocateNode();h.isLeaf=!0;for(k=0;k<a.numberActives;k++)h.keys[k]=
a.keys[k],h.children[k]=a.children[k];h.children[a.numberActives]=a.children[a.numberActives];h.keys[a.numberActives]=c;for(k=0;k<e.numberActives;k++)h.keys[k+a.numberActives+1]=e.keys[k],h.children[k+a.numberActives+1]=e.children[k];h.children[2*this.order-1]=e.children[e.numberActives];h.numberActives=a.numberActives+e.numberActives+1;h.isLeaf=a.isLeaf;h.level=a.level;this._diskWrite(h);return h};K.Tree.prototype.audit=function(a){var c=[],e=[],h=this,k=function(j){for(var k=0;k<e.length;k++)if(h.comparator(e[k],
j)===0){var g=" !!! duplicated key "+j;a===!0&&console.log(g);c.push(g)}},j=null,h=this;this.walkNodes(function(i){a===!0&&(console.log("--- Node at "+i.level+" level"),console.log(" - leaf? "+i.isLeaf),console.log(" - num actives? "+i.numberActives),console.log(" - keys: "));for(var g=i.numberActives;g<i.keys.length;g++)i.keys[g]!=null&&a===!0&&(console.log(" * warning : redundant key data"),c.push(" * warning : redundant key data"));for(g=i.numberActives+1;g<i.children.length;g++)i.children[g]!=
null&&a===!0&&(console.log(" * warning : redundant children data"),c.push(" * warning : redundant key data"));if(i.isLeaf===!1)for(g=0;g<i.numberActives;g++){var r=h._diskRead(i.children[g]).keys[h._diskRead(i.children[g]).numberActives-1].key,u=h._diskRead(i.children[g+1]).keys[0].key;a===!0&&console.log("   "+i.keys[g].key+"("+r+","+u+")");if(h.comparator(i.keys[g].key,r)===-1){var t=" !!! value max left "+r+" > key "+i.keys[g].key;a===!0&&console.log(t);c.push(t)}h.comparator(i.keys[g].key,u)===
1&&(t=" !!! value min right "+u+" < key "+i.keys[g].key,a===!0&&console.log(t),c.push(t));k(i.keys[g].key);e.push(i.keys[g].key)}else{j===null?j=i.level:j!=i.level&&(t=" !!! Leaf node with wrong level value",a===!0&&console.log(t),c.push(t));for(g=0;g<i.numberActives;g++)a===!0&&console.log(" "+i.keys[g].key),k(i.keys[g].key),e.push(i.keys[g].key)}i!=h.root&&(i.numberActives>2*h.order-1&&(a===!0&&(t=" !!!! MAX num keys restriction violated "),console.log(t),c.push(t)),i.numberActives<h.order-1&&(a===
!0&&(t=" !!!! MIN num keys restriction violated "),console.log(t),c.push(t)))});return c};K.Tree.prototype._getMaxKeyPos=function(a){for(var c={};;){if(a===null)break;if(a.isLeaf===!0){c.node=a;c.index=a.numberActives-1;break}else c.node=a,c.index=a.numberActives-1,a=this._diskRead(a.children[a.numberActives])}return c};K.Tree.prototype._getMinKeyPos=function(a){for(var c={};;){if(a===null)break;if(a.isLeaf===!0){c.node=a;c.index=0;break}else c.node=a,c.index=0,a=this._diskRead(a.children[0])}return c};
K.Node=function(){this.numberActives=0;this.isLeaf=null;this.keys=[];this.children=[];this.level=0};var S={NodeKey:function(a,c){this.subject=a.subject;this.predicate=a.predicate;this.object=a.object;this.graph=a.graph;this.order=c}};S.NodeKey.prototype.comparator=function(a){for(var c=0;c<this.order.length;c++){var e=this.order[c];if(a[e]==null)break;else if(this[e]<a[e])return-1;else if(this[e]>a[e])return 1}return 0};S.Pattern=function(a){this.subject=a.subject;this.predicate=a.predicate;this.object=
a.object;this.graph=a.graph;this.indexKey=[];this.keyComponents={};for(var c=[],e=[],a=["subject","predicate","object","graph"],h=0;h<a.length;h++)typeof this[a[h]]==="string"?(e.push(a[h]),this.keyComponents[a[h]]=null):(c.push(a[h]),this.keyComponents[a[h]]=this[a[h]],this.indexKey.push(a[h]));this.order=c.concat(e);this.key=new S.NodeKey(this.keyComponents,this.order)};var X={Tree:function(a,c){if(arguments!=0)this.componentOrder=a.componentOrder,K.Tree.call(this,a.order,a.name,a.persistent,a.cacheMaxSize),
this.comparator=function(a,c){for(var k=0;k<this.componentOrder.length;k++){var j=this.componentOrder[k],i=a[j],j=c[j];if(i<j)return-1;else if(i>j)return 1}return 0},this.rangeComparator=function(a,c){for(var k=0;k<this.componentOrder.length;k++){var j=this.componentOrder[k];if(c[j]==null||a[j]==null)break;else if(a[j]<c[j])return-1;else if(a[j]>c[j])return 1}return 0},c!=null&&c(this)}};y["extends"](K.Tree,X.Tree);X.Tree.prototype.insert=function(a,c){K.Tree.prototype.insert.call(this,a,null);c&&
c(!0);return!0};X.Tree.prototype.search=function(a,c){var e=K.Tree.prototype.search.call(this,a,!0);c&&c(e);return e};X.Tree.prototype.range=function(a,c){var e=null,e=typeof this.root==="string"?this._rangeTraverse(this,this._diskRead(this.root),a):this._rangeTraverse(this,this.root,a);c&&c(e);return e};X.Tree.prototype._rangeTraverse=function(a,c,e){for(var e=e.key,h=[],k=[c],j;k.length>0;){c=k.shift();for(j=0;j<c.numberActives&&a.rangeComparator(c.keys[j].key,e)===-1;)j++;if(c.isLeaf===!0)for(;j<
c.numberActives&&a.rangeComparator(c.keys[j].key,e)===0;)h.push(c.keys[j].key),j++;else{var i=a._diskRead(c.children[j]);for(k.push(i);;)if(j<c.numberActives&&a.rangeComparator(c.keys[j].key,e)===0)h.push(c.keys[j].key),j++,i=a._diskRead(c.children[j]),k.push(i);else break}}return h};var U={QuadBackend:function(a,c){if(arguments!=0){this.indexMap={};this.treeOrder=a.treeOrder;this.indices=["SPOG","GP","OGS","POG","GSP","OS"];this.componentOrders={SPOG:["subject","predicate","object","graph"],GP:["graph",
"predicate","subject","object"],OGS:["object","graph","subject","predicate"],POG:["predicate","object","graph","subject"],GSP:["graph","subject","predicate","object"],OS:["object","subject","predicate","graph"]};for(var e=0;e<this.indices.length;e++){var h=this.indices[e];this.indexMap[h]=new X.Tree({order:this.treeOrder,componentOrder:this.componentOrders[h],persistent:a.persistent,name:(a.name||"")+h,cacheMaxSize:a.cacheMaxSize})}c&&c(this)}}};U.QuadBackend.prototype.clear=function(){for(var a=
0;a<this.indices.length;a++)this.indexMap[this.indices[a]].clear()};U.QuadBackend.prototype._indexForPattern=function(a){for(var a=a.indexKey,c=this.indices,e=0;e<c.length;e++)for(var h=c[e],k=this.componentOrders[h],j=0;j<k.length;j++){if(y.include(a,k[j])===!1)break;if(j==a.length-1)return h}return"SPOG"};U.QuadBackend.prototype.index=function(a,c){for(var e=0;e<this.indices.length;e++)this.indexMap[this.indices[e]].insert(a);c&&c(!0);return!0};U.QuadBackend.prototype.range=function(a,c){var e=
this.indexMap[this._indexForPattern(a)].range(a);c&&c(e);return e};U.QuadBackend.prototype.search=function(a,c){var e=this.indexMap[this.indices[0]].search(a);c&&c(e!=null);return e!=null};U.QuadBackend.prototype["delete"]=function(a,c){for(var e,h=0;h<this.indices.length;h++)e=this.indices[h],e=this.indexMap[e],e["delete"](a);c&&c(!0);return!0};var I={Lexicon:function(a){this.uriToOID={};this.OIDToUri={};this.literalToOID={};this.OIDToLiteral={};this.blankToOID={};this.OIDToBlank={};this.defaultGraphOid=
0;this.defaultGraphUri="https://github.com/antoniogarrote/rdfstore-js#default_graph";this.defaultGraphUriTerm={token:"uri",prefix:null,suffix:null,value:this.defaultGraphUri,oid:this.defaultGraphOid};this.oidCounter=1;this.knownGraphs={};a!=null&&a(this)}};I.Lexicon.prototype.registerGraph=function(a){a!=this.defaultGraphOid&&(this.knownGraphs[a]=!0);return!0};I.Lexicon.prototype.registeredGraphs=function(a){var c=[],e;for(e in this.knownGraphs)a===!0?c.push(this.OIDToUri["u"+e]):c.push(e);return c};
I.Lexicon.prototype.registerUri=function(a){if(a===this.defaultGraphUri)return this.defaultGraphOid;else{if(this.uriToOID[a]==null){var c=this.oidCounter;this.oidCounter++;this.uriToOID[a]=[c,0];this.OIDToUri["u"+c]=a}else{var e=this.uriToOID[a],c=e[0];this.uriToOID[a]=[c,e[1]+1]}return c}};I.Lexicon.prototype.resolveUri=function(a){return a===this.defaultGraphUri?this.defaultGraphOid:(a=this.uriToOID[a],a!=null?a[0]:-1)};I.Lexicon.prototype.resolveUriCost=function(a){return a===this.defaultGraphUri?
this.defaultGraphOid:(a=this.uriToOID[a],a!=null?a[1]:-1)};I.Lexicon.prototype.registerBlank=function(){var a=this.oidCounter;this.oidCounter++;a=""+a;this.OIDToBlank[a]=!0;return a};I.Lexicon.prototype.resolveBlank=function(){var a=this.oidCounter;this.oidCounter++;return""+a};I.Lexicon.prototype.resolveBlankCost=function(){return 0};I.Lexicon.prototype.registerLiteral=function(a){if(this.literalToOID[a]==null){var c=this.oidCounter;this.oidCounter++;this.literalToOID[a]=[c,0];this.OIDToLiteral["l"+
c]=a}else{var e=this.literalToOID[a],c=e[0];this.literalToOID[a]=[c,e[1]+1]}return c};I.Lexicon.prototype.resolveLiteral=function(a){a=this.literalToOID[a];return a!=null?a[0]:-1};I.Lexicon.prototype.resolveLiteralCost=function(a){a=this.literalToOID[a];return a!=null?a[1]:0};I.Lexicon.prototype.parseLiteral=function(a){var c=a.lastIndexOf("@");if(c!=-1&&a[c-1]==='"'&&a.substring(c,a.length).match(/^@[a-zA-Z\-]+$/g)!=null){var e=a.substring(1,c-1),a=a.substring(c+1,a.length);return{token:"literal",
value:e,lang:a}}c=a.lastIndexOf("^^");if(c!=-1&&a[c-1]==='"'&&a[c+2]==="<"&&a[a.length-1]===">")return e=a.substring(1,c-1),a=a.substring(c+3,a.length-1),{token:"literal",value:e,type:a};e=a.substring(1,a.length-1);return{token:"literal",value:e}};I.Lexicon.prototype.parseUri=function(a){return{token:"uri",value:a}};I.Lexicon.prototype.retrieve=function(a){try{if(a===this.defaultGraphOid)return{token:"uri",value:this.defaultGraphUri,prefix:null,suffix:null,defaultGraph:!0};else{var c=this.OIDToUri["u"+
a];if(c!=null)return this.parseUri(c);else{var e=this.OIDToLiteral["l"+a];if(e!=null)return this.parseLiteral(e);else if(this.OIDToBlank[""+a]!=null)return{token:"blank",value:"_:"+a};else throw"Null value for OID";}}}catch(h){throw console.log("error in lexicon retrieving OID:"),console.log(a),h.message||h.stack?(h.message&&console.log(h.message),h.stack&&console.log(h.stack)):console.log(h),Error("Unknown retrieving OID in lexicon:"+a);}};I.Lexicon.prototype.clear=function(){this.uriToOID={};this.OIDToUri=
{};this.literalToOID={};this.OIDToLiteral={};this.blankToOID={};this.OIDToBlank={}};I.Lexicon.prototype.unregister=function(a,c){try{return this.unregisterTerm(a.subject.token,c.subject),this.unregisterTerm(a.predicate.token,c.predicate),this.unregisterTerm(a.object.token,c.object),a.graph!=null&&this.unregisterTerm(a.graph.token,c.graph),!0}catch(e){return console.log("Error unregistering quad"),console.log(e.message),!1}};I.Lexicon.prototype.unregisterTerm=function(a,c){if(a==="uri"){if(c!=this.defaultGraphOid){var e=
"u"+c,h=this.OIDToUri[e],k=this.uriToOID[h],j=k[1];if(""+k[0]===""+c)j===0?(delete this.OIDToUri[e],delete this.uriToOID[h],delete this.knownGraphs[c]):this.uriToOID[h]=[c,j-1];else throw"Not matching OID : "+c+" vs "+k[0];}}else if(a==="literal")if(this.oidCounter++,e="l"+c,h=this.OIDToLiteral[e],k=this.literalToOID[h],j=k[1],""+k[0]===""+c)j===0?(delete this.OIDToLiteral[e],delete this.literalToOID[h]):this.literalToOID[h]=[c,j-1];else throw"Not matching OID : "+c+" vs "+k[0];else a==="blank"&&
delete this.OIDToBlank[""+c]};var O={};O.load=function(a,c,e){jQuery.ajax({url:a,headers:{Accept:c},success:function(a,c,j){if((""+j.status)[0]=="2"){for(var c=j.getAllResponseHeaders().split("\n"),j={},i=0;i<c.length;i++){var g=c[i].split(":");j[g[0]]=g[1]}e(!0,{headers:j,data:a})}},error:function(a){(""+a.status)[0]=="3"?redirection==0?e(!1,500):(a=a.getAllResponseHeaders().Location||a.getAllResponseHeaders().location,a!=null?O.load(a,c,e,redirection-1):e(!1,500)):e(!1,a.statusCode())}})};var ra=
null;(function(){var a=function(a,c){a.stack="";for(var j in c)a[j]=c[j]};if(typeof window!=="undefined"){var c=window.jsonld=window.jsonld||{};Exception=function(c){a(this,c)};if(!Object.keys)Object.keys=function(a){if(a!==Object(a))throw new TypeError("Object.keys called on non-object");var c=[],j;for(j in a)Object.prototype.hasOwnProperty.call(a,j)&&c.push(j);return c};if(!Array.prototype.filter)Array.prototype.filter=function(a,c){if(this==null)throw new TypeError;var j=Object(this),e=j.length>>>
0;if(typeof a!="function")throw new TypeError;for(var h=[],i=0;i<e;i++)if(i in j){var k=j[i];a.call(c,k,i,j)&&h.push(k)}return h}}else typeof module!=="undefined"&&module.exports&&(c={},Exception=function(c){a(this,c);this.stack=Error().stack});ra=c;var e={rdf:"http://www.w3.org/1999/02/22-rdf-syntax-ns#",rdfs:"http://www.w3.org/2000/01/rdf-schema#",owl:"http://www.w3.org/2002/07/owl#",xsd:"http://www.w3.org/2001/XMLSchema#",dcterms:"http://purl.org/dc/terms/",foaf:"http://xmlns.com/foaf/0.1/",cal:"http://www.w3.org/2002/12/cal/ical#",
vcard:"http://www.w3.org/2006/vcard/ns# ",geo:"http://www.w3.org/2003/01/geo/wgs84_pos#",cc:"http://creativecommons.org/ns#",sioc:"http://rdfs.org/sioc/ns#",doap:"http://usefulinc.com/ns/doap#",com:"http://purl.org/commerce#",ps:"http://purl.org/payswarm#",gr:"http://purl.org/goodrelations/v1#",sig:"http://purl.org/signature#",ccard:"http://purl.org/commerce/creditcard#"},h={xsd:"http://www.w3.org/2001/XMLSchema#"},k={"boolean":h.xsd+"boolean","double":h.xsd+"double",integer:h.xsd+"integer"},j=function(a,
c,j){c in a?a[c].constructor===Array?a[c].push(j):a[c]=[a[c],j]:a[c]=j},i=function(a){var c;if(a.constructor===Object){c={};var j=Object.keys(a).sort(),e;for(e in j){var h=j[e];c[h]=i(a[h])}}else if(a.constructor===Array)for(e in c=[],a)c[e]=i(a[e]);else c=a;return c},g=function(a){var c={"@id":"@id","@language":"@language","@literal":"@literal","@type":"@type"};if(a){var j={},e;for(e in a)a[e].constructor===String&&a[e]in c&&(j[a[e]]=e);for(e in j)c[e]=j[e]}return c},r=function(a,c){var j=null;c in
a&&(a[c].constructor===String?j=a[c]:a[c].constructor===Object&&"@id"in a[c]&&(j=a[c]["@id"]));return j},u=function(a,c,j){var e=null,h;for(h in a)if(h.length>0&&h[0]!=="@"&&c===r(a,h)){e=h;j!==null&&(j[h]=i(a[h]));break}e===null&&c==="@type"&&(e=g(a)["@type"]);if(e===null)for(h in a)if(h.length>0&&h[0]!=="@"){var k=r(a,h);if(k!==null&&c.indexOf(k)===0&&c.length>k.length){e=h+":"+c.substr(k.length);j!==null&&(j[h]=i(a[h]));break}}e===null&&(e=c);return e},t=function(a,c,j){var e=c,h=g(a),k=c.indexOf(":");
if(k!==-1)h=c.substr(0,k),h in a&&(e=r(a,h)+c.substr(k+1),j!==null&&(j[h]=i(a[h])));else if(c in a)e=r(a,c),j!==null&&(j[c]=i(a[c]));else for(var t in h)if(c===h[t]){e=t;break}return e},w=function(a){var c=!1;a!==null&&a.constructor===Object&&!("@literal"in a)&&(c=Object.keys(a).length>1||!("@id"in a));return c};c.normalize=function(a){return(new D).normalize(a)};c.expand=function(a){return(new D).expand({},null,a)};c.compact=function(a,j){var e=null;if(j!==null){var j=c.expand(j),h;j.constructor===
Array?(e=[],h=j):h=[j];a.constructor===Array&&(a=c.mergeContexts({},a));for(var k in h){var g={},l=(new D).compact(i(a),null,h[k],g);if(Object.keys(g).length>0){var t=g,g={},r=Object.keys(t).sort(),u=void 0;for(u in r){var w=r[u];g[w]=t[w]}t=Object.keys(l);t.sort();t.unshift("@context");l["@context"]=g;var g={},y;for(y in t)r=t[y],g[r]=l[r];l=g}e===null?e=l:e.push(l)}}return e};c.mergeContexts=function(a,j){a.constructor===Array&&(a=c.mergeContexts({},a));var e=i(a);if(j.constructor===Array)for(var h in j)e=
c.mergeContexts(e,j[h]);else{for(var k in j)if(k.indexOf("@")!==0)for(var g in e)if(e[g]===j[k]){delete e[g];break}for(k in j)e[k]=i(j[k])}return e};c.expandTerm=t;c.compactIri=function(a,c){return u(a,c,null)};c.frame=function(a,c,j){return(new D).frame(a,c,j)};c.toTriples=function(a,j,e){var h=null,a=c.normalize(a),e=e||null;e===null&&(h=[],e=function(a,c,e){h.push({subject:y.lexicalFormTerm(a),predicate:y.lexicalFormTerm(c),object:y.lexicalFormTerm(e),graph:j})});var i=!1,k;for(k in a){var g=a[k],
l=g["@id"],l=l[0]=="_"?{token:"blank",value:l.split(":")[1]}:{token:"uri",value:l},t;for(t in g)if(t!=="@id"){var r=g[t];r.constructor!==Array&&(r=[r]);for(var u in r)if(i=r[u],t==="@type"||t==="http://www.w3.org/1999/02/22-rdf-syntax-ns#type"?(t="http://www.w3.org/1999/02/22-rdf-syntax-ns#type",i={token:"uri",value:i}):typeof i==="string"?i={token:"literal",value:i}:i["@id"]!=null?i=i["@id"][0]=="_"?{token:"blank",value:i["@id"].split(":")[1]}:{token:"uri",value:i["@id"]}:i["@type"]!=null?i={token:"literal",
value:i["@literal"],type:i["@type"]}:i["@language"]!=null&&(i={token:"literal",value:i["@literal"],lang:i["@language"]}),i=e(l,{token:"uri",value:t},i)===!1)break;if(i)break}if(i)break}return h};c.resolve=function(a,c,j){var e={},h=function(a,c){if(a.constructor===Array)for(var j in a)h(a[j]);else if(a.constructor===Object)for(var i in a)if(i==="@context")if(a[i].constructor===Array){var k=a[i];for(j in k)k[j].constructor===String&&(c?k[j]=e[k[j]]:e[k[j]]={})}else a[i].constructor===String&&(c?a[i]=
e[a[i]]:e[a[i]]={})};h(a,!1);var i=Object.keys(e).length,k=null;if(i===0)j(a,k);else for(var g in e)c(g,function(c,l){--i;if(c===null)k=k||[],k.push({url:g,error:l});else try{e[g]=c.constructor===String?JSON.parse(c)["@context"]:c["@context"]}catch(t){k=k||[],k.push({url:g,error:t})}i===0&&(k===null&&h(a,!0),j(a,k))})};var D=function(){};D.prototype.compact=function(a,c,j,e){var h,t=g(a);if(j===null)h=null,this.getCoerceType(a,c,e);else if(j.constructor===Array){h=[];for(var r in j)h.push(this.compact(a,
c,j[r],e))}else if(j.constructor===Object&&"@id"in j&&j["@id"].constructor===Array)h={},h[t["@id"]]=this.compact(a,c,j["@id"],e);else if(w(j)){h={};for(var y in j)if(j[y]!=="@context"&&(t=u(a,y,e),t!==y||!(t in h)))h[t]=this.compact(a,y,j[y],e)}else{c=this.getCoerceType(a,c,e);r=null;j.constructor===Object?"@language"in j||(r="@type"in j?j["@type"]:"@id"in j?"@id":c):j.constructor===String&&(r=c);if(c===null&&(r===k["boolean"]||r===k.integer||r===k["double"]))c=r;if(c!==null)if(r===null)throw{message:"Cannot coerce type when a language is specified. The language information would be lost."};
else if(r!==c)throw new Exception({message:"Cannot coerce type because the type does not match.",type:r,expected:c});else j.constructor===Object?"@id"in j?h=j["@id"]:"@literal"in j&&(h=j["@literal"]):h=j,c===k["boolean"]?h=h==="true"||h!=0:c===k["double"]?h=parseFloat(h):c===k.integer&&(h=parseInt(h));else if(j.constructor===Object)for(y in h={},j)h[t[y]]=j[y];else h=i(j);r==="@id"&&(h.constructor===Object?h[t["@id"]]=u(a,h[t["@id"]],e):h=u(a,h,e))}return h};D.prototype.expand=function(a,e,h){var r;
if(h===null)r=null;else if(e===null&&h.constructor===String)r=t(a,h,null);else if(h.constructor===Array){r=[];for(var u in h)r.push(this.expand(a,e,h[u]))}else if(h.constructor===Object){"@context"in h&&(a=c.mergeContexts(a,h["@context"]));r={};for(var w in h)w==="@embed"||w==="@explicit"||w==="@default"||w==="@omitDefault"?j(r,w,i(h[w])):w!=="@context"&&j(r,t(a,w,null),this.expand(a,w,h[w]))}else{u=this.getCoerceType(a,e,null);r=g(a);if(u===null&&(h.constructor===Number||h.constructor===Boolean))u=
h.constructor===Boolean?k["boolean"]:(""+h).indexOf(".")==-1?k.integer:k["double"];e===r["@id"]||e===r["@type"]?r=t(a,h,null):u!==null?(r={},u==="@id"?r["@id"]=t(a,h,null):(r["@type"]=u,u===k["double"]&&(h=h.toExponential(6).replace(/(e(?:\+|-))([0-9])$/,"$10$2")),r["@literal"]=""+h)):r=""+h}return r};D.prototype.normalize=function(a){var c=[];if(a!==null){this.ng={tmp:null,c14n:null};var j=this.expand(e,null,a);this.nameBlankNodes(j);a={};J(null,null,j,a);for(var h in a){var j=a[h],i={},k=Object.keys(j).sort(),
g;for(g in k){var l=k[g];i[l]=j[l]}c.push(i)}this.canonicalizeBlankNodes(c);c.sort(function(a,c){return F(a["@id"],c["@id"])})}return c};D.prototype.getCoerceType=function(a,c,j){var e=null,c=t(a,c,null);c==="@id"||c==="@type"?e="@id":(c=u(a,c,null),c in a&&a[c].constructor===Object&&"@type"in a[c]&&(e=t(a,a[c]["@type"],j),j!==null&&(j[c]=i(a[c]))));return e};var A=function(a){return a.indexOf("_:")===0},C=function(a){return a.constructor===Object&&"@id"in a&&A(a["@id"])},F=function(a,c){var j=0;
if(a.constructor===Array&&c.constructor===Array)for(var e=0;e<a.length&&j===0;++e)j=F(a[e],c[e]);else j=a<c?-1:a>c?1:0;return j},E=function(a,c,j){var e=0;j in a?e=j in c?F(a[j],c[j]):-1:j in c&&(e=1);return e},B=function(a,c){var j=0;a.constructor===String?j=c.constructor!==String?-1:F(a,c):c.constructor===String?j=1:(j=E(a,c,"@literal"),j===0&&("@literal"in a?(j=E(a,c,"@type"),j===0&&(j=E(a,c,"@language"))):j=F(a["@id"],c["@id"])));return j},G=function(a,c){var j=0,e;for(e in a)if(e!=="@id"){j=
F(a[e].constructor===Array?a[e].length:1,c[e].constructor===Array?c[e].length:1);if(j===0){var h=a[e],i=c[e];h.constructor!==Array&&(h=[h],i=[i]);h=h.filter(function(a){return!C(a)});i=i.filter(function(a){return!C(a)});j=F(h.length,i.length)}if(j===0){h.sort(B);i.sort(B);for(var k=0;k<h.length&&j===0;++k)j=B(h[k],i[k])}if(j!==0)break}return j},K=function(a){var c=-1,j={next:function(){++c;return j.current()},current:function(){return"_:"+a+c},inNamespace:function(c){return c.indexOf("_:"+a)===0}};
return j},L=function(a,c,j){if(a!==null)if(a.constructor===Array)for(var e in a)L(a[e],c,j);else if(a.constructor===Object){"@id"in a?a["@id"].constructor==Array?L(a["@id"],c,j):w(a)&&(c[a["@id"]]=a):w(a)&&(!("@id"in a)||C(a))&&j.push(a);for(var h in a)L(a[h],c,j)}},J=function(a,c,j,e){var h=null;if(j!==null)if(j.constructor===Array)for(var k in j)J(a,c,j[k],e);else if(j.constructor===Object)if("@literal"in j||c==="@type")h=i(j);else if(j["@id"].constructor===Array){if(a!==null)throw{message:"Embedded graph literals cannot be flattened."};
for(var g in j["@id"])J(a,c,j["@id"][g],e)}else{j["@id"]in e?k=e[j["@id"]]:(k={"@id":j["@id"]},e[j["@id"]]=k);var h={"@id":k["@id"]},l;for(l in j)g=j[l],g!==null&&l!=="@id"&&(l in k?k[l].constructor!==Array&&(k[l]=[k[l]]):k[l]=[],J(k[l],l,g,e),k[l].length===1&&(k[l]=k[l][0]))}else h=j;h!==null&&a!==null&&(a.constructor===Array?(c=!1,h.constructor===Object&&"@id"in h&&(c=a.filter(function(a){return a.constructor===Object&&"@id"in a&&a["@id"]===h["@id"]}).length>0),c||a.push(h)):a[c]=h)};D.prototype.nameBlankNodes=
function(a){var c=this.ng.tmp=K("tmp"),j={},e=[];L(a,j,e);for(var h in e)if(a=e[h],!("@id"in a)){for(;c.next()in j;);a["@id"]=c.current();j[c.current()]=a}};D.prototype.renameBlankNode=function(a,c){var j=a["@id"];a["@id"]=c;var e=this.subjects;e[c]=e[j];delete e[j];this.edges.refs[c]=this.edges.refs[j];this.edges.props[c]=this.edges.props[j];delete this.edges.refs[j];delete this.edges.props[j];var h=this.edges.refs[c].all,i;for(i in h){var k=h[i].s;k===j&&(k=c);var g=e[k],l=this.edges.props[k].all,
r;for(r in l)if(l[r].s===j){l[r].s=c;var k=l[r].p,k=g[k].constructor===Object?[g[k]]:g[k].constructor===Array?g[k]:[],t;for(t in k)k[t].constructor===Object&&"@id"in k[t]&&k[t]["@id"]===j&&(k[t]["@id"]=c)}}l=this.edges.props[c].all;for(i in l){var k=l[i].s,h=this.edges.refs[k].all,u;for(u in h)if(h[u].s===j)h[u].s=c}};D.prototype.canonicalizeBlankNodes=function(a){this.renamed={};this.mappings={};this.serializations={};var c=this.edges={refs:{},props:{}},j=this.subjects={},e=[],h;for(h in a){var i=
a[h]["@id"];j[i]=a[h];c.refs[i]={all:[],bnodes:[]};c.props[i]={all:[],bnodes:[]};A(i)&&e.push(a[h])}this.collectEdges();var a=this.ng.c14n=K("c14n"),k=this.ng.tmp;for(h in e){var g=e[h],i=g["@id"];if(a.inNamespace(i)){for(;k.next()in j;);this.renameBlankNode(g,k.current());i=g["@id"]}this.serializations[i]={props:null,refs:null}}for(var k=!0,l=this;e.length>0;){k&&(k=!1,e.sort(function(a,c){return l.deepCompareBlankNodes(a,c)}));var g=e.shift(),i=g["@id"],g=["props","refs"],r;for(r in g){var t=g[r];
if(this.serializations[i][t]===null){var u={};u[i]="s1"}else u=this.serializations[i][t].m;var w=Object.keys(u);w.sort(function(a,c){return F(u[a],u[c])});var y=[];for(h in w){var D=w[h];!a.inNamespace(i)&&D in j&&(this.renameBlankNode(j[D],a.next()),y.push(D))}w=e;e=[];for(h in w){var D=w[h],N=D["@id"];if(!a.inNamespace(N)){for(var C in y)this.markSerializationDirty(N,y[C],t)&&(k=!0);e.push(D)}}}}for(var E in c.props)if(c.props[E].bnodes.length>0){var g=j[E],G;for(G in g)G.indexOf("@")!==0&&g[G].constructor===
Array&&g[G].sort(B)}};MappingBuilder=function(){this.count=1;this.processed={};this.mapping={};this.adj={};this.keyStack=[{keys:["s1"],idx:0}];this.done={};this.s=""};MappingBuilder.prototype.copy=function(){var a=new MappingBuilder;a.count=this.count;a.processed=i(this.processed);a.mapping=i(this.mapping);a.adj=i(this.adj);a.keyStack=i(this.keyStack);a.done=i(this.done);a.s=this.s;return a};MappingBuilder.prototype.mapNode=function(a){a in this.mapping||(this.mapping[a]=a.indexOf("_:c14n")===0?"c"+
a.substr(6):"s"+this.count++);return this.mapping[a]};MappingBuilder.prototype.serialize=function(a,c){if(this.keyStack.length>0)for(var j=this.keyStack.pop();j.idx<j.keys.length;++j.idx){var e=j.keys[j.idx];if(!(e in this.adj)){this.keyStack.push(j);break}if(e in this.done)this.s+="_"+e;else{this.done[e]=!0;var h=e,e=this.adj[e],i=e.i;if(i in a){var k=a[i],g="",l=!0,r=void 0;for(r in k)if(r!=="@id"){l?l=!1:g+="|";g+="<"+r+">";var t=k[r].constructor===Array?k[r]:[k[r]],u;for(u in t){var w=t[u];w.constructor===
Object?"@id"in w?g+=A(w["@id"])?"_:":"<"+w["@id"]+">":(g+='"'+w["@literal"]+'"',"@type"in w?g+="^^<"+w["@type"]+">":"@language"in w&&(g+="@"+w["@language"])):g+='"'+w+'"'}}h+="["+g+"]";k=!0;h+="[";var i=c.refs[i].all,y;for(y in i)k?k=!1:h+="|",h+="<"+i[y].p+">",h+=A(i[y].s)?"_:":"<"+i[y].s+">";h+="]"}h+=e.k.join("");this.s+=h;this.keyStack.push({keys:e.k,idx:0});this.serialize(a,c)}}};D.prototype.markSerializationDirty=function(a,c,j){var e=!1,a=this.serializations[a];a[j]!==null&&c in a[j].m&&(a[j]=
null,e=!0);return e};var I=function(a,c){var j=0;return j=a.length==c.length?F(a,c):a.length>c.length?F(a.substr(0,c.length),c):F(a,c.substr(0,a.length))};D.prototype.serializeCombos=function(a,c,j,e,h,k,g){if(g.length>0){k=i(k);k[e.mapNode(g[0].s)]=g[0].s;for(var l=e.copy(),g=g.slice(1),r=Math.max(1,g.length),t=0;t<r;++t){var u=t===0?e:l.copy();this.serializeCombos(a,c,j,u,h,k,g);g.unshift.apply(g,g.splice(1,g.length))}}else if(g=Object.keys(k).sort(),e.adj[j]={i:c,k:g,m:k},e.serialize(this.subjects,
this.edges),a[h]===null||I(e.s,a[h].s)<=0){for(l in g)this.serializeBlankNode(a,k[g[l]],e,h);e.serialize(this.subjects,this.edges);if(a[h]===null||I(e.s,a[h].s)<=0&&e.s.length>=a[h].s.length)a[h]={s:e.s,m:e.mapping}}};D.prototype.serializeBlankNode=function(a,c,j,e){if(!(c in j.processed)){j.processed[c]=!0;var h=j.mapNode(c),i=j.copy(),k=this.edges[e][c].bnodes,g={},l=[],r;for(r in k)k[r].s in j.mapping?g[j.mapping[k[r].s]]=k[r].s:l.push(k[r]);k=Math.max(1,l.length);for(r=0;r<k;++r){var t=r===0?
j:i.copy();this.serializeCombos(a,c,h,t,e,g,l)}}};D.prototype.deepCompareBlankNodes=function(a,c){var j=0,e=a["@id"],h=c["@id"];if(e===h)j=0;else if(j=this.shallowCompareBlankNodes(a,c),j===0)for(var k=["props","refs"],g=0;j===0&&g<k.length;++g){var j=k[g],l=this.serializations[e],r=this.serializations[h];if(l[j]===null){var t=new MappingBuilder;if(j==="refs")t.mapping=i(l.props.m),t.count=Object.keys(t.mapping).length+1;this.serializeBlankNode(l,e,t,j)}if(r[j]===null){t=new MappingBuilder;if(j===
"refs")t.mapping=i(r.props.m),t.count=Object.keys(t.mapping).length+1;this.serializeBlankNode(r,h,t,j)}j=F(l[j].s,r[j].s)}return j};D.prototype.shallowCompareBlankNodes=function(a,c){var j=0,e=Object.keys(a),h=Object.keys(c),j=F(e.length,h.length);j===0&&(j=F(e.sort(),h.sort()));j===0&&(j=G(a,c));if(j===0)var k=this.edges.refs[a["@id"]].all,i=this.edges.refs[c["@id"]].all,j=F(k.length,i.length);if(j===0)for(e=0;e<k.length&&j===0;++e)j=this.compareEdges(k[e],i[e]);return j};D.prototype.compareEdges=
function(a,c){var j=0,e=A(a.s),h=A(c.s),k=this.ng.c14n;e!=h?j=e?1:-1:(e||(j=F(a.s,c.s)),j===0&&(j=F(a.p,c.p)),j===0&&k!==null&&(e=k.inNamespace(a.s),k=k.inNamespace(c.s),e!=k?j=e?1:-1:e&&(j=F(a.s,c.s))));return j};D.prototype.collectEdges=function(){var a=this.edges.refs,c=this.edges.props,j;for(j in this.subjects){var e=this.subjects[j],h;for(h in e)if(h!=="@id"){var k=e[h],k=k.constructor!==Array?[k]:k,i;for(i in k){var g=k[i];g.constructor===Object&&"@id"in g&&g["@id"]in this.subjects&&(g=g["@id"],
a[g].all.push({s:j,p:h}),c[j].all.push({s:g,p:h}))}}}var l=this;for(j in a)a[j].all.sort(function(a,c){return l.compareEdges(a,c)}),a[j].bnodes=a[j].all.filter(function(a){return A(a.s)});for(j in c)c[j].all.sort(function(a,c){return l.compareEdges(a,c)}),c[j].bnodes=c[j].all.filter(function(a){return A(a.s)})};var O=function(a,c){var j=!1;if(!("@type"in c)){var e=Object.keys(c).filter(function(a){return a.indexOf("@")!==0});if(e.length===0)j=!0;else if(a.constructor===Object&&"@id"in a){var j=!0,
h;for(h in e)if(!(e[h]in a)){j=!1;break}}}return j},S=function(a,c,j,e,h,k,i,g){var l=c["@id"],r=l in e?e[l]:null;if(("@embed"in j&&j["@embed"]||!("@embed"in j)&&g.defaults.embedOn)&&(r===null||r.autoembed&&!h)){if(r===null)r={},e[l]=r;else if(r.parent!==null){if(r.parent[r.key].constructor===Array){var t=r.parent[r.key],u;for(u in t)if(t[u].constructor===Object&&"@id"in t[u]&&t[u]["@id"]===l){t[u]={"@id":c["@id"]};break}}else r.parent[r.key]={"@id":c["@id"]};var w=function(a){var c=Object.keys(e),
j;for(j in c)j=c[j],j in e&&e[j].parent!==null&&e[j].parent["@id"]===a&&(delete e[j],w(j))};w(l)}r.autoembed=h;r.parent=k;r.key=i;if(j["@explicit"]===!0||g.defaults.explicitOn)for(y in c)y!=="@id"&&!(y in j)&&delete c[y];h=Object.keys(c);for(u in h){var y=h[u];if(y.indexOf("@")!==0){y in j?(k=j[y],i=!1):(k=c[y].constructor===Array?[]:{},i=!0);var l=c[y],l=l.constructor===Array?l:[l],D;for(D in l)l[D].constructor===Object&&"@id"in l[D]&&l[D]["@id"]in a&&(l[D]=a[l[D]["@id"]]);c[y]=$(a,l,k,e,i,c,y,g)}}for(y in j)if(y.indexOf("@")!==
0&&(!(y in c)||c[y]===null))k=j[y],k.constructor===Array?c[y]=[]:(k.constructor===Array&&(k=k.length>0?k[0]:{}),k["@omitDefault"]===!0||g.defaults.omitDefaultOn||(c[y]="@default"in k?k["@default"]:null))}else c={"@id":c["@id"]};return c},$=function(a,c,j,e,h,k,i,g){var l=null,r=-1,t;j.constructor===Array?(l=[],t=j,t.length===0&&t.push({})):(t=[j],r=1);for(var u=[],y=0;y<t.length&&r!==0;++y){j=t[y];if(j.constructor!==Object)throw{message:"Invalid JSON-LD frame. Frame must be an object or an array.",
frame:j};u[y]=[];for(var D=0;D<c.length&&r!==0;++D){var A=c[D],F=!1,C="@type";if("@type"in j&&A.constructor===Object&&C in A)for(var E=A[C].constructor===Array?A[C]:[A[C]],B=j[C].constructor===Array?j[C]:[j[C]],G=0;G<B.length&&!F;++G){var C=B[G],K;for(K in E)if(E[K]===C){F=!0;break}}if(F||O(A,j))u[y].push(A),--r}}for(var Va in u)for(var L in u[Va])j=t[Va],c=u[Va][L],w(c)&&(c=S(a,c,j,e,h,k,i,g)),l===null?l=c:(j=c!==null&&c.constructor===Object&&"@id"in c&&Object.keys(c).length===1&&c["@id"]in e,k===
null&&j||l.push(c));return l};D.prototype.frame=function(a,j,e){var a=c.normalize(a),h=null;if("@context"in j)h=i(j["@context"]),j=c.expand(j);else if(j.constructor===Array){j.length>0&&"@context"in j[0]&&(h=i(j[0]["@context"]));var e=[],k;for(k in j)e.push(c.expand(j[k]));j=e}var e={defaults:{embedOn:!0,explicitOn:!1,omitDefaultOn:!1}},g={};for(k in a)g[a[k]["@id"]]=a[k];a=$(g,a,j,{},!1,null,null,e);h!==null&&a!==null&&(a=c.compact(h,a));return a}})();var ta={parser:{}};ta.parser.parse=function(a,
c){typeof a==="string"&&(a=JSON.parse(a));return ra.toTriples(a,c)};var Y={RDFLoader:function(a){this.precedences=["text/turtle","text/n3","application/json"];this.parsers={"text/turtle":aa.parser,"text/n3":aa.parser,"application/json":ta.parser};if(a!=null)for(var c in a.parsers)this.parsers[c]=a.parsers[c];if(a&&a.precedences!=null)for(c in this.precedences=a.precedences,a.parsers)y.include(this.precedences,c)||this.precedences.push(c);this.acceptHeaderValue="";for(a=0;a<this.precedences.length;a++)a!=
0?this.acceptHeaderValue=this.acceptHeaderValue+","+this.precedences[a]:this.acceptHeaderValue+=this.precedences[a]}};Y.RDFLoader.prototype.registerParser=function(a,c){this.parsers[a]=c;this.precedences.push(a)};Y.RDFLoader.prototype.unregisterParser=function(a){delete this.parsers[a];for(var c=[],e=0;e<this.precedences.length;e++)this.precedences[e]!=a&&c.push(this.precedences[e]);this.precedences=c};Y.RDFLoader.prototype.setAcceptHeaderPrecedence=function(a){this.precedences=a};Y.RDFLoader.prototype.load=
function(a,c,e){var h=this;O.load(a,this.acceptHeaderValue,function(k,j){if(k==!0){var i=j.headers["Content-Type"]||j.headers["content-type"],g=j.data;if(i!=null){var i=i.split(";")[0],r;for(r in h.parsers)if(r.indexOf("/")!=-1){var u=r.split("/");if(u[1]==="*"){if(i.indexOf(u[0])!=-1)return h.tryToParse(h.parsers[r],c,g,e)}else if(i.indexOf(r)!=-1)return h.tryToParse(h.parsers[r],c,g,e);else if(i.indexOf(u[1])!=-1)return h.tryToParse(h.parsers[r],c,g,e)}else if(i.indexOf(r)!=-1)return h.tryToParse(h.parsers[r],
a,c,e);e(!1,"Unknown media type : "+i)}else console.log("Unknown media type"),console.log(j.headers),e(!1,"Uknown media type")}else e(!1,"Network error: "+j)})};Y.RDFLoader.prototype.loadFromFile=function(a,c,e,h){try{var k=this;require("fs").readFile(e.split("file:/")[1],function(j,e){if(j)throw j;e=e.toString("utf8");k.tryToParse(a,c,e,h)})}catch(j){h(!1,j)}};Y.RDFLoader.prototype.tryToParse=function(a,c,e,h){try{typeof e==="string"&&(e=y.normalizeUnicodeLiterals(e));var k=a.parse(e,c);k!=null?
h(!0,k):h(!1,"parsing error")}catch(j){console.log(j.message),console.log(j.stack),h(!1,"parsing error with mime type : "+j)}};var J={AbstractQueryTree:function(){}};J.AbstractQueryTree.prototype.parseQueryString=function(a){return ga.parser.parse(a)};J.AbstractQueryTree.prototype.parseExecutableUnit=function(a){if(a.kind==="select")return this.parseSelect(a);else if(a.kind==="ask")return this.parseSelect(a);else if(a.kind==="modify")return this.parseSelect(a);else if(a.kind==="construct")return this.parseSelect(a);
else if(a.kind==="insertdata")return this.parseInsertData(a);else if(a.kind==="deletedata")return this.parseInsertData(a);else if(a.kind==="load")return a;else if(a.kind==="clear")return a;else if(a.kind==="drop")return a;else if(a.kind==="create")return a;else throw Error("unknown executable unit: "+a.kind);};J.AbstractQueryTree.prototype.parseSelect=function(a){return a==null?(console.log("error parsing query"),null):(a.pattern=this.build(a.pattern,{freshCounter:0}),a)};J.AbstractQueryTree.prototype.parseInsertData=
function(a){return a==null?(console.log("error parsing query"),null):a};J.AbstractQueryTree.prototype.build=function(a,c){if(a.token==="groupgraphpattern")return this._buildGroupGraphPattern(a,c);else if(a.token==="basicgraphpattern"){var e={kind:"BGP",value:a.triplesContext};return e=J.translatePathExpressionsInBGP(e,c)}else if(a.token==="graphunionpattern"){var e=this.build(a.value[0],c),h=this.build(a.value[1],c);return{kind:"UNION",value:[e,h]}}else if(a.token==="graphgraphpattern")return{kind:"GRAPH",
value:this.build(a.value,c),graph:a.graph};else throw Error("not supported token in query:"+a.token);};J.translatePathExpressionsInBGP=function(a,c){var e,h=[],k,j;for(j=0;j<a.value.length;j++)if(a.value[j].predicate&&a.value[j].predicate.token==="path"){e=a.value[j];k=a.value.slice(j+1);var i=J.translatePathExpression(e,c);e=null;if(i.kind==="BGP")h=h.concat(i.value);else if(i.kind==="ZERO_OR_MORE_PATH"||i.kind==="ONE_OR_MORE_PATH"){j=h.length>0?{kind:"JOIN",lvalue:{kind:"BGP",value:h},rvalue:i}:
i;if(i.kind==="ZERO_OR_MORE_PATH")if(i.y.token==="var"&&i.y.value.indexOf("fresh:")===0&&i.x.token==="var"&&i.x.value.indexOf("fresh:")===0)for(var g=0;g<a.value.length;g++){if(a.value[g].object&&a.value[g].object.token==="var"&&a.value[g].object.value===i.x.value)e=y.clone(a.value[g]),e.object=i.y}else if(i.y.token==="var"&&i.y.value.indexOf("fresh:")===0)for(g=0;g<a.value.length;g++)if(a.value[g].subject&&a.value[g].subject.token==="var"&&a.value[g].subject.value===i.y.value)e=y.clone(a.value[g]),
e.subject=i.x;return k.length>0?(i=J.translatePathExpressionsInBGP({kind:"BGP",value:k},c),e!=null?(h=h.concat([e]).concat(k),{kind:"UNION",value:[{kind:"JOIN",lvalue:j,rvalue:i},{kind:"BGP",value:h}]}):{kind:"JOIN",lvalue:j,rvalue:i}):j}else return i}else h.push(a.value[j]);a.value=h;return a};J.translatePathExpression=function(a,c){if(a.predicate.kind==="element")if(a.predicate.modifier==="+"){a.predicate.modifier=null;var e=J.translatePathExpression(a,c);return{kind:"ONE_OR_MORE_PATH",path:e,x:a.subject,
y:a.object}}else return a.predicate.modifier==="*"?(a.predicate.modifier=null,e=J.translatePathExpression(a,c),{kind:"ZERO_OR_MORE_PATH",path:e,x:a.subject,y:a.object}):(a.predicate=a.predicate.value,{kind:"BGP",value:[a]});else if(a.predicate.kind==="sequence"){for(var e=a.subject,h=a.object,k=a.graph,j,i,g=[],r=0;r<a.predicate.value.length;r++){r!=a.predicate.value.length-1?(j={token:"var",value:"fresh:"+c.freshCounter},c.freshCounter++):j=h;i={subject:e,predicate:a.predicate.value[r],object:j};
if(k!=null)i.graph=y.clone(k);g.push(i);r!=a.predicate.value.length-1&&(e=y.clone(j))}return J.translatePathExpressionsInBGP({kind:"BGP",value:g},c)}};J.AbstractQueryTree.prototype._buildGroupGraphPattern=function(a,c){for(var e=a.filters||[],h={kind:"EMPTY_PATTERN"},k=0;k<a.patterns.length;k++){var j=a.patterns[k];j.token==="optionalgraphpattern"?(j=this.build(j.value,c),h=j.kind==="FILTER"?{kind:"LEFT_JOIN",lvalue:h,rvalue:j.value,filter:j.filter}:{kind:"LEFT_JOIN",lvalue:h,rvalue:j,filter:!0}):
(j=this.build(j,c),h=h.kind=="EMPTY_PATTERN"?j:{kind:"JOIN",lvalue:h,rvalue:j})}if(e.length!=0)if(h.kind==="EMPTY_PATTERN")return{kind:"FILTER",filter:e,value:h};else if(h.kind==="LEFT_JOIN"&&h.filter===!0)return{kind:"FILTER",filter:e,value:h};else if(h.kind==="LEFT_JOIN")return{kind:"FILTER",filter:e,value:h};else if(h.kind==="JOIN")return{kind:"FILTER",filter:e,value:h};else if(h.kind==="UNION")return{kind:"FILTER",filter:e,value:h};else if(h.kind==="GRAPH")return{kind:"FILTER",filter:e,value:h};
else if(h.kind==="BGP")return{kind:"FILTER",filter:e,value:h};else throw Error("Unknow kind of algebra expression: "+h.kind);else return h};J.AbstractQueryTree.prototype.collectBasicTriples=function(a,c){c==null&&(c=[]);if(a.kind==="select")c=this.collectBasicTriples(a.pattern,c);else if(a.kind==="BGP")c=c.concat(a.value);else if(a.kind==="ZERO_OR_MORE_PATH")c=this.collectBasicTriples(a.path);else if(a.kind==="UNION")c=this.collectBasicTriples(a.value[0],c),c=this.collectBasicTriples(a.value[1],c);
else if(a.kind==="GRAPH")c=this.collectBasicTriples(a.value,c);else if(a.kind==="LEFT_JOIN"||a.kind==="JOIN")c=this.collectBasicTriples(a.lvalue,c),c=this.collectBasicTriples(a.rvalue,c);else if(a.kind==="FILTER")c=this.collectBasicTriples(a.value,c);else if(a.kind==="construct")c=this.collectBasicTriples(a.pattern,c);else if(a.kind!=="EMPTY_PATTERN")throw"Unknown pattern: "+a.kind;return c};J.AbstractQueryTree.prototype.bind=function(a,c){if(a.graph!=null&&a.graph.token&&a.graph.token==="var"&&c[a.graph.value]!=
null)a.graph=c[a.graph.value];if(a.filter!=null){for(var e=[],h=0;h<a.filter.length;h++)a.filter[h].value=this._bindFilter(a.filter[h].value,c),e.push(a.filter[h]);a.filter=e}if(a.kind==="select")a.pattern=this.bind(a.pattern,c);else if(a.kind==="BGP")a.value=this._bindTripleContext(a.value,c);else if(a.kind==="ZERO_OR_MORE_PATH"){a.path=this._bindTripleContext(a.path,c);if(a.x&&a.x.token==="var"&&c[a.x.value]!=null)a.x=c[a.x.value];if(a.y&&a.y.token==="var"&&c[a.y.value]!=null)a.y=c[a.y.value]}else if(a.kind===
"UNION")a.value[0]=this.bind(a.value[0],c),a.value[1]=this.bind(a.value[1],c);else if(a.kind==="GRAPH")a.value=this.bind(a.value,c);else if(a.kind==="LEFT_JOIN"||a.kind==="JOIN")a.lvalue=this.bind(a.lvalue,c),a.rvalue=this.bind(a.rvalue,c);else if(a.kind==="FILTER")a.filter=this._bindFilter(a.filter[h].value,c);else if(a.kind!=="EMPTY_PATTERN")throw"Unknown pattern: "+a.kind;return a};J.AbstractQueryTree.prototype._bindTripleContext=function(a,c){for(var e=0;e<a.length;e++){delete a[e].graph;delete a[e].variables;
for(var h in a[e]){var k=a[e][h];k.token==="var"&&c[k.value]!=null&&(a[e][h]=c[k.value])}}return a};J.AbstractQueryTree.prototype._bindFilter=function(a,c){if(a.expressionType!=null){var e=a.expressionType;if(e=="relationalexpression")a.op1=this._bindFilter(a.op1,c),a.op2=this._bindFilter(a.op2,c);else if(e=="conditionalor"||e=="conditionaland")for(e=0;e<a.operands.length;e++)a.operands[e]=this._bindFilter(a.operands[e],c);else if(e=="additiveexpression"){a.summand=this._bindFilter(a.summand,c);for(e=
0;e<a.summands.length;e++)a.summands[e].expression=this._bindFilter(a.summands[e].expression,c)}else if(e=="builtincall")for(e=0;e<a.args.length;e++)a.args[e]=this._bindFilter(a.args[e],c);else if(e=="multiplicativeexpression"){a.factor=this._bindFilter(a.factor,c);for(e=0;e<a.factors.length;e++)a.factors[e].expression=this._bindFilter(a.factors[e].expression,c)}else if(e=="unaryexpression")a.expression=this._bindFilter(a.expression,c);else if(e=="irireforfunction")for(e=0;e<a.factors.args;e++)a.args[e]=
this._bindFilter(a.args[e],c);else if(e=="atomic"&&a.primaryexpression=="var"&&c[a.value.value]!=null)e=c[a.value.value],a.primaryexpression=e.token==="uri"?"iri":"literal",a.value=e}return a};J.AbstractQueryTree.prototype.replace=function(a,c,e,h){if(a.graph!=null&&a.graph.token&&a.graph.token===c.token&&a.graph.value==c.value)a.graph=y.clone(e);if(a.filter!=null){for(var k=[],j=0;j<a.filter.length;j++)a.filter[j].value=this._replaceFilter(a.filter[j].value,c,e,h),k.push(a.filter[j]);a.filter=k}if(a.kind===
"select")a.pattern=this.replace(a.pattern,c,e,h);else if(a.kind==="BGP")a.value=this._replaceTripleContext(a.value,c,e,h);else if(a.kind==="ZERO_OR_MORE_PATH"){a.path=this._replaceTripleContext(a.path,c,e,h);if(a.x&&a.x.token===c.token&&a.value===c.value)a.x=y.clone(e);if(a.y&&a.y.token===c.token&&a.value===c.value)a.y=y.clone(e)}else if(a.kind==="UNION")a.value[0]=this.replace(a.value[0],c,e,h),a.value[1]=this.replace(a.value[1],c,e,h);else if(a.kind==="GRAPH")a.value=this.replace(a.value,c,e);else if(a.kind===
"LEFT_JOIN"||a.kind==="JOIN")a.lvalue=this.replace(a.lvalue,c,e,h),a.rvalue=this.replace(a.rvalue,c,e,h);else if(a.kind==="FILTER")a.value=this._replaceFilter(a.value,c,e,h);else if(a.kind!=="EMPTY_PATTERN")throw"Unknown pattern: "+a.kind;return a};J.AbstractQueryTree.prototype._replaceTripleContext=function(a,c,e,h){for(var k=0;k<a.length;k++)for(var j in a[k]){var i=a[k][j];if(i.token==="var"&&c.token==="var"&&i.value===c.value)a[k][j]=e;else if(i.token==="blank"&&c.token==="blank"&&i.value===c.value)a[k][j]=
e;else if((i.token==="literal"||i.token==="uri")&&(c.token==="literal"||c.token==="uri")&&i.token===c.token&&y.lexicalFormTerm(i,h)[i.token]===y.lexicalFormTerm(c,h)[i.token])a[k][j]=e}return a};J.AbstractQueryTree.prototype._replaceFilter=function(a,c,e,h){if(a.expressionType!=null){var k=a.expressionType;if(k=="relationalexpression")a.op1=this._replaceFilter(a.op1,c,e,h),a.op2=this._replaceFilter(a.op2,c,e,h);else if(k=="conditionalor"||k=="conditionaland")for(k=0;k<a.operands.length;k++)a.operands[k]=
this._replaceFilter(a.operands[k],c,e,h);else if(k=="additiveexpression"){a.summand=this._replaceFilter(a.summand,c,e,h);for(k=0;k<a.summands.length;k++)a.summands[k].expression=this._replaceFilter(a.summands[k].expression,c,e,h)}else if(k=="builtincall")for(k=0;k<a.args.length;k++)a.args[k]=this._replaceFilter(a.args[k],c,e,h);else if(k=="multiplicativeexpression"){a.factor=this._replaceFilter(a.factor,c,e,h);for(k=0;k<a.factors.length;k++)a.factors[k].expression=this._replaceFilter(a.factors[k].expression,
c,e,h)}else if(k=="unaryexpression")a.expression=this._replaceFilter(a.expression,c,e,h);else if(k=="irireforfunction")for(k=0;k<a.factors.args;k++)a.args[k]=this._replaceFilter(a.args[k],c,e,h);else if(k=="atomic"){h=null;if(a.primaryexpression==c.token&&a.value==c.value)h=e.value;else if(a.primaryexpression=="iri"&&c.token=="uri"&&a.value==c.value)h=e.value;if(h!=null)a.primaryexpression=e.token==="uri"?"iri":e.token,a.value=h}}return a};J.AbstractQueryTree.prototype.treeWithUnion=function(a){if(a==
null)return!1;if(a.kind==null)return!1;if(a.kind==="select")return this.treeWithUnion(a.pattern);else if(a.kind==="BGP")return this.treeWithUnion(a.value);else if(a.kind==="ZERO_OR_MORE_PATH")return!1;else if(a.kind==="UNION")if(console.log("UNION!!"),a.value[0].value!=null&&a.value[0].value.variables!=null&&a.value[1].value!=null&&a.value[1].value.variables!=null){if(console.log("COMPARING:"+a.value[0].variables.join("/")),console.log("VS "+a.values[1].variables.join("/")),a.value[0].variables.join("/")===
a.values[1].variables.join("/"))return this.treeWithUnion(a.value[0])?!0:this.treeWithUnion(a.value[1])}else return!0;else if(a.kind==="GRAPH")return!1;else if(a.kind==="LEFT_JOIN"||a.kind==="JOIN")if(this.treeWithUnion(a.lvalue))return!0;else this.treeWithUnion(a.rvalue);else return!1};var ga={};ga.parser=function(){var a={parse:function(a,e){function h(a){var b=a.charCodeAt(0);if(b<=255)var a="x",c=2;else a="u",c=4;var a="\\"+a,d=b.toString(16).toUpperCase(),b=d;c-=d.length;for(d=0;d<c;d++)b="0"+
b;return a+b}function k(a){return'"'+a.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\r/g,"\\r").replace(/\n/g,"\\n").replace(/[\x80-\uFFFF]/g,h)+'"'}function j(a){b<ua||(b>ua&&(ua=b,Xa=[]),Xa.push(a))}function i(){var a="SPARQL@"+b,c=x[a];if(c)return b=c.nextPos,c.result;c=g();c===null&&(c=Ua(),c=c!==null?c:null);x[a]={nextPos:b,result:c};return c}function g(){var a="Query@"+b,c=x[a];if(c)return b=c.nextPos,c.result;c=m;m=!1;var e=b,d=b,f=r();if(f!==null){var h=E();h===null&&(h=K(),h===null&&
(h=L(),h===null&&(h=J(),h=h!==null?h:null)));h!==null?f=[f,h]:(f=null,b=d)}else f=null,b=d;d=f!==null?{token:"query",kind:"query",prologue:f[0],units:[f[1]]}:null;d===null&&(d=null,b=e);(m=c)&&d===null&&j("[2] Query");x[a]={nextPos:b,result:d};return d}function r(){var a="Prologue@"+b,c=x[a];if(c)return b=c.nextPos,c.result;c=m;m=!1;var e=b,d=b,f=u(),f=f!==null?f:"";if(f!==null){for(var h=[],q=o();q!==null;)h.push(q),q=o();if(h!==null){for(var q=[],v=t();v!==null;)q.push(v),v=t();q!==null?f=[f,h,
q]:(f=null,b=d)}else f=null,b=d}else f=null,b=d;d=f!==null?{token:"prologue",base:f[0],prefixes:f[2]}:null;d===null&&(d=null,b=e);(m=c)&&d===null&&j("[3] Prologue");x[a]={nextPos:b,result:d};return d}function u(){var e="BaseDecl@"+b,h=x[e];if(h)return b=h.nextPos,h.result;h=m;m=!1;for(var H=b,d=b,f=[],z=o();z!==null;)f.push(z),z=o();if(f!==null)if(a.substr(b,4)==="BASE"?(z="BASE",b+=4):(z=null,m&&j('"BASE"')),z===null&&(a.substr(b,4)==="base"?(z="base",b+=4):(z=null,m&&j('"base"')),z=z!==null?z:null),
z!==null){for(var q=[],v=o();v!==null;)q.push(v),v=o();q!==null?(v=ka(),v!==null?f=[f,z,q,v]:(f=null,b=d)):(f=null,b=d)}else f=null,b=d;else f=null,b=d;d=f!==null?function(a){var b={token:"base"};b.value=a;return b}(f[3]):null;d===null&&(d=null,b=H);(m=h)&&d===null&&j("[4] BaseDecl");x[e]={nextPos:b,result:d};return d}function t(){var e="PrefixDecl@"+b,h=x[e];if(h)return b=h.nextPos,h.result;h=m;m=!1;for(var H=b,d=b,f=[],z=o();z!==null;)f.push(z),z=o();if(f!==null)if(a.substr(b,6)==="PREFIX"?(z="PREFIX",
b+=6):(z=null,m&&j('"PREFIX"')),z===null&&(a.substr(b,6)==="prefix"?(z="prefix",b+=6):(z=null,m&&j('"prefix"')),z=z!==null?z:null),z!==null){for(var q=[],v=o();v!==null;)q.push(v),v=o();if(q!==null)if(v=Aa(),v!==null){for(var n=[],k=o();k!==null;)n.push(k),k=o();n!==null?(k=ka(),k!==null?f=[f,z,q,v,n,k]:(f=null,b=d)):(f=null,b=d)}else f=null,b=d;else f=null,b=d}else f=null,b=d;else f=null,b=d;d=f!==null?function(a,b){var f={token:"prefix"};f.prefix=a;f.local=b;return f}(f[3],f[5]):null;d===null&&
(d=null,b=H);(m=h)&&d===null&&j("[5] PrefixDecl");x[e]={nextPos:b,result:d};return d}function w(){var a="TURTLE@"+b,c=x[a];if(c)return b=c.nextPos,c.result;for(var c=b,j=[],d=y();d!==null;)j.push(d),d=y();j=j!==null?j:null;j===null&&(j=null,b=c);x[a]={nextPos:b,result:j};return j}function y(){var e="statement@"+b,h=x[e];if(h)return b=h.nextPos,h.result;for(var H=h=b,d=[],f=o();f!==null;)d.push(f),f=o();if(d!==null)if(f=A(),f!==null){for(var z=[],q=o();q!==null;)z.push(q),q=o();if(z!==null)if(a.substr(b,
1)==="."?(q=".",b+=1):(q=null,m&&j('"."')),q!==null){for(var v=[],n=o();n!==null;)v.push(n),n=o();v!==null?d=[d,f,z,q,v]:(d=null,b=H)}else d=null,b=H;else d=null,b=H}else d=null,b=H;else d=null,b=H;H=d!==null?d[1]:null;H===null&&(H=null,b=h);if(H!==null)h=H;else{H=h=b;d=[];for(f=o();f!==null;)d.push(f),f=o();if(d!==null)if(f=la(),f!==null){z=[];for(q=o();q!==null;)z.push(q),q=o();z!==null?d=[d,f,z]:(d=null,b=H)}else d=null,b=H;else d=null,b=H;H=d!==null?d[1]:null;H===null&&(H=null,b=h);if(H!==null)h=
H;else{h=o();if(h!==null)for(H=[];h!==null;)H.push(h),h=o();else H=null;h=H!==null?H:null}}x[e]={nextPos:b,result:h};return h}function A(){var a="directive@"+b,c=x[a];if(c)return b=c.nextPos,c.result;c=F();c===null&&(c=C(),c=c!==null?c:null);x[a]={nextPos:b,result:c};return c}function C(){var e="base@"+b,h=x[e];if(h)return b=h.nextPos,h.result;for(var H=h=b,d=[],f=o();f!==null;)d.push(f),f=o();if(d!==null)if(a.substr(b,5)==="@base"?(f="@base",b+=5):(f=null,m&&j('"@base"')),f!==null){var z=o();if(z!==
null)for(var q=[];z!==null;)q.push(z),z=o();else q=null;q!==null?(z=ka(),z!==null?d=[d,f,q,z]:(d=null,b=H)):(d=null,b=H)}else d=null,b=H;else d=null,b=H;H=d!==null?function(a){base={token:"base"};base.value=a;return base}(d[3]):null;H===null&&(H=null,b=h);x[e]={nextPos:b,result:H};return H}function F(){var e="prefixID@"+b,h=x[e];if(h)return b=h.nextPos,h.result;for(var H=h=b,d=[],f=o();f!==null;)d.push(f),f=o();if(d!==null)if(a.substr(b,7)==="@prefix"?(f="@prefix",b+=7):(f=null,m&&j('"@prefix"')),
f!==null){var z=o();if(z!==null)for(var q=[];z!==null;)q.push(z),z=o();else q=null;if(q!==null)if(z=Ya(),z=z!==null?z:"",z!==null){if(a.substr(b,1)===":"){var v=":";b+=1}else v=null,m&&j('":"');if(v!==null){for(var n=[],k=o();k!==null;)n.push(k),k=o();n!==null?(k=ka(),k!==null?d=[d,f,q,z,v,n,k]:(d=null,b=H)):(d=null,b=H)}else d=null,b=H}else d=null,b=H;else d=null,b=H}else d=null,b=H;else d=null,b=H;H=d!==null?function(a,b){prefix={token:"prefix"};prefix.prefix=a;prefix.local=b;return prefix}(d[3],
d[6]):null;H===null&&(H=null,b=h);x[e]={nextPos:b,result:H};return H}function E(){var a="SelectQuery@"+b,c=x[a];if(c)return b=c.nextPos,c.result;c=m;m=!1;var e=b,d=b,f=B();if(f!==null){for(var h=[],q=o();q!==null;)h.push(q),q=o();if(h!==null){for(var q=[],v=I();v!==null;)q.push(v),v=I();if(q!==null){for(var v=[],n=o();n!==null;)v.push(n),n=o();if(v!==null)if(n=$(),n!==null){for(var k=[],i=o();i!==null;)k.push(i),i=o();if(k!==null)if(i=U(),i!==null){for(var g=[],l=o();l!==null;)g.push(l),l=o();g!==
null?(l=ta(),l!==null?f=[f,h,q,v,n,k,i,g,l]:(f=null,b=d)):(f=null,b=d)}else f=null,b=d;else f=null,b=d}else f=null,b=d;else f=null,b=d}else f=null,b=d}else f=null,b=d}else f=null,b=d;d=f!==null?function(a,b,f,d){for(var c={named:[],implicit:[]},j=0;j<b.length;j++){var e=b[j];e.kind==="default"?c.implicit.push(e.graph):c.named.push(e.graph)}c.named.length===0&&c.implicit.length===0&&c.implicit.push({token:"uri",prefix:null,suffix:null,value:"https://github.com/antoniogarrote/rdfstore-js#default_graph"});
b={kind:"select",token:"executableunit"};b.dataset=c;b.projection=a.vars;b.modifier=a.modifier;b.pattern=f;if(d!=null&&d.limit!=null)b.limit=d.limit;if(d!=null&&d.offset!=null)b.offset=d.offset;if(d!=null&&d.order!=null&&d.order!="")b.order=d.order;if(d!=null&&d.group!=null)b.group=d.group;return b}(f[0],f[2],f[4],f[6]):null;d===null&&(d=null,b=e);(m=c)&&d===null&&j("[6] SelectQuery");x[a]={nextPos:b,result:d};return d}function G(){var a="SubSelect@"+b,c=x[a];if(c)return b=c.nextPos,c.result;c=m;
m=!1;var e=b,d=B();if(d!==null){var f=$();if(f!==null){var h=U();h!==null?d=[d,f,h]:(d=null,b=e)}else d=null,b=e}else d=null,b=e;(m=c)&&d===null&&j("[7] SubSelect");x[a]={nextPos:b,result:d};return d}function B(){var e="SelectClause@"+b,h=x[e];if(h)return b=h.nextPos,h.result;h=m;m=!1;for(var H=b,d=b,f=[],z=o();z!==null;)f.push(z),z=o();if(f!==null)if(a.substr(b,6)==="SELECT"?(z="SELECT",b+=6):(z=null,m&&j('"SELECT"')),z===null&&(a.substr(b,6)==="select"?(z="select",b+=6):(z=null,m&&j('"select"')),
z=z!==null?z:null),z!==null){for(var q=[],v=o();v!==null;)q.push(v),v=o();if(q!==null)if(a.substr(b,8)==="DISTINCT"?(v="DISTINCT",b+=8):(v=null,m&&j('"DISTINCT"')),v===null&&(a.substr(b,8)==="distinct"?(v="distinct",b+=8):(v=null,m&&j('"distinct"')),v=v!==null?v:null),v===null&&(a.substr(b,7)==="REDUCED"?(v="REDUCED",b+=7):(v=null,m&&j('"REDUCED"')),v===null&&(a.substr(b,7)==="reduced"?(v="reduced",b+=7):(v=null,m&&j('"reduced"')),v=v!==null?v:null),v=v!==null?v:null),v=v!==null?v:"",v!==null){for(var n=
[],k=o();k!==null;)n.push(k),k=o();if(n!==null){for(var i=b,g=[],l=o();l!==null;)g.push(l),l=o();if(g!==null)if(l=P(),l!==null){for(var r=[],t=o();t!==null;)r.push(t),t=o();r!==null?g=[g,l,r]:(g=null,b=i)}else g=null,b=i;else g=null,b=i;if(g!==null)i=g;else{i=b;g=[];for(l=o();l!==null;)g.push(l),l=o();if(g!==null)if(a.substr(b,1)==="("?(l="(",b+=1):(l=null,m&&j('"("')),l!==null){r=[];for(t=o();t!==null;)r.push(t),t=o();if(r!==null)if(t=M(),t!==null){for(var u=[],w=o();w!==null;)u.push(w),w=o();if(u!==
null)if(a.substr(b,2)==="AS"?(w="AS",b+=2):(w=null,m&&j('"AS"')),w===null&&(a.substr(b,2)==="as"?(w="as",b+=2):(w=null,m&&j('"as"')),w=w!==null?w:null),w!==null){for(var y=[],D=o();D!==null;)y.push(D),D=o();if(y!==null)if(D=P(),D!==null){for(var A=[],R=o();R!==null;)A.push(R),R=o();if(A!==null)if(a.substr(b,1)===")"?(R=")",b+=1):(R=null,m&&j('")"')),R!==null){for(var N=[],F=o();F!==null;)N.push(F),F=o();N!==null?g=[g,l,r,t,u,w,y,D,A,R,N]:(g=null,b=i)}else g=null,b=i;else g=null,b=i}else g=null,b=
i;else g=null,b=i}else g=null,b=i;else g=null,b=i}else g=null,b=i;else g=null,b=i}else g=null,b=i;else g=null,b=i;i=g!==null?g:null}if(i!==null)for(k=[];i!==null;){k.push(i);i=b;g=[];for(l=o();l!==null;)g.push(l),l=o();if(g!==null)if(l=P(),l!==null){r=[];for(t=o();t!==null;)r.push(t),t=o();r!==null?g=[g,l,r]:(g=null,b=i)}else g=null,b=i;else g=null,b=i;if(g!==null)i=g;else{i=b;g=[];for(l=o();l!==null;)g.push(l),l=o();if(g!==null)if(a.substr(b,1)==="("?(l="(",b+=1):(l=null,m&&j('"("')),l!==null){r=
[];for(t=o();t!==null;)r.push(t),t=o();if(r!==null)if(t=M(),t!==null){u=[];for(w=o();w!==null;)u.push(w),w=o();if(u!==null)if(a.substr(b,2)==="AS"?(w="AS",b+=2):(w=null,m&&j('"AS"')),w===null&&(a.substr(b,2)==="as"?(w="as",b+=2):(w=null,m&&j('"as"')),w=w!==null?w:null),w!==null){y=[];for(D=o();D!==null;)y.push(D),D=o();if(y!==null)if(D=P(),D!==null){A=[];for(R=o();R!==null;)A.push(R),R=o();if(A!==null)if(a.substr(b,1)===")"?(R=")",b+=1):(R=null,m&&j('")"')),R!==null){N=[];for(F=o();F!==null;)N.push(F),
F=o();N!==null?g=[g,l,r,t,u,w,y,D,A,R,N]:(g=null,b=i)}else g=null,b=i;else g=null,b=i}else g=null,b=i;else g=null,b=i}else g=null,b=i;else g=null,b=i}else g=null,b=i;else g=null,b=i}else g=null,b=i;else g=null,b=i;i=g!==null?g:null}}else k=null;if(k===null){k=b;i=[];for(g=o();g!==null;)i.push(g),g=o();if(i!==null)if(a.substr(b,1)==="*"?(g="*",b+=1):(g=null,m&&j('"*"')),g!==null){l=[];for(r=o();r!==null;)l.push(r),r=o();l!==null?i=[i,g,l]:(i=null,b=k)}else i=null,b=k;else i=null,b=k;k=i!==null?i:null}k!==
null?f=[f,z,q,v,n,k]:(f=null,b=d)}else f=null,b=d}else f=null,b=d;else f=null,b=d}else f=null,b=d;else f=null,b=d;d=f!==null?function(a,b){var f=[];if(b.length===3&&b[1]==="*")return{vars:[{token:"variable",kind:"*"}],modifier:zb(a)};for(var d=0;d<b.length;d++){var c=b[d];c.length===3?f.push({token:"variable",kind:"var",value:c[1]}):f.push({token:"variable",kind:"aliased",expression:c[3],alias:c[7]})}return{vars:f,modifier:zb(a)}}(f[3],f[5]):null;d===null&&(d=null,b=H);(m=h)&&d===null&&j("[8] SelectClause");
x[e]={nextPos:b,result:d};return d}function K(){var e="ConstructQuery@"+b,h=x[e];if(h)return b=h.nextPos,h.result;h=m;m=!1;for(var H=b,d=b,f=[],z=o();z!==null;)f.push(z),z=o();if(f!==null)if(a.substr(b,9)==="CONSTRUCT"?(z="CONSTRUCT",b+=9):(z=null,m&&j('"CONSTRUCT"')),z===null&&(a.substr(b,9)==="construct"?(z="construct",b+=9):(z=null,m&&j('"construct"')),z=z!==null?z:null),z!==null){for(var q=[],v=o();v!==null;)q.push(v),v=o();if(q!==null)if(v=Ab(),v!==null){for(var n=[],k=o();k!==null;)n.push(k),
k=o();if(n!==null){for(var k=[],i=I();i!==null;)k.push(i),i=I();if(k!==null){for(var i=[],g=o();g!==null;)i.push(g),g=o();if(i!==null)if(g=$(),g!==null){for(var l=[],r=o();r!==null;)l.push(r),r=o();l!==null?(r=U(),r!==null?f=[f,z,q,v,n,k,i,g,l,r]:(f=null,b=d)):(f=null,b=d)}else f=null,b=d;else f=null,b=d}else f=null,b=d}else f=null,b=d}else f=null,b=d;else f=null,b=d}else f=null,b=d;else f=null,b=d;d=f!==null?function(a,b,f,d){for(var c={named:[],implicit:[]},j=0;j<b.length;j++){var e=b[j];e.kind===
"default"?c.implicit.push(e.graph):c.named.push(e.graph)}c.named.length===0&&c.implicit.length===0&&c.implicit.push({token:"uri",prefix:null,suffix:null,value:"https://github.com/antoniogarrote/rdfstore-js#default_graph"});b={kind:"construct",token:"executableunit"};b.dataset=c;b.template=a;b.pattern=f;if(d!=null&&d.limit!=null)b.limit=d.limit;if(d!=null&&d.offset!=null)b.offset=d.offset;if(d!=null&&d.order!=null&&d.order!="")b.order=d.order;return b}(f[3],f[5],f[7],f[9]):null;d===null&&(d=null,b=
H);(m=h)&&d===null&&j("[9] ConstructQuery");x[e]={nextPos:b,result:d};return d}function L(){var e="DescribeQuery@"+b,h=x[e];if(h)return b=h.nextPos,h.result;h=m;m=!1;var k=b;if(a.substr(b,8)==="DESCRIBE"){var d="DESCRIBE";b+=8}else d=null,m&&j('"DESCRIBE"');if(d!==null){var f=ha();if(f!==null)for(var z=[];f!==null;)z.push(f),f=ha();else z=null;z!==null?f=z:(a.substr(b,1)==="*"?(f="*",b+=1):(f=null,m&&j('"*"')),f=f!==null?f:null);if(f!==null){for(var z=[],q=I();q!==null;)z.push(q),q=I();if(z!==null)if(q=
$(),q=q!==null?q:"",q!==null){var v=U();v!==null?d=[d,f,z,q,v]:(d=null,b=k)}else d=null,b=k;else d=null,b=k}else d=null,b=k}else d=null,b=k;(m=h)&&d===null&&j("[10] DescribeQuery");x[e]={nextPos:b,result:d};return d}function J(){var e="AskQuery@"+b,h=x[e];if(h)return b=h.nextPos,h.result;h=m;m=!1;for(var k=b,d=b,f=[],z=o();z!==null;)f.push(z),z=o();if(f!==null)if(a.substr(b,3)==="ASK"?(z="ASK",b+=3):(z=null,m&&j('"ASK"')),z===null&&(a.substr(b,3)==="ask"?(z="ask",b+=3):(z=null,m&&j('"ask"')),z=z!==
null?z:null),z!==null){for(var q=[],v=o();v!==null;)q.push(v),v=o();if(q!==null){for(var v=[],n=I();n!==null;)v.push(n),n=I();if(v!==null){for(var n=[],i=o();i!==null;)n.push(i),i=o();n!==null?(i=$(),i!==null?f=[f,z,q,v,n,i]:(f=null,b=d)):(f=null,b=d)}else f=null,b=d}else f=null,b=d}else f=null,b=d;else f=null,b=d;d=f!==null?function(a,b){for(var f={named:[],implicit:[]},d=0;d<a.length;d++){var c=a[d];c.kind==="implicit"?f.implicit.push(c.graph):f.named.push(c.graph)}f.named.length===0&&f.implicit.length===
0&&f.implicit.push({token:"uri",prefix:null,suffix:null,value:"https://github.com/antoniogarrote/rdfstore-js#default_graph"});d={kind:"ask",token:"executableunit"};d.dataset=f;d.pattern=b;return d}(f[3],f[5]):null;d===null&&(d=null,b=k);(m=h)&&d===null&&j("[11] AskQuery");x[e]={nextPos:b,result:d};return d}function I(){var e="DatasetClause@"+b,h=x[e];if(h)return b=h.nextPos,h.result;h=m;m=!1;var k=b,d=b;if(a.substr(b,4)==="FROM"){var f="FROM";b+=4}else f=null,m&&j('"FROM"');f===null&&(a.substr(b,
4)==="from"?(f="from",b+=4):(f=null,m&&j('"from"')),f=f!==null?f:null);if(f!==null){for(var i=[],q=o();q!==null;)i.push(q),q=o();if(i!==null)if(q=O(),q===null&&(q=S(),q=q!==null?q:null),q!==null){for(var v=[],n=o();n!==null;)v.push(n),n=o();v!==null?f=[f,i,q,v]:(f=null,b=d)}else f=null,b=d;else f=null,b=d}else f=null,b=d;d=f!==null?f[2]:null;d===null&&(d=null,b=k);(m=h)&&d===null&&j("[12] DatasetClause");x[e]={nextPos:b,result:d};return d}function O(){var a="DefaultGraphClause@"+b,c=x[a];if(c)return b=
c.nextPos,c.result;c=m;m=!1;for(var e=b,d=b,f=[],h=o();h!==null;)f.push(h),h=o();f!==null?(h=Q(),h!==null?f=[f,h]:(f=null,b=d)):(f=null,b=d);d=f!==null?{graph:f[1],kind:"default",token:"graphClause"}:null;d===null&&(d=null,b=e);(m=c)&&d===null&&j("[13] DefaultGraphClause");x[a]={nextPos:b,result:d};return d}function S(){var e="NamedGraphClause@"+b,h=x[e];if(h)return b=h.nextPos,h.result;h=m;m=!1;var k=b,d=b;if(a.substr(b,5)==="NAMED"){var f="NAMED";b+=5}else f=null,m&&j('"NAMED"');f===null&&(a.substr(b,
5)==="named"?(f="named",b+=5):(f=null,m&&j('"named"')),f=f!==null?f:null);if(f!==null){for(var i=[],q=o();q!==null;)i.push(q),q=o();i!==null?(q=Q(),q!==null?f=[f,i,q]:(f=null,b=d)):(f=null,b=d)}else f=null,b=d;d=f!==null?{graph:f[2],kind:"named",token:"graphCluase"}:null;d===null&&(d=null,b=k);(m=h)&&d===null&&j("[14] NamedGraphClause");x[e]={nextPos:b,result:d};return d}function $(){var e="WhereClause@"+b,h=x[e];if(h)return b=h.nextPos,h.result;h=m;m=!1;var k=b,d=b;if(a.substr(b,5)==="WHERE"){var f=
"WHERE";b+=5}else f=null,m&&j('"WHERE"');f===null&&(a.substr(b,5)==="where"?(f="where",b+=5):(f=null,m&&j('"where"')),f=f!==null?f:null);f=f!==null?f:"";if(f!==null){for(var i=[],q=o();q!==null;)i.push(q),q=o();if(i!==null)if(q=V(),q!==null){for(var v=[],n=o();n!==null;)v.push(n),n=o();v!==null?f=[f,i,q,v]:(f=null,b=d)}else f=null,b=d;else f=null,b=d}else f=null,b=d;d=f!==null?f[2]:null;d===null&&(d=null,b=k);(m=h)&&d===null&&j("[16] WhereClause");x[e]={nextPos:b,result:d};return d}function U(){var a=
"SolutionModifier@"+b,c=x[a];if(c)return b=c.nextPos,c.result;c=m;m=!1;var e=b,d=b,f=Y(),f=f!==null?f:"";if(f!==null){var h=aa(),h=h!==null?h:"";if(h!==null){var q=ea(),q=q!==null?q:"";if(q!==null){var v=ra(),v=v!==null?v:"";v!==null?f=[f,h,q,v]:(f=null,b=d)}else f=null,b=d}else f=null,b=d}else f=null,b=d;d=f!==null?function(a,b,f){var d={};if(f!=null){if(f.limit!=null)d.limit=f.limit;if(f.offset!=null)d.offset=f.offset}if(a!=null)d.group=a;d.order=b;return d}(f[0],f[2],f[3]):null;d===null&&(d=null,
b=e);(m=c)&&d===null&&j("[17] SolutionModifier");x[a]={nextPos:b,result:d};return d}function Y(){var e="GroupClause@"+b,h=x[e];if(h)return b=h.nextPos,h.result;h=m;m=!1;var k=b,d=b;if(a.substr(b,5)==="GROUP"){var f="GROUP";b+=5}else f=null,m&&j('"GROUP"');f===null&&(a.substr(b,5)==="group"?(f="group",b+=5):(f=null,m&&j('"group"')),f=f!==null?f:null);if(f!==null){for(var i=[],q=o();q!==null;)i.push(q),q=o();if(i!==null)if(a.substr(b,2)==="BY"?(q="BY",b+=2):(q=null,m&&j('"BY"')),q===null&&(a.substr(b,
2)==="by"?(q="by",b+=2):(q=null,m&&j('"by"')),q=q!==null?q:null),q!==null){for(var v=[],n=o();n!==null;)v.push(n),n=o();if(v!==null){n=X();if(n!==null)for(var g=[];n!==null;)g.push(n),n=X();else g=null;g!==null?f=[f,i,q,v,g]:(f=null,b=d)}else f=null,b=d}else f=null,b=d;else f=null,b=d}else f=null,b=d;d=f!==null?f[4]:null;d===null&&(d=null,b=k);(m=h)&&d===null&&j("[18] GroupClause");x[e]={nextPos:b,result:d};return d}function X(){var e="GroupCondition@"+b,h=x[e];if(h)return b=h.nextPos,h.result;h=
m;m=!1;for(var k=b,d=b,f=[],i=o();i!==null;)f.push(i),i=o();if(f!==null)if(i=Ba(),i!==null){for(var q=[],v=o();v!==null;)q.push(v),v=o();q!==null?f=[f,i,q]:(f=null,b=d)}else f=null,b=d;else f=null,b=d;d=f!==null?f[1]:null;d===null&&(d=null,b=k);if(d!==null)k=d;else{d=k=b;f=[];for(i=o();i!==null;)f.push(i),i=o();if(f!==null)if(i=Za(),i!==null){q=[];for(v=o();v!==null;)q.push(v),v=o();q!==null?f=[f,i,q]:(f=null,b=d)}else f=null,b=d;else f=null,b=d;d=f!==null?f[1]:null;d===null&&(d=null,b=k);if(d!==
null)k=d;else{d=k=b;f=[];for(i=o();i!==null;)f.push(i),i=o();if(f!==null)if(a.substr(b,1)==="("?(i="(",b+=1):(i=null,m&&j('"("')),i!==null){q=[];for(v=o();v!==null;)q.push(v),v=o();if(q!==null)if(v=M(),v!==null){for(var n=[],g=o();g!==null;)n.push(g),g=o();if(n!==null){g=b;if(a.substr(b,2)==="AS"){var s="AS";b+=2}else s=null,m&&j('"AS"');s===null&&(a.substr(b,2)==="as"?(s="as",b+=2):(s=null,m&&j('"as"')),s=s!==null?s:null);if(s!==null){for(var l=[],r=o();r!==null;)l.push(r),r=o();l!==null?(r=P(),
r!==null?s=[s,l,r]:(s=null,b=g)):(s=null,b=g)}else s=null,b=g;g=s!==null?s:"";if(g!==null){s=[];for(l=o();l!==null;)s.push(l),l=o();if(s!==null)if(a.substr(b,1)===")"?(l=")",b+=1):(l=null,m&&j('")"')),l!==null){for(var r=[],t=o();t!==null;)r.push(t),t=o();r!==null?f=[f,i,q,v,n,g,s,l,r]:(f=null,b=d)}else f=null,b=d;else f=null,b=d}else f=null,b=d}else f=null,b=d}else f=null,b=d;else f=null,b=d}else f=null,b=d;else f=null,b=d;d=f!==null?f[5].length!=0?{token:"aliased_expression",expression:f[3],alias:f[5][2]}:
f[3]:null;d===null&&(d=null,b=k);if(d!==null)k=d;else{d=k=b;f=[];for(i=o();i!==null;)f.push(i),i=o();if(f!==null)if(i=P(),i!==null){q=[];for(v=o();v!==null;)q.push(v),v=o();q!==null?f=[f,i,q]:(f=null,b=d)}else f=null,b=d;else f=null,b=d;d=f!==null?f[1]:null;d===null&&(d=null,b=k);k=d!==null?d:null}}}(m=h)&&k===null&&j("[19] GroupCondition");x[e]={nextPos:b,result:k};return k}function aa(){var e="HavingClause@"+b,h=x[e];if(h)return b=h.nextPos,h.result;h=m;m=!1;var i=b;if(a.substr(b,6)==="HAVING"){var d=
"HAVING";b+=6}else d=null,m&&j('"HAVING"');if(d!==null){var f=va();if(f!==null)for(var k=[];f!==null;)k.push(f),f=va();else k=null;k!==null?d=[d,k]:(d=null,b=i)}else d=null,b=i;(m=h)&&d===null&&j("[20] HavingClause");x[e]={nextPos:b,result:d};return d}function ea(){var e="OrderClause@"+b,h=x[e];if(h)return b=h.nextPos,h.result;h=m;m=!1;var i=b,d=b;if(a.substr(b,5)==="ORDER"){var f="ORDER";b+=5}else f=null,m&&j('"ORDER"');f===null&&(a.substr(b,5)==="order"?(f="order",b+=5):(f=null,m&&j('"order"')),
f=f!==null?f:null);if(f!==null){for(var k=[],q=o();q!==null;)k.push(q),q=o();if(k!==null)if(a.substr(b,2)==="BY"?(q="BY",b+=2):(q=null,m&&j('"BY"')),q===null&&(a.substr(b,2)==="by"?(q="by",b+=2):(q=null,m&&j('"by"')),q=q!==null?q:null),q!==null){for(var v=[],n=o();n!==null;)v.push(n),n=o();if(v!==null){var g=ga();if(g!==null)for(n=[];g!==null;)n.push(g),g=ga();else n=null;if(n!==null){for(var g=[],s=o();s!==null;)g.push(s),s=o();g!==null?f=[f,k,q,v,n,g]:(f=null,b=d)}else f=null,b=d}else f=null,b=
d}else f=null,b=d;else f=null,b=d}else f=null,b=d;d=f!==null?f[4]:null;d===null&&(d=null,b=i);(m=h)&&d===null&&j("[22] OrderClause");x[e]={nextPos:b,result:d};return d}function ga(){var e="OrderCondition@"+b,h=x[e];if(h)return b=h.nextPos,h.result;h=m;m=!1;var i=b,d=b;if(a.substr(b,3)==="ASC"){var f="ASC";b+=3}else f=null,m&&j('"ASC"');f===null&&(a.substr(b,3)==="asc"?(f="asc",b+=3):(f=null,m&&j('"asc"')),f===null&&(a.substr(b,4)==="DESC"?(f="DESC",b+=4):(f=null,m&&j('"DESC"')),f===null&&(a.substr(b,
4)==="desc"?(f="desc",b+=4):(f=null,m&&j('"desc"')),f=f!==null?f:null)));if(f!==null){for(var k=[],q=o();q!==null;)k.push(q),q=o();if(k!==null)if(q=Ca(),q!==null){for(var v=[],n=o();n!==null;)v.push(n),n=o();v!==null?f=[f,k,q,v]:(f=null,b=d)}else f=null,b=d;else f=null,b=d}else f=null,b=d;d=f!==null?{direction:f[0].toUpperCase(),expression:f[2]}:null;d===null&&(d=null,b=i);if(d!==null)i=d;else{d=i=b;f=va();f===null&&(f=P(),f=f!==null?f:null);if(f!==null){k=[];for(q=o();q!==null;)k.push(q),q=o();k!==
null?f=[f,k]:(f=null,b=d)}else f=null,b=d;d=f!==null?function(a){a.token==="var"&&(a={token:"expression",expressionType:"atomic",primaryexpression:"var",value:a});return{direction:"ASC",expression:a}}(f[0]):null;d===null&&(d=null,b=i);i=d!==null?d:null}(m=h)&&i===null&&j("[23] OrderCondition");x[e]={nextPos:b,result:i};return i}function ra(){var a="LimitOffsetClauses@"+b,c=x[a];if(c)return b=c.nextPos,c.result;c=m;m=!1;var e=b,d=b,f=Sa();if(f!==null){var h=Ta(),h=h!==null?h:"";h!==null?f=[f,h]:(f=
null,b=d)}else f=null,b=d;f!==null?d=f:(d=b,f=Ta(),f!==null?(h=Sa(),h=h!==null?h:"",h!==null?f=[f,h]:(f=null,b=d)):(f=null,b=d),d=f!==null?f:null);d=d!==null?function(a){for(var b={},f=0;f<a.length;f++){var d=a[f];if(d.limit!=null)b.limit=d.limit;else if(d.offset!=null)b.offset=d.offset}return b}(d):null;d===null&&(d=null,b=e);(m=c)&&d===null&&j("[24] LimitOffsetClauses");x[a]={nextPos:b,result:d};return d}function Sa(){var e="LimitClause@"+b,h=x[e];if(h)return b=h.nextPos,h.result;h=m;m=!1;var i=
b,d=b;if(a.substr(b,5)==="LIMIT"){var f="LIMIT";b+=5}else f=null,m&&j('"LIMIT"');f===null&&(a.substr(b,5)==="limit"?(f="limit",b+=5):(f=null,m&&j('"limit"')),f=f!==null?f:null);if(f!==null){for(var k=[],q=o();q!==null;)k.push(q),q=o();if(k!==null)if(q=ba(),q!==null){for(var v=[],n=o();n!==null;)v.push(n),n=o();v!==null?f=[f,k,q,v]:(f=null,b=d)}else f=null,b=d;else f=null,b=d}else f=null,b=d;d=f!==null?{limit:parseInt(f[2].value)}:null;d===null&&(d=null,b=i);(m=h)&&d===null&&j("[25] LimitClause");
x[e]={nextPos:b,result:d};return d}function Ta(){var e="OffsetClause@"+b,h=x[e];if(h)return b=h.nextPos,h.result;h=m;m=!1;var i=b,d=b;if(a.substr(b,6)==="OFFSET"){var f="OFFSET";b+=6}else f=null,m&&j('"OFFSET"');f===null&&(a.substr(b,6)==="offset"?(f="offset",b+=6):(f=null,m&&j('"offset"')),f=f!==null?f:null);if(f!==null){for(var k=[],q=o();q!==null;)k.push(q),q=o();if(k!==null)if(q=ba(),q!==null){for(var v=[],n=o();n!==null;)v.push(n),n=o();v!==null?f=[f,k,q,v]:(f=null,b=d)}else f=null,b=d;else f=
null,b=d}else f=null,b=d;d=f!==null?{offset:parseInt(f[2].value)}:null;d===null&&(d=null,b=i);(m=h)&&d===null&&j("[26] OffsetClause");x[e]={nextPos:b,result:d};return d}function ta(){var e="BindingsClause@"+b,h=x[e];if(h)return b=h.nextPos,h.result;h=m;m=!1;var i=b;if(a.substr(b,8)==="BINDINGS"){var d="BINDINGS";b+=8}else d=null,m&&j('"BINDINGS"');if(d!==null){for(var f=[],k=P();k!==null;)f.push(k),k=P();if(f!==null)if(a.substr(b,1)==="{"?(k="{",b+=1):(k=null,m&&j('"{"')),k!==null){var q=[],v=b;if(a.substr(b,
1)==="("){var n="(";b+=1}else n=null,m&&j('"("');if(n!==null){var g=sa();if(g!==null)for(var o=[];g!==null;)o.push(g),g=sa();else o=null;o!==null?(a.substr(b,1)===")"?(g=")",b+=1):(g=null,m&&j('")"')),g!==null?n=[n,o,g]:(n=null,b=v)):(n=null,b=v)}else n=null,b=v;n!==null?v=n:(v=ia(),v=v!==null?v:null);for(;v!==null;){q.push(v);v=b;a.substr(b,1)==="("?(n="(",b+=1):(n=null,m&&j('"("'));if(n!==null){g=sa();if(g!==null)for(o=[];g!==null;)o.push(g),g=sa();else o=null;o!==null?(a.substr(b,1)===")"?(g=")",
b+=1):(g=null,m&&j('")"')),g!==null?n=[n,o,g]:(n=null,b=v)):(n=null,b=v)}else n=null,b=v;n!==null?v=n:(v=ia(),v=v!==null?v:null)}q!==null?(a.substr(b,1)==="}"?(v="}",b+=1):(v=null,m&&j('"}"')),v!==null?d=[d,f,k,q,v]:(d=null,b=i)):(d=null,b=i)}else d=null,b=i;else d=null,b=i}else d=null,b=i;i=d!==null?d:"";(m=h)&&i===null&&j("[27] BindingsClause");x[e]={nextPos:b,result:i};return i}function sa(){var e="BindingValue@"+b,h=x[e];if(h)return b=h.nextPos,h.result;h=m;m=!1;var i=Q();i===null&&(i=Da(),i===
null&&(i=Ea(),i===null&&(i=Fa(),i===null&&(a.substr(b,5)==="UNDEF"?(i="UNDEF",b+=5):(i=null,m&&j('"UNDEF"')),i=i!==null?i:null))));(m=h)&&i===null&&j("[28] BindingValue");x[e]={nextPos:b,result:i};return i}function Ua(){var e="Update@"+b,h=x[e];if(h)return b=h.nextPos,h.result;h=m;m=!1;var i=b,d=b,f=r();if(f!==null){for(var k=[],q=o();q!==null;)k.push(q),q=o();if(k!==null)if(q=pb(),q!==null){for(var v=b,n=[],g=o();g!==null;)n.push(g),g=o();if(n!==null)if(a.substr(b,1)===";"?(g=";",b+=1):(g=null,m&&
j('";"')),g!==null){for(var s=[],l=o();l!==null;)s.push(l),l=o();s!==null?(l=Ua(),l=l!==null?l:"",l!==null?n=[n,g,s,l]:(n=null,b=v)):(n=null,b=v)}else n=null,b=v;else n=null,b=v;v=n!==null?n:"";v!==null?f=[f,k,q,v]:(f=null,b=d)}else f=null,b=d;else f=null,b=d}else f=null,b=d;d=f!==null?function(a,b,f){var d={token:"query",kind:"update"};d.prologue=a;a=[b];f.length!=null&&f[3]!=null&&f[3].units!=null&&(a=a.concat(f[3].units));d.units=a;return d}(f[0],f[2],f[3]):null;d===null&&(d=null,b=i);(m=h)&&d===
null&&j("[30] Update");x[e]={nextPos:b,result:d};return d}function pb(){var a="Update1@"+b,c=x[a];if(c)return b=c.nextPos,c.result;c=m;m=!1;var e=qb();e===null&&(e=tb(),e===null&&(e=ub(),e===null&&(e=vb(),e===null&&(e=wb(),e===null&&(e=xb(),e===null&&(e=rb(),e===null&&(e=sb(),e=e!==null?e:null)))))));(m=c)&&e===null&&j("[31] Update1");x[a]={nextPos:b,result:e};return e}function qb(){var e="Load@"+b,h=x[e];if(h)return b=h.nextPos,h.result;h=m;m=!1;var i=b,d=b;if(a.substr(b,4)==="LOAD"){var f="LOAD";
b+=4}else f=null,m&&j('"LOAD"');f===null&&(a.substr(b,4)==="load"?(f="load",b+=4):(f=null,m&&j('"load"')),f=f!==null?f:null);if(f!==null){for(var k=[],q=o();q!==null;)k.push(q),q=o();if(k!==null)if(q=Q(),q!==null){for(var v=[],n=o();n!==null;)v.push(n),n=o();if(v!==null){n=b;if(a.substr(b,4)==="INTO"){var g="INTO";b+=4}else g=null,m&&j('"INTO"');g===null&&(a.substr(b,4)==="into"?(g="into",b+=4):(g=null,m&&j('"into"')),g=g!==null?g:null);if(g!==null){for(var s=[],l=o();l!==null;)s.push(l),l=o();s!==
null?(l=Ga(),l!==null?g=[g,s,l]:(g=null,b=n)):(g=null,b=n)}else g=null,b=n;n=g!==null?g:"";n!==null?f=[f,k,q,v,n]:(f=null,b=d)}else f=null,b=d}else f=null,b=d;else f=null,b=d}else f=null,b=d;d=f!==null?function(a,b){var f={kind:"load",token:"executableunit"};f.sourceGraph=a;f.destinyGraph=b[2];return f}(f[2],f[4]):null;d===null&&(d=null,b=i);(m=h)&&d===null&&j("[32] Load");x[e]={nextPos:b,result:d};return d}function tb(){var e="Clear@"+b,h=x[e];if(h)return b=h.nextPos,h.result;h=m;m=!1;var i=b,d=
b;if(a.substr(b,5)==="CLEAR"){var f="CLEAR";b+=5}else f=null,m&&j('"CLEAR"');f===null&&(a.substr(b,5)==="clear"?(f="clear",b+=5):(f=null,m&&j('"clear"')),f=f!==null?f:null);if(f!==null){for(var k=[],q=o();q!==null;)k.push(q),q=o();if(k!==null)if(a.substr(b,6)==="SILENT"?(q="SILENT",b+=6):(q=null,m&&j('"SILENT"')),q===null&&(a.substr(b,6)==="silent"?(q="silent",b+=6):(q=null,m&&j('"silent"')),q=q!==null?q:null),q=q!==null?q:"",q!==null){for(var v=[],n=o();n!==null;)v.push(n),n=o();v!==null?(n=$a(),
n!==null?f=[f,k,q,v,n]:(f=null,b=d)):(f=null,b=d)}else f=null,b=d;else f=null,b=d}else f=null,b=d;d=f!==null?function(a){var b={kind:"clear",token:"executableunit"};b.destinyGraph=a;return b}(f[4]):null;d===null&&(d=null,b=i);(m=h)&&d===null&&j("[33] Clear");x[e]={nextPos:b,result:d};return d}function ub(){var e="Drop@"+b,h=x[e];if(h)return b=h.nextPos,h.result;h=m;m=!1;var i=b,d=b;if(a.substr(b,4)==="DROP"){var f="DROP";b+=4}else f=null,m&&j('"DROP"');f===null&&(a.substr(b,4)==="drop"?(f="drop",
b+=4):(f=null,m&&j('"drop"')),f=f!==null?f:null);if(f!==null){for(var k=[],q=o();q!==null;)k.push(q),q=o();if(k!==null)if(a.substr(b,6)==="SILENT"?(q="SILENT",b+=6):(q=null,m&&j('"SILENT"')),q===null&&(a.substr(b,6)==="silent"?(q="silent",b+=6):(q=null,m&&j('"silent"')),q=q!==null?q:null),q=q!==null?q:"",q!==null){for(var v=[],n=o();n!==null;)v.push(n),n=o();v!==null?(n=$a(),n!==null?f=[f,k,q,v,n]:(f=null,b=d)):(f=null,b=d)}else f=null,b=d;else f=null,b=d}else f=null,b=d;d=f!==null?function(a){var b=
{kind:"drop",token:"executableunit"};b.destinyGraph=a;return b}(f[4]):null;d===null&&(d=null,b=i);(m=h)&&d===null&&j("[34] Drop");x[e]={nextPos:b,result:d};return d}function vb(){var e="Create@"+b,h=x[e];if(h)return b=h.nextPos,h.result;h=m;m=!1;var i=b,d=b;if(a.substr(b,6)==="CREATE"){var f="CREATE";b+=6}else f=null,m&&j('"CREATE"');f===null&&(a.substr(b,6)==="create"?(f="create",b+=6):(f=null,m&&j('"create"')),f=f!==null?f:null);if(f!==null){for(var k=[],q=o();q!==null;)k.push(q),q=o();if(k!==null)if(a.substr(b,
6)==="SILENT"?(q="SILENT",b+=6):(q=null,m&&j('"SILENT"')),q===null&&(a.substr(b,6)==="silent"?(q="silent",b+=6):(q=null,m&&j('"silent"')),q=q!==null?q:null),q=q!==null?q:"",q!==null){for(var v=[],n=o();n!==null;)v.push(n),n=o();v!==null?(n=Ga(),n!==null?f=[f,k,q,v,n]:(f=null,b=d)):(f=null,b=d)}else f=null,b=d;else f=null,b=d}else f=null,b=d;d=f!==null?function(a){var b={kind:"create",token:"executableunit"};b.destinyGraph=a;return b}(f[4]):null;d===null&&(d=null,b=i);(m=h)&&d===null&&j("[35] Create");
x[e]={nextPos:b,result:d};return d}function wb(){var e="InsertData@"+b,h=x[e];if(h)return b=h.nextPos,h.result;h=m;m=!1;var i=b,d=b;if(a.substr(b,6)==="INSERT"){var f="INSERT";b+=6}else f=null,m&&j('"INSERT"');f===null&&(a.substr(b,6)==="insert"?(f="insert",b+=6):(f=null,m&&j('"insert"')),f=f!==null?f:null);if(f!==null){for(var k=[],q=o();q!==null;)k.push(q),q=o();if(k!==null)if(a.substr(b,4)==="DATA"?(q="DATA",b+=4):(q=null,m&&j('"DATA"')),q===null&&(a.substr(b,4)==="data"?(q="data",b+=4):(q=null,
m&&j('"data"')),q=q!==null?q:null),q!==null){for(var v=[],n=o();n!==null;)v.push(n),n=o();v!==null?(n=ab(),n!==null?f=[f,k,q,v,n]:(f=null,b=d)):(f=null,b=d)}else f=null,b=d;else f=null,b=d}else f=null,b=d;d=f!==null?function(a){var b={kind:"insertdata",token:"executableunit"};b.quads=a;return b}(f[4]):null;d===null&&(d=null,b=i);(m=h)&&d===null&&j("[36] InsertData");x[e]={nextPos:b,result:d};return d}function xb(){var e="DeleteData@"+b,h=x[e];if(h)return b=h.nextPos,h.result;h=m;m=!1;var i=b,d=b;
if(a.substr(b,6)==="DELETE"){var f="DELETE";b+=6}else f=null,m&&j('"DELETE"');f===null&&(a.substr(b,6)==="delete"?(f="delete",b+=6):(f=null,m&&j('"delete"')),f=f!==null?f:null);if(f!==null){for(var k=[],q=o();q!==null;)k.push(q),q=o();if(k!==null)if(a.substr(b,4)==="DATA"?(q="DATA",b+=4):(q=null,m&&j('"DATA"')),q===null&&(a.substr(b,4)==="data"?(q="data",b+=4):(q=null,m&&j('"data"')),q=q!==null?q:null),q!==null){var v=ab();v!==null?f=[f,k,q,v]:(f=null,b=d)}else f=null,b=d;else f=null,b=d}else f=null,
b=d;d=f!==null?function(a){var b={kind:"deletedata",token:"executableunit"};b.quads=a;return b}(f[3]):null;d===null&&(d=null,b=i);(m=h)&&d===null&&j("[37] DeleteData");x[e]={nextPos:b,result:d};return d}function rb(){var e="DeleteWhere@"+b,h=x[e];if(h)return b=h.nextPos,h.result;h=m;m=!1;var i=b,d=b;if(a.substr(b,6)==="DELETE"){var f="DELETE";b+=6}else f=null,m&&j('"DELETE"');f===null&&(a.substr(b,6)==="delete"?(f="delete",b+=6):(f=null,m&&j('"delete"')),f=f!==null?f:null);if(f!==null){for(var k=
[],q=o();q!==null;)k.push(q),q=o();if(k!==null)if(a.substr(b,5)==="WHERE"?(q="WHERE",b+=5):(q=null,m&&j('"WHERE"')),q===null&&(a.substr(b,5)==="where"?(q="where",b+=5):(q=null,m&&j('"where"')),q=q!==null?q:null),q!==null){for(var v=[],n=o();n!==null;)v.push(n),n=o();v!==null?(n=V(),n!==null?f=[f,k,q,v,n]:(f=null,b=d)):(f=null,b=d)}else f=null,b=d;else f=null,b=d}else f=null,b=d;d=f!==null?function(a){var b={kind:"modify"};b.pattern=a;b["with"]=null;b.using=null;for(var f=[],a=a.patterns[0],a=a.triplesContext==
null&&a.patterns!=null?a.patterns[0].triplesContext:a.triplesContext,d=0;d<a.length;d++){var c={},j=a[d];c.subject=j.subject;c.predicate=j.predicate;c.object=j.object;c.graph=j.graph;f.push(c)}b["delete"]=f;return b}(f[4]):null;d===null&&(d=null,b=i);(m=h)&&d===null&&j("[38] DeleteWhere");x[e]={nextPos:b,result:d};return d}function sb(){var e="Modify@"+b,h=x[e];if(h)return b=h.nextPos,h.result;h=m;m=!1;var i=b,d=b,f=b;if(a.substr(b,4)==="WITH"){var k="WITH";b+=4}else k=null,m&&j('"WITH"');k===null&&
(a.substr(b,4)==="with"?(k="with",b+=4):(k=null,m&&j('"with"')),k=k!==null?k:null);if(k!==null){for(var q=[],v=o();v!==null;)q.push(v),v=o();q!==null?(v=Q(),v!==null?k=[k,q,v]:(k=null,b=f)):(k=null,b=f)}else k=null,b=f;f=k!==null?k:"";if(f!==null){k=[];for(q=o();q!==null;)k.push(q),q=o();if(k!==null){q=b;v=yb();if(v!==null){for(var n=[],g=o();g!==null;)n.push(g),g=o();n!==null?(g=Wa(),g=g!==null?g:"",g!==null?v=[v,n,g]:(v=null,b=q)):(v=null,b=q)}else v=null,b=q;v!==null?q=v:(q=Wa(),q=q!==null?q:null);
if(q!==null){v=[];for(n=o();n!==null;)v.push(n),n=o();if(v!==null){n=[];for(g=bb();g!==null;)n.push(g),g=bb();if(n!==null){for(var g=[],s=o();s!==null;)g.push(s),s=o();if(g!==null)if(a.substr(b,5)==="WHERE"?(s="WHERE",b+=5):(s=null,m&&j('"WHERE"')),s===null&&(a.substr(b,5)==="where"?(s="where",b+=5):(s=null,m&&j('"where"')),s=s!==null?s:null),s!==null){for(var l=[],r=o();r!==null;)l.push(r),r=o();if(l!==null)if(r=V(),r!==null){for(var t=[],u=o();u!==null;)t.push(u),u=o();t!==null?f=[f,k,q,v,n,g,s,
l,r,t]:(f=null,b=d)}else f=null,b=d;else f=null,b=d}else f=null,b=d;else f=null,b=d}else f=null,b=d}else f=null,b=d}else f=null,b=d}else f=null,b=d}else f=null,b=d;d=f!==null?function(a,b,f,d){var c={kind:"modify"};c["with"]=a!=""?a[2]:null;b.length===3&&b[2]===""?(c["delete"]=b[0],c.insert=null):b.length===3&&b[0].length!=null&&b[1].length!=null&&b[2].length!=null?(c["delete"]=b[0],c.insert=b[2]):(c.insert=b,c["delete"]=null);f!=""&&(c.using=f);c.pattern=d;return c}(f[0],f[2],f[4],f[8]):null;d===
null&&(d=null,b=i);(m=h)&&d===null&&j("[39] Modify");x[e]={nextPos:b,result:d};return d}function yb(){var e="DeleteClause@"+b,h=x[e];if(h)return b=h.nextPos,h.result;h=m;m=!1;var k=b,d=b;if(a.substr(b,6)==="DELETE"){var f="DELETE";b+=6}else f=null,m&&j('"DELETE"');f===null&&(a.substr(b,6)==="delete"?(f="delete",b+=6):(f=null,m&&j('"delete"')),f=f!==null?f:null);if(f!==null){var i=cb();i!==null?f=[f,i]:(f=null,b=d)}else f=null,b=d;d=f!==null?f[1]:null;d===null&&(d=null,b=k);(m=h)&&d===null&&j("[40] DeleteClause");
x[e]={nextPos:b,result:d};return d}function Wa(){var e="InsertClause@"+b,h=x[e];if(h)return b=h.nextPos,h.result;h=m;m=!1;var k=b,d=b;if(a.substr(b,6)==="INSERT"){var f="INSERT";b+=6}else f=null,m&&j('"INSERT"');f===null&&(a.substr(b,6)==="insert"?(f="insert",b+=6):(f=null,m&&j('"insert"')),f=f!==null?f:null);if(f!==null){var i=cb();i!==null?f=[f,i]:(f=null,b=d)}else f=null,b=d;d=f!==null?f[1]:null;d===null&&(d=null,b=k);(m=h)&&d===null&&j("[41] InsertClause");x[e]={nextPos:b,result:d};return d}function bb(){var e=
"UsingClause@"+b,h=x[e];if(h)return b=h.nextPos,h.result;h=m;m=!1;for(var k=b,d=b,f=[],i=o();i!==null;)f.push(i),i=o();if(f!==null)if(a.substr(b,5)==="USING"?(i="USING",b+=5):(i=null,m&&j('"USING"')),i===null&&(a.substr(b,5)==="using"?(i="using",b+=5):(i=null,m&&j('"using"')),i=i!==null?i:null),i!==null){for(var q=[],v=o();v!==null;)q.push(v),v=o();if(q!==null){v=Q();if(v===null){v=b;if(a.substr(b,5)==="NAMED"){var n="NAMED";b+=5}else n=null,m&&j('"NAMED"');n===null&&(a.substr(b,5)==="named"?(n="named",
b+=5):(n=null,m&&j('"named"')),n=n!==null?n:null);if(n!==null){for(var g=[],s=o();s!==null;)g.push(s),s=o();g!==null?(s=Q(),s!==null?n=[n,g,s]:(n=null,b=v)):(n=null,b=v)}else n=null,b=v;v=n!==null?n:null}v!==null?f=[f,i,q,v]:(f=null,b=d)}else f=null,b=d}else f=null,b=d;else f=null,b=d;d=f!==null?f[3].length!=null?{kind:"named",uri:f[3][2]}:{kind:"default",uri:f[3]}:null;d===null&&(d=null,b=k);(m=h)&&d===null&&j("[42] UsingClause");x[e]={nextPos:b,result:d};return d}function Ga(){var e="GraphRef@"+
b,h=x[e];if(h)return b=h.nextPos,h.result;h=m;m=!1;var i=b,d=b;if(a.substr(b,5)==="GRAPH"){var f="GRAPH";b+=5}else f=null,m&&j('"GRAPH"');f===null&&(a.substr(b,5)==="graph"?(f="graph",b+=5):(f=null,m&&j('"graph"')),f=f!==null?f:null);if(f!==null){for(var k=[],q=o();q!==null;)k.push(q),q=o();k!==null?(q=Q(),q!==null?f=[f,k,q]:(f=null,b=d)):(f=null,b=d)}else f=null,b=d;d=f!==null?f[2]:null;d===null&&(d=null,b=i);(m=h)&&d===null&&j("[43] GraphRef");x[e]={nextPos:b,result:d};return d}function $a(){var e=
"GraphRefAll@"+b,h=x[e];if(h)return b=h.nextPos,h.result;h=m;m=!1;var k=b,d=Ga(),d=d!==null?d:null;d===null&&(d=null,b=k);d!==null?k=d:(k=b,a.substr(b,7)==="DEFAULT"?(d="DEFAULT",b+=7):(d=null,m&&j('"DEFAULT"')),d===null&&(a.substr(b,7)==="default"?(d="default",b+=7):(d=null,m&&j('"default"')),d=d!==null?d:null),d=d!==null?"default":null,d===null&&(d=null,b=k),d!==null?k=d:(k=b,a.substr(b,5)==="NAMED"?(d="NAMED",b+=5):(d=null,m&&j('"NAMED"')),d===null&&(a.substr(b,5)==="named"?(d="named",b+=5):(d=
null,m&&j('"named"')),d=d!==null?d:null),d=d!==null?"named":null,d===null&&(d=null,b=k),d!==null?k=d:(k=b,a.substr(b,3)==="ALL"?(d="ALL",b+=3):(d=null,m&&j('"ALL"')),d===null&&(a.substr(b,3)==="all"?(d="all",b+=3):(d=null,m&&j('"all"')),d=d!==null?d:null),d=d!==null?"all":null,d===null&&(d=null,b=k),k=d!==null?d:null)));(m=h)&&k===null&&j("[44] GraphRefAll");x[e]={nextPos:b,result:k};return k}function cb(){var e="QuadPattern@"+b,h=x[e];if(h)return b=h.nextPos,h.result;h=m;m=!1;for(var k=b,d=b,f=[],
i=o();i!==null;)f.push(i),i=o();if(f!==null)if(a.substr(b,1)==="{"?(i="{",b+=1):(i=null,m&&j('"{"')),i!==null){for(var q=[],v=o();v!==null;)q.push(v),v=o();if(q!==null)if(v=db(),v!==null){for(var n=[],g=o();g!==null;)n.push(g),g=o();if(n!==null)if(a.substr(b,1)==="}"?(g="}",b+=1):(g=null,m&&j('"}"')),g!==null){for(var s=[],l=o();l!==null;)s.push(l),l=o();s!==null?f=[f,i,q,v,n,g,s]:(f=null,b=d)}else f=null,b=d;else f=null,b=d}else f=null,b=d;else f=null,b=d}else f=null,b=d;else f=null,b=d;d=f!==null?
f[3].quadsContext:null;d===null&&(d=null,b=k);(m=h)&&d===null&&j("[45] QuadPattern");x[e]={nextPos:b,result:d};return d}function ab(){var e="QuadData@"+b,h=x[e];if(h)return b=h.nextPos,h.result;h=m;m=!1;for(var k=b,d=b,f=[],i=o();i!==null;)f.push(i),i=o();if(f!==null)if(a.substr(b,1)==="{"?(i="{",b+=1):(i=null,m&&j('"{"')),i!==null){for(var q=[],v=o();v!==null;)q.push(v),v=o();if(q!==null)if(v=db(),v!==null){for(var n=[],g=o();g!==null;)n.push(g),g=o();if(n!==null)if(a.substr(b,1)==="}"?(g="}",b+=
1):(g=null,m&&j('"}"')),g!==null){for(var s=[],l=o();l!==null;)s.push(l),l=o();s!==null?f=[f,i,q,v,n,g,s]:(f=null,b=d)}else f=null,b=d;else f=null,b=d}else f=null,b=d;else f=null,b=d}else f=null,b=d;else f=null,b=d;d=f!==null?f[3].quadsContext:null;d===null&&(d=null,b=k);(m=h)&&d===null&&j("[46] QuadData");x[e]={nextPos:b,result:d};return d}function db(){var e="Quads@"+b,h=x[e];if(h)return b=h.nextPos,h.result;h=m;m=!1;var k=b,d=b,f=ma(),f=f!==null?f:"";if(f!==null){var i=[],q=b,v=eb();if(v!==null){if(a.substr(b,
1)==="."){var n=".";b+=1}else n=null,m&&j('"."');n=n!==null?n:"";if(n!==null){var g=ma(),g=g!==null?g:"";g!==null?v=[v,n,g]:(v=null,b=q)}else v=null,b=q}else v=null,b=q;for(;v!==null;)i.push(v),q=b,v=eb(),v!==null?(a.substr(b,1)==="."?(n=".",b+=1):(n=null,m&&j('"."')),n=n!==null?n:"",n!==null?(g=ma(),g=g!==null?g:"",g!==null?v=[v,n,g]:(v=null,b=q)):(v=null,b=q)):(v=null,b=q);i!==null?f=[f,i]:(f=null,b=d)}else f=null,b=d;d=f!==null?function(a,b){var f=[];if(a.triplesContext!=null&&a.triplesContext!=
null)for(var d=0;d<a.triplesContext.length;d++){var c=a.triplesContext[d];c.graph=null;f.push(c)}if(b&&b.length>0&&b[0].length>0&&(f=f.concat(b[0][0].quadsContext),b[0][2]!=null&&b[0][2].triplesContext!=null))for(d=0;d<b[0][2].triplesContext.length;d++)c=b[0][2].triplesContext[d],c.graph=null,f.push(c);return{token:"quads",quadsContext:f}}(f[0],f[1]):null;d===null&&(d=null,b=k);(m=h)&&d===null&&j("[47] Quads");x[e]={nextPos:b,result:d};return d}function eb(){var e="QuadsNotTriples@"+b,h=x[e];if(h)return b=
h.nextPos,h.result;h=m;m=!1;for(var k=b,d=b,f=[],i=o();i!==null;)f.push(i),i=o();if(f!==null)if(a.substr(b,5)==="GRAPH"?(i="GRAPH",b+=5):(i=null,m&&j('"GRAPH"')),i===null&&(a.substr(b,5)==="graph"?(i="graph",b+=5):(i=null,m&&j('"graph"')),i=i!==null?i:null),i!==null){for(var q=[],v=o();v!==null;)q.push(v),v=o();if(q!==null)if(v=ha(),v!==null){for(var n=[],g=o();g!==null;)n.push(g),g=o();if(n!==null)if(a.substr(b,1)==="{"?(g="{",b+=1):(g=null,m&&j('"{"')),g!==null){for(var s=[],l=o();l!==null;)s.push(l),
l=o();if(s!==null)if(l=ma(),l=l!==null?l:"",l!==null){for(var r=[],t=o();t!==null;)r.push(t),t=o();if(r!==null)if(a.substr(b,1)==="}"?(t="}",b+=1):(t=null,m&&j('"}"')),t!==null){for(var u=[],w=o();w!==null;)u.push(w),w=o();u!==null?f=[f,i,q,v,n,g,s,l,r,t,u]:(f=null,b=d)}else f=null,b=d;else f=null,b=d}else f=null,b=d;else f=null,b=d}else f=null,b=d;else f=null,b=d}else f=null,b=d;else f=null,b=d}else f=null,b=d;else f=null,b=d;d=f!==null?function(a,b){for(var f=[],d=0;d<b.triplesContext.length;d++){var c=
b.triplesContext[d];c.graph=a;f.push(c)}return{token:"quadsnottriples",quadsContext:f}}(f[3],f[7]):null;d===null&&(d=null,b=k);(m=h)&&d===null&&j("[48] QuadsNotTriples");x[e]={nextPos:b,result:d};return d}function ma(){var e="TriplesTemplate@"+b,h=x[e];if(h)return b=h.nextPos,h.result;h=m;m=!1;var i=b,d=b,f=fb();if(f!==null){for(var k=b,q=[],v=o();v!==null;)q.push(v),v=o();if(q!==null)if(a.substr(b,1)==="."?(v=".",b+=1):(v=null,m&&j('"."')),v!==null){for(var n=[],g=o();g!==null;)n.push(g),g=o();n!==
null?(g=ma(),g=g!==null?g:"",g!==null?q=[q,v,n,g]:(q=null,b=k)):(q=null,b=k)}else q=null,b=k;else q=null,b=k;k=q!==null?q:"";k!==null?f=[f,k]:(f=null,b=d)}else f=null,b=d;d=f!==null?function(a,b){var f=a.triplesContext;typeof b==="object"&&b.length!=null&&b[3].triplesContext!=null&&(f=f.concat(b[3].triplesContext));return{token:"triplestemplate",triplesContext:f}}(f[0],f[1]):null;d===null&&(d=null,b=i);(m=h)&&d===null&&j("[49] TriplesTemplate");x[e]={nextPos:b,result:d};return d}function V(){var e=
"GroupGraphPattern@"+b,h=x[e];if(h)return b=h.nextPos,h.result;h=m;m=!1;var i=b,d=b;if(a.substr(b,1)==="{"){var f="{";b+=1}else f=null,m&&j('"{"');if(f!==null){for(var k=[],q=o();q!==null;)k.push(q),q=o();if(k!==null)if(q=G(),q!==null){for(var v=[],n=o();n!==null;)v.push(n),n=o();v!==null?(a.substr(b,1)==="}"?(n="}",b+=1):(n=null,m&&j('"}"')),n!==null?f=[f,k,q,v,n]:(f=null,b=d)):(f=null,b=d)}else f=null,b=d;else f=null,b=d}else f=null,b=d;d=f!==null?f[2]:null;d===null&&(d=null,b=i);if(d!==null)i=
d;else{d=i=b;a.substr(b,1)==="{"?(f="{",b+=1):(f=null,m&&j('"{"'));if(f!==null){k=[];for(q=o();q!==null;)k.push(q),q=o();if(k!==null)if(q=Bb(),q!==null){v=[];for(n=o();n!==null;)v.push(n),n=o();v!==null?(a.substr(b,1)==="}"?(n="}",b+=1):(n=null,m&&j('"}"')),n!==null?f=[f,k,q,v,n]:(f=null,b=d)):(f=null,b=d)}else f=null,b=d;else f=null,b=d}else f=null,b=d;d=f!==null?f[2]:null;d===null&&(d=null,b=i);i=d!==null?d:null}(m=h)&&i===null&&j("[50] GroupGraphPattern");x[e]={nextPos:b,result:i};return i}function Bb(){var e=
"GroupGraphPatternSub@"+b,h=x[e];if(h)return b=h.nextPos,h.result;h=m;m=!1;var i=b,d=b,f=la(),f=f!==null?f:"";if(f!==null){for(var k=[],q=o();q!==null;)k.push(q),q=o();if(k!==null){var q=[],v=b,n=gb();if(n!==null){for(var g=[],s=o();s!==null;)g.push(s),s=o();if(g!==null)if(a.substr(b,1)==="."?(s=".",b+=1):(s=null,m&&j('"."')),s=s!==null?s:"",s!==null){for(var l=[],r=o();r!==null;)l.push(r),r=o();l!==null?(r=la(),r=r!==null?r:"",r!==null?n=[n,g,s,l,r]:(n=null,b=v)):(n=null,b=v)}else n=null,b=v;else n=
null,b=v}else n=null,b=v;for(;n!==null;)if(q.push(n),v=b,n=gb(),n!==null){g=[];for(s=o();s!==null;)g.push(s),s=o();if(g!==null)if(a.substr(b,1)==="."?(s=".",b+=1):(s=null,m&&j('"."')),s=s!==null?s:"",s!==null){l=[];for(r=o();r!==null;)l.push(r),r=o();l!==null?(r=la(),r=r!==null?r:"",r!==null?n=[n,g,s,l,r]:(n=null,b=v)):(n=null,b=v)}else n=null,b=v;else n=null,b=v}else n=null,b=v;q!==null?f=[f,k,q]:(f=null,b=d)}else f=null,b=d}else f=null,b=d;d=f!==null?function(a,b){var f=[];a!=null&&a!=[]&&f.push(a);
for(var d=0;d<b.length;d++)for(var c=0;c<b[d].length;c++)b[d][c].token!=null&&f.push(b[d][c]);for(var e=[],j=[],h=[],d=0;d<f.length;d++)if(f[d].token!="triplespattern"&&f[d].token!="filter"){if(j.length!=0||h.length!=0){for(var q=[],c=0;c<j.length;c++)q=q.concat(j[c].triplesContext);q.length>0&&e.push({token:"basicgraphpattern",triplesContext:q});j=[]}e.push(f[d])}else f[d].token==="triplespattern"?j.push(f[d]):h.push(f[d]);if(j.length!=0||h.length!=0){q=[];for(c=0;c<j.length;c++)q=q.concat(j[c].triplesContext);
q.length>0&&e.push({token:"basicgraphpattern",triplesContext:q})}return{token:"groupgraphpattern",patterns:e,filters:h}}(f[0],f[2]):null;d===null&&(d=null,b=i);(m=h)&&d===null&&j("[51] GroupGraphPatternSub");x[e]={nextPos:b,result:d};return d}function la(){var e="TriplesBlock@"+b,h=x[e];if(h)return b=h.nextPos,h.result;h=m;m=!1;var i=b,d=b,f=Cb();if(f!==null){for(var k=b,q=[],v=o();v!==null;)q.push(v),v=o();if(q!==null)if(a.substr(b,1)==="."?(v=".",b+=1):(v=null,m&&j('"."')),v!==null){var n=la(),
n=n!==null?n:"";n!==null?q=[q,v,n]:(q=null,b=k)}else q=null,b=k;else q=null,b=k;k=q!==null?q:"";k!==null?f=[f,k]:(f=null,b=d)}else f=null,b=d;d=f!==null?function(a,b){var f=a.triplesContext;typeof b==="object"&&b.length!=null&&b[2].triplesContext!=null&&(f=f.concat(b[2].triplesContext));return{token:"triplespattern",triplesContext:f}}(f[0],f[1]):null;d===null&&(d=null,b=i);(m=h)&&d===null&&j("[54] TriplesBlock");x[e]={nextPos:b,result:d};return d}function gb(){var a="GraphPatternNotTriples@"+b,c=
x[a];if(c)return b=c.nextPos,c.result;c=m;m=!1;var e=Db();e===null&&(e=Eb(),e===null&&(e=Fb(),e===null&&(e=Gb(),e===null&&(e=Hb(),e===null&&(e=Ib(),e=e!==null?e:null)))));(m=c)&&e===null&&j("[53] GraphPatternNotTriples");x[a]={nextPos:b,result:e};return e}function Eb(){var e="OptionalGraphPattern@"+b,h=x[e];if(h)return b=h.nextPos,h.result;h=m;m=!1;for(var k=b,d=b,f=[],i=o();i!==null;)f.push(i),i=o();if(f!==null)if(a.substr(b,8)==="OPTIONAL"?(i="OPTIONAL",b+=8):(i=null,m&&j('"OPTIONAL"')),i===null&&
(a.substr(b,8)==="optional"?(i="optional",b+=8):(i=null,m&&j('"optional"')),i=i!==null?i:null),i!==null){for(var q=[],v=o();v!==null;)q.push(v),v=o();q!==null?(v=V(),v!==null?f=[f,i,q,v]:(f=null,b=d)):(f=null,b=d)}else f=null,b=d;else f=null,b=d;d=f!==null?{token:"optionalgraphpattern",value:f[3]}:null;d===null&&(d=null,b=k);(m=h)&&d===null&&j("[54] OptionalGraphPattern");x[e]={nextPos:b,result:d};return d}function Gb(){var e="GraphGraphPattern@"+b,h=x[e];if(h)return b=h.nextPos,h.result;h=m;m=!1;
for(var i=b,d=b,f=[],k=o();k!==null;)f.push(k),k=o();if(f!==null)if(a.substr(b,5)==="GRAPH"?(k="GRAPH",b+=5):(k=null,m&&j('"GRAPH"')),k===null&&(a.substr(b,5)==="graph"?(k="graph",b+=5):(k=null,m&&j('"graph"')),k=k!==null?k:null),k!==null){for(var q=[],v=o();v!==null;)q.push(v),v=o();if(q!==null)if(v=ha(),v!==null){for(var n=[],g=o();g!==null;)n.push(g),g=o();n!==null?(g=V(),g!==null?f=[f,k,q,v,n,g]:(f=null,b=d)):(f=null,b=d)}else f=null,b=d;else f=null,b=d}else f=null,b=d;else f=null,b=d;d=f!==null?
function(a,b){for(var f=0;f<b.patterns.length;f++)for(var d=b.patterns[f],c=0;c<d.triplesContext.length;c++)d.triplesContext[c].graph=a;b.token="groupgraphpattern";return b}(f[3],f[5]):null;d===null&&(d=null,b=i);(m=h)&&d===null&&j("[55] GraphGraphPattern");x[e]={nextPos:b,result:d};return d}function Hb(){var e="ServiceGraphPattern@"+b,h=x[e];if(h)return b=h.nextPos,h.result;h=m;m=!1;var k=b,d=b;if(a.substr(b,7)==="SERVICE"){var f="SERVICE";b+=7}else f=null,m&&j('"SERVICE"');if(f!==null){var i=ha();
if(i!==null){var q=V();q!==null?f=[f,i,q]:(f=null,b=d)}else f=null,b=d}else f=null,b=d;d=f!==null?{token:"servicegraphpattern",status:"todo",value:[f[1],f[2]]}:null;d===null&&(d=null,b=k);(m=h)&&d===null&&j("[56] ServiceGraphPattern");x[e]={nextPos:b,result:d};return d}function Fb(){var e="MinusGraphPattern@"+b,h=x[e];if(h)return b=h.nextPos,h.result;h=m;m=!1;var k=b,d=b;if(a.substr(b,5)==="MINUS"){var f="MINUS";b+=5}else f=null,m&&j('"MINUS"');if(f!==null){var i=V();i!==null?f=[f,i]:(f=null,b=d)}else f=
null,b=d;d=f!==null?{token:"minusgraphpattern",status:"todo",value:f[1]}:null;d===null&&(d=null,b=k);(m=h)&&d===null&&j("[57] MinusGraphPattern");x[e]={nextPos:b,result:d};return d}function Db(){var e="GroupOrUnionGraphPattern@"+b,h=x[e];if(h)return b=h.nextPos,h.result;h=m;m=!1;var k=b,d=b,f=V();if(f!==null){for(var i=[],q=b,v=[],n=o();n!==null;)v.push(n),n=o();if(v!==null)if(a.substr(b,5)==="UNION"?(n="UNION",b+=5):(n=null,m&&j('"UNION"')),n===null&&(a.substr(b,5)==="union"?(n="union",b+=5):(n=
null,m&&j('"union"')),n=n!==null?n:null),n!==null){for(var g=[],s=o();s!==null;)g.push(s),s=o();g!==null?(s=V(),s!==null?v=[v,n,g,s]:(v=null,b=q)):(v=null,b=q)}else v=null,b=q;else v=null,b=q;for(;v!==null;){i.push(v);q=b;v=[];for(n=o();n!==null;)v.push(n),n=o();if(v!==null)if(a.substr(b,5)==="UNION"?(n="UNION",b+=5):(n=null,m&&j('"UNION"')),n===null&&(a.substr(b,5)==="union"?(n="union",b+=5):(n=null,m&&j('"union"')),n=n!==null?n:null),n!==null){g=[];for(s=o();s!==null;)g.push(s),s=o();g!==null?(s=
V(),s!==null?v=[v,n,g,s]:(v=null,b=q)):(v=null,b=q)}else v=null,b=q;else v=null,b=q}i!==null?f=[f,i]:(f=null,b=d)}else f=null,b=d;d=f!==null?function(a,b){if(b.length===0)return a;else{for(var f={token:"graphunionpattern",value:[a]},d=0;d<b.length;d++)d==b.length-1?f.value.push(b[d][3]):(f.value.push(b[d][3]),f={token:"graphunionpattern",value:[f]});return f}}(f[0],f[1]):null;d===null&&(d=null,b=k);(m=h)&&d===null&&j("[58] GroupOrUnionGraphPattern");x[e]={nextPos:b,result:d};return d}function Ib(){var e=
"Filter@"+b,h=x[e];if(h)return b=h.nextPos,h.result;h=m;m=!1;for(var i=b,d=b,f=[],k=o();k!==null;)f.push(k),k=o();if(f!==null)if(a.substr(b,6)==="FILTER"?(k="FILTER",b+=6):(k=null,m&&j('"FILTER"')),k===null&&(a.substr(b,6)==="filter"?(k="filter",b+=6):(k=null,m&&j('"filter"')),k=k!==null?k:null),k!==null){for(var q=[],v=o();v!==null;)q.push(v),v=o();q!==null?(v=va(),v!==null?f=[f,k,q,v]:(f=null,b=d)):(f=null,b=d)}else f=null,b=d;else f=null,b=d;d=f!==null?{token:"filter",value:f[3]}:null;d===null&&
(d=null,b=i);(m=h)&&d===null&&j("[59] Filter");x[e]={nextPos:b,result:d};return d}function va(){var a="Constraint@"+b,c=x[a];if(c)return b=c.nextPos,c.result;c=m;m=!1;var e=Ca();e===null&&(e=Ba(),e===null&&(e=Za(),e=e!==null?e:null));(m=c)&&e===null&&j("[60] Constraint");x[a]={nextPos:b,result:e};return e}function Za(){var a="FunctionCall@"+b,c=x[a];if(c)return b=c.nextPos,c.result;c=m;m=!1;var e=b,d=b,f=Q();if(f!==null){var h=hb();h!==null?f=[f,h]:(f=null,b=d)}else f=null,b=d;d=f!==null?function(a,
b){var f={token:"expression",expressionType:"irireforfunction"};f.iriref=a;f.args=b.value;return f}(f[0],f[1]):null;d===null&&(d=null,b=e);(m=c)&&d===null&&j("[61] FunctionCall");x[a]={nextPos:b,result:d};return d}function hb(){var e="ArgList@"+b,h=x[e];if(h)return b=h.nextPos,h.result;h=m;m=!1;var k=b,d=ia()!==null?{token:"args",value:[]}:null;d===null&&(d=null,b=k);if(d!==null)k=d;else{d=k=b;if(a.substr(b,1)==="("){var f="(";b+=1}else f=null,m&&j('"("');if(f!==null){if(a.substr(b,8)==="DISTINCT"){var i=
"DISTINCT";b+=8}else i=null,m&&j('"DISTINCT"');i===null&&(a.substr(b,8)==="distinct"?(i="distinct",b+=8):(i=null,m&&j('"distinct"')),i=i!==null?i:null);i=i!==null?i:"";if(i!==null){var q=M();if(q!==null){var v=[],g=b;if(a.substr(b,1)===","){var o=",";b+=1}else o=null,m&&j('","');if(o!==null){var s=M();s!==null?o=[o,s]:(o=null,b=g)}else o=null,b=g;for(;o!==null;)v.push(o),g=b,a.substr(b,1)===","?(o=",",b+=1):(o=null,m&&j('","')),o!==null?(s=M(),s!==null?o=[o,s]:(o=null,b=g)):(o=null,b=g);v!==null?
(a.substr(b,1)===")"?(g=")",b+=1):(g=null,m&&j('")"')),g!==null?f=[f,i,q,v,g]:(f=null,b=d)):(f=null,b=d)}else f=null,b=d}else f=null,b=d}else f=null,b=d;d=f!==null?function(a,b,f){for(var d=[],c=0;c<f.length;c++)d.push(f[c][1]);f={token:"args"};f.value=[b].concat(d);f.distinct=a!=null&&a.toUpperCase()==="DISTINCT"?!0:!1;return f}(f[1],f[2],f[3]):null;d===null&&(d=null,b=k);k=d!==null?d:null}(m=h)&&k===null&&j("[62] ArgList");x[e]={nextPos:b,result:k};return k}function Jb(){var e="ExpressionList@"+
b,h=x[e];if(h)return b=h.nextPos,h.result;h=m;m=!1;var k=b,d=ia()!==null?{token:"args",value:[]}:null;d===null&&(d=null,b=k);if(d!==null)k=d;else{d=k=b;if(a.substr(b,1)==="("){var f="(";b+=1}else f=null,m&&j('"("');if(f!==null){var i=M();if(i!==null){var q=[],v=b;if(a.substr(b,1)===","){var g=",";b+=1}else g=null,m&&j('","');if(g!==null){var o=M();o!==null?g=[g,o]:(g=null,b=v)}else g=null,b=v;for(;g!==null;)q.push(g),v=b,a.substr(b,1)===","?(g=",",b+=1):(g=null,m&&j('","')),g!==null?(o=M(),o!==null?
g=[g,o]:(g=null,b=v)):(g=null,b=v);q!==null?(a.substr(b,1)===")"?(v=")",b+=1):(v=null,m&&j('")"')),v!==null?f=[f,i,q,v]:(f=null,b=d)):(f=null,b=d)}else f=null,b=d}else f=null,b=d;d=f!==null?function(a,b){for(var f=[],d=0;d<b.length;d++)f.push(b[d][1]);d={token:"args"};d.value=[a].concat(f);return d}(f[1],f[2]):null;d===null&&(d=null,b=k);k=d!==null?d:null}(m=h)&&k===null&&j("[63] ExpressionList");x[e]={nextPos:b,result:k};return k}function Ab(){var e="ConstructTemplate@"+b,h=x[e];if(h)return b=h.nextPos,
h.result;h=m;m=!1;var k=b,d=b;if(a.substr(b,1)==="{"){var f="{";b+=1}else f=null,m&&j('"{"');if(f!==null){for(var i=[],q=o();q!==null;)i.push(q),q=o();if(i!==null)if(q=ib(),q=q!==null?q:"",q!==null){for(var g=[],n=o();n!==null;)g.push(n),n=o();g!==null?(a.substr(b,1)==="}"?(n="}",b+=1):(n=null,m&&j('"}"')),n!==null?f=[f,i,q,g,n]:(f=null,b=d)):(f=null,b=d)}else f=null,b=d;else f=null,b=d}else f=null,b=d;d=f!==null?f[2]:null;d===null&&(d=null,b=k);(m=h)&&d===null&&j("[64] ConstructTemplate");x[e]={nextPos:b,
result:d};return d}function ib(){var e="ConstructTriples@"+b,h=x[e];if(h)return b=h.nextPos,h.result;h=m;m=!1;var k=b,d=b,f=fb();if(f!==null){for(var i=b,q=[],g=o();g!==null;)q.push(g),g=o();if(q!==null)if(a.substr(b,1)==="."?(g=".",b+=1):(g=null,m&&j('"."')),g!==null){for(var n=[],l=o();l!==null;)n.push(l),l=o();n!==null?(l=ib(),l=l!==null?l:"",l!==null?q=[q,g,n,l]:(q=null,b=i)):(q=null,b=i)}else q=null,b=i;else q=null,b=i;i=q!==null?q:"";i!==null?f=[f,i]:(f=null,b=d)}else f=null,b=d;d=f!==null?
function(a,b){var f=a.triplesContext;typeof b==="object"&&b.length!=null&&b[3].triplesContext!=null&&(f=f.concat(b[3].triplesContext));return{token:"triplestemplate",triplesContext:f}}(f[0],f[1]):null;d===null&&(d=null,b=k);(m=h)&&d===null&&j("[65] ConstructTriples");x[e]={nextPos:b,result:d};return d}function fb(){var a="TriplesSameSubject@"+b,c=x[a];if(c)return b=c.nextPos,c.result;c=m;m=!1;for(var e=b,d=b,f=[],h=o();h!==null;)f.push(h),h=o();if(f!==null)if(h=Ha(),h!==null){for(var q=[],k=o();k!==
null;)q.push(k),k=o();q!==null?(k=wa(),k!==null?f=[f,h,q,k]:(f=null,b=d)):(f=null,b=d)}else f=null,b=d;else f=null,b=d;d=f!==null?function(a,b){var f=b.triplesContext;if(b.pairs)for(var d=0;d<b.pairs.length;d++){var c=b.pairs[d],e=null;c[1].length!=null&&(c[1]=c[1][0]);a.token&&a.token==="triplesnodecollection"?(e={subject:a.chainSubject[0],predicate:c[0],object:c[1]},f.push(e),f=f.concat(a.triplesContext)):(e={subject:a,predicate:c[0],object:c[1]},f.push(e))}d={token:"triplessamesubject"};d.triplesContext=
f;d.chainSubject=a;return d}(f[1],f[3]):null;d===null&&(d=null,b=e);if(d!==null)e=d;else{d=e=b;f=[];for(h=o();h!==null;)f.push(h),h=o();if(f!==null)if(h=Ia(),h!==null){q=[];for(k=o();k!==null;)q.push(k),k=o();q!==null?(k=Kb(),k!==null?f=[f,h,q,k]:(f=null,b=d)):(f=null,b=d)}else f=null,b=d;else f=null,b=d;d=f!==null?function(a,b){var f=a.triplesContext,d=a.chainSubject;if(b.pairs)for(var c=0;c<b.pairs.length;c++){var e=b.pairs[c];e[1].length!=null&&(e[1]=e[1][0]);if(a.token==="triplesnodecollection")for(var j=
0;j<d.length;j++){var h=d[j];if(h.triplesContext!=null){var q={subject:h.chainSubject,predicate:e[0],object:e[1]};f.concat(h.triplesContext)}else q={subject:d[j],predicate:e[0],object:e[1]},f.push(q)}else q={subject:d,predicate:e[0],object:e[1]},f.push(q)}c={token:"triplessamesubject"};c.triplesContext=f;c.chainSubject=d;return c}(f[1],f[3]):null;d===null&&(d=null,b=e);e=d!==null?d:null}(m=c)&&e===null&&j("[66] TriplesSameSubject");x[a]={nextPos:b,result:e};return e}function wa(){var e="PropertyListNotEmpty@"+
b,h=x[e];if(h)return b=h.nextPos,h.result;h=m;m=!1;var k=b,d=b,f=Ja();if(f!==null){for(var i=[],q=o();q!==null;)i.push(q),q=o();if(i!==null)if(q=ja(),q!==null){for(var g=[],n=b,l=[],s=o();s!==null;)l.push(s),s=o();if(l!==null)if(a.substr(b,1)===";"?(s=";",b+=1):(s=null,m&&j('";"')),s!==null){for(var r=[],t=o();t!==null;)r.push(t),t=o();if(r!==null){var t=b,u=Ja();if(u!==null){for(var w=[],y=o();y!==null;)w.push(y),y=o();w!==null?(y=ja(),y!==null?u=[u,w,y]:(u=null,b=t)):(u=null,b=t)}else u=null,b=
t;t=u!==null?u:"";t!==null?l=[l,s,r,t]:(l=null,b=n)}else l=null,b=n}else l=null,b=n;else l=null,b=n;for(;l!==null;){g.push(l);n=b;l=[];for(s=o();s!==null;)l.push(s),s=o();if(l!==null)if(a.substr(b,1)===";"?(s=";",b+=1):(s=null,m&&j('";"')),s!==null){r=[];for(t=o();t!==null;)r.push(t),t=o();if(r!==null){t=b;u=Ja();if(u!==null){w=[];for(y=o();y!==null;)w.push(y),y=o();w!==null?(y=ja(),y!==null?u=[u,w,y]:(u=null,b=t)):(u=null,b=t)}else u=null,b=t;t=u!==null?u:"";t!==null?l=[l,s,r,t]:(l=null,b=n)}else l=
null,b=n}else l=null,b=n;else l=null,b=n}g!==null?f=[f,i,q,g]:(f=null,b=d)}else f=null,b=d;else f=null,b=d}else f=null,b=d;d=f!==null?function(a,b,f){for(var d={token:"propertylist"},c=[],e=[],j=0;j<b.length;j++)b[j].triplesContext!=null?(c=c.concat(b[j].triplesContext),b[j].token==="triplesnodecollection"&&b[j].chainSubject.length!=null?e.push([a,b[j].chainSubject[0]]):e.push([a,b[j].chainSubject])):e.push([a,b[j]]);for(j=0;j<f.length;j++)for(var b=f[j][3],a=b[0],b=b[2]||[],h=0;h<b.length;h++)b[h].triplesContext!=
null?(c=c.concat(b[h].triplesContext),e.push([a,b[h].chainSubject])):e.push([a,b[h]]);d.pairs=e;d.triplesContext=c;return d}(f[0],f[2],f[3]):null;d===null&&(d=null,b=k);(m=h)&&d===null&&j("[67] PropertyListNotEmpty");x[e]={nextPos:b,result:d};return d}function Kb(){var a="PropertyList@"+b,c=x[a];if(c)return b=c.nextPos,c.result;c=m;m=!1;var e=wa(),e=e!==null?e:"";(m=c)&&e===null&&j("[68] PropertyList");x[a]={nextPos:b,result:e};return e}function ja(){var e="ObjectList@"+b,h=x[e];if(h)return b=h.nextPos,
h.result;h=m;m=!1;var k=b,d=b,f=na();if(f!==null){for(var i=[],q=o();q!==null;)i.push(q),q=o();if(i!==null){var q=[],g=b;if(a.substr(b,1)===","){var n=",";b+=1}else n=null,m&&j('","');if(n!==null){for(var l=[],s=o();s!==null;)l.push(s),s=o();l!==null?(s=na(),s!==null?n=[n,l,s]:(n=null,b=g)):(n=null,b=g)}else n=null,b=g;for(;n!==null;)if(q.push(n),g=b,a.substr(b,1)===","?(n=",",b+=1):(n=null,m&&j('","')),n!==null){l=[];for(s=o();s!==null;)l.push(s),s=o();l!==null?(s=na(),s!==null?n=[n,l,s]:(n=null,
b=g)):(n=null,b=g)}else n=null,b=g;q!==null?f=[f,i,q]:(f=null,b=d)}else f=null,b=d}else f=null,b=d;d=f!==null?function(a,b){var f=[];f.push(a);for(var d=0;d<b.length;d++)for(var c=0;c<b[d].length;c++)typeof b[d][c]=="object"&&b[d][c].token!=null&&f.push(b[d][c]);return f}(f[0],f[2]):null;d===null&&(d=null,b=k);(m=h)&&d===null&&j("[69] ObjectList");x[e]={nextPos:b,result:d};return d}function Ja(){var e="Verb@"+b,h=x[e];if(h)return b=h.nextPos,h.result;h=m;m=!1;var k=ha();if(k===null){k=b;if(a.substr(b,
1)==="a"){var d="a";b+=1}else d=null,m&&j('"a"');d=d!==null?{token:"uri",prefix:null,suffix:null,value:"http://www.w3.org/1999/02/22-rdf-syntax-ns#type"}:null;d===null&&(d=null,b=k);k=d!==null?d:null}(m=h)&&k===null&&j("[71] Verb");x[e]={nextPos:b,result:k};return k}function Cb(){var a="TriplesSameSubjectPath@"+b,c=x[a];if(c)return b=c.nextPos,c.result;c=m;m=!1;for(var e=b,d=b,f=[],h=o();h!==null;)f.push(h),h=o();if(f!==null)if(h=Ha(),h!==null){for(var k=[],i=o();i!==null;)k.push(i),i=o();k!==null?
(i=Lb(),i!==null?f=[f,h,k,i]:(f=null,b=d)):(f=null,b=d)}else f=null,b=d;else f=null,b=d;d=f!==null?function(a,b){var f=b.triplesContext;if(b.pairs)for(var d=0;d<b.pairs.length;d++){var c=b.pairs[d],e=null;c[1].length!=null&&(c[1]=c[1][0]);a.token&&a.token==="triplesnodecollection"?(e={subject:a.chainSubject[0],predicate:c[0],object:c[1]},f.push(e),f=f.concat(a.triplesContext)):(e={subject:a,predicate:c[0],object:c[1]},f.push(e))}d={token:"triplessamesubject"};d.triplesContext=f;d.chainSubject=a;return d}(f[1],
f[3]):null;d===null&&(d=null,b=e);if(d!==null)e=d;else{d=e=b;f=[];for(h=o();h!==null;)f.push(h),h=o();if(f!==null)if(h=Ia(),h!==null){k=[];for(i=o();i!==null;)k.push(i),i=o();k!==null?(i=Mb(),i!==null?f=[f,h,k,i]:(f=null,b=d)):(f=null,b=d)}else f=null,b=d;else f=null,b=d;d=f!==null?function(a,b){var f=a.triplesContext,d=a.chainSubject;if(b.pairs)for(var c=0;c<b.pairs.length;c++){var e=b.pairs[c];e[1].length!=null&&(e[1]=e[1][0]);if(a.token==="triplesnodecollection")for(var j=0;j<d.length;j++){var h=
d[j];if(h.triplesContext!=null){var k={subject:h.chainSubject,predicate:e[0],object:e[1]};f.concat(h.triplesContext)}else k={subject:d[j],predicate:e[0],object:e[1]},f.push(k)}else k={subject:d,predicate:e[0],object:e[1]},f.push(k)}c={token:"triplessamesubject"};c.triplesContext=f;c.chainSubject=d;return c}(f[1],f[3]):null;d===null&&(d=null,b=e);e=d!==null?d:null}(m=c)&&e===null&&j("[72] TriplesSameSubjectPath");x[a]={nextPos:b,result:e};return e}function Lb(){var e="PropertyListNotEmptyPath@"+b,
h=x[e];if(h)return b=h.nextPos,h.result;h=m;m=!1;var k=b,d=b,f=Ka();f===null&&(f=P(),f=f!==null?f:null);if(f!==null){for(var i=[],q=o();q!==null;)i.push(q),q=o();if(i!==null)if(q=ja(),q!==null){for(var g=[],n=b,l=[],s=o();s!==null;)l.push(s),s=o();if(l!==null)if(a.substr(b,1)===";"?(s=";",b+=1):(s=null,m&&j('";"')),s!==null){for(var r=[],t=o();t!==null;)r.push(t),t=o();if(r!==null){var t=b,u=Ka();u===null&&(u=P(),u=u!==null?u:null);if(u!==null){var w=ja();w!==null?u=[u,w]:(u=null,b=t)}else u=null,
b=t;t=u!==null?u:"";t!==null?l=[l,s,r,t]:(l=null,b=n)}else l=null,b=n}else l=null,b=n;else l=null,b=n;for(;l!==null;){g.push(l);n=b;l=[];for(s=o();s!==null;)l.push(s),s=o();if(l!==null)if(a.substr(b,1)===";"?(s=";",b+=1):(s=null,m&&j('";"')),s!==null){r=[];for(t=o();t!==null;)r.push(t),t=o();r!==null?(t=b,u=Ka(),u===null&&(u=P(),u=u!==null?u:null),u!==null?(w=ja(),w!==null?u=[u,w]:(u=null,b=t)):(u=null,b=t),t=u!==null?u:"",t!==null?l=[l,s,r,t]:(l=null,b=n)):(l=null,b=n)}else l=null,b=n;else l=null,
b=n}g!==null?f=[f,i,q,g]:(f=null,b=d)}else f=null,b=d;else f=null,b=d}else f=null,b=d;d=f!==null?function(a,b,f){token={token:"propertylist"};for(var d=[],c=[],e=0;e<b.length;e++)b[e].triplesContext!=null?(d=d.concat(b[e].triplesContext),b[e].token==="triplesnodecollection"&&b[e].chainSubject.length!=null?c.push([a,b[e].chainSubject[0]]):c.push([a,b[e].chainSubject])):c.push([a,b[e]]);for(e=0;e<f.length;e++)for(var b=f[e][3],a=b[0],b=b[1]||[],j=0;j<b.length;j++)b[j].triplesContext!=null?(d=d.concat(b[j].triplesContext),
c.push([a,b[j].chainSubject])):c.push([a,b[j]]);token.pairs=c;token.triplesContext=d;return token}(f[0],f[2],f[3]):null;d===null&&(d=null,b=k);(m=h)&&d===null&&j("[73] PropertyListNotEmptyPath");x[e]={nextPos:b,result:d};return d}function Mb(){var a="PropertyListPath@"+b,c=x[a];if(c)return b=c.nextPos,c.result;c=m;m=!1;var e=wa(),e=e!==null?e:"";(m=c)&&e===null&&j("[74] PropertyListPath");x[a]={nextPos:b,result:e};return e}function Ka(){var a="VerbPath@"+b,c=x[a];if(c)return b=c.nextPos,c.result;
c=m;m=!1;var e=b,d=jb(),d=d!==null?d:null;d===null&&(d=null,b=e);(m=c)&&d===null&&j("[75]");x[a]={nextPos:b,result:d};return d}function jb(){var e="PathAlternative@"+b,h=x[e];if(h)return b=h.nextPos,h.result;h=m;m=!1;var k=b,d=b,f=La();if(f!==null){var i=[],q=b;if(a.substr(b,1)==="|"){var g="|";b+=1}else g=null,m&&j('"|"');if(g!==null){var n=La();n!==null?g=[g,n]:(g=null,b=q)}else g=null,b=q;for(;g!==null;)i.push(g),q=b,a.substr(b,1)==="|"?(g="|",b+=1):(g=null,m&&j('"|"')),g!==null?(n=La(),n!==null?
g=[g,n]:(g=null,b=q)):(g=null,b=q);i!==null?f=[f,i]:(f=null,b=d)}else f=null,b=d;d=f!==null?function(a,b){if(b==null||b.length===0)return a;else{for(var f=[],d=0;d<b.length;d++)f.push(b[1]);d={token:"path",kind:"alternative"};d.value=f;return d}}(f[0],f[1]):null;d===null&&(d=null,b=k);(m=h)&&d===null&&j("[78] PathAlternative");x[e]={nextPos:b,result:d};return d}function La(){var e="PathSequence@"+b,h=x[e];if(h)return b=h.nextPos,h.result;h=m;m=!1;var k=b,d=b,f=Ma();if(f!==null){var i=[],q=b;if(a.substr(b,
1)==="/"){var g="/";b+=1}else g=null,m&&j('"/"');if(g!==null){var n=Ma();n!==null?g=[g,n]:(g=null,b=q)}else g=null,b=q;for(;g!==null;)i.push(g),q=b,a.substr(b,1)==="/"?(g="/",b+=1):(g=null,m&&j('"/"')),g!==null?(n=Ma(),n!==null?g=[g,n]:(g=null,b=q)):(g=null,b=q);i!==null?f=[f,i]:(f=null,b=d)}else f=null,b=d;d=f!==null?function(a,b){if(b==null||b.length===0)return a;else{for(var f=[a],d=0;d<b.length;d++)f.push(b[d][1]);d={token:"path",kind:"sequence"};d.value=f;return d}}(f[0],f[1]):null;d===null&&
(d=null,b=k);(m=h)&&d===null&&j("[79] PathSequence");x[e]={nextPos:b,result:d};return d}function kb(){var a="PathElt@"+b,c=x[a];if(c)return b=c.nextPos,c.result;c=m;m=!1;var e=b,d=b,f=Nb();if(f!==null){var h=Ob(),h=h!==null?h:"";h!==null?f=[f,h]:(f=null,b=d)}else f=null,b=d;d=f!==null?function(a,b){if(a.token&&a.token!="path"&&b=="")return a;else if(a.token&&a.token!=d&&b!=""){var d={token:"path",kind:"element"};d.value=a;d.modifier=b;return d}else return a.modifier=b,a}(f[0],f[1]):null;d===null&&
(d=null,b=e);(m=c)&&d===null&&j("[88] PathElt");x[a]={nextPos:b,result:d};return d}function Ma(){var e="PathEltOrInverse@"+b,h=x[e];if(h)return b=h.nextPos,h.result;h=m;m=!1;var k=kb();if(k===null){var d=k=b;if(a.substr(b,1)==="^"){var f="^";b+=1}else f=null,m&&j('"^"');if(f!==null){var i=kb();i!==null?f=[f,i]:(f=null,b=d)}else f=null,b=d;d=f!==null?function(a){var b={token:"path",kind:"inversePath"};b.value=a;return b}(f[1]):null;d===null&&(d=null,b=k);k=d!==null?d:null}(m=h)&&k===null&&j("[81] PathEltOrInverse");
x[e]={nextPos:b,result:k};return k}function Ob(){var e="PathMod@"+b,h=x[e];if(h)return b=h.nextPos,h.result;h=m;m=!1;if(a.substr(b,1)==="*"){var k="*";b+=1}else k=null,m&&j('"*"');if(k===null&&(a.substr(b,1)==="?"?(k="?",b+=1):(k=null,m&&j('"?"')),k===null&&(a.substr(b,1)==="+"?(k="+",b+=1):(k=null,m&&j('"+"')),k===null))){k=b;if(a.substr(b,1)==="{"){var d="{";b+=1}else d=null,m&&j('"{"');if(d!==null){var f=b,i=ba();if(i!==null){var q=b;if(a.substr(b,1)===","){var g=",";b+=1}else g=null,m&&j('","');
if(g!==null){if(a.substr(b,1)==="}"){var n="}";b+=1}else n=null,m&&j('"}"');if(n===null){var n=b,o=ba();if(o!==null){if(a.substr(b,1)==="}"){var l="}";b+=1}else l=null,m&&j('"}"');l!==null?o=[o,l]:(o=null,b=n)}else o=null,b=n;n=o!==null?o:null}n!==null?g=[g,n]:(g=null,b=q)}else g=null,b=q;g!==null?q=g:(a.substr(b,1)==="}"?(q="}",b+=1):(q=null,m&&j('"}"')),q=q!==null?q:null);q!==null?i=[i,q]:(i=null,b=f)}else i=null,b=f;i!==null?f=i:(f=b,a.substr(b,1)===","?(i=",",b+=1):(i=null,m&&j('","')),i!==null?
(q=ba(),q!==null?(a.substr(b,1)==="}"?(g="}",b+=1):(g=null,m&&j('"}"')),g!==null?i=[i,q,g]:(i=null,b=f)):(i=null,b=f)):(i=null,b=f),f=i!==null?i:null);f!==null?d=[d,f]:(d=null,b=k)}else d=null,b=k;k=d!==null?d:null}(m=h)&&k===null&&j("[82] PathMod");x[e]={nextPos:b,result:k};return k}function Nb(){var e="PathPrimary@"+b,h=x[e];if(h)return b=h.nextPos,h.result;h=m;m=!1;var k=Q();if(k===null){k=b;if(a.substr(b,1)==="a"){var d="a";b+=1}else d=null,m&&j('"a"');d=d!==null?{token:"uri",prefix:null,suffix:null,
value:"http://www.w3.org/1999/02/22-rdf-syntax-ns#type"}:null;d===null&&(d=null,b=k);if(d!==null)k=d;else{k=b;a.substr(b,1)==="!"?(d="!",b+=1):(d=null,m&&j('"!"'));if(d!==null){var f=Pb();f!==null?d=[d,f]:(d=null,b=k)}else d=null,b=k;if(d!==null)k=d;else{d=k=b;a.substr(b,1)==="("?(f="(",b+=1):(f=null,m&&j('"("'));if(f!==null){var i=jb();if(i!==null){if(a.substr(b,1)===")"){var q=")";b+=1}else q=null,m&&j('")"');q!==null?f=[f,i,q]:(f=null,b=d)}else f=null,b=d}else f=null,b=d;d=f!==null?f[1]:null;d===
null&&(d=null,b=k);k=d!==null?d:null}}}(m=h)&&k===null&&j("[83] PathPrimary");x[e]={nextPos:b,result:k};return k}function Pb(){var e="PathNegatedPropertySet@"+b,h=x[e];if(h)return b=h.nextPos,h.result;h=xa();if(h===null){h=b;if(a.substr(b,1)==="("){var k="(";b+=1}else k=null,m&&j('"("');if(k!==null){var d=b,f=xa();if(f!==null){var i=[],q=b;if(a.substr(b,1)==="|"){var g="|";b+=1}else g=null,m&&j('"|"');if(g!==null){var n=xa();n!==null?g=[g,n]:(g=null,b=q)}else g=null,b=q;for(;g!==null;)i.push(g),q=
b,a.substr(b,1)==="|"?(g="|",b+=1):(g=null,m&&j('"|"')),g!==null?(n=xa(),n!==null?g=[g,n]:(g=null,b=q)):(g=null,b=q);i!==null?f=[f,i]:(f=null,b=d)}else f=null,b=d;d=f!==null?f:"";d!==null?(a.substr(b,1)===")"?(f=")",b+=1):(f=null,m&&j('")"')),f!==null?k=[k,d,f]:(k=null,b=h)):(k=null,b=h)}else k=null,b=h;h=k!==null?k:null}x[e]={nextPos:b,result:h};return h}function xa(){var e="PathOneInPropertySet@"+b,h=x[e];if(h)return b=h.nextPos,h.result;h=m;m=!1;var k=Q();if(k===null&&(a.substr(b,1)==="a"?(k="a",
b+=1):(k=null,m&&j('"a"')),k===null)){k=b;if(a.substr(b,1)==="^"){var d="^";b+=1}else d=null,m&&j('"^"');if(d!==null){var f=Q();f===null&&(a.substr(b,1)==="a"?(f="a",b+=1):(f=null,m&&j('"a"')),f=f!==null?f:null);f!==null?d=[d,f]:(d=null,b=k)}else d=null,b=k;k=d!==null?d:null}(m=h)&&k===null&&j("[85] PathOneInPropertySet");x[e]={nextPos:b,result:k};return k}function Ia(){var a="TriplesNode@"+b,c=x[a];if(c)return b=c.nextPos,c.result;c=m;m=!1;var e=b,d=Qb(),d=d!==null?function(a){for(var b=[],d=[],
c=null,e=0;e<a.length;e++)ca++,c=null,a[e].chainSubject==null&&a[e].triplesContext==null?c=a[e]:(c=a[e].chainSubject,b=b.concat(nextSubject.triplesContext)),c={subject:{token:"blank",value:"_:"+ca},predicate:{token:"uri",prefix:null,suffix:null,value:"http://www.w3.org/1999/02/22-rdf-syntax-ns#first"},object:c},e==0&&d.push(c.subject),b.push(c),c=e===a.length-1?{subject:{token:"blank",value:"_:"+ca},predicate:{token:"uri",prefix:null,suffix:null,value:"http://www.w3.org/1999/02/22-rdf-syntax-ns#rest"},
object:{token:"uri",prefix:null,suffix:null,value:"http://www.w3.org/1999/02/22-rdf-syntax-ns#nil"}}:{subject:{token:"blank",value:"_:"+ca},predicate:{token:"uri",prefix:null,suffix:null,value:"http://www.w3.org/1999/02/22-rdf-syntax-ns#rest"},object:{token:"blank",value:"_:"+(ca+1)}},b.push(c);return{token:"triplesnodecollection",triplesContext:b,chainSubject:d}}(d):null;d===null&&(d=null,b=e);d!==null?e=d:(e=Rb(),e=e!==null?e:null);(m=c)&&e===null&&j("[87] TriplesNode");x[a]={nextPos:b,result:e};
return e}function Rb(){var e="BlankNodePropertyList@"+b,h=x[e];if(h)return b=h.nextPos,h.result;h=m;m=!1;for(var k=b,d=b,f=[],i=o();i!==null;)f.push(i),i=o();if(f!==null)if(a.substr(b,1)==="["?(i="[",b+=1):(i=null,m&&j('"["')),i!==null){for(var q=[],g=o();g!==null;)q.push(g),g=o();if(q!==null)if(g=wa(),g!==null){for(var n=[],l=o();l!==null;)n.push(l),l=o();if(n!==null)if(a.substr(b,1)==="]"?(l="]",b+=1):(l=null,m&&j('"]"')),l!==null){for(var s=[],r=o();r!==null;)s.push(r),r=o();s!==null?f=[f,i,q,
g,n,l,s]:(f=null,b=d)}else f=null,b=d;else f=null,b=d}else f=null,b=d;else f=null,b=d}else f=null,b=d;else f=null,b=d;d=f!==null?function(a){ca++;for(var b={token:"blank",value:"_:"+ca},d=[],f=0;f<a.pairs.length;f++){var c=a.pairs[f],e={};e.subject=b;e.predicate=c[0];c[1].length!=null&&(c[1]=c[1][0]);e.object=c[1];d.push(e)}return{token:"triplesnode",kind:"blanknodepropertylist",triplesContext:a.triplesContext.concat(d),chainSubject:b}}(f[3]):null;d===null&&(d=null,b=k);(m=h)&&d===null&&j("[88] BlankNodePropertyList");
x[e]={nextPos:b,result:d};return d}function Qb(){var e="Collection@"+b,h=x[e];if(h)return b=h.nextPos,h.result;h=m;m=!1;for(var k=b,d=b,f=[],i=o();i!==null;)f.push(i),i=o();if(f!==null)if(a.substr(b,1)==="("?(i="(",b+=1):(i=null,m&&j('"("')),i!==null){for(var q=[],g=o();g!==null;)q.push(g),g=o();if(q!==null){var n=na();if(n!==null)for(g=[];n!==null;)g.push(n),n=na();else g=null;if(g!==null){for(var n=[],l=o();l!==null;)n.push(l),l=o();if(n!==null)if(a.substr(b,1)===")"?(l=")",b+=1):(l=null,m&&j('")"')),
l!==null){for(var s=[],r=o();r!==null;)s.push(r),r=o();s!==null?f=[f,i,q,g,n,l,s]:(f=null,b=d)}else f=null,b=d;else f=null,b=d}else f=null,b=d}else f=null,b=d}else f=null,b=d;else f=null,b=d;d=f!==null?f[3]:null;d===null&&(d=null,b=k);(m=h)&&d===null&&j("[89] Collection");x[e]={nextPos:b,result:d};return d}function na(){var a="GraphNode@"+b,c=x[a];if(c)return b=c.nextPos,c.result;c=m;m=!1;for(var e=b,d=b,f=[],h=o();h!==null;)f.push(h),h=o();if(f!==null)if(h=Ha(),h!==null){for(var k=[],i=o();i!==null;)k.push(i),
i=o();k!==null?f=[f,h,k]:(f=null,b=d)}else f=null,b=d;else f=null,b=d;if(f!==null)d=f;else{d=b;f=[];for(h=o();h!==null;)f.push(h),h=o();if(f!==null)if(h=Ia(),h!==null){k=[];for(i=o();i!==null;)k.push(i),i=o();k!==null?f=[f,h,k]:(f=null,b=d)}else f=null,b=d;else f=null,b=d;d=f!==null?f:null}d=d!==null?d[1]:null;d===null&&(d=null,b=e);(m=c)&&d===null&&j("[90] GraphNode");x[a]={nextPos:b,result:d};return d}function Ha(){var a="VarOrTerm@"+b,c=x[a];if(c)return b=c.nextPos,c.result;c=m;m=!1;var e=P();
e===null&&(e=Sb(),e=e!==null?e:null);(m=c)&&e===null&&j("[91] VarOrTerm");x[a]={nextPos:b,result:e};return e}function ha(){var a="VarOrIRIref@"+b,c=x[a];if(c)return b=c.nextPos,c.result;c=m;m=!1;var e=P();e===null&&(e=Q(),e=e!==null?e:null);(m=c)&&e===null&&j("[92] VarOrIRIref");x[a]={nextPos:b,result:e};return e}function P(){var a="Var@"+b,c=x[a];if(c)return b=c.nextPos,c.result;c=m;m=!1;var e=b,d=Tb();d===null&&(d=Ub(),d=d!==null?d:null);d=d!==null?function(a){var b={token:"var"};b.value=a;return b}(d):
null;d===null&&(d=null,b=e);(m=c)&&d===null&&j("[93] Var");x[a]={nextPos:b,result:d};return d}function Sb(){var a="GraphTerm@"+b,c=x[a];if(c)return b=c.nextPos,c.result;c=m;m=!1;var e=Q();e===null&&(e=Da(),e===null&&(e=Ea(),e===null&&(e=Fa(),e===null&&(e=Vb(),e===null&&(e=ia(),e=e!==null?e:null)))));(m=c)&&e===null&&j("[94] GraphTerm");x[a]={nextPos:b,result:e};return e}function M(){var e="ConditionalOrExpression@"+b,h=x[e];if(h)return b=h.nextPos,h.result;h=m;m=!1;var k=b,d=b,f=Na();if(f!==null){for(var i=
[],q=b,g=[],n=o();n!==null;)g.push(n),n=o();if(g!==null)if(a.substr(b,2)==="||"?(n="||",b+=2):(n=null,m&&j('"||"')),n!==null){for(var l=[],s=o();s!==null;)l.push(s),s=o();l!==null?(s=Na(),s!==null?g=[g,n,l,s]:(g=null,b=q)):(g=null,b=q)}else g=null,b=q;else g=null,b=q;for(;g!==null;){i.push(g);q=b;g=[];for(n=o();n!==null;)g.push(n),n=o();if(g!==null)if(a.substr(b,2)==="||"?(n="||",b+=2):(n=null,m&&j('"||"')),n!==null){l=[];for(s=o();s!==null;)l.push(s),s=o();l!==null?(s=Na(),s!==null?g=[g,n,l,s]:(g=
null,b=q)):(g=null,b=q)}else g=null,b=q;else g=null,b=q}i!==null?f=[f,i]:(f=null,b=d)}else f=null,b=d;d=f!==null?function(a,b){if(b.length===0)return a;for(var d={token:"expression",expressionType:"conditionalor"},c=[a],f=0;f<b.length;f++)c.push(b[f][3]);d.operands=c;return d}(f[0],f[1]):null;d===null&&(d=null,b=k);(m=h)&&d===null&&j("[96] ConditionalOrExpression");x[e]={nextPos:b,result:d};return d}function Na(){var e="ConditionalAndExpression@"+b,h=x[e];if(h)return b=h.nextPos,h.result;h=m;m=!1;
var k=b,d=b,f=Oa();if(f!==null){for(var i=[],q=b,g=[],n=o();n!==null;)g.push(n),n=o();if(g!==null)if(a.substr(b,2)==="&&"?(n="&&",b+=2):(n=null,m&&j('"&&"')),n!==null){for(var l=[],s=o();s!==null;)l.push(s),s=o();l!==null?(s=Oa(),s!==null?g=[g,n,l,s]:(g=null,b=q)):(g=null,b=q)}else g=null,b=q;else g=null,b=q;for(;g!==null;){i.push(g);q=b;g=[];for(n=o();n!==null;)g.push(n),n=o();if(g!==null)if(a.substr(b,2)==="&&"?(n="&&",b+=2):(n=null,m&&j('"&&"')),n!==null){l=[];for(s=o();s!==null;)l.push(s),s=o();
l!==null?(s=Oa(),s!==null?g=[g,n,l,s]:(g=null,b=q)):(g=null,b=q)}else g=null,b=q;else g=null,b=q}i!==null?f=[f,i]:(f=null,b=d)}else f=null,b=d;d=f!==null?function(a,b){if(b.length===0)return a;for(var d={token:"expression",expressionType:"conditionaland"},c=[a],f=0;f<b.length;f++)c.push(b[f][3]);d.operands=c;return d}(f[0],f[1]):null;d===null&&(d=null,b=k);(m=h)&&d===null&&j("[97] ConditionalAndExpression");x[e]={nextPos:b,result:d};return d}function Oa(){var e="RelationalExpression@"+b,h=x[e];if(h)return b=
h.nextPos,h.result;h=m;m=!1;var k=b,d=b,f=T();if(f!==null){for(var i=[],q=b,g=[],n=o();n!==null;)g.push(n),n=o();if(g!==null)if(a.substr(b,1)==="="?(n="=",b+=1):(n=null,m&&j('"="')),n!==null){for(var l=[],s=o();s!==null;)l.push(s),s=o();l!==null?(s=T(),s!==null?g=[g,n,l,s]:(g=null,b=q)):(g=null,b=q)}else g=null,b=q;else g=null,b=q;if(g!==null)q=g;else{q=b;g=[];for(n=o();n!==null;)g.push(n),n=o();if(g!==null)if(a.substr(b,2)==="!="?(n="!=",b+=2):(n=null,m&&j('"!="')),n!==null){l=[];for(s=o();s!==null;)l.push(s),
s=o();l!==null?(s=T(),s!==null?g=[g,n,l,s]:(g=null,b=q)):(g=null,b=q)}else g=null,b=q;else g=null,b=q;if(g!==null)q=g;else{q=b;g=[];for(n=o();n!==null;)g.push(n),n=o();if(g!==null)if(a.substr(b,1)==="<"?(n="<",b+=1):(n=null,m&&j('"<"')),n!==null){l=[];for(s=o();s!==null;)l.push(s),s=o();l!==null?(s=T(),s!==null?g=[g,n,l,s]:(g=null,b=q)):(g=null,b=q)}else g=null,b=q;else g=null,b=q;if(g!==null)q=g;else{q=b;g=[];for(n=o();n!==null;)g.push(n),n=o();if(g!==null)if(a.substr(b,1)===">"?(n=">",b+=1):(n=
null,m&&j('">"')),n!==null){l=[];for(s=o();s!==null;)l.push(s),s=o();l!==null?(s=T(),s!==null?g=[g,n,l,s]:(g=null,b=q)):(g=null,b=q)}else g=null,b=q;else g=null,b=q;if(g!==null)q=g;else{q=b;g=[];for(n=o();n!==null;)g.push(n),n=o();if(g!==null)if(a.substr(b,2)==="<="?(n="<=",b+=2):(n=null,m&&j('"<="')),n!==null){l=[];for(s=o();s!==null;)l.push(s),s=o();l!==null?(s=T(),s!==null?g=[g,n,l,s]:(g=null,b=q)):(g=null,b=q)}else g=null,b=q;else g=null,b=q;if(g!==null)q=g;else{q=b;g=[];for(n=o();n!==null;)g.push(n),
n=o();if(g!==null)if(a.substr(b,2)===">="?(n=">=",b+=2):(n=null,m&&j('">="')),n!==null){l=[];for(s=o();s!==null;)l.push(s),s=o();l!==null?(s=T(),s!==null?g=[g,n,l,s]:(g=null,b=q)):(g=null,b=q)}else g=null,b=q;else g=null,b=q;q=g!==null?g:null}}}}}for(;q!==null;){i.push(q);q=b;g=[];for(n=o();n!==null;)g.push(n),n=o();if(g!==null)if(a.substr(b,1)==="="?(n="=",b+=1):(n=null,m&&j('"="')),n!==null){l=[];for(s=o();s!==null;)l.push(s),s=o();l!==null?(s=T(),s!==null?g=[g,n,l,s]:(g=null,b=q)):(g=null,b=q)}else g=
null,b=q;else g=null,b=q;if(g!==null)q=g;else{q=b;g=[];for(n=o();n!==null;)g.push(n),n=o();if(g!==null)if(a.substr(b,2)==="!="?(n="!=",b+=2):(n=null,m&&j('"!="')),n!==null){l=[];for(s=o();s!==null;)l.push(s),s=o();l!==null?(s=T(),s!==null?g=[g,n,l,s]:(g=null,b=q)):(g=null,b=q)}else g=null,b=q;else g=null,b=q;if(g!==null)q=g;else{q=b;g=[];for(n=o();n!==null;)g.push(n),n=o();if(g!==null)if(a.substr(b,1)==="<"?(n="<",b+=1):(n=null,m&&j('"<"')),n!==null){l=[];for(s=o();s!==null;)l.push(s),s=o();l!==null?
(s=T(),s!==null?g=[g,n,l,s]:(g=null,b=q)):(g=null,b=q)}else g=null,b=q;else g=null,b=q;if(g!==null)q=g;else{q=b;g=[];for(n=o();n!==null;)g.push(n),n=o();if(g!==null)if(a.substr(b,1)===">"?(n=">",b+=1):(n=null,m&&j('">"')),n!==null){l=[];for(s=o();s!==null;)l.push(s),s=o();l!==null?(s=T(),s!==null?g=[g,n,l,s]:(g=null,b=q)):(g=null,b=q)}else g=null,b=q;else g=null,b=q;if(g!==null)q=g;else{q=b;g=[];for(n=o();n!==null;)g.push(n),n=o();if(g!==null)if(a.substr(b,2)==="<="?(n="<=",b+=2):(n=null,m&&j('"<="')),
n!==null){l=[];for(s=o();s!==null;)l.push(s),s=o();l!==null?(s=T(),s!==null?g=[g,n,l,s]:(g=null,b=q)):(g=null,b=q)}else g=null,b=q;else g=null,b=q;if(g!==null)q=g;else{q=b;g=[];for(n=o();n!==null;)g.push(n),n=o();if(g!==null)if(a.substr(b,2)===">="?(n=">=",b+=2):(n=null,m&&j('">="')),n!==null){l=[];for(s=o();s!==null;)l.push(s),s=o();l!==null?(s=T(),s!==null?g=[g,n,l,s]:(g=null,b=q)):(g=null,b=q)}else g=null,b=q;else g=null,b=q;q=g!==null?g:null}}}}}}i!==null?f=[f,i]:(f=null,b=d)}else f=null,b=d;
d=f!==null?function(a,b){if(b.length===0)return a;else{var d={expressionType:"relationalexpression"};d.operator=b[0][1];d.op1=a;d.op2=b[0][3];d.token="expression";return d}}(f[0],f[1]):null;d===null&&(d=null,b=k);(m=h)&&d===null&&j("[99] RelationalExpression");x[e]={nextPos:b,result:d};return d}function T(){var e="AdditiveExpression@"+b,h=x[e];if(h)return b=h.nextPos,h.result;h=m;m=!1;var k=b,d=b,f=oa();if(f!==null){for(var g=[],i=b,l=[],n=o();n!==null;)l.push(n),n=o();if(l!==null)if(a.substr(b,1)===
"+"?(n="+",b+=1):(n=null,m&&j('"+"')),n!==null){for(var r=[],s=o();s!==null;)r.push(s),s=o();r!==null?(s=oa(),s!==null?l=[l,n,r,s]:(l=null,b=i)):(l=null,b=i)}else l=null,b=i;else l=null,b=i;if(l!==null)i=l;else{i=b;l=[];for(n=o();n!==null;)l.push(n),n=o();if(l!==null)if(a.substr(b,1)==="-"?(n="-",b+=1):(n=null,m&&j('"-"')),n!==null){r=[];for(s=o();s!==null;)r.push(s),s=o();r!==null?(s=oa(),s!==null?l=[l,n,r,s]:(l=null,b=i)):(l=null,b=i)}else l=null,b=i;else l=null,b=i;if(l!==null)i=l;else{i=b;l=pa();
l===null&&(l=pa(),l=l!==null?l:null);if(l!==null){n=b;r=[];for(s=o();s!==null;)r.push(s),s=o();if(r!==null)if(a.substr(b,1)==="*"?(s="*",b+=1):(s=null,m&&j('"*"')),s!==null){for(var t=[],u=o();u!==null;)t.push(u),u=o();t!==null?(u=Z(),u!==null?r=[r,s,t,u]:(r=null,b=n)):(r=null,b=n)}else r=null,b=n;else r=null,b=n;if(r!==null)n=r;else{n=b;r=[];for(s=o();s!==null;)r.push(s),s=o();if(r!==null)if(a.substr(b,1)==="/"?(s="/",b+=1):(s=null,m&&j('"/"')),s!==null){t=[];for(u=o();u!==null;)t.push(u),u=o();
t!==null?(u=Z(),u!==null?r=[r,s,t,u]:(r=null,b=n)):(r=null,b=n)}else r=null,b=n;else r=null,b=n;n=r!==null?r:null}n=n!==null?n:"";n!==null?l=[l,n]:(l=null,b=i)}else l=null,b=i;i=l!==null?l:null}}for(;i!==null;){g.push(i);i=b;l=[];for(n=o();n!==null;)l.push(n),n=o();if(l!==null)if(a.substr(b,1)==="+"?(n="+",b+=1):(n=null,m&&j('"+"')),n!==null){r=[];for(s=o();s!==null;)r.push(s),s=o();r!==null?(s=oa(),s!==null?l=[l,n,r,s]:(l=null,b=i)):(l=null,b=i)}else l=null,b=i;else l=null,b=i;if(l!==null)i=l;else{i=
b;l=[];for(n=o();n!==null;)l.push(n),n=o();if(l!==null)if(a.substr(b,1)==="-"?(n="-",b+=1):(n=null,m&&j('"-"')),n!==null){r=[];for(s=o();s!==null;)r.push(s),s=o();r!==null?(s=oa(),s!==null?l=[l,n,r,s]:(l=null,b=i)):(l=null,b=i)}else l=null,b=i;else l=null,b=i;if(l!==null)i=l;else{i=b;l=pa();l===null&&(l=pa(),l=l!==null?l:null);if(l!==null){n=b;r=[];for(s=o();s!==null;)r.push(s),s=o();if(r!==null)if(a.substr(b,1)==="*"?(s="*",b+=1):(s=null,m&&j('"*"')),s!==null){t=[];for(u=o();u!==null;)t.push(u),
u=o();t!==null?(u=Z(),u!==null?r=[r,s,t,u]:(r=null,b=n)):(r=null,b=n)}else r=null,b=n;else r=null,b=n;if(r!==null)n=r;else{n=b;r=[];for(s=o();s!==null;)r.push(s),s=o();if(r!==null)if(a.substr(b,1)==="/"?(s="/",b+=1):(s=null,m&&j('"/"')),s!==null){t=[];for(u=o();u!==null;)t.push(u),u=o();t!==null?(u=Z(),u!==null?r=[r,s,t,u]:(r=null,b=n)):(r=null,b=n)}else r=null,b=n;else r=null,b=n;n=r!==null?r:null}n=n!==null?n:"";n!==null?l=[l,n]:(l=null,b=i)}else l=null,b=i;i=l!==null?l:null}}}g!==null?f=[f,g]:
(f=null,b=d)}else f=null,b=d;d=f!==null?function(a,b){if(b.length===0)return a;var d={token:"expression",expressionType:"additiveexpression"};d.summand=a;d.summands=[];for(var c=0;c<b.length;c++){var f=b[c],e={};if(f.length==4&&typeof f[1]==="string")e.operator=f[1],e.expression=f[3];else{var f={},h=e[0],j=e[1][1],i=e[1][3],j=null;h.value<0?(e.operator="-",h.value=-h.value):e.operator="+";f.token="expression";f.expressionType="multiplicativeexpression";f.operator=h;f.factors=[{operator:j,expression:i}];
e.expression=f}d.summands.push(e)}return d}(f[0],f[1]):null;d===null&&(d=null,b=k);(m=h)&&d===null&&j("[101] AdditiveExpression");x[e]={nextPos:b,result:d};return d}function oa(){var e="MultiplicativeExpression@"+b,h=x[e];if(h)return b=h.nextPos,h.result;h=m;m=!1;var i=b,d=b,f=Z();if(f!==null){for(var k=[],g=b,l=[],n=o();n!==null;)l.push(n),n=o();if(l!==null)if(a.substr(b,1)==="*"?(n="*",b+=1):(n=null,m&&j('"*"')),n!==null){for(var r=[],s=o();s!==null;)r.push(s),s=o();r!==null?(s=Z(),s!==null?l=[l,
n,r,s]:(l=null,b=g)):(l=null,b=g)}else l=null,b=g;else l=null,b=g;if(l!==null)g=l;else{g=b;l=[];for(n=o();n!==null;)l.push(n),n=o();if(l!==null)if(a.substr(b,1)==="/"?(n="/",b+=1):(n=null,m&&j('"/"')),n!==null){r=[];for(s=o();s!==null;)r.push(s),s=o();r!==null?(s=Z(),s!==null?l=[l,n,r,s]:(l=null,b=g)):(l=null,b=g)}else l=null,b=g;else l=null,b=g;g=l!==null?l:null}for(;g!==null;){k.push(g);g=b;l=[];for(n=o();n!==null;)l.push(n),n=o();if(l!==null)if(a.substr(b,1)==="*"?(n="*",b+=1):(n=null,m&&j('"*"')),
n!==null){r=[];for(s=o();s!==null;)r.push(s),s=o();r!==null?(s=Z(),s!==null?l=[l,n,r,s]:(l=null,b=g)):(l=null,b=g)}else l=null,b=g;else l=null,b=g;if(l!==null)g=l;else{g=b;l=[];for(n=o();n!==null;)l.push(n),n=o();if(l!==null)if(a.substr(b,1)==="/"?(n="/",b+=1):(n=null,m&&j('"/"')),n!==null){r=[];for(s=o();s!==null;)r.push(s),s=o();r!==null?(s=Z(),s!==null?l=[l,n,r,s]:(l=null,b=g)):(l=null,b=g)}else l=null,b=g;else l=null,b=g;g=l!==null?l:null}}k!==null?f=[f,k]:(f=null,b=d)}else f=null,b=d;d=f!==null?
function(a,b){if(b.length===0)return a;var d={token:"expression",expressionType:"multiplicativeexpression"};d.factor=a;d.factors=[];for(var c=0;c<b.length;c++){var f=b[c],e={};e.operator=f[1];e.expression=f[3];d.factors.push(e)}return d}(f[0],f[1]):null;d===null&&(d=null,b=i);(m=h)&&d===null&&j("[102] MultiplicativeExpression");x[e]={nextPos:b,result:d};return d}function Z(){var e="UnaryExpression@"+b,h=x[e];if(h)return b=h.nextPos,h.result;h=m;m=!1;var i=b,d=b;if(a.substr(b,1)==="!"){var f="!";b+=
1}else f=null,m&&j('"!"');if(f!==null){for(var k=[],g=o();g!==null;)k.push(g),g=o();k!==null?(g=ya(),g!==null?f=[f,k,g]:(f=null,b=d)):(f=null,b=d)}else f=null,b=d;d=f!==null?function(a){var b={token:"expression",expressionType:"unaryexpression",unaryexpression:"!"};b.expression=a;return b}(f[2]):null;d===null&&(d=null,b=i);if(d!==null)i=d;else{d=i=b;a.substr(b,1)==="+"?(f="+",b+=1):(f=null,m&&j('"+"'));if(f!==null){k=[];for(g=o();g!==null;)k.push(g),g=o();k!==null?(g=ya(),g!==null?f=[f,k,g]:(f=null,
b=d)):(f=null,b=d)}else f=null,b=d;d=f!==null?function(a){var b={token:"expression",expressionType:"unaryexpression",unaryexpression:"+"};b.expression=a;return b}(f[2]):null;d===null&&(d=null,b=i);if(d!==null)i=d;else{d=i=b;a.substr(b,1)==="-"?(f="-",b+=1):(f=null,m&&j('"-"'));if(f!==null){k=[];for(g=o();g!==null;)k.push(g),g=o();k!==null?(g=ya(),g!==null?f=[f,k,g]:(f=null,b=d)):(f=null,b=d)}else f=null,b=d;d=f!==null?function(a){var b={token:"expression",expressionType:"unaryexpression",unaryexpression:"-"};
b.expression=a;return b}(f[2]):null;d===null&&(d=null,b=i);d!==null?i=d:(i=ya(),i=i!==null?i:null)}}(m=h)&&i===null&&j("[103] UnaryExpression");x[e]={nextPos:b,result:i};return i}function ya(){var a="PrimaryExpression@"+b,c=x[a];if(c)return b=c.nextPos,c.result;c=m;m=!1;var e=Ca();if(e===null&&(e=Ba(),e===null&&(e=Wb(),e===null))){var e=b,d=Da(),d=d!==null?function(a){var b={token:"expression",expressionType:"atomic",primaryexpression:"rdfliteral"};b.value=a;return b}(d):null;d===null&&(d=null,b=
e);d!==null?e=d:(e=b,d=Ea(),d=d!==null?function(a){var b={token:"expression",expressionType:"atomic",primaryexpression:"numericliteral"};b.value=a;return b}(d):null,d===null&&(d=null,b=e),d!==null?e=d:(e=b,d=Fa(),d=d!==null?function(a){var b={token:"expression",expressionType:"atomic",primaryexpression:"booleanliteral"};b.value=a;return b}(d):null,d===null&&(d=null,b=e),d!==null?e=d:(e=Xb(),e===null&&(e=b,d=P(),d=d!==null?function(a){var b={token:"expression",expressionType:"atomic",primaryexpression:"var"};
b.value=a;return b}(d):null,d===null&&(d=null,b=e),e=d!==null?d:null))))}(m=c)&&e===null&&j("[104] PrimaryExpression");x[a]={nextPos:b,result:e};return e}function Ca(){var e="BrackettedExpression@"+b,h=x[e];if(h)return b=h.nextPos,h.result;h=m;m=!1;var g=b,d=b;if(a.substr(b,1)==="("){var f="(";b+=1}else f=null,m&&j('"("');if(f!==null){for(var i=[],k=o();k!==null;)i.push(k),k=o();if(i!==null)if(k=M(),k!==null){for(var l=[],n=o();n!==null;)l.push(n),n=o();l!==null?(a.substr(b,1)===")"?(n=")",b+=1):
(n=null,m&&j('")"')),n!==null?f=[f,i,k,l,n]:(f=null,b=d)):(f=null,b=d)}else f=null,b=d;else f=null,b=d}else f=null,b=d;d=f!==null?f[2]:null;d===null&&(d=null,b=g);(m=h)&&d===null&&j("[105] BrackettedExpression");x[e]={nextPos:b,result:d};return d}function Ba(){var e="BuiltInCall@"+b,h=x[e];if(h)return b=h.nextPos,h.result;h=m;m=!1;var g=b,d=b;if(a.substr(b,3)==="STR"){var f="STR";b+=3}else f=null,m&&j('"STR"');f===null&&(a.substr(b,3)==="str"?(f="str",b+=3):(f=null,m&&j('"str"')),f=f!==null?f:null);
if(f!==null){for(var i=[],k=o();k!==null;)i.push(k),k=o();if(i!==null)if(a.substr(b,1)==="("?(k="(",b+=1):(k=null,m&&j('"("')),k!==null){for(var l=[],n=o();n!==null;)l.push(n),n=o();if(l!==null)if(n=M(),n!==null){for(var r=[],s=o();s!==null;)r.push(s),s=o();r!==null?(a.substr(b,1)===")"?(s=")",b+=1):(s=null,m&&j('")"')),s!==null?f=[f,i,k,l,n,r,s]:(f=null,b=d)):(f=null,b=d)}else f=null,b=d;else f=null,b=d}else f=null,b=d;else f=null,b=d}else f=null,b=d;d=f!==null?function(a){var b={token:"expression",
expressionType:"builtincall",builtincall:"str"};b.args=[a];return b}(f[4]):null;d===null&&(d=null,b=g);if(d!==null)g=d;else{d=g=b;a.substr(b,4)==="LANG"?(f="LANG",b+=4):(f=null,m&&j('"LANG"'));f===null&&(a.substr(b,4)==="lang"?(f="lang",b+=4):(f=null,m&&j('"lang"')),f=f!==null?f:null);if(f!==null){i=[];for(k=o();k!==null;)i.push(k),k=o();if(i!==null)if(a.substr(b,1)==="("?(k="(",b+=1):(k=null,m&&j('"("')),k!==null){l=[];for(n=o();n!==null;)l.push(n),n=o();if(l!==null)if(n=M(),n!==null){r=[];for(s=
o();s!==null;)r.push(s),s=o();r!==null?(a.substr(b,1)===")"?(s=")",b+=1):(s=null,m&&j('")"')),s!==null?f=[f,i,k,l,n,r,s]:(f=null,b=d)):(f=null,b=d)}else f=null,b=d;else f=null,b=d}else f=null,b=d;else f=null,b=d}else f=null,b=d;d=f!==null?function(a){var b={token:"expression",expressionType:"builtincall",builtincall:"lang"};b.args=[a];return b}(f[4]):null;d===null&&(d=null,b=g);if(d!==null)g=d;else{d=g=b;a.substr(b,11)==="LANGMATCHES"?(f="LANGMATCHES",b+=11):(f=null,m&&j('"LANGMATCHES"'));if(f!==
null){i=[];for(k=o();k!==null;)i.push(k),k=o();if(i!==null)if(a.substr(b,1)==="("?(k="(",b+=1):(k=null,m&&j('"("')),k!==null){l=[];for(n=o();n!==null;)l.push(n),n=o();if(l!==null)if(n=M(),n!==null){r=[];for(s=o();s!==null;)r.push(s),s=o();if(r!==null)if(a.substr(b,1)===","?(s=",",b+=1):(s=null,m&&j('","')),s!==null){for(var t=[],u=o();u!==null;)t.push(u),u=o();if(t!==null)if(u=M(),u!==null){for(var w=[],y=o();y!==null;)w.push(y),y=o();w!==null?(a.substr(b,1)===")"?(y=")",b+=1):(y=null,m&&j('")"')),
y!==null?f=[f,i,k,l,n,r,s,t,u,w,y]:(f=null,b=d)):(f=null,b=d)}else f=null,b=d;else f=null,b=d}else f=null,b=d;else f=null,b=d}else f=null,b=d;else f=null,b=d}else f=null,b=d;else f=null,b=d}else f=null,b=d;d=f!==null?function(a,b){var d={token:"expression",expressionType:"builtincall",builtincall:"langmatches"};d.args=[a,b];return d}(f[4],f[8]):null;d===null&&(d=null,b=g);if(d!==null)g=d;else{d=g=b;a.substr(b,8)==="DATATYPE"?(f="DATATYPE",b+=8):(f=null,m&&j('"DATATYPE"'));f===null&&(a.substr(b,8)===
"datatype"?(f="datatype",b+=8):(f=null,m&&j('"datatype"')),f=f!==null?f:null);if(f!==null){i=[];for(k=o();k!==null;)i.push(k),k=o();if(i!==null)if(a.substr(b,1)==="("?(k="(",b+=1):(k=null,m&&j('"("')),k!==null){l=[];for(n=o();n!==null;)l.push(n),n=o();if(l!==null)if(n=M(),n!==null){r=[];for(s=o();s!==null;)r.push(s),s=o();r!==null?(a.substr(b,1)===")"?(s=")",b+=1):(s=null,m&&j('")"')),s!==null?f=[f,i,k,l,n,r,s]:(f=null,b=d)):(f=null,b=d)}else f=null,b=d;else f=null,b=d}else f=null,b=d;else f=null,
b=d}else f=null,b=d;d=f!==null?function(a){var b={token:"expression",expressionType:"builtincall",builtincall:"datatype"};b.args=[a];return b}(f[4]):null;d===null&&(d=null,b=g);if(d!==null)g=d;else{d=g=b;a.substr(b,5)==="BOUND"?(f="BOUND",b+=5):(f=null,m&&j('"BOUND"'));if(f!==null){i=[];for(k=o();k!==null;)i.push(k),k=o();if(i!==null)if(a.substr(b,1)==="("?(k="(",b+=1):(k=null,m&&j('"("')),k!==null){l=[];for(n=o();n!==null;)l.push(n),n=o();if(l!==null)if(n=P(),n!==null){r=[];for(s=o();s!==null;)r.push(s),
s=o();r!==null?(a.substr(b,1)===")"?(s=")",b+=1):(s=null,m&&j('")"')),s!==null?f=[f,i,k,l,n,r,s]:(f=null,b=d)):(f=null,b=d)}else f=null,b=d;else f=null,b=d}else f=null,b=d;else f=null,b=d}else f=null,b=d;d=f!==null?function(a){var b={token:"expression",expressionType:"builtincall",builtincall:"bound"};b.args=[a];return b}(f[4]):null;d===null&&(d=null,b=g);if(d!==null)g=d;else{d=g=b;a.substr(b,3)==="IRI"?(f="IRI",b+=3):(f=null,m&&j('"IRI"'));if(f!==null){i=[];for(k=o();k!==null;)i.push(k),k=o();if(i!==
null)if(a.substr(b,1)==="("?(k="(",b+=1):(k=null,m&&j('"("')),k!==null){l=[];for(n=o();n!==null;)l.push(n),n=o();if(l!==null)if(n=M(),n!==null){r=[];for(s=o();s!==null;)r.push(s),s=o();r!==null?(a.substr(b,1)===")"?(s=")",b+=1):(s=null,m&&j('")"')),s!==null?f=[f,i,k,l,n,r,s]:(f=null,b=d)):(f=null,b=d)}else f=null,b=d;else f=null,b=d}else f=null,b=d;else f=null,b=d}else f=null,b=d;d=f!==null?function(a){var b={token:"expression",expressionType:"builtincall",builtincall:"iri"};b.args=[a];return b}(f[4]):
null;d===null&&(d=null,b=g);if(d!==null)g=d;else{d=g=b;a.substr(b,3)==="URI"?(f="URI",b+=3):(f=null,m&&j('"URI"'));if(f!==null){i=[];for(k=o();k!==null;)i.push(k),k=o();if(i!==null)if(a.substr(b,1)==="("?(k="(",b+=1):(k=null,m&&j('"("')),k!==null){l=[];for(n=o();n!==null;)l.push(n),n=o();if(l!==null)if(n=M(),n!==null){r=[];for(s=o();s!==null;)r.push(s),s=o();r!==null?(a.substr(b,1)===")"?(s=")",b+=1):(s=null,m&&j('")"')),s!==null?f=[f,i,k,l,n,r,s]:(f=null,b=d)):(f=null,b=d)}else f=null,b=d;else f=
null,b=d}else f=null,b=d;else f=null,b=d}else f=null,b=d;d=f!==null?function(a){var b={token:"expression",expressionType:"builtincall",builtincall:"uri"};b.args=[a];return b}(f[4]):null;d===null&&(d=null,b=g);if(d!==null)g=d;else{d=g=b;a.substr(b,5)==="BNODE"?(f="BNODE",b+=5):(f=null,m&&j('"BNODE"'));if(f!==null){i=[];for(k=o();k!==null;)i.push(k),k=o();if(i!==null){k=b;a.substr(b,1)==="("?(l="(",b+=1):(l=null,m&&j('"("'));if(l!==null){n=[];for(r=o();r!==null;)n.push(r),r=o();if(n!==null)if(r=M(),
r!==null){s=[];for(t=o();t!==null;)s.push(t),t=o();s!==null?(a.substr(b,1)===")"?(t=")",b+=1):(t=null,m&&j('")"')),t!==null?l=[l,n,r,s,t]:(l=null,b=k)):(l=null,b=k)}else l=null,b=k;else l=null,b=k}else l=null,b=k;l!==null?k=l:(k=ia(),k=k!==null?k:null);k!==null?f=[f,i,k]:(f=null,b=d)}else f=null,b=d}else f=null,b=d;d=f!==null?function(a){var b={token:"expression",expressionType:"builtincall",builtincall:"bnode"};b.args=a.length===5?[a[2]]:null;return b}(f[2]):null;d===null&&(d=null,b=g);if(d!==null)g=
d;else{d=g=b;a.substr(b,8)==="COALESCE"?(f="COALESCE",b+=8):(f=null,m&&j('"COALESCE"'));if(f!==null){i=[];for(k=o();k!==null;)i.push(k),k=o();i!==null?(k=Jb(),k!==null?f=[f,i,k]:(f=null,b=d)):(f=null,b=d)}else f=null,b=d;d=f!==null?function(a){var b={token:"expression",expressionType:"builtincall",builtincall:"coalesce"};b.args=a;return b}(f[2]):null;d===null&&(d=null,b=g);if(d!==null)g=d;else{d=g=b;a.substr(b,2)==="IF"?(f="IF",b+=2):(f=null,m&&j('"IF"'));if(f!==null){i=[];for(k=o();k!==null;)i.push(k),
k=o();if(i!==null)if(a.substr(b,1)==="("?(k="(",b+=1):(k=null,m&&j('"("')),k!==null){l=[];for(n=o();n!==null;)l.push(n),n=o();if(l!==null)if(n=M(),n!==null){r=[];for(s=o();s!==null;)r.push(s),s=o();if(r!==null)if(a.substr(b,1)===","?(s=",",b+=1):(s=null,m&&j('","')),s!==null){t=[];for(u=o();u!==null;)t.push(u),u=o();if(t!==null)if(u=M(),u!==null){w=[];for(y=o();y!==null;)w.push(y),y=o();if(w!==null)if(a.substr(b,1)===","?(y=",",b+=1):(y=null,m&&j('","')),y!==null){for(var D=[],A=o();A!==null;)D.push(A),
A=o();if(D!==null)if(A=M(),A!==null){for(var N=[],F=o();F!==null;)N.push(F),F=o();N!==null?(a.substr(b,1)===")"?(F=")",b+=1):(F=null,m&&j('")"')),F!==null?f=[f,i,k,l,n,r,s,t,u,w,y,D,A,N,F]:(f=null,b=d)):(f=null,b=d)}else f=null,b=d;else f=null,b=d}else f=null,b=d;else f=null,b=d}else f=null,b=d;else f=null,b=d}else f=null,b=d;else f=null,b=d}else f=null,b=d;else f=null,b=d}else f=null,b=d;else f=null,b=d}else f=null,b=d;d=f!==null?function(a,b,d){var c={token:"expression",expressionType:"builtincall",
builtincall:"if"};c.args=[a,b,d];return c}(f[4],f[8],f[12]):null;d===null&&(d=null,b=g);if(d!==null)g=d;else{d=g=b;a.substr(b,9)==="ISLITERAL"?(f="ISLITERAL",b+=9):(f=null,m&&j('"ISLITERAL"'));if(f!==null){i=[];for(k=o();k!==null;)i.push(k),k=o();if(i!==null)if(a.substr(b,1)==="("?(k="(",b+=1):(k=null,m&&j('"("')),k!==null){l=[];for(n=o();n!==null;)l.push(n),n=o();if(l!==null)if(n=M(),n!==null){r=[];for(s=o();s!==null;)r.push(s),s=o();r!==null?(a.substr(b,1)===")"?(s=")",b+=1):(s=null,m&&j('")"')),
s!==null?f=[f,i,k,l,n,r,s]:(f=null,b=d)):(f=null,b=d)}else f=null,b=d;else f=null,b=d}else f=null,b=d;else f=null,b=d}else f=null,b=d;d=f!==null?function(a){var b={token:"expression",expressionType:"builtincall",builtincall:"isliteral"};b.args=[a];return b}(f[4]):null;d===null&&(d=null,b=g);if(d!==null)g=d;else{d=g=b;a.substr(b,7)==="ISBLANK"?(f="ISBLANK",b+=7):(f=null,m&&j('"ISBLANK"'));if(f!==null){i=[];for(k=o();k!==null;)i.push(k),k=o();if(i!==null)if(a.substr(b,1)==="("?(k="(",b+=1):(k=null,
m&&j('"("')),k!==null){l=[];for(n=o();n!==null;)l.push(n),n=o();if(l!==null)if(n=M(),n!==null){r=[];for(s=o();s!==null;)r.push(s),s=o();r!==null?(a.substr(b,1)===")"?(s=")",b+=1):(s=null,m&&j('")"')),s!==null?f=[f,i,k,l,n,r,s]:(f=null,b=d)):(f=null,b=d)}else f=null,b=d;else f=null,b=d}else f=null,b=d;else f=null,b=d}else f=null,b=d;d=f!==null?function(a){var b={token:"expression",expressionType:"builtincall",builtincall:"isblank"};b.args=[a];return b}(f[4]):null;d===null&&(d=null,b=g);if(d!==null)g=
d;else{d=g=b;a.substr(b,8)==="SAMETERM"?(f="SAMETERM",b+=8):(f=null,m&&j('"SAMETERM"'));if(f!==null){i=[];for(k=o();k!==null;)i.push(k),k=o();if(i!==null)if(a.substr(b,1)==="("?(k="(",b+=1):(k=null,m&&j('"("')),k!==null){l=[];for(n=o();n!==null;)l.push(n),n=o();if(l!==null)if(n=M(),n!==null){r=[];for(s=o();s!==null;)r.push(s),s=o();if(r!==null)if(a.substr(b,1)===","?(s=",",b+=1):(s=null,m&&j('","')),s!==null){t=[];for(u=o();u!==null;)t.push(u),u=o();if(t!==null)if(u=M(),u!==null){w=[];for(y=o();y!==
null;)w.push(y),y=o();w!==null?(a.substr(b,1)===")"?(y=")",b+=1):(y=null,m&&j('")"')),y!==null?f=[f,i,k,l,n,r,s,t,u,w,y]:(f=null,b=d)):(f=null,b=d)}else f=null,b=d;else f=null,b=d}else f=null,b=d;else f=null,b=d}else f=null,b=d;else f=null,b=d}else f=null,b=d;else f=null,b=d}else f=null,b=d;d=f!==null?function(a,b){var d={token:"expression",expressionType:"builtincall",builtincall:"sameterm"};d.args=[a,b];return d}(f[4],f[8]):null;d===null&&(d=null,b=g);if(d!==null)g=d;else{d=g=b;a.substr(b,5)===
"ISURI"?(f="ISURI",b+=5):(f=null,m&&j('"ISURI"'));f===null&&(a.substr(b,5)==="isuri"?(f="isuri",b+=5):(f=null,m&&j('"isuri"')),f===null&&(a.substr(b,5)==="ISIRI"?(f="ISIRI",b+=5):(f=null,m&&j('"ISIRI"')),f===null&&(a.substr(b,5)==="isiri"?(f="isiri",b+=5):(f=null,m&&j('"isiri"')),f=f!==null?f:null)));if(f!==null){i=[];for(k=o();k!==null;)i.push(k),k=o();if(i!==null)if(a.substr(b,1)==="("?(k="(",b+=1):(k=null,m&&j('"("')),k!==null){l=[];for(n=o();n!==null;)l.push(n),n=o();if(l!==null)if(n=M(),n!==
null){r=[];for(s=o();s!==null;)r.push(s),s=o();r!==null?(a.substr(b,1)===")"?(s=")",b+=1):(s=null,m&&j('")"')),s!==null?f=[f,i,k,l,n,r,s]:(f=null,b=d)):(f=null,b=d)}else f=null,b=d;else f=null,b=d}else f=null,b=d;else f=null,b=d}else f=null,b=d;d=f!==null?function(a){var b={token:"expression",expressionType:"builtincall",builtincall:"isuri"};b.args=[a];return b}(f[4]):null;d===null&&(d=null,b=g);d!==null?g=d:(g=Yb(),g===null&&(g=Zb(),g===null&&(g=$b(),g=g!==null?g:null)))}}}}}}}}}}}}}(m=h)&&g===null&&
j("[106] BuiltInCall");x[e]={nextPos:b,result:g};return g}function Yb(){var e="RegexExpression@"+b,h=x[e];if(h)return b=h.nextPos,h.result;h=m;m=!1;var k=b,d=b;if(a.substr(b,5)==="REGEX"){var f="REGEX";b+=5}else f=null,m&&j('"REGEX"');f===null&&(a.substr(b,5)==="regex"?(f="regex",b+=5):(f=null,m&&j('"regex"')),f=f!==null?f:null);if(f!==null){for(var i=[],g=o();g!==null;)i.push(g),g=o();if(i!==null)if(a.substr(b,1)==="("?(g="(",b+=1):(g=null,m&&j('"("')),g!==null){for(var l=[],n=o();n!==null;)l.push(n),
n=o();if(l!==null)if(n=M(),n!==null){for(var r=[],s=o();s!==null;)r.push(s),s=o();if(r!==null)if(a.substr(b,1)===","?(s=",",b+=1):(s=null,m&&j('","')),s!==null){for(var t=[],u=o();u!==null;)t.push(u),u=o();if(t!==null)if(u=M(),u!==null){for(var w=[],y=o();y!==null;)w.push(y),y=o();if(w!==null){y=b;if(a.substr(b,1)===","){var D=",";b+=1}else D=null,m&&j('","');if(D!==null){for(var A=[],N=o();N!==null;)A.push(N),N=o();A!==null?(N=M(),N!==null?D=[D,A,N]:(D=null,b=y)):(D=null,b=y)}else D=null,b=y;y=D!==
null?D:"";if(y!==null){D=[];for(A=o();A!==null;)D.push(A),A=o();D!==null?(a.substr(b,1)===")"?(A=")",b+=1):(A=null,m&&j('")"')),A!==null?f=[f,i,g,l,n,r,s,t,u,w,y,D,A]:(f=null,b=d)):(f=null,b=d)}else f=null,b=d}else f=null,b=d}else f=null,b=d;else f=null,b=d}else f=null,b=d;else f=null,b=d}else f=null,b=d;else f=null,b=d}else f=null,b=d;else f=null,b=d}else f=null,b=d;d=f!==null?function(a,b,d){var c={token:"expression",expressionType:"regex"};c.text=a;c.pattern=b;c.flags=d[2];return c}(f[4],f[8],
f[10]):null;d===null&&(d=null,b=k);(m=h)&&d===null&&j("[107] RegexExpression");x[e]={nextPos:b,result:d};return d}function Zb(){var e="ExistsFunc@"+b,h=x[e];if(h)return b=h.nextPos,h.result;h=m;m=!1;var k=b,d=b;if(a.substr(b,6)==="EXISTS"){var f="EXISTS";b+=6}else f=null,m&&j('"EXISTS"');f===null&&(a.substr(b,6)==="exists"?(f="exists",b+=6):(f=null,m&&j('"exists"')),f=f!==null?f:null);if(f!==null){for(var g=[],i=o();i!==null;)g.push(i),i=o();g!==null?(i=V(),i!==null?f=[f,g,i]:(f=null,b=d)):(f=null,
b=d)}else f=null,b=d;d=f!==null?function(a){var b={token:"expression",expressionType:"builtincall",builtincall:"exists"};b.args=[a];return b}(f[2]):null;d===null&&(d=null,b=k);(m=h)&&d===null&&j("[108] ExistsFunc");x[e]={nextPos:b,result:d};return d}function $b(){var e="NotExistsFunc@"+b,h=x[e];if(h)return b=h.nextPos,h.result;h=m;m=!1;var k=b,d=b;if(a.substr(b,3)==="NOT"){var f="NOT";b+=3}else f=null,m&&j('"NOT"');f===null&&(a.substr(b,3)==="not"?(f="not",b+=3):(f=null,m&&j('"not"')),f=f!==null?
f:null);if(f!==null){for(var i=[],g=o();g!==null;)i.push(g),g=o();if(i!==null)if(a.substr(b,6)==="EXISTS"?(g="EXISTS",b+=6):(g=null,m&&j('"EXISTS"')),g===null&&(a.substr(b,6)==="exists"?(g="exists",b+=6):(g=null,m&&j('"exists"')),g=g!==null?g:null),g!==null){for(var l=[],n=o();n!==null;)l.push(n),n=o();l!==null?(n=V(),n!==null?f=[f,i,g,l,n]:(f=null,b=d)):(f=null,b=d)}else f=null,b=d;else f=null,b=d}else f=null,b=d;d=f!==null?function(a){var b={token:"expression",expressionType:"builtincall",builtincall:"notexists"};
b.args=[a];return b}(f[4]):null;d===null&&(d=null,b=k);(m=h)&&d===null&&j("[109] NotExistsFunc");x[e]={nextPos:b,result:d};return d}function Xb(){var e="Aggregate@"+b,h=x[e];if(h)return b=h.nextPos,h.result;h=m;m=!1;var k=b,d=b;if(a.substr(b,5)==="COUNT"){var f="COUNT";b+=5}else f=null,m&&j('"COUNT"');f===null&&(a.substr(b,5)==="count"?(f="count",b+=5):(f=null,m&&j('"count"')),f=f!==null?f:null);if(f!==null){for(var g=[],i=o();i!==null;)g.push(i),i=o();if(g!==null)if(a.substr(b,1)==="("?(i="(",b+=
1):(i=null,m&&j('"("')),i!==null){for(var l=[],n=o();n!==null;)l.push(n),n=o();if(l!==null)if(a.substr(b,8)==="DISTINCT"?(n="DISTINCT",b+=8):(n=null,m&&j('"DISTINCT"')),n===null&&(a.substr(b,8)==="distinct"?(n="distinct",b+=8):(n=null,m&&j('"distinct"')),n=n!==null?n:null),n=n!==null?n:"",n!==null){for(var r=[],s=o();s!==null;)r.push(s),s=o();if(r!==null)if(a.substr(b,1)==="*"?(s="*",b+=1):(s=null,m&&j('"*"')),s===null&&(s=M(),s=s!==null?s:null),s!==null){for(var t=[],u=o();u!==null;)t.push(u),u=
o();if(t!==null)if(a.substr(b,1)===")"?(u=")",b+=1):(u=null,m&&j('")"')),u!==null){for(var w=[],y=o();y!==null;)w.push(y),y=o();w!==null?f=[f,g,i,l,n,r,s,t,u,w]:(f=null,b=d)}else f=null,b=d;else f=null,b=d}else f=null,b=d;else f=null,b=d}else f=null,b=d;else f=null,b=d}else f=null,b=d;else f=null,b=d}else f=null,b=d;d=f!==null?function(a,b){var d={token:"expression",expressionType:"aggregate",aggregateType:"count"};d.distinct=a!=""?"DISTINCT":a;d.expression=b;return d}(f[4],f[6]):null;d===null&&(d=
null,b=k);if(d!==null)k=d;else{d=k=b;a.substr(b,3)==="SUM"?(f="SUM",b+=3):(f=null,m&&j('"SUM"'));f===null&&(a.substr(b,3)==="sum"?(f="sum",b+=3):(f=null,m&&j('"sum"')),f=f!==null?f:null);if(f!==null){g=[];for(i=o();i!==null;)g.push(i),i=o();if(g!==null)if(a.substr(b,1)==="("?(i="(",b+=1):(i=null,m&&j('"("')),i!==null){l=[];for(n=o();n!==null;)l.push(n),n=o();if(l!==null)if(a.substr(b,8)==="DISTINCT"?(n="DISTINCT",b+=8):(n=null,m&&j('"DISTINCT"')),n===null&&(a.substr(b,8)==="distinct"?(n="distinct",
b+=8):(n=null,m&&j('"distinct"')),n=n!==null?n:null),n=n!==null?n:"",n!==null){r=[];for(s=o();s!==null;)r.push(s),s=o();if(r!==null)if(s=M(),s!==null){t=[];for(u=o();u!==null;)t.push(u),u=o();if(t!==null)if(a.substr(b,1)===")"?(u=")",b+=1):(u=null,m&&j('")"')),u!==null){w=[];for(y=o();y!==null;)w.push(y),y=o();w!==null?f=[f,g,i,l,n,r,s,t,u,w]:(f=null,b=d)}else f=null,b=d;else f=null,b=d}else f=null,b=d;else f=null,b=d}else f=null,b=d;else f=null,b=d}else f=null,b=d;else f=null,b=d}else f=null,b=d;
d=f!==null?function(a,b){var d={token:"expression",expressionType:"aggregate",aggregateType:"sum"};d.distinct=a!=""?"DISTINCT":a;d.expression=b;return d}(f[4],f[6]):null;d===null&&(d=null,b=k);if(d!==null)k=d;else{d=k=b;a.substr(b,3)==="MIN"?(f="MIN",b+=3):(f=null,m&&j('"MIN"'));f===null&&(a.substr(b,3)==="min"?(f="min",b+=3):(f=null,m&&j('"min"')),f=f!==null?f:null);if(f!==null){g=[];for(i=o();i!==null;)g.push(i),i=o();if(g!==null)if(a.substr(b,1)==="("?(i="(",b+=1):(i=null,m&&j('"("')),i!==null){l=
[];for(n=o();n!==null;)l.push(n),n=o();if(l!==null)if(a.substr(b,8)==="DISTINCT"?(n="DISTINCT",b+=8):(n=null,m&&j('"DISTINCT"')),n===null&&(a.substr(b,8)==="distinct"?(n="distinct",b+=8):(n=null,m&&j('"distinct"')),n=n!==null?n:null),n=n!==null?n:"",n!==null){r=[];for(s=o();s!==null;)r.push(s),s=o();if(r!==null)if(s=M(),s!==null){t=[];for(u=o();u!==null;)t.push(u),u=o();if(t!==null)if(a.substr(b,1)===")"?(u=")",b+=1):(u=null,m&&j('")"')),u!==null){w=[];for(y=o();y!==null;)w.push(y),y=o();w!==null?
f=[f,g,i,l,n,r,s,t,u,w]:(f=null,b=d)}else f=null,b=d;else f=null,b=d}else f=null,b=d;else f=null,b=d}else f=null,b=d;else f=null,b=d}else f=null,b=d;else f=null,b=d}else f=null,b=d;d=f!==null?function(a,b){var d={token:"expression",expressionType:"aggregate",aggregateType:"min"};d.distinct=a!=""?"DISTINCT":a;d.expression=b;return d}(f[4],f[6]):null;d===null&&(d=null,b=k);if(d!==null)k=d;else{d=k=b;a.substr(b,3)==="MAX"?(f="MAX",b+=3):(f=null,m&&j('"MAX"'));f===null&&(a.substr(b,3)==="max"?(f="max",
b+=3):(f=null,m&&j('"max"')),f=f!==null?f:null);if(f!==null){g=[];for(i=o();i!==null;)g.push(i),i=o();if(g!==null)if(a.substr(b,1)==="("?(i="(",b+=1):(i=null,m&&j('"("')),i!==null){l=[];for(n=o();n!==null;)l.push(n),n=o();if(l!==null)if(a.substr(b,8)==="DISTINCT"?(n="DISTINCT",b+=8):(n=null,m&&j('"DISTINCT"')),n===null&&(a.substr(b,8)==="distinct"?(n="distinct",b+=8):(n=null,m&&j('"distinct"')),n=n!==null?n:null),n=n!==null?n:"",n!==null){r=[];for(s=o();s!==null;)r.push(s),s=o();if(r!==null)if(s=
M(),s!==null){t=[];for(u=o();u!==null;)t.push(u),u=o();if(t!==null)if(a.substr(b,1)===")"?(u=")",b+=1):(u=null,m&&j('")"')),u!==null){w=[];for(y=o();y!==null;)w.push(y),y=o();w!==null?f=[f,g,i,l,n,r,s,t,u,w]:(f=null,b=d)}else f=null,b=d;else f=null,b=d}else f=null,b=d;else f=null,b=d}else f=null,b=d;else f=null,b=d}else f=null,b=d;else f=null,b=d}else f=null,b=d;d=f!==null?function(a,b){var d={token:"expression",expressionType:"aggregate",aggregateType:"max"};d.distinct=a!=""?"DISTINCT":a;d.expression=
b;return d}(f[4],f[6]):null;d===null&&(d=null,b=k);if(d!==null)k=d;else{d=k=b;a.substr(b,3)==="AVG"?(f="AVG",b+=3):(f=null,m&&j('"AVG"'));f===null&&(a.substr(b,3)==="avg"?(f="avg",b+=3):(f=null,m&&j('"avg"')),f=f!==null?f:null);if(f!==null){g=[];for(i=o();i!==null;)g.push(i),i=o();if(g!==null)if(a.substr(b,1)==="("?(i="(",b+=1):(i=null,m&&j('"("')),i!==null){l=[];for(n=o();n!==null;)l.push(n),n=o();if(l!==null)if(a.substr(b,8)==="DISTINCT"?(n="DISTINCT",b+=8):(n=null,m&&j('"DISTINCT"')),n===null&&
(a.substr(b,8)==="distinct"?(n="distinct",b+=8):(n=null,m&&j('"distinct"')),n=n!==null?n:null),n=n!==null?n:"",n!==null){r=[];for(s=o();s!==null;)r.push(s),s=o();if(r!==null)if(s=M(),s!==null){t=[];for(u=o();u!==null;)t.push(u),u=o();if(t!==null)if(a.substr(b,1)===")"?(u=")",b+=1):(u=null,m&&j('")"')),u!==null){w=[];for(y=o();y!==null;)w.push(y),y=o();w!==null?f=[f,g,i,l,n,r,s,t,u,w]:(f=null,b=d)}else f=null,b=d;else f=null,b=d}else f=null,b=d;else f=null,b=d}else f=null,b=d;else f=null,b=d}else f=
null,b=d;else f=null,b=d}else f=null,b=d;d=f!==null?function(a,b){var d={token:"expression",expressionType:"aggregate",aggregateType:"avg"};d.distinct=a!=""?"DISTINCT":a;d.expression=b;return d}(f[4],f[6]):null;d===null&&(d=null,b=k);k=d!==null?d:null}}}}(m=h)&&k===null&&j("[110] Aggregate");x[e]={nextPos:b,result:k};return k}function Wb(){var a="IRIrefOrFunction@"+b,c=x[a];if(c)return b=c.nextPos,c.result;c=m;m=!1;var e=b,d=b,f=Q();if(f!==null){var h=hb(),h=h!==null?h:"";h!==null?f=[f,h]:(f=null,
b=d)}else f=null,b=d;d=f!==null?function(a,b){var d={token:"expression",expressionType:"irireforfunction"};d.iriref=a;d.args=b.value;return d}(f[0],f[1]):null;d===null&&(d=null,b=e);(m=c)&&d===null&&j("[117] IRIrefOrFunction");x[a]={nextPos:b,result:d};return d}function Da(){var e="RDFLiteral@"+b,h=x[e];if(h)return b=h.nextPos,h.result;h=m;m=!1;var k=b,d=b,f=ac();if(f!==null){var i=bc();if(i===null){i=b;if(a.substr(b,2)==="^^"){var g="^^";b+=2}else g=null,m&&j('"^^"');if(g!==null){var l=Q();l!==null?
g=[g,l]:(g=null,b=i)}else g=null,b=i;i=g!==null?g:null}i=i!==null?i:"";i!==null?f=[f,i]:(f=null,b=d)}else f=null,b=d;d=f!==null?function(a,b){return typeof b==="string"&&b.length>0?{token:"literal",value:a.value,lang:b.slice(1),type:null}:typeof b==="object"?(b.shift(),{token:"literal",value:a.value,lang:null,type:b[0]}):{token:"literal",value:a.value,lang:null,type:null}}(f[0],f[1]):null;d===null&&(d=null,b=k);(m=h)&&d===null&&j("[112] RDFLiteral");x[e]={nextPos:b,result:d};return d}function Ea(){var a=
"NumericLiteral@"+b,c=x[a];if(c)return b=c.nextPos,c.result;c=m;m=!1;var e=cc();e===null&&(e=dc(),e===null&&(e=pa(),e=e!==null?e:null));(m=c)&&e===null&&j("[113] NumericLiteral");x[a]={nextPos:b,result:e};return e}function cc(){var a="NumericLiteralUnsigned@"+b,c=x[a];if(c)return b=c.nextPos,c.result;c=m;m=!1;var e=Pa();e===null&&(e=Qa(),e===null&&(e=ba(),e=e!==null?e:null));(m=c)&&e===null&&j("[114] NumericLiteralUnsigned");x[a]={nextPos:b,result:e};return e}function dc(){var a="NumericLiteralPositive@"+
b,c=x[a];if(c)return b=c.nextPos,c.result;c=m;m=!1;var e=ec();e===null&&(e=fc(),e===null&&(e=gc(),e=e!==null?e:null));(m=c)&&e===null&&j("[115] NumericLiteralPositive");x[a]={nextPos:b,result:e};return e}function pa(){var a="NumericLiteralNegative@"+b,c=x[a];if(c)return b=c.nextPos,c.result;c=m;m=!1;var e=hc();e===null&&(e=ic(),e===null&&(e=jc(),e=e!==null?e:null));(m=c)&&e===null&&j("[116] NumericLiteralNegative");x[a]={nextPos:b,result:e};return e}function Fa(){var e="BooleanLiteral@"+b,h=x[e];
if(h)return b=h.nextPos,h.result;h=m;m=!1;var k=b;if(a.substr(b,4)==="TRUE"){var d="TRUE";b+=4}else d=null,m&&j('"TRUE"');d===null&&(a.substr(b,4)==="true"?(d="true",b+=4):(d=null,m&&j('"true"')),d=d!==null?d:null);d=d!==null?{token:"literal",lang:null,type:"http://www.w3.org/2001/XMLSchema#boolean",value:!0}:null;d===null&&(d=null,b=k);d!==null?k=d:(k=b,a.substr(b,5)==="FALSE"?(d="FALSE",b+=5):(d=null,m&&j('"FALSE"')),d===null&&(a.substr(b,5)==="false"?(d="false",b+=5):(d=null,m&&j('"false"')),d=
d!==null?d:null),d=d!==null?{token:"literal",lang:null,type:"http://www.w3.org/2001/XMLSchema#boolean",value:!1}:null,d===null&&(d=null,b=k),k=d!==null?d:null);(m=h)&&k===null&&j("[117] BooleanLiteral");x[e]={nextPos:b,result:k};return k}function ac(){var a="String@"+b,c=x[a];if(c)return b=c.nextPos,c.result;c=m;m=!1;var e=b,d=kc(),d=d!==null?{token:"string",value:d}:null;d===null&&(d=null,b=e);d!==null?e=d:(e=b,d=lc(),d=d!==null?{token:"string",value:d}:null,d===null&&(d=null,b=e),d!==null?e=d:(e=
b,d=mc(),d=d!==null?{token:"string",value:d}:null,d===null&&(d=null,b=e),d!==null?e=d:(e=b,d=nc(),d=d!==null?{token:"string",value:d}:null,d===null&&(d=null,b=e),e=d!==null?d:null)));(m=c)&&e===null&&j("[118] String");x[a]={nextPos:b,result:e};return e}function Q(){var a="IRIref@"+b,c=x[a];if(c)return b=c.nextPos,c.result;c=m;m=!1;var e=b,d=ka(),d=d!==null?{token:"uri",prefix:null,suffix:null,value:d}:null;d===null&&(d=null,b=e);d!==null?e=d:(e=b,d=oc(),d=d!==null?d:null,d===null&&(d=null,b=e),e=
d!==null?d:null);(m=c)&&e===null&&j("[119] IRIref");x[a]={nextPos:b,result:e};return e}function oc(){var a="PrefixedName@"+b,c=x[a];if(c)return b=c.nextPos,c.result;c=m;m=!1;var e=b,d=pc(),d=d!==null?{token:"uri",prefix:d[0],suffix:d[1],value:null}:null;d===null&&(d=null,b=e);d!==null?e=d:(e=b,d=Aa(),d=d!==null?{token:"uri",prefix:d,suffix:"",value:null}:null,d===null&&(d=null,b=e),e=d!==null?d:null);(m=c)&&e===null&&j("[120] PrefixedName");x[a]={nextPos:b,result:e};return e}function Vb(){var a="BlankNode@"+
b,c=x[a];if(c)return b=c.nextPos,c.result;c=m;m=!1;var e=b,d=qc(),d=d!==null?{token:"blank",value:d}:null;d===null&&(d=null,b=e);d!==null?e=d:(e=b,rc()!==null?(ca++,d={token:"blank",value:"_:"+ca}):d=null,d===null&&(d=null,b=e),e=d!==null?d:null);(m=c)&&e===null&&j("[121] BlankNode");x[a]={nextPos:b,result:e};return e}function ka(){var e="IRI_REF@"+b,h=x[e];if(h)return b=h.nextPos,h.result;h=m;m=!1;var k=b,d=b;if(a.substr(b,1)==="<"){var f="<";b+=1}else f=null,m&&j('"<"');if(f!==null){var i=[];if(a.substr(b).match(/^[^<>"{}|^`\\]/)!==
null){var g=a.charAt(b);b++}else g=null,m&&j('[^<>"{}|^`\\\\]');for(;g!==null;)i.push(g),a.substr(b).match(/^[^<>"{}|^`\\]/)!==null?(g=a.charAt(b),b++):(g=null,m&&j('[^<>"{}|^`\\\\]'));i!==null?(a.substr(b,1)===">"?(g=">",b+=1):(g=null,m&&j('">"')),g!==null?f=[f,i,g]:(f=null,b=d)):(f=null,b=d)}else f=null,b=d;d=f!==null?f[1].join(""):null;d===null&&(d=null,b=k);(m=h)&&d===null&&j("[122] IRI_REF");x[e]={nextPos:b,result:d};return d}function Aa(){var e="PNAME_NS@"+b,h=x[e];if(h)return b=h.nextPos,h.result;
h=m;m=!1;var k=b,d=b,f=Ya(),f=f!==null?f:"";if(f!==null){if(a.substr(b,1)===":"){var i=":";b+=1}else i=null,m&&j('":"');i!==null?f=[f,i]:(f=null,b=d)}else f=null,b=d;d=f!==null?f[0]:null;d===null&&(d=null,b=k);(m=h)&&d===null&&j("[123] PNAME_NS");x[e]={nextPos:b,result:d};return d}function pc(){var a="PNAME_LN@"+b,c=x[a];if(c)return b=c.nextPos,c.result;c=m;m=!1;var e=b,d=b,f=Aa();if(f!==null){var h=lb();h!==null?f=[f,h]:(f=null,b=d)}else f=null,b=d;d=f!==null?[f[0],f[1]]:null;d===null&&(d=null,b=
e);(m=c)&&d===null&&j("[124] PNAME_LN");x[a]={nextPos:b,result:d};return d}function qc(){var e="BLANK_NODE_LABEL@"+b,h=x[e];if(h)return b=h.nextPos,h.result;h=m;m=!1;var k=b,d=b;if(a.substr(b,2)==="_:"){var f="_:";b+=2}else f=null,m&&j('"_:"');if(f!==null){var i=lb();i!==null?f=[f,i]:(f=null,b=d)}else f=null,b=d;d=f!==null?f[1]:null;d===null&&(d=null,b=k);(m=h)&&d===null&&j("[125] BLANK_NODE_LABEL");x[e]={nextPos:b,result:d};return d}function Tb(){var e="VAR1@"+b,h=x[e];if(h)return b=h.nextPos,h.result;
h=m;m=!1;var k=b,d=b;if(a.substr(b,1)==="?"){var f="?";b+=1}else f=null,m&&j('"?"');if(f!==null){var i=mb();i!==null?f=[f,i]:(f=null,b=d)}else f=null,b=d;d=f!==null?f[1]:null;d===null&&(d=null,b=k);(m=h)&&d===null&&j("[126] VAR1");x[e]={nextPos:b,result:d};return d}function Ub(){var e="VAR2@"+b,h=x[e];if(h)return b=h.nextPos,h.result;h=m;m=!1;var k=b,d=b;if(a.substr(b,1)==="$"){var f="$";b+=1}else f=null,m&&j('"$"');if(f!==null){var i=mb();i!==null?f=[f,i]:(f=null,b=d)}else f=null,b=d;d=f!==null?
f[1]:null;d===null&&(d=null,b=k);(m=h)&&d===null&&j("[127] VAR2");x[e]={nextPos:b,result:d};return d}function bc(){var e="LANGTAG@"+b,h=x[e];if(h)return b=h.nextPos,h.result;h=m;m=!1;var k=b,d=b;if(a.substr(b,1)==="@"){var f="@";b+=1}else f=null,m&&j('"@"');if(f!==null){if(a.substr(b).match(/^[a-zA-Z]/)!==null){var i=a.charAt(b);b++}else i=null,m&&j("[a-zA-Z]");if(i!==null)for(var g=[];i!==null;)g.push(i),a.substr(b).match(/^[a-zA-Z]/)!==null?(i=a.charAt(b),b++):(i=null,m&&j("[a-zA-Z]"));else g=null;
if(g!==null){var i=[],l=b;if(a.substr(b,1)==="-"){var n="-";b+=1}else n=null,m&&j('"-"');if(n!==null){if(a.substr(b).match(/^[a-zA-Z0-9]/)!==null){var o=a.charAt(b);b++}else o=null,m&&j("[a-zA-Z0-9]");if(o!==null)for(var r=[];o!==null;)r.push(o),a.substr(b).match(/^[a-zA-Z0-9]/)!==null?(o=a.charAt(b),b++):(o=null,m&&j("[a-zA-Z0-9]"));else r=null;r!==null?n=[n,r]:(n=null,b=l)}else n=null,b=l;for(;n!==null;)if(i.push(n),l=b,a.substr(b,1)==="-"?(n="-",b+=1):(n=null,m&&j('"-"')),n!==null){a.substr(b).match(/^[a-zA-Z0-9]/)!==
null?(o=a.charAt(b),b++):(o=null,m&&j("[a-zA-Z0-9]"));if(o!==null)for(r=[];o!==null;)r.push(o),a.substr(b).match(/^[a-zA-Z0-9]/)!==null?(o=a.charAt(b),b++):(o=null,m&&j("[a-zA-Z0-9]"));else r=null;r!==null?n=[n,r]:(n=null,b=l)}else n=null,b=l;i!==null?f=[f,g,i]:(f=null,b=d)}else f=null,b=d}else f=null,b=d;d=f!==null?f[2].length===0?("@"+f[1].join("")).toLowerCase():("@"+f[1].join("")+"-"+f[2][0][1].join("")).toLowerCase():null;d===null&&(d=null,b=k);(m=h)&&d===null&&j("[128] LANGTAG");x[e]={nextPos:b,
result:d};return d}function ba(){var e="INTEGER@"+b,h=x[e];if(h)return b=h.nextPos,h.result;h=m;m=!1;var k=b;if(a.substr(b).match(/^[0-9]/)!==null){var d=a.charAt(b);b++}else d=null,m&&j("[0-9]");if(d!==null)for(var f=[];d!==null;)f.push(d),a.substr(b).match(/^[0-9]/)!==null?(d=a.charAt(b),b++):(d=null,m&&j("[0-9]"));else f=null;d=f!==null?function(a){var b={token:"literal",lang:null,type:"http://www.w3.org/2001/XMLSchema#integer"};b.value=W(a);return b}(f):null;d===null&&(d=null,b=k);(m=h)&&d===
null&&j("[129] INTEGER");x[e]={nextPos:b,result:d};return d}function Qa(){var e="DECIMAL@"+b,h=x[e];if(h)return b=h.nextPos,h.result;h=m;m=!1;var k=b,d=b;if(a.substr(b).match(/^[0-9]/)!==null){var f=a.charAt(b);b++}else f=null,m&&j("[0-9]");if(f!==null)for(var i=[];f!==null;)i.push(f),a.substr(b).match(/^[0-9]/)!==null?(f=a.charAt(b),b++):(f=null,m&&j("[0-9]"));else i=null;if(i!==null)if(a.substr(b,1)==="."?(f=".",b+=1):(f=null,m&&j('"."')),f!==null){var g=[];if(a.substr(b).match(/^[0-9]/)!==null){var l=
a.charAt(b);b++}else l=null,m&&j("[0-9]");for(;l!==null;)g.push(l),a.substr(b).match(/^[0-9]/)!==null?(l=a.charAt(b),b++):(l=null,m&&j("[0-9]"));g!==null?i=[i,f,g]:(i=null,b=d)}else i=null,b=d;else i=null,b=d;d=i!==null?function(a,b,c){var d={token:"literal",lang:null,type:"http://www.w3.org/2001/XMLSchema#decimal"};d.value=W([a,b,c]);return d}(i[0],i[1],i[2]):null;d===null&&(d=null,b=k);if(d!==null)k=d;else{d=k=b;a.substr(b,1)==="."?(i=".",b+=1):(i=null,m&&j('"."'));if(i!==null){a.substr(b).match(/^[0-9]/)!==
null?(f=a.charAt(b),b++):(f=null,m&&j("[0-9]"));if(f!==null)for(g=[];f!==null;)g.push(f),a.substr(b).match(/^[0-9]/)!==null?(f=a.charAt(b),b++):(f=null,m&&j("[0-9]"));else g=null;g!==null?i=[i,g]:(i=null,b=d)}else i=null,b=d;d=i!==null?function(a,b){var c={token:"literal",lang:null,type:"http://www.w3.org/2001/XMLSchema#decimal"};c.value=W([a,b]);return c}(i[0],i[1]):null;d===null&&(d=null,b=k);k=d!==null?d:null}(m=h)&&k===null&&j("[130] DECIMAL");x[e]={nextPos:b,result:k};return k}function Pa(){var e=
"DOUBLE@"+b,h=x[e];if(h)return b=h.nextPos,h.result;h=m;m=!1;var k=b,d=b;if(a.substr(b).match(/^[0-9]/)!==null){var f=a.charAt(b);b++}else f=null,m&&j("[0-9]");if(f!==null)for(var i=[];f!==null;)i.push(f),a.substr(b).match(/^[0-9]/)!==null?(f=a.charAt(b),b++):(f=null,m&&j("[0-9]"));else i=null;if(i!==null)if(a.substr(b,1)==="."?(f=".",b+=1):(f=null,m&&j('"."')),f!==null){var g=[];if(a.substr(b).match(/^[0-9]/)!==null){var l=a.charAt(b);b++}else l=null,m&&j("[0-9]");for(;l!==null;)g.push(l),a.substr(b).match(/^[0-9]/)!==
null?(l=a.charAt(b),b++):(l=null,m&&j("[0-9]"));g!==null?(l=Ra(),l!==null?i=[i,f,g,l]:(i=null,b=d)):(i=null,b=d)}else i=null,b=d;else i=null,b=d;d=i!==null?function(a,b,c,d){var f={token:"literal",lang:null,type:"http://www.w3.org/2001/XMLSchema#double"};f.value=W([a,b,c,d]);return f}(i[0],i[1],i[2],i[3]):null;d===null&&(d=null,b=k);if(d!==null)k=d;else{d=k=b;a.substr(b,1)==="."?(i=".",b+=1):(i=null,m&&j('"."'));if(i!==null){a.substr(b).match(/^[0-9]/)!==null?(g=a.charAt(b),b++):(g=null,m&&j("[0-9]"));
if(g!==null)for(f=[];g!==null;)f.push(g),a.substr(b).match(/^[0-9]/)!==null?(g=a.charAt(b),b++):(g=null,m&&j("[0-9]"));else f=null;f!==null?(g=Ra(),g!==null?i=[i,f,g]:(i=null,b=d)):(i=null,b=d)}else i=null,b=d;d=i!==null?function(a,b,c){var d={token:"literal",lang:null,type:"http://www.w3.org/2001/XMLSchema#double"};d.value=W([a,b,c]);return d}(i[0],i[1],i[2]):null;d===null&&(d=null,b=k);if(d!==null)k=d;else{d=k=b;a.substr(b).match(/^[0-9]/)!==null?(f=a.charAt(b),b++):(f=null,m&&j("[0-9]"));if(f!==
null)for(i=[];f!==null;)i.push(f),a.substr(b).match(/^[0-9]/)!==null?(f=a.charAt(b),b++):(f=null,m&&j("[0-9]"));else i=null;i!==null?(f=Ra(),f!==null?i=[i,f]:(i=null,b=d)):(i=null,b=d);d=i!==null?function(a,b){var c={token:"literal",lang:null,type:"http://www.w3.org/2001/XMLSchema#double"};c.value=W([a,b]);return c}(i[0],i[1]):null;d===null&&(d=null,b=k);k=d!==null?d:null}}(m=h)&&k===null&&j("[131] DOUBLE");x[e]={nextPos:b,result:k};return k}function gc(){var e="INTEGER_POSITIVE@"+b,h=x[e];if(h)return b=
h.nextPos,h.result;h=m;m=!1;var i=b,d=b;if(a.substr(b,1)==="+"){var f="+";b+=1}else f=null,m&&j('"+"');if(f!==null){var k=ba();k!==null?f=[f,k]:(f=null,b=d)}else f=null,b=d;d=f!==null?function(a){a.value="+"+a.value;return a}(f[1]):null;d===null&&(d=null,b=i);(m=h)&&d===null&&j("[132] INTEGER_POSITIVE");x[e]={nextPos:b,result:d};return d}function fc(){var e="DECIMAL_POSITIVE@"+b,h=x[e];if(h)return b=h.nextPos,h.result;h=m;m=!1;var i=b,d=b;if(a.substr(b,1)==="+"){var f="+";b+=1}else f=null,m&&j('"+"');
if(f!==null){var k=Qa();k!==null?f=[f,k]:(f=null,b=d)}else f=null,b=d;d=f!==null?function(a){a.value="+"+a.value;return a}(f[1]):null;d===null&&(d=null,b=i);(m=h)&&d===null&&j("[133] DECIMAL_POSITIVE");x[e]={nextPos:b,result:d};return d}function ec(){var e="DOUBLE_POSITIVE@"+b,h=x[e];if(h)return b=h.nextPos,h.result;h=m;m=!1;var i=b,d=b;if(a.substr(b,1)==="+"){var f="+";b+=1}else f=null,m&&j('"+"');if(f!==null){var k=Pa();k!==null?f=[f,k]:(f=null,b=d)}else f=null,b=d;d=f!==null?function(a){a.value=
"+"+a.value;return a}(f[1]):null;d===null&&(d=null,b=i);(m=h)&&d===null&&j("[134] DOUBLE_POSITIVE");x[e]={nextPos:b,result:d};return d}function jc(){var e="INTEGER_NEGATIVE@"+b,h=x[e];if(h)return b=h.nextPos,h.result;h=m;m=!1;var i=b,d=b;if(a.substr(b,1)==="-"){var f="-";b+=1}else f=null,m&&j('"-"');if(f!==null){var k=ba();k!==null?f=[f,k]:(f=null,b=d)}else f=null,b=d;d=f!==null?function(a){a.value="-"+a.value;return a}(f[1]):null;d===null&&(d=null,b=i);(m=h)&&d===null&&j("[135] INTEGER_NEGATIVE");
x[e]={nextPos:b,result:d};return d}function ic(){var e="DECIMAL_NEGATIVE@"+b,h=x[e];if(h)return b=h.nextPos,h.result;h=m;m=!1;var i=b,d=b;if(a.substr(b,1)==="-"){var f="-";b+=1}else f=null,m&&j('"-"');if(f!==null){var k=Qa();k!==null?f=[f,k]:(f=null,b=d)}else f=null,b=d;d=f!==null?function(a){a.value="-"+a.value;return a}(f[1]):null;d===null&&(d=null,b=i);(m=h)&&d===null&&j("[136] DECIMAL_NEGATIVE");x[e]={nextPos:b,result:d};return d}function hc(){var e="DOUBLE_NEGATIVE@"+b,h=x[e];if(h)return b=h.nextPos,
h.result;h=m;m=!1;var i=b,d=b;if(a.substr(b,1)==="-"){var f="-";b+=1}else f=null,m&&j('"-"');if(f!==null){var k=Pa();k!==null?f=[f,k]:(f=null,b=d)}else f=null,b=d;d=f!==null?function(a){a.value="-"+a.value;return a}(f[1]):null;d===null&&(d=null,b=i);(m=h)&&d===null&&j("[137] DOUBLE_NEGATIVE");x[e]={nextPos:b,result:d};return d}function Ra(){var e="EXPONENT@"+b,h=x[e];if(h)return b=h.nextPos,h.result;h=m;m=!1;var i=b,d=b;if(a.substr(b).match(/^[eE]/)!==null){var f=a.charAt(b);b++}else f=null,m&&j("[eE]");
if(f!==null){if(a.substr(b).match(/^[+\-]/)!==null){var k=a.charAt(b);b++}else k=null,m&&j("[+\\-]");k=k!==null?k:"";if(k!==null){if(a.substr(b).match(/^[0-9]/)!==null){var g=a.charAt(b);b++}else g=null,m&&j("[0-9]");if(g!==null)for(var l=[];g!==null;)l.push(g),a.substr(b).match(/^[0-9]/)!==null?(g=a.charAt(b),b++):(g=null,m&&j("[0-9]"));else l=null;l!==null?f=[f,k,l]:(f=null,b=d)}else f=null,b=d}else f=null,b=d;d=f!==null?W([f[0],f[1],f[2]]):null;d===null&&(d=null,b=i);(m=h)&&d===null&&j("[138] EXPONENT");
x[e]={nextPos:b,result:d};return d}function mc(){var e="STRING_LITERAL1@"+b,h=x[e];if(h)return b=h.nextPos,h.result;h=m;m=!1;var i=b,d=b;if(a.substr(b,1)==="'"){var f="'";b+=1}else f=null,m&&j('"\'"');if(f!==null){var k=[];if(a.substr(b).match(/^[^'\\\n\r]/)!==null){var g=a.charAt(b);b++}else g=null,m&&j("[^'\\\\\\n\\r]");g===null&&(g=da(),g=g!==null?g:null);for(;g!==null;)k.push(g),a.substr(b).match(/^[^'\\\n\r]/)!==null?(g=a.charAt(b),b++):(g=null,m&&j("[^'\\\\\\n\\r]")),g===null&&(g=da(),g=g!==
null?g:null);k!==null?(a.substr(b,1)==="'"?(g="'",b+=1):(g=null,m&&j('"\'"')),g!==null?f=[f,k,g]:(f=null,b=d)):(f=null,b=d)}else f=null,b=d;d=f!==null?W(f[1]):null;d===null&&(d=null,b=i);(m=h)&&d===null&&j("[139] STRING_LITERAL1");x[e]={nextPos:b,result:d};return d}function nc(){var e="STRING_LITERAL2@"+b,h=x[e];if(h)return b=h.nextPos,h.result;h=m;m=!1;var i=b,d=b;if(a.substr(b,1)==='"'){var f='"';b+=1}else f=null,m&&j('"\\""');if(f!==null){var k=[];if(a.substr(b).match(/^[^"\\\n\r]/)!==null){var g=
a.charAt(b);b++}else g=null,m&&j('[^"\\\\\\n\\r]');g===null&&(g=da(),g=g!==null?g:null);for(;g!==null;)k.push(g),a.substr(b).match(/^[^"\\\n\r]/)!==null?(g=a.charAt(b),b++):(g=null,m&&j('[^"\\\\\\n\\r]')),g===null&&(g=da(),g=g!==null?g:null);k!==null?(a.substr(b,1)==='"'?(g='"',b+=1):(g=null,m&&j('"\\""')),g!==null?f=[f,k,g]:(f=null,b=d)):(f=null,b=d)}else f=null,b=d;d=f!==null?W(f[1]):null;d===null&&(d=null,b=i);(m=h)&&d===null&&j("[140] STRING_LITERAL2");x[e]={nextPos:b,result:d};return d}function kc(){var e=
"STRING_LITERAL_LONG1@"+b,h=x[e];if(h)return b=h.nextPos,h.result;h=m;m=!1;var i=b,d=b;if(a.substr(b,3)==="'''"){var f="'''";b+=3}else f=null,m&&j("\"'''\"");if(f!==null){var k=[];if(a.substr(b).match(/^[^'\\]/)!==null){var g=a.charAt(b);b++}else g=null,m&&j("[^'\\\\]");g===null&&(g=da(),g=g!==null?g:null);for(;g!==null;)k.push(g),a.substr(b).match(/^[^'\\]/)!==null?(g=a.charAt(b),b++):(g=null,m&&j("[^'\\\\]")),g===null&&(g=da(),g=g!==null?g:null);k!==null?(a.substr(b,3)==="'''"?(g="'''",b+=3):(g=
null,m&&j("\"'''\"")),g!==null?f=[f,k,g]:(f=null,b=d)):(f=null,b=d)}else f=null,b=d;d=f!==null?W(f[1]):null;d===null&&(d=null,b=i);(m=h)&&d===null&&j("[141] STRING_LITERAL_LONG1");x[e]={nextPos:b,result:d};return d}function lc(){var e="STRING_LITERAL_LONG2@"+b,h=x[e];if(h)return b=h.nextPos,h.result;h=m;m=!1;var i=b,d=b;if(a.substr(b,3)==='"""'){var f='"""';b+=3}else f=null,m&&j('"\\"\\"\\""');if(f!==null){var k=[];if(a.substr(b).match(/^[^"\\]/)!==null){var g=a.charAt(b);b++}else g=null,m&&j('[^"\\\\]');
g===null&&(g=da(),g=g!==null?g:null);for(;g!==null;)k.push(g),a.substr(b).match(/^[^"\\]/)!==null?(g=a.charAt(b),b++):(g=null,m&&j('[^"\\\\]')),g===null&&(g=da(),g=g!==null?g:null);k!==null?(a.substr(b,3)==='"""'?(g='"""',b+=3):(g=null,m&&j('"\\"\\"\\""')),g!==null?f=[f,k,g]:(f=null,b=d)):(f=null,b=d)}else f=null,b=d;d=f!==null?W(f[1]):null;d===null&&(d=null,b=i);(m=h)&&d===null&&j("[142] STRING_LITERAL_LONG2");x[e]={nextPos:b,result:d};return d}function da(){var e="ECHAR@"+b,h=x[e];if(h)return b=
h.nextPos,h.result;h=m;m=!1;var g=b;if(a.substr(b,1)==="\\"){var d="\\";b+=1}else d=null,m&&j('"\\\\"');if(d!==null){if(a.substr(b).match(/^[tbnrf"']/)!==null){var f=a.charAt(b);b++}else f=null,m&&j("[tbnrf\"']");f!==null?d=[d,f]:(d=null,b=g)}else d=null,b=g;(m=h)&&d===null&&j("[143] ECHAR");x[e]={nextPos:b,result:d};return d}function ia(){var e="NIL@"+b,h=x[e];if(h)return b=h.nextPos,h.result;h=m;m=!1;var g=b,d=b;if(a.substr(b,1)==="("){var f="(";b+=1}else f=null,m&&j('"("');if(f!==null){for(var i=
[],k=o();k!==null;)i.push(k),k=o();i!==null?(a.substr(b,1)===")"?(k=")",b+=1):(k=null,m&&j('")"')),k!==null?f=[f,i,k]:(f=null,b=d)):(f=null,b=d)}else f=null,b=d;d=f!==null?{token:"triplesnodecollection",triplesContext:[],chainSubject:[{token:"uri",value:"http://www.w3.org/1999/02/22-rdf-syntax-ns#nil"}]}:null;d===null&&(d=null,b=g);(m=h)&&d===null&&j("[144] NIL");x[e]={nextPos:b,result:d};return d}function o(){var e="WS@"+b,h=x[e];if(h)return b=h.nextPos,h.result;h=m;m=!1;if(a.substr(b).match(/^[ ]/)!==
null){var g=a.charAt(b);b++}else g=null,m&&j("[ ]");g===null&&(a.substr(b).match(/^[\t]/)!==null?(g=a.charAt(b),b++):(g=null,m&&j("[\t]")),g===null&&(a.substr(b).match(/^[\r]/)!==null?(g=a.charAt(b),b++):(g=null,m&&j("[\\r]")),g===null&&(a.substr(b).match(/^[\n]/)!==null?(g=a.charAt(b),b++):(g=null,m&&j("[\\n]")),g===null&&(g=sc(),g=g!==null?g:null))));(m=h)&&g===null&&j("[145] WS");x[e]={nextPos:b,result:g};return g}function sc(){var e="COMMENT@"+b,h=x[e];if(h)return b=h.nextPos,h.result;h=m;m=!1;
var g=b;if(a.substr(b,1)==="#"){var d="#";b+=1}else d=null,m&&j('"#"');if(d!==null){var f=[];if(a.substr(b).match(/^[^\n\r]/)!==null){var i=a.charAt(b);b++}else i=null,m&&j("[^\\n\\r]");for(;i!==null;)f.push(i),a.substr(b).match(/^[^\n\r]/)!==null?(i=a.charAt(b),b++):(i=null,m&&j("[^\\n\\r]"));f!==null?d=[d,f]:(d=null,b=g)}else d=null,b=g;(m=h)&&d===null&&j(" COMMENT");x[e]={nextPos:b,result:d};return d}function rc(){var e="ANON@"+b,h=x[e];if(h)return b=h.nextPos,h.result;h=m;m=!1;var g=b;if(a.substr(b,
1)==="["){var d="[";b+=1}else d=null,m&&j('"["');if(d!==null){for(var f=[],i=o();i!==null;)f.push(i),i=o();f!==null?(a.substr(b,1)==="]"?(i="]",b+=1):(i=null,m&&j('"]"')),i!==null?d=[d,f,i]:(d=null,b=g)):(d=null,b=g)}else d=null,b=g;(m=h)&&d===null&&j("[146] ANON");x[e]={nextPos:b,result:d};return d}function nb(){var e="PN_CHARS_BASE@"+b,h=x[e];if(h)return b=h.nextPos,h.result;h=m;m=!1;if(a.substr(b).match(/^[A-Z]/)!==null){var g=a.charAt(b);b++}else g=null,m&&j("[A-Z]");g===null&&(a.substr(b).match(/^[a-z]/)!==
null?(g=a.charAt(b),b++):(g=null,m&&j("[a-z]")),g===null&&(a.substr(b).match(/^[\xC0-\xD6]/)!==null?(g=a.charAt(b),b++):(g=null,m&&j("[\\xC0-\\xD6]")),g===null&&(a.substr(b).match(/^[\xD8-\xF6]/)!==null?(g=a.charAt(b),b++):(g=null,m&&j("[\\xD8-\\xF6]")),g===null&&(a.substr(b).match(/^[\xF8-\u02FF]/)!==null?(g=a.charAt(b),b++):(g=null,m&&j("[\\xF8-\\u02FF]")),g===null&&(a.substr(b).match(/^[\u0370-\u037D]/)!==null?(g=a.charAt(b),b++):(g=null,m&&j("[\\u0370-\\u037D]")),g===null&&(a.substr(b).match(/^[\u037F-\u1FFF]/)!==
null?(g=a.charAt(b),b++):(g=null,m&&j("[\\u037F-\\u1FFF]")),g===null&&(a.substr(b).match(/^[\u200C-\u200D]/)!==null?(g=a.charAt(b),b++):(g=null,m&&j("[\\u200C-\\u200D]")),g===null&&(a.substr(b).match(/^[\u2070-\u218F]/)!==null?(g=a.charAt(b),b++):(g=null,m&&j("[\\u2070-\\u218F]")),g===null&&(a.substr(b).match(/^[\u2C00-\u2FEF]/)!==null?(g=a.charAt(b),b++):(g=null,m&&j("[\\u2C00-\\u2FEF]")),g===null&&(a.substr(b).match(/^[\u3001-\uD7FF]/)!==null?(g=a.charAt(b),b++):(g=null,m&&j("[\\u3001-\\uD7FF]")),
g===null&&(a.substr(b).match(/^[\uF900-\uFDCF]/)!==null?(g=a.charAt(b),b++):(g=null,m&&j("[\\uF900-\\uFDCF]")),g===null&&(a.substr(b).match(/^[\uFDF0-\uFFFD]/)!==null?(g=a.charAt(b),b++):(g=null,m&&j("[\\uFDF0-\\uFFFD]")),g===null&&(a.substr(b).match(/^[\u1000-\uEFFF]/)!==null?(g=a.charAt(b),b++):(g=null,m&&j("[\\u1000-\\uEFFF]")),g=g!==null?g:null)))))))))))));(m=h)&&g===null&&j("[147] PN_CHARS_BASE");x[e]={nextPos:b,result:g};return g}function qa(){var e="PN_CHARS_U@"+b,h=x[e];if(h)return b=h.nextPos,
h.result;h=m;m=!1;var g=nb();g===null&&(a.substr(b,1)==="_"?(g="_",b+=1):(g=null,m&&j('"_"')),g=g!==null?g:null);(m=h)&&g===null&&j("[148] PN_CHARS_U");x[e]={nextPos:b,result:g};return g}function mb(){var e="VARNAME@"+b,h=x[e];if(h)return b=h.nextPos,h.result;h=m;m=!1;var g=b,d=b,f=qa();f===null&&(a.substr(b).match(/^[0-9]/)!==null?(f=a.charAt(b),b++):(f=null,m&&j("[0-9]")),f=f!==null?f:null);if(f!==null){var i=[],k=qa();k===null&&(a.substr(b).match(/^[0-9]/)!==null?(k=a.charAt(b),b++):(k=null,m&&
j("[0-9]")),k===null&&(a.substr(b).match(/^[\xB7]/)!==null?(k=a.charAt(b),b++):(k=null,m&&j("[\\xB7]")),k===null&&(a.substr(b).match(/^[\u0300-\u036F]/)!==null?(k=a.charAt(b),b++):(k=null,m&&j("[\\u0300-\\u036F]")),k===null&&(a.substr(b).match(/^[\u203F-\u2040]/)!==null?(k=a.charAt(b),b++):(k=null,m&&j("[\\u203F-\\u2040]")),k=k!==null?k:null))));for(;k!==null;)i.push(k),k=qa(),k===null&&(a.substr(b).match(/^[0-9]/)!==null?(k=a.charAt(b),b++):(k=null,m&&j("[0-9]")),k===null&&(a.substr(b).match(/^[\xB7]/)!==
null?(k=a.charAt(b),b++):(k=null,m&&j("[\\xB7]")),k===null&&(a.substr(b).match(/^[\u0300-\u036F]/)!==null?(k=a.charAt(b),b++):(k=null,m&&j("[\\u0300-\\u036F]")),k===null&&(a.substr(b).match(/^[\u203F-\u2040]/)!==null?(k=a.charAt(b),b++):(k=null,m&&j("[\\u203F-\\u2040]")),k=k!==null?k:null))));i!==null?f=[f,i]:(f=null,b=d)}else f=null,b=d;d=f!==null?f[0]+f[1].join(""):null;d===null&&(d=null,b=g);(m=h)&&d===null&&j("[149] VARNAME");x[e]={nextPos:b,result:d};return d}function za(){var e="PN_CHARS@"+
b,h=x[e];if(h)return b=h.nextPos,h.result;h=m;m=!1;var g=qa();g===null&&(a.substr(b,1)==="-"?(g="-",b+=1):(g=null,m&&j('"-"')),g===null&&(a.substr(b).match(/^[0-9]/)!==null?(g=a.charAt(b),b++):(g=null,m&&j("[0-9]")),g===null&&(a.substr(b).match(/^[\xB7]/)!==null?(g=a.charAt(b),b++):(g=null,m&&j("[\\xB7]")),g===null&&(a.substr(b).match(/^[\u0300-\u036F]/)!==null?(g=a.charAt(b),b++):(g=null,m&&j("[\\u0300-\\u036F]")),g===null&&(a.substr(b).match(/^[\u203F-\u2040]/)!==null?(g=a.charAt(b),b++):(g=null,
m&&j("[\\u203F-\\u2040]")),g=g!==null?g:null)))));(m=h)&&g===null&&j("[150] PN_CHARS");x[e]={nextPos:b,result:g};return g}function Ya(){var e="PN_PREFIX@"+b,h=x[e];if(h)return b=h.nextPos,h.result;h=m;m=!1;var g=b,d=b,f=nb();if(f!==null){var k=[],i=za();i===null&&(a.substr(b,1)==="."?(i=".",b+=1):(i=null,m&&j('"."')),i=i!==null?i:null);for(;i!==null;)k.push(i),i=za(),i===null&&(a.substr(b,1)==="."?(i=".",b+=1):(i=null,m&&j('"."')),i=i!==null?i:null);k!==null?f=[f,k]:(f=null,b=d)}else f=null,b=d;d=
f!==null?function(a,b){if(b[b.length-1]==".")throw Error("Wrong PN_PREFIX, cannot finish with '.'");else return a+b.join("")}(f[0],f[1]):null;d===null&&(d=null,b=g);(m=h)&&d===null&&j("[151] PN_PREFIX");x[e]={nextPos:b,result:d};return d}function lb(){var e="PN_LOCAL@"+b,h=x[e];if(h)return b=h.nextPos,h.result;h=m;m=!1;var g=b,d=b,f=qa();f===null&&(a.substr(b).match(/^[0-9]/)!==null?(f=a.charAt(b),b++):(f=null,m&&j("[0-9]")),f=f!==null?f:null);if(f!==null){for(var k=[],i=za();i!==null;)k.push(i),
i=za();k!==null?f=[f,k]:(f=null,b=d)}else f=null,b=d;d=f!==null?f[0]+f[1].join(""):null;d===null&&(d=null,b=g);(m=h)&&d===null&&j("[152] PN_LOCAL");x[e]={nextPos:b,result:d};return d}function ob(){var e=function(a){a.sort();for(var b=null,c=[],e=0;e<a.length;e++)a[e]!==b&&(c.push(a[e]),b=a[e]);switch(c.length){case 0:return"end of input";case 1:return c[0];default:return c.slice(0,c.length-1).join(", ")+" or "+c[c.length-1]}}(Xa),h=Math.max(b,ua),h=h<a.length?k(a.charAt(h)):"end of input";return"Expected "+
e+" but "+h+" found."}function tc(){for(var b=1,e=1,h=!1,d=0;d<ua;d++){var f=a.charAt(d);f==="\n"?(h||b++,e=1,h=!1):f==="\r"|f==="\u2028"||f==="\u2029"?(b++,e=1,h=!0):(e++,h=!1)}return{line:b,column:e}}var fa={ANON:rc,AdditiveExpression:T,Aggregate:Xb,ArgList:hb,AskQuery:J,BLANK_NODE_LABEL:qc,BaseDecl:u,BindingValue:sa,BindingsClause:ta,BlankNode:Vb,BlankNodePropertyList:Rb,BooleanLiteral:Fa,BrackettedExpression:Ca,BuiltInCall:Ba,COMMENT:sc,Clear:tb,Collection:Qb,ConditionalAndExpression:Na,ConditionalOrExpression:M,
Constraint:va,ConstructQuery:K,ConstructTemplate:Ab,ConstructTriples:ib,Create:vb,DECIMAL:Qa,DECIMAL_NEGATIVE:ic,DECIMAL_POSITIVE:fc,DOCUMENT:function(){var a="DOCUMENT@"+b,c=x[a];if(c)return b=c.nextPos,c.result;c=i();c===null&&(c=w(),c=c!==null?c:null);x[a]={nextPos:b,result:c};return c},DOUBLE:Pa,DOUBLE_NEGATIVE:hc,DOUBLE_POSITIVE:ec,DatasetClause:I,DefaultGraphClause:O,DeleteClause:yb,DeleteData:xb,DeleteWhere:rb,DescribeQuery:L,Drop:ub,ECHAR:da,EXPONENT:Ra,ExistsFunc:Zb,ExpressionList:Jb,Filter:Ib,
FunctionCall:Za,GraphGraphPattern:Gb,GraphNode:na,GraphPatternNotTriples:gb,GraphRef:Ga,GraphRefAll:$a,GraphTerm:Sb,GroupClause:Y,GroupCondition:X,GroupGraphPattern:V,GroupGraphPatternSub:Bb,GroupOrUnionGraphPattern:Db,HavingClause:aa,INTEGER:ba,INTEGER_NEGATIVE:jc,INTEGER_POSITIVE:gc,IRI_REF:ka,IRIref:Q,IRIrefOrFunction:Wb,InsertClause:Wa,InsertData:wb,LANGTAG:bc,LimitClause:Sa,LimitOffsetClauses:ra,Load:qb,MinusGraphPattern:Fb,Modify:sb,MultiplicativeExpression:oa,NIL:ia,NamedGraphClause:S,NotExistsFunc:$b,
NumericLiteral:Ea,NumericLiteralNegative:pa,NumericLiteralPositive:dc,NumericLiteralUnsigned:cc,ObjectList:ja,OffsetClause:Ta,OptionalGraphPattern:Eb,OrderClause:ea,OrderCondition:ga,PNAME_LN:pc,PNAME_NS:Aa,PN_CHARS:za,PN_CHARS_BASE:nb,PN_CHARS_U:qa,PN_LOCAL:lb,PN_PREFIX:Ya,PathAlternative:jb,PathElt:kb,PathEltOrInverse:Ma,PathMod:Ob,PathNegatedPropertySet:Pb,PathOneInPropertySet:xa,PathPrimary:Nb,PathSequence:La,PrefixDecl:t,PrefixedName:oc,PrimaryExpression:ya,Prologue:r,PropertyList:Kb,PropertyListNotEmpty:wa,
PropertyListNotEmptyPath:Lb,PropertyListPath:Mb,QuadData:ab,QuadPattern:cb,Quads:db,QuadsNotTriples:eb,Query:g,RDFLiteral:Da,RegexExpression:Yb,RelationalExpression:Oa,SPARQL:i,STRING_LITERAL1:mc,STRING_LITERAL2:nc,STRING_LITERAL_LONG1:kc,STRING_LITERAL_LONG2:lc,SelectClause:B,SelectQuery:E,ServiceGraphPattern:Hb,SolutionModifier:U,String:ac,SubSelect:G,TURTLE:w,TriplesBlock:la,TriplesNode:Ia,TriplesSameSubject:fb,TriplesSameSubjectPath:Cb,TriplesTemplate:ma,UnaryExpression:Z,Update:Ua,Update1:pb,
UsingClause:bb,VAR1:Tb,VAR2:Ub,VARNAME:mb,Var:P,VarOrIRIref:ha,VarOrTerm:Ha,Verb:Ja,VerbPath:Ka,WS:o,WhereClause:$,base:C,directive:A,prefixID:F,statement:y};if(e!==void 0){if(fa[e]===void 0)throw Error("Invalid rule name: "+k(e)+".");}else e="DOCUMENT";var b=0,m=!0,ua=0,Xa=[],x={},W=function(a){for(var b="",c=0;c<a.length;c++)b+=typeof a[c]==="string"?a[c]:a[c].join("");return b},ca=0,zb=function(a){for(var b="",c=0;c<a.length;c++)b+=a[c];return b.toUpperCase()},fa=fa[e]();if(fa===null||b!==a.length)throw fa=
tc(),new this.SyntaxError(ob(),fa.line,fa.column);return fa},toSource:function(){return this._source},SyntaxError:function(a,e,h){this.name="SyntaxError";this.message=a;this.line=e;this.column=h}};a.SyntaxError.prototype=Error.prototype;return a}();var aa={};(new Date).getTime();aa.combined_parser=ga.parser;aa.parser={};aa.parser.parse=function(a,c){for(var e=[],h=aa.combined_parser.parse(a),g={},j={namespaces:g,base:"",blankCounter:0},i=0;i<h.length;i++){var l=h[i];if(l.token==="base")j.base=l.value;
else if(l.token==="prefix")g[l.prefix]=l.local;else if(l.token==="triples"||l.token==="triplespattern")for(var r=0;r<l.triplesContext.length;r++){var u=l.triplesContext[r],u={subject:y.lexicalFormTerm(u.subject,j),predicate:y.lexicalFormTerm(u.predicate,j),object:y.lexicalFormTerm(u.object,j),graph:c};e.push(u)}}return e};var w={defaultContext:{rdf:"http://www.w3.org/1999/02/22-rdf-syntax-ns#",rdfs:"http://www.w3.org/2000/01/rdf-schema#",owl:"http://www.w3.org/2002/07/owl#",xsd:"http://www.w3.org/2001/XMLSchema#",
dcterms:"http://purl.org/dc/terms/",foaf:"http://xmlns.com/foaf/0.1/",cal:"http://www.w3.org/2002/12/cal/ical#",vcard:"http://www.w3.org/2006/vcard/ns# ",geo:"http://www.w3.org/2003/01/geo/wgs84_pos#",cc:"http://creativecommons.org/ns#",sioc:"http://rdfs.org/sioc/ns#",doap:"http://usefulinc.com/ns/doap#",com:"http://purl.org/commerce#",ps:"http://purl.org/payswarm#",gr:"http://purl.org/goodrelations/v1#",sig:"http://purl.org/signature#",ccard:"http://purl.org/commerce/creditcard#"},UrisMap:function(){this.defaultNs=
"";this.interfaceProperties=["get","remove","set","setDefault","addAll","resolve","shrink"]}};w.UrisMap.prototype.values=function(){var a={},c;for(c in this)!y.include(this.interfaceProperties,c)&&typeof this[c]!=="function"&&c!=="defaultNs"&&c!=="interfaceProperties"&&(a[c]=this[c]);return a};w.UrisMap.prototype.get=function(a){if(a.indexOf(" ")!=-1)throw"Prefix must not contain any whitespaces";return this[a]};w.UrisMap.prototype.remove=function(a){if(a.indexOf(" ")!=-1)throw"Prefix must not contain any whitespaces";
delete this[a];return null};w.UrisMap.prototype.set=function(a,c){if(a.indexOf(" ")!=-1)throw"Prefix must not contain any whitespaces";this[a]=c};w.UrisMap.prototype.setDefault=function(a){this.defaultNs=a};w.UrisMap.prototype.addAll=function(a,c){for(var e in a)y.include(this.interfaceProperties,e)||(this[e]!=null?c===!0&&(this[e]=a[e]):this[e]=a[e]);return this};w.UrisMap.prototype.resolve=function(a){var c=a.split(":"),a=c[0],c=c[1];return a===""?this.defaultNs==null?null:this.defaultNs+c:this[a]!=
null?this[a]+c:null};w.UrisMap.prototype.shrink=function(a){for(var c in this){var e=this[c];if(a.indexOf(e)===0&&e!==""&&c!="defaultNs")return a=a.split(e)[1],c+":"+a}return a};w.Profile=function(){this.prefixes=new w.UrisMap;this.terms=new w.UrisMap};w.Profile.prototype.importProfile=function(a,c){this.prefixes.addAll(a.prefixes,c);this.terms.addAll(a.terms,c)};w.Profile.prototype.resolve=function(a){return a.indexOf(":")!=-1?this.prefixes.resolve(a):this.terms[a]!=null?this.terms.resolve(a):null};
w.Profile.prototype.setDefaultPrefix=function(a){this.prefixes.setDefault(a)};w.Profile.prototype.setDefaultVocabulary=function(a){this.terms.setDefault(a)};w.Profile.prototype.setPrefix=function(a,c){this.prefixes.set(a,c)};w.Profile.prototype.setTerm=function(a,c){this.terms.set(a,c)};w.RDFEnvironment=function(){this.blankNodeCounter=0;var a=this;this.filters={s:function(a){return function(c){return c.subject.equals(a)}},p:function(a){return function(c){return c.predicate.equals(a)}},o:function(a){return function(c){return c.object.equals(a)}},
sp:function(a,c){return function(g){return g.subject.equals(a)&&g.predicate.equals(c)}},so:function(a,c){return function(g){return g.subject.equals(a)&&g.object.equals(c)}},po:function(a,c){return function(g){return g.predicate.equals(a)&&g.object.equals(c)}},spo:function(a,c,g){return function(j){return j.subject.equals(a)&&j.predicate.equals(c)&&j.object.equals(g)}},describes:function(a){return function(c){return c.subject.equals(a)||c.object.equals(a)}},type:function(c){var h=a.resolve("rdf:type");
return function(a){return a.predicate.equals(h)&&a.object.equals(c)}}};for(var c in w.defaultContext)this.prefixes.set(c,w.defaultContext[c])};y["extends"](w.Profile,w.RDFEnvironment);w.RDFEnvironment.prototype.createBlankNode=function(){var a=new w.BlankNode(this.blankNodeCounter);this.blankNodeCounter++;return a};w.RDFEnvironment.prototype.createNamedNode=function(a){var c=this.resolve(a);return c!=null?new w.NamedNode(c):new w.NamedNode(a)};w.RDFEnvironment.prototype.createLiteral=function(a,c,
e){return e!=null?new w.Literal(a,c,e.toString()):new w.Literal(a,c,e)};w.RDFEnvironment.prototype.createTriple=function(a,c,e){return new w.Triple(a,c,e)};w.RDFEnvironment.prototype.createGraph=function(a){var c=new w.Graph;if(a!=null)for(var e=0;e<a.length;e++)c.add(a[e]);return c};w.RDFEnvironment.prototype.createAction=function(a,c){return function(e){return a(e)?c(e):e}};w.RDFEnvironment.prototype.createProfile=function(a){return a===!0?new w.RDFEnvironment.Profile:(a=new w.RDFEnvironment.Profile,
a.importProfile(this),a)};w.RDFEnvironment.prototype.createTermMap=function(a){if(a===!0)return new w.UrisMap;else{var a=this.terms.values(),c=new w.UrisMap,e;for(e in a)c[e]=a[e];return c}};w.RDFEnvironment.prototype.createPrefixMap=function(a){if(a===!0)return new w.UrisMap;else{var a=this.prefixes.values(),c=new w.UrisMap,e;for(e in a)c[e]=a[e];return c}};w.RDFNode=function(a){this.interfaceName=a;this.attributes=["interfaceName","nominalValue"]};w.RDFNode.prototype.equals=function(a){if(a.interfaceName==
null)return this.valueOf()==a;else{for(var c in this.attributes){var e=this.attributes[c];if(this[e]!=a[e])return!1}return!0}};w.BlankNode=function(a){w.RDFNode.call(this,"BlankNode");this.nominalValue="_:"+a;this.bnodeId=a};y["extends"](w.RDFNode,w.BlankNode);w.BlankNode.prototype.toString=function(){return this.nominalValue};w.BlankNode.prototype.toNT=function(){return this.nominalValue};w.BlankNode.prototype.valueOf=function(){return this.nominalValue};w.Literal=function(a,c,e){w.RDFNode.call(this,
"Literal");this.nominalValue=a;if(c!=null)this.language=c;else if(e!=null)this.datatype=e};y["extends"](w.RDFNode,w.Literal);w.Literal.prototype.toString=function(){var a='"'+this.nominalValue+'"';if(this.language!=null)a=a+"@"+this.language;else if(this.datatype!=null||this.type)a=a+"^^<"+(this.datatype||this.type)+">";return a};w.Literal.prototype.toNT=function(){return this.toString()};w.Literal.prototype.valueOf=function(){return g.effectiveTypeValue({token:"literal",type:this.type,value:this.nominalValue,
language:this.language})};w.NamedNode=function(a){w.RDFNode.call(this,"NamedNode");this.nominalValue=a.value!=null?a.value:a};y["extends"](w.RDFNode,w.NamedNode);w.NamedNode.prototype.toString=function(){return this.nominalValue};w.NamedNode.prototype.toNT=function(){return"<"+this.toString()+">"};w.NamedNode.prototype.valueOf=function(){return this.nominalValue};w.Triple=function(a,c,e){this.subject=a;this.predicate=c;this.object=e};w.Triple.prototype.equals=function(a){return this.subject.equals(a.subject)&&
this.predicate.equals(a.predicate)&&this.object.equals(a.object)};w.Triple.prototype.toString=function(){return this.subject.toNT()+" "+this.predicate.toNT()+" "+this.object.toNT()+" . \r\n"};w.Graph=function(){this.triples=[];this.duplicates={};this.actions=[]};w.Graph.prototype.add=function(a){for(var c=0;c<this.actions.length;c++)a=this.actions[c](a);c=a.subject.toString()+a.predicate.toString()+a.object.toString();this.duplicates[c]||(this.duplicates[c]=!0,this.triples.push(a));return this};w.Graph.prototype.addAction=
function(a,c){this.actions.push(a);if(c==!0)for(var e=0;e<this.triples.length;e++)this.triples[e]=a(this.triples[e]);return this};w.Graph.prototype.addAll=function(a){for(var a=a.toArray(),c=0;c<a.length;c++)this.add(a[c]);return this};w.Graph.prototype.remove=function(a){for(var c=null,e=0;e<this.triples.length;e++)if(this.triples[e].equals(a)){delete this.duplicates[a.subject.toString()+a.predicate.toString()+a.object.toString()];c=e;break}c!=null&&this.triples.splice(c,1);return this};w.Graph.prototype.toArray=
function(){return this.triples};w.Graph.prototype.some=function(a){for(var c=0;c<this.triples.length;c++)if(a(this.triples[c],this)===!0)return!0;return!1};w.Graph.prototype.every=function(a){for(var c=0;c<this.triples.length;c++)if(a(this.triples[c],this)===!1)return!1;return!0};w.Graph.prototype.filter=function(a){for(var c=new w.Graph,e=0;e<this.triples.length;e++)a(this.triples[e],this)===!0&&c.add(this.triples[e]);return c};w.Graph.prototype.forEach=function(a){for(var c=0;c<this.triples.length;c++)a(this.triples[c],
this)};w.Graph.prototype.merge=function(){for(var a=new w.Graph,c=0;c<this.triples;c++){var e=this.triples[c];a.add(e)}for(c=0;c<triples.length;c++)e=triples[c],this.add(e);return a};w.Graph.prototype.match=function(a,c,e,h){for(var g=new w.Graph,j=0,i=0;i<this.triples.length;i++){var l=this.triples[i];if(a==null||l.subject.equals(a))if(c==null||l.predicate.equals(c))if(e==null||l.object.equals(e))if(h==null||j<h)j++,g.add(l);else break}return g};w.Graph.prototype.removeMatches=function(a,c,e){for(var h=
[],g=0;g<this.triples.length;g++){var j=this.triples[g];if(a==null||j.subject.equals(a))if(c==null||j.predicate.equals(c))(e==null||j.object.equals(e))&&h.push(j)}for(g=0;g<h.length;g++)this.remove(h[g]);return this};w.Graph.prototype.toNT=function(){var a="";this.forEach(function(c){a+=c.toString()});return a};w.buildRDFResource=function(a,c,e,h){return a.token==="blank"?w.buildBlankNode(a,c,e,h):a.token==="literal"?w.buildLiteral(a,c,e,h):a.token==="uri"?w.buildNamedNode(a,c,e,h):a.token==="var"?
(a=c[a.value],a!=null?w.buildRDFResource(a,c,e,h):null):null};w.buildBlankNode=function(a){if(a.valuetmp!=null)a.value=a.valuetmp;if(a.value.indexOf("_:")===0)a.value=a.value.split("_:")[1];return new w.BlankNode(a.value)};w.buildLiteral=function(a){return new w.Literal(a.value,a.lang,a.type)};w.buildNamedNode=function(a,c,e,h){if(a.value==null&&a.prefix!=null)c=e.resolveNsInEnvironment(a.prefix,h),a.value=c+a.suffix;return new w.NamedNode(a)};w.rdf=new w.RDFEnvironment;var g={checkFilters:function(a,
c,e,h,k,j){var i=a.filter,l=[];if(i==null||a.length!=null)return c;for(a=0;a<i.length;a++){for(var c=g.run(i[a].value,c,e,h,k,j),r=[],u=0;u<c.length;u++)c[u].__nullify__!=null?l.push(c[u]):r.push(c[u]);c=r}return c.concat(l)}};g.boundVars=function(a){if(a.expressionType!=null){var c=a.expressionType;if(c=="relationalexpression")return c=a.op2,g.boundVars(a.op1)+g.boundVars(c);else if(c=="conditionalor"||c=="conditionaland"){for(var e=[],c=0;c<a.operands;c++)e=e.concat(g.boundVars(a.operands[c]));
return e}else if(c=="builtincall")if(a.args==null)return[];else{e=[];for(c=0;c<a.args.length;c++)e=e.concat(g.boundVars(a.args[c]));return e}else if(c=="multiplicativeexpression"){e=g.boundVars(a.factor);for(c=0;c<a.factors.length;c++)e=e.concat(g.boundVars(a.factors[c].expression));return e}else if(c=="additiveexpression"){e=g.boundVars(a.summand);for(c=0;c<a.summands.length;c++)e=e.concat(g.boundVars(a.summands[c].expression));return e}else if(c=="regex")return e=g.boundVars(a.expression1),e.concat(g.boundVars(a.expression2));
else if(c=="unaryexpression")return g.boundVars(a.expression);else if(c=="atomic")return a.primaryexpression=="var"?[a.value]:[]}else throw console.log("ERROR"),console.log(a),"Cannot find bound expressions in a no expression token";};g.run=function(a,c,e,h,k,j){for(var i=j.copyDenormalizedBindings(c,k.outCache),l=[],r=0;r<c.length;r++){var u=g.runFilter(a,i[r],j,h,k),u=g.ebv(u);g.isEbvError(u)?e&&(u={__nullify__:!0,bindings:c[r]},l.push(u)):u===!0?l.push(c[r]):e&&(u={__nullify__:!0,bindings:c[r]},
l.push(u))}return l};g.collect=function(a,c,e,h,k){for(var j=k.copyDenormalizedBindings(c,h.outCache),i=[],l=0;l<j.length;l++){var r=g.runFilter(a,j[l],k,e,h);i.push({binding:c[l],value:r})}return i};g.runDistinct=function(){};g.runAggregator=function(a,c,e,h,k){if(c==null||c.length===0)return g.ebvError();else if(a.token==="variable"&&a.kind=="var")return c[0][a.value.value];else if(a.token==="variable"&&a.kind==="aliased")if(a.expression.expressionType==="atomic"&&a.expression.primaryexpression===
"var")return c[0][a.expression.value.value];else if(a.expression.expressionType==="aggregate")if(a.expression.aggregateType==="max"){for(var j=null,i=0;i<c.length;i++){var l=c[i],l=g.runFilter(a.expression.expression,l,e,h,k);g.isEbvError(l)||(j===null?j=l:g.runLtFunction(j,l).value===!0&&(j=l))}return j===null?g.ebvError():j}else if(a.expression.aggregateType==="min"){j=null;for(i=0;i<c.length;i++)l=c[i],l=g.runFilter(a.expression.expression,l,e,h,k),g.isEbvError(l)||(j===null?j=l:g.runGtFunction(j,
l).value===!0&&(j=l));return j===null?g.ebvError():j}else if(a.expression.aggregateType==="count"){var j={},r=0;if(a.expression.expression==="*")if(a.expression.distinct!=null&&a.expression.distinct!="")for(i=0;i<c.length;i++){var l=c[i],u=y.hashTerm(l);j[u]==null&&(j[u]=!0,r++)}else r=c.length;else for(i=0;i<c.length;i++)l=c[i],l=g.runFilter(a.expression.expression,l,e,h,k),g.isEbvError(l)||(a.expression.distinct!=null&&a.expression.distinct!=""?(u=y.hashTerm(l),j[u]==null&&(j[u]=!0,r++)):r++);return{token:"literal",
type:"http://www.w3.org/2001/XMLSchema#integer",value:""+r}}else if(a.expression.aggregateType==="avg"){for(var j={},t={token:"literal",type:"http://www.w3.org/2001/XMLSchema#integer",value:"0"},i=r=0;i<c.length;i++)l=c[i],l=g.runFilter(a.expression.expression,l,e,h,k),g.isEbvError(l)||(a.expression.distinct!=null&&a.expression.distinct!=""?(u=y.hashTerm(l),j[u]==null&&(j[u]=!0,g.isNumeric(l)&&(t=g.runSumFunction(t,l),r++))):g.isNumeric(l)&&(t=g.runSumFunction(t,l),r++));a=g.runDivFunction(t,{token:"literal",
type:"http://www.w3.org/2001/XMLSchema#integer",value:""+r});a.value=""+a.value;return a}else if(a.expression.aggregateType==="sum"){j={};t={token:"literal",type:"http://www.w3.org/2001/XMLSchema#integer",value:"0"};for(i=0;i<c.length;i++)l=c[i],l=g.runFilter(a.expression.expression,l,e,h,k),g.isEbvError(l)||(a.expression.distinct!=null&&a.expression.distinct!=""?(u=y.hashTerm(l),j[u]==null&&(j[u]=!0,g.isNumeric(l)&&(t=g.runSumFunction(t,l)))):g.isNumeric(l)&&(t=g.runSumFunction(t,l)));t.value=""+
t.value;return t}else return l=g.runFilter(aggregate.expression,c[0],h,{blanks:{},outCache:{}})};g.runFilter=function(a,c,e,h,k){if(a.expressionType!=null){var j=a.expressionType;if(j=="relationalexpression"){var j=g.runFilter(a.op1,c,e,h,k),i=g.runFilter(a.op2,c,e,h,k);return g.runRelationalFilter(a,j,i,c,e,h,k)}else if(j=="conditionalor")return g.runOrFunction(a,c,e,h,k);else if(j=="conditionaland")return g.runAndFunction(a,c,e,h,k);else if(j=="additiveexpression")return g.runAddition(a.summand,
a.summands,c,e,h,k);else if(j=="builtincall")return g.runBuiltInCall(a.builtincall,a.args,c,e,h,k);else if(j=="multiplicativeexpression")return g.runMultiplication(a.factor,a.factors,c,e,h,k);else if(j=="unaryexpression")return g.runUnaryExpression(a.unaryexpression,a.expression,c,e,h,k);else if(j=="irireforfunction")return g.runIriRefOrFunction(a.iriref,a.args,c,e,h,k);else if(j=="regex")return g.runRegex(a.text,a.pattern,a.flags,c,e,h,k);else if(j=="atomic")if(a.primaryexpression=="var")return c[a.value.value];
else{if(typeof a.value=="object"&&!(a.value.type==null||typeof a.value.type!="object"))a.value.type=y.lexicalFormBaseUri(a.value.type,k);return a.value}else throw"Unknown filter expression type";}else throw"Cannot find bound expressions in a no expression token";};g.isRDFTerm=function(a){return a==null?!1:a.token&&a.token=="literal"||a.token&&a.token=="uri"||a.token&&a.token=="blank"?!0:!1};g.RDFTermEquality=function(a,c,e,h){return a.token==="literal"&&c.token==="literal"?a.lang==c.lang&&a.type==
c.type&&a.value==c.value?!0:a.type!=null&&c.type!=null?g.ebvError():g.isSimpleLiteral(a)&&c.type!=null?g.ebvError():g.isSimpleLiteral(c)&&a.type!=null?g.ebvError():!1:a.token==="uri"&&c.token==="uri"?y.lexicalFormBaseUri(a,h)==y.lexicalFormBaseUri(c,h):a.token==="blank"&&c.token==="blank"?a.value==c.value:!1};g.isInteger=function(a){return a==null?!1:a.token==="literal"?a.type=="http://www.w3.org/2001/XMLSchema#integer"||a.type=="http://www.w3.org/2001/XMLSchema#decimal"||a.type=="http://www.w3.org/2001/XMLSchema#double"||
a.type=="http://www.w3.org/2001/XMLSchema#nonPositiveInteger"||a.type=="http://www.w3.org/2001/XMLSchema#negativeInteger"||a.type=="http://www.w3.org/2001/XMLSchema#long"||a.type=="http://www.w3.org/2001/XMLSchema#int"||a.type=="http://www.w3.org/2001/XMLSchema#short"||a.type=="http://www.w3.org/2001/XMLSchema#byte"||a.type=="http://www.w3.org/2001/XMLSchema#nonNegativeInteger"||a.type=="http://www.w3.org/2001/XMLSchema#unsignedLong"||a.type=="http://www.w3.org/2001/XMLSchema#unsignedInt"||a.type==
"http://www.w3.org/2001/XMLSchema#unsignedShort"||a.type=="http://www.w3.org/2001/XMLSchema#unsignedByte"||a.type=="http://www.w3.org/2001/XMLSchema#positiveInteger"?!0:!1:!1};g.isFloat=function(a){return a==null?!1:a.token==="literal"?a.type=="http://www.w3.org/2001/XMLSchema#float"?!0:!1:!1};g.isDecimal=function(a){return a==null?!1:a.token==="literal"?a.type=="http://www.w3.org/2001/XMLSchema#decimal"?!0:!1:!1};g.isDouble=function(a){return a==null?!1:a.token==="literal"?a.type=="http://www.w3.org/2001/XMLSchema#double"?
!0:!1:!1};g.isNumeric=function(a){return a==null?!1:a.token==="literal"?a.type=="http://www.w3.org/2001/XMLSchema#integer"||a.type=="http://www.w3.org/2001/XMLSchema#decimal"||a.type=="http://www.w3.org/2001/XMLSchema#float"||a.type=="http://www.w3.org/2001/XMLSchema#double"||a.type=="http://www.w3.org/2001/XMLSchema#nonPositiveInteger"||a.type=="http://www.w3.org/2001/XMLSchema#negativeInteger"||a.type=="http://www.w3.org/2001/XMLSchema#long"||a.type=="http://www.w3.org/2001/XMLSchema#int"||a.type==
"http://www.w3.org/2001/XMLSchema#short"||a.type=="http://www.w3.org/2001/XMLSchema#byte"||a.type=="http://www.w3.org/2001/XMLSchema#nonNegativeInteger"||a.type=="http://www.w3.org/2001/XMLSchema#unsignedLong"||a.type=="http://www.w3.org/2001/XMLSchema#unsignedInt"||a.type=="http://www.w3.org/2001/XMLSchema#unsignedShort"||a.type=="http://www.w3.org/2001/XMLSchema#unsignedByte"||a.type=="http://www.w3.org/2001/XMLSchema#positiveInteger"?!0:!1:!1};g.isSimpleLiteral=function(a){return a&&a.token=="literal"?
a.type==null&&a.lang==null?!0:!1:!1};g.isXsdType=function(a,c){return c&&c.token=="literal"?c.type=="http://www.w3.org/2001/XMLSchema#"+a:!1};g.ebv=function(a){if(a==null||g.isEbvError(a))return g.ebvError();else if(a.token&&a.token==="literal")if(a.type=="http://www.w3.org/2001/XMLSchema#integer"||a.type=="http://www.w3.org/2001/XMLSchema#decimal"||a.type=="http://www.w3.org/2001/XMLSchema#double"||a.type=="http://www.w3.org/2001/XMLSchema#nonPositiveInteger"||a.type=="http://www.w3.org/2001/XMLSchema#negativeInteger"||
a.type=="http://www.w3.org/2001/XMLSchema#long"||a.type=="http://www.w3.org/2001/XMLSchema#int"||a.type=="http://www.w3.org/2001/XMLSchema#short"||a.type=="http://www.w3.org/2001/XMLSchema#byte"||a.type=="http://www.w3.org/2001/XMLSchema#nonNegativeInteger"||a.type=="http://www.w3.org/2001/XMLSchema#unsignedLong"||a.type=="http://www.w3.org/2001/XMLSchema#unsignedInt"||a.type=="http://www.w3.org/2001/XMLSchema#unsignedShort"||a.type=="http://www.w3.org/2001/XMLSchema#unsignedByte"||a.type=="http://www.w3.org/2001/XMLSchema#positiveInteger"){var c=
parseFloat(a.value);return isNaN(c)?!1:parseFloat(a.value)!=0}else return a.type==="http://www.w3.org/2001/XMLSchema#boolean"?a.value==="true"||a.value===!0||a.value==="True":a.type==="http://www.w3.org/2001/XMLSchema#string"?a.value!="":a.type==="http://www.w3.org/2001/XMLSchema#dateTime"?new Date(a.value)!=null:g.isEbvError(a)?a:a.type==null?a.value!=""?!0:!1:g.ebvError();else return a.value===!0};g.ebvTrue=function(){return{token:"literal",type:"http://www.w3.org/2001/XMLSchema#boolean",value:!0}};
g.ebvFalse=function(){return{token:"literal",type:"http://www.w3.org/2001/XMLSchema#boolean",value:!1}};g.ebvError=function(){return{token:"literal",type:"https://github.com/antoniogarrote/js-tools/types#error",value:null}};g.isEbvError=function(a){return typeof a=="object"&&a!=null?a.type==="https://github.com/antoniogarrote/js-tools/types#error":!1};g.ebvBoolean=function(a){return g.isEbvError(a)?a:a===!0?g.ebvTrue():g.ebvFalse()};g.runRelationalFilter=function(a,c,e,h,k,j,i){a=a.operator;if(a===
"=")return g.runEqualityFunction(c,e,h,k,j,i);else if(a==="!="){c=g.runEqualityFunction(c,e,h,k,j,i);if(!g.isEbvError(c))c.value=!c.value;return c}else if(a==="<")return g.runLtFunction(c,e,h);else if(a===">")return g.runGtFunction(c,e,h);else if(a==="<=")return g.runLtEqFunction(c,e,h);else if(a===">=")return g.runGtEqFunction(c,e,h);else throw"Error applying relational filter, unknown operator";};g.effectiveTypeValue=function(a){if(a.token=="literal")if(a.type=="http://www.w3.org/2001/XMLSchema#integer")return a=
parseInt(a.value);else if(a.type=="http://www.w3.org/2001/XMLSchema#decimal")return a=parseFloat(a.value);else if(a.type=="http://www.w3.org/2001/XMLSchema#float")return a=parseFloat(a.value);else if(a.type=="http://www.w3.org/2001/XMLSchema#double")return a=parseFloat(a.value);else if(a.type=="http://www.w3.org/2001/XMLSchema#nonPositiveInteger")return a=parseFloat(a.value);else if(a.type=="http://www.w3.org/2001/XMLSchema#negativeInteger")return a=parseInt(a.value);else if(a.type=="http://www.w3.org/2001/XMLSchema#long")return a=
parseInt(a.value);else if(a.type=="http://www.w3.org/2001/XMLSchema#int")return a=parseInt(a.value);else if(a.type=="http://www.w3.org/2001/XMLSchema#short")return a=parseInt(a.value);else if(a.type=="http://www.w3.org/2001/XMLSchema#byte")return a=parseInt(a.value);else if(a.type=="http://www.w3.org/2001/XMLSchema#nonNegativeInteger")return a=parseInt(a.value);else if(a.type=="http://www.w3.org/2001/XMLSchema#unsignedLong")return a=parseInt(a.value);else if(a.type=="http://www.w3.org/2001/XMLSchema#unsignedInt")return a=
parseInt(a.value);else if(a.type=="http://www.w3.org/2001/XMLSchema#unsignedShort")return a=parseInt(a.value);else if(a.type=="http://www.w3.org/2001/XMLSchema#unsignedByte")return a=parseInt(a.value);else if(a.type=="http://www.w3.org/2001/XMLSchema#positiveInteger")return a=parseInt(a.value);else if(a.type=="http://www.w3.org/2001/XMLSchema#date"||a.type=="http://www.w3.org/2001/XMLSchema#dateTime")try{return y.parseISO8601(a.value)}catch(c){return null}else return a.type=="http://www.w3.org/2001/XMLSchema#boolean"?
a.value===!0||a.value==="true"||a.value==="1"||a.value===1||a.value===!0?!0:a.value===!1||a.value==="false"||a.value==="0"||a.value===0||a.value===!1?!1:void 0:a.type=="http://www.w3.org/2001/XMLSchema#string"?a.value===null||a.value===void 0?void 0:""+a.value:a.value;else throw console.log("not implemented yet"),"value not supported in operations yet";};g.runOrFunction=function(a,c,e,h,k){for(var j=null,i=0;i<a.operands.length;i++){var l=g.runFilter(a.operands[i],c,e,h,k);g.isEbvError(l)==!1&&(l=
g.ebv(l));j==null?j=l:g.isEbvError(l)?j=g.isEbvError(j)?g.ebvError():j===!0?!0:g.ebvError():l===!0?j=!0:g.isEbvError(j)&&(j=g.ebvError())}return g.ebvBoolean(j)};g.runAndFunction=function(a,c,e,h,k){for(var j=null,i=0;i<a.operands.length;i++){var l=g.runFilter(a.operands[i],c,e,h,k);g.isEbvError(l)==!1&&(l=g.ebv(l));j==null?j=l:g.isEbvError(l)?j=g.isEbvError(j)?g.ebvError():j===!0?g.ebvError():!1:l===!0?g.isEbvError(j)&&(j=g.ebvError()):j=!1}return g.ebvBoolean(j)};g.runEqualityFunction=function(a,
c,e,h,k,j){if(g.isEbvError(a)||g.isEbvError(c))return g.ebvError();if(g.isNumeric(a)&&g.isNumeric(c))return e=g.effectiveTypeValue(a),k=g.effectiveTypeValue(c),isNaN(e)||isNaN(k)?g.ebvBoolean(g.RDFTermEquality(a,c,h,j)):g.ebvBoolean(e==k);else if((g.isSimpleLiteral(a)||g.isXsdType("string",a))&&(g.isSimpleLiteral(c)||g.isXsdType("string",c)))return g.ebvBoolean(g.effectiveTypeValue(a)==g.effectiveTypeValue(c));else if(g.isXsdType("boolean",a)&&g.isXsdType("boolean",c))return g.ebvBoolean(g.effectiveTypeValue(a)==
g.effectiveTypeValue(c));else if((g.isXsdType("dateTime",a)||g.isXsdType("date",a))&&(g.isXsdType("dateTime",c)||g.isXsdType("date",c))){if(g.isXsdType("dateTime",a)&&g.isXsdType("date",c))return g.ebvFalse();if(g.isXsdType("date",a)&&g.isXsdType("dateTime",c))return g.ebvFalse();a=y.compareDateComponents(a.value,c.value);return a!=null?a==0?g.ebvTrue():g.ebvFalse():g.ebvError()}else return g.isRDFTerm(a)&&g.isRDFTerm(c)?g.ebvBoolean(g.RDFTermEquality(a,c,h,j)):g.ebvFalse()};g.runGtFunction=function(a,
c){if(g.isEbvError(a)||g.isEbvError(c))return g.ebvError();if(g.isNumeric(a)&&g.isNumeric(c))return g.ebvBoolean(g.effectiveTypeValue(a)>g.effectiveTypeValue(c));else if(g.isSimpleLiteral(a)&&g.isSimpleLiteral(c))return g.ebvBoolean(g.effectiveTypeValue(a)>g.effectiveTypeValue(c));else if(g.isXsdType("string",a)&&g.isXsdType("string",c))return g.ebvBoolean(g.effectiveTypeValue(a)>g.effectiveTypeValue(c));else if(g.isXsdType("boolean",a)&&g.isXsdType("boolean",c))return g.ebvBoolean(g.effectiveTypeValue(a)>
g.effectiveTypeValue(c));else if((g.isXsdType("dateTime",a)||g.isXsdType("date",a))&&(g.isXsdType("dateTime",c)||g.isXsdType("date",c))){if(g.isXsdType("dateTime",a)&&g.isXsdType("date",c))return g.ebvFalse();if(g.isXsdType("date",a)&&g.isXsdType("dateTime",c))return g.ebvFalse();var e=y.compareDateComponents(a.value,c.value);return e!=null?e==1?g.ebvTrue():g.ebvFalse():g.ebvError()}else return g.ebvFalse()};g.runTotalGtFunction=function(a,c){return g.isEbvError(a)||g.isEbvError(c)?g.ebvError():g.isNumeric(a)&&
g.isNumeric(c)||g.isSimpleLiteral(a)&&g.isSimpleLiteral(c)||g.isXsdType("string",a)&&g.isSimpleLiteral("string",c)||g.isXsdType("boolean",a)&&g.isSimpleLiteral("boolean",c)||g.isXsdType("dateTime",a)&&g.isSimpleLiteral("dateTime",c)?g.runGtFunction(a,c,[]):a.token&&a.token==="uri"&&c.token&&c.token==="uri"?g.ebvBoolean(a.value>c.value):a.token&&a.token==="literal"&&c.token&&c.token==="literal"?g.ebvBoolean(""+a.value+a.type+a.lang>""+c.value+c.type+c.lang):a.token&&a.token==="blank"&&c.token&&c.token===
"blank"?g.ebvBoolean(a.value>c.value):a.value&&c.value?g.ebvBoolean(a.value>c.value):g.ebvTrue()};g.runLtFunction=function(a,c){if(g.isEbvError(a)||g.isEbvError(c))return g.ebvError();if(g.isNumeric(a)&&g.isNumeric(c))return g.ebvBoolean(g.effectiveTypeValue(a)<g.effectiveTypeValue(c));else if(g.isSimpleLiteral(a)&&g.isSimpleLiteral(c))return g.ebvBoolean(g.effectiveTypeValue(a)<g.effectiveTypeValue(c));else if(g.isXsdType("string",a)&&g.isXsdType("string",c))return g.ebvBoolean(g.effectiveTypeValue(a)<
g.effectiveTypeValue(c));else if(g.isXsdType("boolean",a)&&g.isXsdType("boolean",c))return g.ebvBoolean(g.effectiveTypeValue(a)<g.effectiveTypeValue(c));else if((g.isXsdType("dateTime",a)||g.isXsdType("date",a))&&(g.isXsdType("dateTime",c)||g.isXsdType("date",c))){if(g.isXsdType("dateTime",a)&&g.isXsdType("date",c))return g.ebvFalse();if(g.isXsdType("date",a)&&g.isXsdType("dateTime",c))return g.ebvFalse();var e=y.compareDateComponents(a.value,c.value);return e!=null?e==-1?g.ebvTrue():g.ebvFalse():
g.ebvError()}else return g.ebvFalse()};g.runGtEqFunction=function(a,c){if(g.isEbvError(a)||g.isEbvError(c))return g.ebvError();if(g.isNumeric(a)&&g.isNumeric(c))return g.ebvBoolean(g.effectiveTypeValue(a)>=g.effectiveTypeValue(c));else if(g.isSimpleLiteral(a)&&g.isSimpleLiteral(c))return g.ebvBoolean(g.effectiveTypeValue(a)>=g.effectiveTypeValue(c));else if(g.isXsdType("string",a)&&g.isXsdType("string",c))return g.ebvBoolean(g.effectiveTypeValue(a)>=g.effectiveTypeValue(c));else if(g.isXsdType("boolean",
a)&&g.isXsdType("boolean",c))return g.ebvBoolean(g.effectiveTypeValue(a)>=g.effectiveTypeValue(c));else if((g.isXsdType("dateTime",a)||g.isXsdType("date",a))&&(g.isXsdType("dateTime",c)||g.isXsdType("date",c))){if(g.isXsdType("dateTime",a)&&g.isXsdType("date",c))return g.ebvFalse();if(g.isXsdType("date",a)&&g.isXsdType("dateTime",c))return g.ebvFalse();var e=y.compareDateComponents(a.value,c.value);return e!=null?e!=-1?g.ebvTrue():g.ebvFalse():g.ebvError()}else return g.ebvFalse()};g.runLtEqFunction=
function(a,c){if(g.isEbvError(a)||g.isEbvError(c))return g.ebvError();if(g.isNumeric(a)&&g.isNumeric(c))return g.ebvBoolean(g.effectiveTypeValue(a)<=g.effectiveTypeValue(c));else if(g.isSimpleLiteral(a)&&g.isSimpleLiteral(c))return g.ebvBoolean(g.effectiveTypeValue(a)<=g.effectiveTypeValue(c));else if(g.isXsdType("string",a)&&g.isXsdType("string",c))return g.ebvBoolean(g.effectiveTypeValue(a)<=g.effectiveTypeValue(c));else if(g.isXsdType("boolean",a)&&g.isXsdType("boolean",c))return g.ebvBoolean(g.effectiveTypeValue(a)<=
g.effectiveTypeValue(c));else if((g.isXsdType("dateTime",a)||g.isXsdType("date",a))&&(g.isXsdType("dateTime",c)||g.isXsdType("date",c))){if(g.isXsdType("dateTime",a)&&g.isXsdType("date",c))return g.ebvFalse();if(g.isXsdType("date",a)&&g.isXsdType("dateTime",c))return g.ebvFalse();var e=y.compareDateComponents(a.value,c.value);return e!=null?e!=1?g.ebvTrue():g.ebvFalse():g.ebvError()}else return g.ebvFalse()};g.runAddition=function(a,c,e,h,k,j){var i=g.runFilter(a,e,h,k,j);if(g.isEbvError(i))return g.ebvError();
a=i;if(g.isNumeric(i)){for(i=0;i<c.length;i++){var l=g.runFilter(c[i].expression,e,h,k,j);if(g.isNumeric(l))c[i].operator==="+"?a=g.runSumFunction(a,l):c[i].operator==="-"&&(a=g.runSubFunction(a,l));else return g.ebvFalse()}return a}else return g.ebvFalse()};g.runSumFunction=function(a,c){if(g.isEbvError(a)||g.isEbvError(c))return g.ebvError();var e=g.effectiveTypeValue(a)+g.effectiveTypeValue(c);return g.isDouble(a)||g.isDouble(c)?{token:"literal",type:"http://www.w3.org/2001/XMLSchema#double",value:e}:
g.isFloat(a)||g.isFloat(c)?{token:"literal",type:"http://www.w3.org/2001/XMLSchema#float",value:e}:g.isDecimal(a)||g.isDecimal(c)?{token:"literal",type:"http://www.w3.org/2001/XMLSchema#decimal",value:e}:{token:"literal",type:"http://www.w3.org/2001/XMLSchema#integer",value:e}};g.runSubFunction=function(a,c){if(g.isEbvError(a)||g.isEbvError(c))return g.ebvError();var e=g.effectiveTypeValue(a)-g.effectiveTypeValue(c);return g.isDouble(a)||g.isDouble(c)?{token:"literal",type:"http://www.w3.org/2001/XMLSchema#double",
value:e}:g.isFloat(a)||g.isFloat(c)?{token:"literal",type:"http://www.w3.org/2001/XMLSchema#float",value:e}:g.isDecimal(a)||g.isDecimal(c)?{token:"literal",type:"http://www.w3.org/2001/XMLSchema#decimal",value:e}:{token:"literal",type:"http://www.w3.org/2001/XMLSchema#integer",value:e}};g.runMultiplication=function(a,c,e,h,k,j){a=g.runFilter(a,e,h,k,j);if(g.isEbvError(a))return a;var i=a;if(g.isNumeric(a)){for(var l=0;l<c.length;l++){var r=g.runFilter(c[l].expression,e,h,k,j);if(g.isEbvError(r))return a;
if(g.isNumeric(r))c[l].operator==="*"?i=g.runMulFunction(i,r):c[l].operator==="/"&&(i=g.runDivFunction(i,r));else return g.ebvFalse()}return i}else return g.ebvFalse()};g.runMulFunction=function(a,c){if(g.isEbvError(a)||g.isEbvError(c))return g.ebvError();var e=g.effectiveTypeValue(a)*g.effectiveTypeValue(c);return g.isDouble(a)||g.isDouble(c)?{token:"literal",type:"http://www.w3.org/2001/XMLSchema#double",value:e}:g.isFloat(a)||g.isFloat(c)?{token:"literal",type:"http://www.w3.org/2001/XMLSchema#float",
value:e}:g.isDecimal(a)||g.isDecimal(c)?{token:"literal",type:"http://www.w3.org/2001/XMLSchema#decimal",value:e}:{token:"literal",type:"http://www.w3.org/2001/XMLSchema#integer",value:e}};g.runDivFunction=function(a,c){if(g.isEbvError(a)||g.isEbvError(c))return g.ebvError();var e=g.effectiveTypeValue(a)/g.effectiveTypeValue(c);return g.isDouble(a)||g.isDouble(c)?{token:"literal",type:"http://www.w3.org/2001/XMLSchema#double",value:e}:g.isFloat(a)||g.isFloat(c)?{token:"literal",type:"http://www.w3.org/2001/XMLSchema#float",
value:e}:g.isDecimal(a)||g.isDecimal(c)?{token:"literal",type:"http://www.w3.org/2001/XMLSchema#decimal",value:e}:{token:"literal",type:"http://www.w3.org/2001/XMLSchema#integer",value:e}};g.runBuiltInCall=function(a,c,e,h,k,j){if(a==="notexists"||a==="exists"){var i=JSON.parse(JSON.stringify(c[0])),i=h.abstractQueryTree.parseSelect({pattern:i},e),i=h.abstractQueryTree.bind(i.pattern,e),e=h.executeSelectUnit([{kind:"*"}],k,i,j);return a==="exists"?g.ebvBoolean(e.length!==0):g.ebvBoolean(e.length===
0)}else{for(var i=[],l=0;l<c.length;l++)if(c[l].token==="var")i.push(c[l]);else{var r=g.runFilter(c[l],e,h,k,j);if(g.isEbvError(r))return r;i.push(r)}if(a==="str")return i[0].token==="literal"?{token:"literal",type:null,value:""+i[0].value}:i[0].token==="uri"?{token:"literal",type:null,value:i[0].value}:g.ebvFalse();else if(a==="lang")return i[0].token==="literal"?i[0].lang!=null?{token:"literal",value:""+i[0].lang}:{token:"literal",value:""}:g.ebvError();else if(a==="datatype")return i[0].token===
"literal"?(a=i[0],a.type!=null?typeof a.type==="string"?{token:"uri",value:a.type,prefix:null,suffix:null}:a.type:a.lang==null?{token:"uri",value:"http://www.w3.org/2001/XMLSchema#string",prefix:null,suffix:null}:g.ebvError()):g.ebvError();else if(a==="isliteral")return i[0].token==="literal"?g.ebvTrue():g.ebvFalse();else if(a==="isblank")return i[0].token==="blank"?g.ebvTrue():g.ebvFalse();else if(a==="isuri"||a==="isiri")return i[0].token==="uri"?g.ebvTrue():g.ebvFalse();else if(a==="sameterm")return a=
g.RDFTermEquality(i[0],i[1],h,j),g.isEbvError(a)&&(a=!1),g.ebvBoolean(a);else if(a==="langmatches")return a=i[0],e=i[1],a.token==="literal"&&e.token==="literal"?e.value==="*"&&a.value!=""?g.ebvTrue():g.ebvBoolean(a.value.toLowerCase().indexOf(e.value.toLowerCase())===0):g.ebvError();else if(a==="bound")return a=i[0].value,a==null?g.ebvError():e[a]!=null?g.ebvTrue():g.ebvFalse();else throw"Builtin call "+a+" not implemented yet";}};g.runUnaryExpression=function(a,c,e,h,k,j){c=g.runFilter(c,e,h,k,j);
if(g.isEbvError(c))return c;if(a==="!"){var i=g.ebv(c);return g.isEbvError(i)?g.ebvFalse():g.ebvBoolean(!i)}else if(a==="+")return g.isNumeric(c)?c:g.ebvError();else if(a==="-")if(g.isNumeric(c)){a={};for(i in c)a[i]=c[i];a.value=-a.value;return a}else return g.ebvError()};g.runRegex=function(a,c,e,h,k,j,i){if(a!=null)a=g.runFilter(a,h,k,j,i);else return g.ebvError();if(c!=null)c=g.runFilter(c,h,k,j,i);else return g.ebvError();e!=null&&(e=g.runFilter(e,h,k,j,i));if(c!=null&&c.token==="literal"&&(e==
null||e.token==="literal"))c=c.value,e=e==null?null:e.value;else return g.ebvError();if(a!=null&&a.token=="var")if(h[a.value]!=null)a=h[a.value];else return g.ebvError();else if(a!=null&&a.token==="literal")if(a.type==null||g.isXsdType("string",a))a=a.value;else return g.ebvError();else return g.ebvError();return(e==null?RegExp(c):RegExp(c,e.toLowerCase())).exec(a)?g.ebvTrue():g.ebvFalse()};g.normalizeLiteralDatatype=function(a,c,e){if(!(a.value.type==null||typeof a.value.type!="object"))a.value.type=
y.lexicalFormBaseUri(a.value.type,e);return a};g.runIriRefOrFunction=function(a,c,e,h,k,j){if(c==null)return a;else{for(var i=[],l=0;l<c.length;l++)i.push(g.runFilter(c[l],e,h,k,j));a=y.lexicalFormBaseUri(a,j);if(a=="http://www.w3.org/2001/XMLSchema#integer"||a=="http://www.w3.org/2001/XMLSchema#decimal"||a=="http://www.w3.org/2001/XMLSchema#double"||a=="http://www.w3.org/2001/XMLSchema#nonPositiveInteger"||a=="http://www.w3.org/2001/XMLSchema#negativeInteger"||a=="http://www.w3.org/2001/XMLSchema#long"||
a=="http://www.w3.org/2001/XMLSchema#int"||a=="http://www.w3.org/2001/XMLSchema#short"||a=="http://www.w3.org/2001/XMLSchema#byte"||a=="http://www.w3.org/2001/XMLSchema#nonNegativeInteger"||a=="http://www.w3.org/2001/XMLSchema#unsignedLong"||a=="http://www.w3.org/2001/XMLSchema#unsignedInt"||a=="http://www.w3.org/2001/XMLSchema#unsignedShort"||a=="http://www.w3.org/2001/XMLSchema#unsignedByte"||a=="http://www.w3.org/2001/XMLSchema#positiveInteger")if(i=i[0],i.token==="literal")if(i=g.normalizeLiteralDatatype(i,
h,j),i.type=="http://www.w3.org/2001/XMLSchema#integer"||i.type=="http://www.w3.org/2001/XMLSchema#decimal"||i.type=="http://www.w3.org/2001/XMLSchema#double"||i.type=="http://www.w3.org/2001/XMLSchema#nonPositiveInteger"||i.type=="http://www.w3.org/2001/XMLSchema#negativeInteger"||i.type=="http://www.w3.org/2001/XMLSchema#long"||i.type=="http://www.w3.org/2001/XMLSchema#int"||i.type=="http://www.w3.org/2001/XMLSchema#short"||i.type=="http://www.w3.org/2001/XMLSchema#byte"||i.type=="http://www.w3.org/2001/XMLSchema#nonNegativeInteger"||
i.type=="http://www.w3.org/2001/XMLSchema#unsignedLong"||i.type=="http://www.w3.org/2001/XMLSchema#unsignedInt"||i.type=="http://www.w3.org/2001/XMLSchema#unsignedShort"||i.type=="http://www.w3.org/2001/XMLSchema#unsignedByte"||i.type=="http://www.w3.org/2001/XMLSchema#positiveInteger")return i.type=a,i;else if(i.type=="http://www.w3.org/2001/XMLSchema#boolean")return g.ebv(i)==!0?(i.type=a,i.value=1):(i.type=a,i.value=0),i;else if(i.type=="http://www.w3.org/2001/XMLSchema#float"||i.type=="http://www.w3.org/2001/XMLSchema#double")return i.type=
a,i.value=parseInt(i.value),i;else if(i.type=="http://www.w3.org/2001/XMLSchema#string"||i.type==null){if(i.value.split(".").length>2)return g.ebvError();else if(i.value.split("-").length>2)return g.ebvError();else if(i.value.split("/").length>2)return g.ebvError();else if(i.value.split("+").length>2)return g.ebvError();if(a=="http://www.w3.org/2001/XMLSchema#decimal"&&(i.value.indexOf("e")!=-1||i.value.indexOf("E")!=-1))return g.ebvError();if(a=="http://www.w3.org/2001/XMLSchema#int"||a=="http://www.w3.org/2001/XMLSchema#integer")if(i.value.indexOf("e")!=
-1||i.value.indexOf("E")!=-1||i.value.indexOf(".")!=-1)return g.ebvError();try{return i.value=parseInt(parseFloat(i.value)),isNaN(i.value)?g.ebvError():(i.type=a,i)}catch(r){return g.ebvError()}}else return g.ebvError();else return g.ebvError();else if(a=="http://www.w3.org/2001/XMLSchema#boolean")return i=i[0],i.token==="literal"&&i.type==null?i.value==="true"||i.value==="1"?g.ebvTrue():i.value==="false"||i.value==="0"?g.ebvFalse():g.ebvError():i.token==="literal"?g.isEbvError(i)?i:g.ebvBoolean(i):
g.ebvError();else if(a=="http://www.w3.org/2001/XMLSchema#string")if(i=i[0],i.token==="literal")if(i=g.normalizeLiteralDatatype(i,h,j),i.type=="http://www.w3.org/2001/XMLSchema#integer"||i.type=="http://www.w3.org/2001/XMLSchema#decimal"||i.type=="http://www.w3.org/2001/XMLSchema#double"||i.type=="http://www.w3.org/2001/XMLSchema#nonPositiveInteger"||i.type=="http://www.w3.org/2001/XMLSchema#negativeInteger"||i.type=="http://www.w3.org/2001/XMLSchema#long"||i.type=="http://www.w3.org/2001/XMLSchema#int"||
i.type=="http://www.w3.org/2001/XMLSchema#short"||i.type=="http://www.w3.org/2001/XMLSchema#byte"||i.type=="http://www.w3.org/2001/XMLSchema#nonNegativeInteger"||i.type=="http://www.w3.org/2001/XMLSchema#unsignedLong"||i.type=="http://www.w3.org/2001/XMLSchema#unsignedInt"||i.type=="http://www.w3.org/2001/XMLSchema#unsignedShort"||i.type=="http://www.w3.org/2001/XMLSchema#unsignedByte"||i.type=="http://www.w3.org/2001/XMLSchema#positiveInteger"||i.type=="http://www.w3.org/2001/XMLSchema#float")return i.type=
a,i.value=""+i.value,i;else if(i.type=="http://www.w3.org/2001/XMLSchema#string")return i;else if(i.type=="http://www.w3.org/2001/XMLSchema#boolean")return g.ebv(i)?(i.type=a,i.value="true"):(i.type=a,i.value="false"),i;else if(i.type=="http://www.w3.org/2001/XMLSchema#dateTime"||i.type=="http://www.w3.org/2001/XMLSchema#date"){i.type=a;if(typeof i.value!="string")i.value=y.iso8601(i.value);return i}else return i.type==null?(i.value=""+i.value,i.type=a,i):g.ebvError();else return i.token==="uri"?
{token:"literal",value:y.lexicalFormBaseUri(i,j),type:a,lang:null}:g.ebvError();else if(a=="http://www.w3.org/2001/XMLSchema#dateTime"||a=="http://www.w3.org/2001/XMLSchema#date")if(i=i[0],i.type=="http://www.w3.org/2001/XMLSchema#dateTime"||i.type=="http://www.w3.org/2001/XMLSchema#date")return i;else if(i.type=="http://www.w3.org/2001/XMLSchema#string"||i.type==null)try{return i.value=y.iso8601(y.parseStrictISO8601(i.value)),i.type=a,i}catch(u){return g.ebvError()}else return g.ebvError();else if(a==
"http://www.w3.org/2001/XMLSchema#float")if(i=i[0],i.token==="literal")if(i=g.normalizeLiteralDatatype(i,h,j),i.type=="http://www.w3.org/2001/XMLSchema#decimal"||i.type=="http://www.w3.org/2001/XMLSchema#int")return i.type=a,i.value=parseFloat(i.value),i;else if(i.type=="http://www.w3.org/2001/XMLSchema#boolean")return g.ebv(i)==!0?(i.type=a,i.value=1):(i.type=a,i.value=0),i;else if(i.type=="http://www.w3.org/2001/XMLSchema#float"||i.type=="http://www.w3.org/2001/XMLSchema#double")return i.type=a,
i.value=parseFloat(i.value),i;else if(i.type=="http://www.w3.org/2001/XMLSchema#string")try{return i.value=parseFloat(i.value),isNaN(i.value)?g.ebvError():(i.type=a,i)}catch(t){return g.ebvError()}else if(i.type==null){if(i.value.split(".").length>2)return g.ebvError();else if(i.value.split("-").length>2)return g.ebvError();else if(i.value.split("/").length>2)return g.ebvError();else if(i.value.split("+").length>2)return g.ebvError();try{return i.value=parseFloat(i.value),isNaN(i.value)?g.ebvError():
(i.type=a,i)}catch(w){return g.ebvError()}}else return g.ebvError();else return g.ebvError();else return g.ebvError()}};var C={variablesInBGP:function(a){var c=a.variables;if(c)return c;var e=a.value||a,c=[],h;for(h in e)e[h]&&e[h].token==="var"?c.push(e[h].value):e[h]&&e[h].token==="blank"&&c.push("blank:"+e[h].value);return a.variables=c},connected:function(a,c){for(var e="/"+a.vars.join("/")+"/",h=0;h<c.vars.length;h++)if(e.indexOf("/"+c.vars[h]+"/")!=-1)return!0;return!1},variablesIntersectionBGP:function(a,
c){for(var e=C.variablesInBGP(a).sort(),h=C.variablesInBGP(c).sort(),g=0,j=0,i=[];g<e.length&&j<h.length;)e[g]===h[j]?(i.push(e[g]),g++,j++):e[g]<h[j]?g++:j++;return i},executeAndBGPsGroups:function(a){for(var c={},e={},h=0,g=0;g<a.length;g++){var j=a[g],i=[],l;for(l in j)l!="_cost"&&(j[l].token==="var"?i.push(j[l].value):j[l].token==="blank"&&i.push(j[l].value));var r=!1,u;for(u in e){for(var t=e[u],w=0;w<i.length;w++)if(t.indexOf("/"+i[w]+"/")!=-1){c[u].push(j);e[u]=t+i.join("/")+"/";r=!0;break}if(r)break}r||
(c[h]=[j],e[h]="/"+i.join("/")+"/",h++)}a=[];for(h in c)a.push(c[h]);return a},intersectionSize:function(a,c){for(var e=c.i.split("_"),h=0;h<e.length;h++)if(e[h]!=""&&a.i.indexOf("_"+e[h]+"_")!=-1)return 1;return 0},createJoinTree:function(a,c){for(var e="/"+a.vars.join("/")+"/",h=a.vars.concat([]),g=[],j=0;j<c.vars.length;j++)e.indexOf("/"+c.vars[j]+"/")!=-1?c.vars[j].indexOf("_:")==0?g.push("blank:"+c.vars[j]):g.push(c.vars[j]):h.push(c.vars[j]);for(var i=c.i.split("_"),l=a.i.split("_"),e={},j=
0;j<i.length;j++)i[j]!=""&&(e[i[j]]=!0);for(j=0;j<l.length;j++)l[j]!=""&&(e[l[j]]=!0);var j=[],r;for(r in e)j.push(r);return{left:a,right:c,cost:a.cost+c.cost,i:"_"+j.sort().join("_")+"_",vars:h,join:g}}};C.executeBushyTree=function(a,c,e,h){if(a.left==null)return C.executeEmptyJoinBGP(a.right,c,e,h);else if(a.right==null)return C.executeEmptyJoinBGP(a.left,c,e,h);else{var g=C.executeBushyTree(a.left,c,e,h);if(g!=null)return c=C.executeBushyTree(a.right,c,e,h),c!=null?C.joinBindings2(a.join,g,c):
null}};C.executeAndBGPsDPSize=function(a,c,e,h){for(var g=C.executeAndBGPsGroups(a),a=[],j=0;j<g.length;j++){var i=g[j];e.computeCosts(i,h);var l={},r={},u={},t=1,w=null,y={};u["1"]=[];for(var A=0;A<i.length;A++){var t=[],E;for(E in i[A])E!="_cost"&&(i[A][E].token==="var"?t.push(i[A][E].value):i[A][E].token==="blank"&&t.push(i[A][E].value));r["_"+A+"_"]={left:i[A],right:null,cost:i[A]._cost,i:"_"+A+"_",vars:t};t={left:i[A],right:null,cost:i[A]._cost,i:"_"+A+"_",vars:t};l["_"+A+"_"]=t;delete i[A]._cost;
y["_"+A+"_"]=!0;u["1"].push("_"+A+"_");if(w==null||w.cost>t.cost)w=t}for(var F=2;F<=i.length;F++)for(var B=1;B<F;B++)for(var G=u[""+B]||[],K=u[""+(F-B)]||[],A=0;A<G.length;A++)for(var L=0;L<K.length;L++)if(G[A]!==K[L]){var J=r[G[A]],I=r[K[L]];if(C.intersectionSize(J,I)==0&&C.connected(J,I)&&(t=F,I=C.createJoinTree(l[J.i],l[I.i]),!y[I.i])){y[I.i]=!0;var O=I.cost+1;if(l[I.i]!=null)O=l[I.i].cost;J=u[F]||[];J.push(I.i);r[I.i]=I;u[F]=J;O>I.cost&&(t===F&&(w=I),l[I.i]=I)}}a.push(w)}J=null;for(j=0;j<a.length;j++)E=
C.executeBushyTree(a[j],c,e,h),J=J==null?E:C.crossProductBindings(J,E);return J};C.executeEmptyJoinBGP=function(a,c,e,h){return C.executeBGPDatasets(a,c,e,h)};C.executeBGPDatasets=function(a,c,e,h){var g={};if(a.graph==null){for(var j=[],i=0;i<c.implicit.length;i++)if(g[c.implicit[i].oid]==null){g[c.implicit[i].oid]=!0;a.graph=c.implicit[i];var l=e.rangeQuery(a,h),l=C.buildBindingsFromRange(l,a);j.push(l)}return a=C.unionManyBindings(j)}else if(a.graph.token==="var"){for(var r=a.graph.value,j=[],
i=0;i<c.named.length;i++)if(g[c.named[i].oid]==null)if(g[c.named[i].oid]=!0,a.graph=c.named[i],l=e.rangeQuery(a,h),l!=null){for(var l=C.buildBindingsFromRange(l,a),u=0;u<l.length;u++)l[u][r]=c.named[i].oid;j.push(l)}else return null;return a=C.unionManyBindings(j||[])}else return l=e.rangeQuery(a,h),l!=null?l=C.buildBindingsFromRange(l,a):null};C.buildBindingsFromRange=function(a,c){C.variablesInBGP(c);var e={},h=c.value||c,e={};for(l in h)h[l]&&h[l].token==="var"?e[l]=h[l].value:h[l]&&h[l].token===
"blank"&&(e[l]="blank:"+h[l].value);h=[];if(a!=null)for(var g=0;g<a.length;g++){var j={},i=a[g],l;for(l in e)j[e[l]]=i[l];h.push(j)}return h};C.areCompatibleBindings=function(a,c){for(var e in a)if(c[e]!=null&&c[e]!=a[e])return!1;return!0};C.mergeBindings=function(a,c){var e={},h;for(h in a)e[h]=a[h];for(h in c)e[h]=c[h];return e};C.joinBindings2=function(a,c,e){for(var h={},g,j,i,l,r=[],u=0;u<c.length;u++){g=c[u];l=h;for(var t=0;t<a.length;t++)j=a[t],j=g[j],t==a.length-1?(i=l[j]||[],i.push(g),l[j]=
i):(i=l[j]||{},l=l[j]=i)}for(u=0;u<e.length;u++){g=e[u];l=h;for(t=0;t<a.length;t++)if(j=a[t],j=g[j],l[j]!=null)if(t==a.length-1)for(c=0;c<l[j].length;c++)r.push(C.mergeBindings(l[j][c],g));else l=l[j]}return r};C.joinBindings=function(a,c){for(var e=[],h=0;h<a.length;h++)for(var g=a[h],j=0;j<c.length;j++){var i=c[j];C.areCompatibleBindings(g,i)&&e.push(C.mergeBindings(g,i))}return e};C.augmentMissingBindings=function(a,c){for(var e in c)a[e]==null&&(a[e]=null);return a};C.leftOuterJoinBindings=function(a,
c){for(var e=[],h=0;h<a.length;h++){for(var g=a[h],j=!1,i=0;i<c.length;i++){var l=c[i];C.areCompatibleBindings(g,l)&&(j=!0,e.push(C.mergeBindings(g,l)))}j===!1&&(C.augmentMissingBindings(g,l),e.push(g))}return e};C.crossProductBindings=function(a,c){for(var e=[],h=0;h<a.length;h++)for(var g=a[h],j=0;j<c.length;j++)e.push(C.mergeBindings(g,c[j]));return e};C.unionBindings=function(a,c){return a.concat(c)};C.unionManyBindings=function(a){for(var c=[],e=0;e<a.length;e++)c=C.unionBindings(c,a[e]);return c};
var E={},ea=C;E.QueryEngine=function(a){if(arguments.length!=0)this.backend=a.backend,this.lexicon=a.lexicon,this.eventsOnBatchLoad=a.eventsOnBatchLoad||!1,this.defaultPrefixes={},this.abstractQueryTree=new J.AbstractQueryTree,this.rdfLoader=new Y.RDFLoader(a.communication),this.callbacksBackend=new B.CallbacksBackend(this)};E.QueryEngine.prototype.registerNsInEnvironment=function(a,c){var e=[];if(a!=null&&a.prefixes!=null)e=a.prefixes;var h={},g;for(g in this.defaultPrefixes)h[g]=this.defaultPrefixes[g];
for(g=0;g<e.length;g++){var j=e[g];if(j.token==="prefix")h[j.prefix]=j.local}c.namespaces=h;c.base=a!=null&&a.base&&typeof a.base==="object"?a.base.value:null};E.QueryEngine.prototype.applyModifier=function(a,c){if(a=="DISTINCT"){for(var e={},h=[],g=0;g<c.length;g++){var j=c[g],i="",l;for(l in j){var r=j[l];r==null?i=i+l+"null":r.token=="literal"?(r.value!=null&&(i+=r.value),r.lang!=null&&(i+=r.lang),r.type!=null&&(i+=r.type)):i=r.value?i+l+r.value:i+l+r}e[i]==null&&(h.push(j),e[i]=!0)}return h}else return c};
E.QueryEngine.prototype.applyLimitOffset=function(a,c,e){if(c==null&&a==null)return e;a==null&&(a=0);c=c==null?e.length:a+c;return e.slice(a,c)};E.QueryEngine.prototype.applySingleOrderBy=function(a,c,e,h){for(var k=[],j=0;j<a.length;j++){var i=g.collect(a[j].expression,[c],e,h,this);k.push(i[0].value)}return{binding:c,value:k}};E.QueryEngine.prototype.applyOrderBy=function(a,c,e,h){var g=this,j=[];if(a!=null&&a.length>0){for(var i=0;i<c.length;i++){var l=g.applySingleOrderBy(a,c[i],e,h);j.push(l)}j.sort(function(c,
e){return g.compareFilteredBindings(c,e,a,h)});c=[];for(i=0;i<j.length;i++)c.push(j[i].binding)}return c};E.QueryEngine.prototype.compareFilteredBindings=function(a,c,e,h){for(var k=0;;){if(k==a.value.length)return 0;var j=e[k].direction;if(a.value[k]==null&&c.value[k]==null)k++;else{if(a.value[k]==null)a={value:!1};else if(c.value[k]==null)a={value:!0};else if(a.value[k].token==="blank"&&c.value[k].token==="blank"){k++;continue}else if(a.value[k].token==="blank")a={value:!1};else if(c.value[k].token===
"blank")a={value:!0};else if(a.value[k].token==="uri"&&c.value[k].token==="uri")if(g.runEqualityFunction(a.value[k],c.value[k],[],this,h).value==!0){k++;continue}else a=g.runTotalGtFunction(a.value[k],c.value[k],[]);else if(a.value[k].token==="uri")a={value:!1};else if(c.value[k].token==="uri")a={value:!0};else if(a.value[k].token==="literal"&&c.value[k].token==="literal"&&a.value[k].type==null&&c.value[k].type==null)if(g.runEqualityFunction(a.value[k],c.value[k],[],this,h).value==!0){k++;continue}else a=
g.runTotalGtFunction(a.value[k],c.value[k],[]);else if(a.value[k].token==="literal"&&a.value[k].type==null)a={value:!1};else if(c.value[k].token==="literal"&&c.value[k].type==null)a={value:!0};else if(g.runEqualityFunction(a.value[k],c.value[k],[],this,h).value==!0){k++;continue}else a=g.runTotalGtFunction(a.value[k],c.value[k],[]);return a.value==!0?j==="ASC"?1:-1:j==="ASC"?-1:1}}};E.QueryEngine.prototype.removeDefaultGraphBindings=function(a,c){for(var e=[],h={},g=0;g<c.named.length;g++)h[c.named[g].oid]=
!0;for(g=0;g<c.implicit.length;g++)h[c.implicit[g].oid]==null&&e.push(c.implicit[g].oid);e=[];for(g=0;g<a.length;g++){var j=a[g],i=!1,l;for(l in j){for(var r=0;r<h.length;r++)if(j[l]===h[r]){i=!0;break}if(i)break}i||e.push(j)}return e};E.QueryEngine.prototype.aggregateBindings=function(a,c,e,h){for(var c=this.copyDenormalizedBindings(c,h.outCache),k={},j=0;j<a.length;j++){var i=g.runAggregator(a[j],c,this,e,h);a[j].alias?k[a[j].alias.value]=i:k[a[j].value.value]=i}return k};E.QueryEngine.prototype.projectBindings=
function(a,c,e){if(a[0].kind==="*")return c;else{for(var h=[],k=0;k<c.length;k++){for(var j=c[k],i={},l=!0,r=0;r<a.length;r++)if(a[r].token=="variable"&&a[r].kind!="aliased")i[a[r].value.value]=j[a[r].value.value];else if(a[r].token=="variable"&&a[r].kind=="aliased"){var u=g.runFilter(a[r].expression,j,this,e,{blanks:{},outCache:{}});if(g.isEbvError(u)){l=!1;break}else i[a[r].alias.value]=u}l===!0&&h.push(i)}return h}};E.QueryEngine.prototype.resolveNsInEnvironment=function(a,c){return c.namespaces[a]};
E.QueryEngine.prototype.termCost=function(a,c){if(a.token==="uri"){var e=y.lexicalFormBaseUri(a,c);return e==null?0:this.lexicon.resolveUriCost(e)}else return a.token==="literal"?this.lexicon.resolveLiteralCost(y.lexicalFormLiteral(a,c)):a.token==="blank"?this.lexicon.resolveBlankCost(a.value):a.token==="var"?this.lexicon.oidCounter/3:null};E.QueryEngine.prototype.normalizeTerm=function(a,c,e){if(a.token==="uri")return c=y.lexicalFormBaseUri(a,c),c==null?null:e?this.lexicon.registerUri(c):this.lexicon.resolveUri(c);
else if(a.token==="literal")return c=y.lexicalFormLiteral(a,c),a=e?this.lexicon.registerLiteral(c):this.lexicon.resolveLiteral(c);else if(a.token==="blank"){var h=a.value,a=c.blanks[h];a==null&&(a=e?this.lexicon.registerBlank(h):this.lexicon.resolveBlank(h),c.blanks[h]=a);return a}else return a.token==="var"?a.value:null};E.QueryEngine.prototype.normalizeDatasets=function(a,c){for(var e=0;e<a.length;e++){var h=a[e];if(h.value===this.lexicon.defaultGraphUri)h.oid=this.lexicon.defaultGraphOid;else{var g=
this.normalizeTerm(h,c,!1);if(g!=null)h.oid=g;else return null}}return!0};E.QueryEngine.prototype.normalizeQuad=function(a,c,e){var h=null,g=null,j=h=null,i;if(a.graph==null)j=0;else if(i=this.normalizeTerm(a.graph,c,e),i!=null)j=i,e===!0&&a.graph.token!="var"&&this.lexicon.registerGraph(i);else return null;i=this.normalizeTerm(a.subject,c,e);if(i!=null)h=i;else return null;i=this.normalizeTerm(a.predicate,c,e);if(i!=null)g=i;else return null;i=this.normalizeTerm(a.object,c,e);return i==null?null:
{subject:h,predicate:g,object:i,graph:j}};E.QueryEngine.prototype.quadCost=function(a,c){var e=null,h=null,g=null,j=null,j=a.graph==null?this.lexicon.oidCounter/4:this.termCost(a.graph,c),e=this.termCost(a.subject,c),h=this.termCost(a.predicate,c),g=this.termCost(a.object,c);return j+e+h+g};E.QueryEngine.prototype.denormalizeBindingsList=function(a,c){for(var e=[],h=0;h<a.length;h++){var g=this.denormalizeBindings(a[h],c);e.push(g)}return e};E.QueryEngine.prototype.copyDenormalizedBindings=function(a,
c){for(var e=[],h=0;h<a.length;h++){for(var g={},j=a[h],i=y.keys(j),l=0;l<i.length;l++){var r=j[i[l]];if(r==null)g[i[l]]=null;else if(typeof r==="object")g[i[l]]=r;else{var u=c[r];u==null&&(u=this.lexicon.retrieve(r),c[r]=u);g[i[l]]=u}}e.push(g)}return e};E.QueryEngine.prototype.denormalizeBindings=function(a,c){for(var e=y.keys(a),h=c.outCache,g=0;g<e.length;g++){var j=a[e[g]];if(j==null)a[e[g]]=null;else if(h[j]!=null)a[e[g]]=h[j];else{var i=this.lexicon.retrieve(j);a[e[g]]=i;i.token==="blank"&&
(c.blanks[i.value]=j)}}return a};E.QueryEngine.prototype.execute=function(a,c,e,h){a=y.normalizeUnicodeLiterals(a);a=this.abstractQueryTree.parseQueryString(a);if(a==null)c(!1,"Error parsing query string");else if(a.token==="query"&&a.kind=="update"){this.callbacksBackend.startGraphModification();var g=this;this.executeUpdate(a,function(a,e){g.lexicon.updateAfterWrite&&g.lexicon.updateAfterWrite();a?g.callbacksBackend.endGraphModification(function(){c(a,e)}):(g.callbacksBackend.cancelGraphModification(),
c(a,e))})}else a.token==="query"&&a.kind=="query"&&this.executeQuery(a,c,e,h)};E.QueryEngine.prototype.executeQuery=function(a,c,e,h){var g=a.units,j=this,i={blanks:{},outCache:{}};this.registerNsInEnvironment(a.prologue,i);var l=j.abstractQueryTree.parseExecutableUnit(g[0]);if(l.kind==="select")this.executeSelect(l,i,e,h,function(a,e){a?typeof e==="object"&&e.denorm===!0?c(!0,e.bindings):(e=j.denormalizeBindingsList(e,i),e!=null?c(!0,e):c(!1,e)):c(!1,e)});else if(l.kind==="ask")l.projection=[{token:"variable",
kind:"*"}],this.executeSelect(l,i,e,h,function(a,e){a?a?e.length>0?c(!0,!0):c(!0,!1):c(!1,e):c(!1,e)});else if(l.kind==="construct")l.projection=[{token:"variable",kind:"*"}],j=this,this.executeSelect(l,i,e,h,function(a,e){if(a)if(a)if(e=j.denormalizeBindingsList(e,i),e!=null){var h=new w.Graph;if(l.template==null)l.template={triplesContext:l.pattern};for(var g=1,k=[],y=0;y<e.length;y++){for(var E=e[y],F=0;F<k.length;F++)delete k[F].valuetmp;for(F=0;F<l.template.triplesContext.length;F++){for(var C=
["subject","predicate","object"],B=l.template.triplesContext[F],G=0;G<C.length;G++){var I=C[G];if(B[I].token==="blank"&&!(B[I].valuetmp&&B[I].valuetmp!=null)){var J="_:b"+g;g++;B[I].valuetmp=J;k.push(B[I])}}C=w.buildRDFResource(B.subject,E,j,i);G=w.buildRDFResource(B.predicate,E,j,i);B=w.buildRDFResource(B.object,E,j,i);C!=null&&G!=null&&B!=null&&(G=new w.Triple(C,G,B),h.add(G))}}c(!0,h)}else c(!1,e);else c(!1,e);else c(!1,e)})};E.QueryEngine.prototype.executeSelect=function(a,c,e,h,g){if(a.kind===
"select"||a.kind==="ask"||a.kind==="construct"||a.kind==="modify"){var j=a.projection,i=a.dataset,l=a.modifier,r=a.limit,u=a.offset,t=a.order;if(e!=null||h!=null)i.implicit=e||[],i.named=h||[];i.implicit!=null&&i.implicit.length===0&&i.named!=null&&i.named.length===0&&i.implicit.push(this.lexicon.defaultGraphUriTerm);if(this.normalizeDatasets(i.implicit.concat(i.named),c)!=null)if(h=this.executeSelectUnit(j,i,a.pattern,c),h!=null){if(a.group!=null&&a.group===""){for(var w=!1,e=0;e<a.projection.length;e++)if(a.projection[e].expression!=
null&&a.projection[e].expression.expressionType==="aggregate"){w=!0;break}if(w===!0)a.group="singleGroup"}if(a.group&&a.group!="")if(this.checkGroupSemantics(a.group,j)){r=this.groupSolution(h,a.group,i,c);u=[];for(e=0;e<r.length;e++)l=this.aggregateBindings(j,r[e],i,c),u.push(l);g(!0,{bindings:u,denorm:!0})}else g(!1,"Incompatible Group and Projection variables");else c=this.applyOrderBy(t,h,i,c),j=this.projectBindings(j,c,i),j=this.applyModifier(l,j),i=this.removeDefaultGraphBindings(this.applyLimitOffset(u,
r,j),i),g(!0,i)}else g(!1,h);else g(!1,"Error normalizing datasets")}else g(!1,"Cannot execute "+a.kind+" query as a select query")};E.QueryEngine.prototype.groupSolution=function(a,c,e,h){var k=[],j=[],i=!1;if(c==="singleGroup")return[a];else{for(var l=0;l<a.length;l++){for(var r=a[l],u=!0,t=0;t<c.length;t++){var w=c[t],y=null;if(w.token==="var")y=w.value,i==!1&&k.push(y);else if(w.token==="aliased_expression")if(y=w.alias.value,i==!1&&k.push(y),w.expression.primaryexpression==="var")r[w.alias.value]=
r[w.expression.value.value];else if(y=this.copyDenormalizedBindings([r],h.outCache),y=g.runFilter(w.expression,y[0],this,e,h),g.isEbvError(y))u=!1;else{if(y.value!=null)y.value=""+y.value;r[w.alias.value]=y}else y=this.copyDenormalizedBindings([r],h.outCache),y=g.runFilter(w,y[0],this,h),g.isEbvError(y)?u=!1:(r["groupCondition"+env._i]=y,y="groupCondition"+env._i,i==!1&&k.push(y))}i==!1&&(i=!0);u===!0&&j.push(r)}a={};for(l=0;l<j.length;l++){c=j[l];e="";for(t=0;t<k.length;t++)h=c[k[t]],e+=typeof h===
"object"?h.value:h;a[e]==null?a[e]=[c]:a[e].push(c)}var k=[],A;for(A in a)k.push(a[A]);return k}};E.QueryEngine.prototype.executeSelectUnit=function(a,c,e,h){return e.kind==="BGP"?this.executeAndBGP(a,c,e,h):e.kind==="UNION"?this.executeUNION(a,c,e.value,h):e.kind==="JOIN"?this.executeJOIN(a,c,e,h):e.kind==="LEFT_JOIN"?this.executeLEFT_JOIN(a,c,e,h):e.kind==="FILTER"?(a=this.executeSelectUnit(a,c,e.value,h),a!=null?a=g.checkFilters(e,a,!1,c,h,this):[]):e.kind==="EMPTY_PATTERN"?[]:e.kind==="ZERO_OR_MORE_PATH"||
e.kind==="ONE_OR_MORE_PATH"?this.executeZeroOrMorePath(e,c,h):(console.log("Cannot execute query pattern "+e.kind+". Not implemented yet."),null)};E.QueryEngine.prototype.executeZeroOrMorePath=function(a,c,e){var h=[];a.x.token==="var"&&h.push({token:"variable",kind:"var",value:a.x.value});a.y.token==="var"&&h.push({token:"variable",kind:"var",value:a.y.value});h.length===0&&h.push({token:"variable",kind:"*"});if(a.x.token==="var"&&a.y.token==="var"){var g=this.executeAndBGP(h,c,a.path,e),j={},h=
[],i,l,r,u,t=a.x.value;l=a.x;for(var w=a.path,D=0;D<g.length;D++)if(i=g[D][t],j[i]==null){u=this.lexicon.retrieve(i);a.x=u;a.path=this.abstractQueryTree.replace(w,l,u,e);w=y.clone(a.path);l=this.executeZeroOrMorePath(a,c,e);for(var A=0;A<l.length;A++)r=l[A],r[t]=i,h.push(r);l=u}return h}else if(a.x.token!=="var"&&a.y.token==="var"){j={};i=!0;u=[];for(t=[];i==!0||u.length!==0;){i===!0?(g=this.executeAndBGP(h,c,a.path,e),l=a.x,i=!1):(w=this.lexicon.retrieve(u.pop()),g=a.path,g=this.abstractQueryTree.replace(g,
l,w,e),g=this.executeAndBGP(h,c,g,e),l=w);for(D=0;D<g.length;D++)w=g[D][a.y.value],j[w]!==!0&&(r={},r[a.y.value]=w,t.push(r),j[w]=!0,u.push(w))}return t}else throw"Kind of path not supported!";};E.QueryEngine.prototype.executeUNION=function(a,c,e,h){var k=e[0],j=e[1],i=null,l=null;if(e.length!=2)throw"SPARQL algebra UNION with more than two components";i=this.executeSelectUnit(a,c,k,h);if(i==null)return null;l=this.executeSelectUnit(a,c,j,h);if(l==null)return null;a=ea.unionBindings(i,l);return a=
g.checkFilters(e,a,!1,c,h,this)};E.QueryEngine.prototype.executeAndBGP=function(a,c,e,h){a=ea.executeAndBGPsDPSize(e.value,c,this,h);return a!=null?g.checkFilters(e,a,!1,c,h,this):null};E.QueryEngine.prototype.executeLEFT_JOIN=function(a,c,e,h){var k=e.rvalue,j=null,i=null,j=this.executeSelectUnit(a,c,e.lvalue,h);if(j==null)return null;i=this.executeSelectUnit(a,c,k,h);if(i==null)return null;a=ea.leftOuterJoinBindings(j,i);c=g.checkFilters(e,a,!0,c,h,this);if(j.length>1&&i.length>1){var e=[],h={},
l;for(l in j[0])h[l]=!0;for(l in i[0])h[l]!=!0&&e.push(l);j=[];i={};for(h=0;h<c.length;h++)if(c[h].__nullify__===!0){for(k=0;k<e.length;k++)c[h].bindings[e[k]]=null;k=[];a=[];for(l in c[h].bindings)c[h].bindings[l]!=null&&(k.push(l+c[h].bindings[l]),k.sort(),a.push(k.join("")));if(i[k.join("")]==null){for(k=0;k<a.length;k++)i[a[k]]=!0;j.push(c[h].bindings)}}else for(l in j.push(c[h]),k=[],c[h])k.push(l+c[h][l]),k.sort(),i[k.join("")]=!0;return j}else return c};E.QueryEngine.prototype.executeJOIN=
function(a,c,e,h){var k=e.lvalue,j=e.rvalue,i=null,l=null,i=this.executeSelectUnit(a,c,k,h);if(i==null)return null;l=this.executeSelectUnit(a,c,j,h);if(l==null)return null;a=null;if(i.length===0||l.length===0)a=[];else{var a={},r=[],u;for(u in i[0])a[u]=!1;for(u in l[0])a[u]===!1&&r.push(u);a=r.length==0?ea.joinBindings(i,l):this.abstractQueryTree.treeWithUnion(k)||this.abstractQueryTree.treeWithUnion(j)?ea.joinBindings(i,l):ea.joinBindings2(r,i,l)}return a=g.checkFilters(e,a,!1,c,h,this)};E.QueryEngine.prototype.rangeQuery=
function(a,c){var e=this.normalizeQuad(a,c,!1);return e!=null?(e=this.backend.range(new S.Pattern(e)),e==null||e.length==0?[]:e):(console.log("ERROR normalizing quad"),null)};E.QueryEngine.prototype.executeUpdate=function(a,c){var e=a.units,h=this,g={blanks:{},outCache:{}};this.registerNsInEnvironment(a.prologue,g);for(var j=0;j<e.length;j++){var i=h.abstractQueryTree.parseExecutableUnit(e[j]);if(i.kind==="insertdata"){for(var l=0;l<i.quads.length;l++){var r=i.quads[l];if(h._executeQuadInsert(r,g)!==
!0)return c(!1,error)}c(!0)}else if(i.kind==="deletedata"){for(l=0;l<i.quads.length;l++)r=i.quads[l],this._executeQuadDelete(r,g);c(!0)}else if(i.kind==="modify")this._executeModifyQuery(i,g,c);else if(i.kind==="create")c(!0);else if(i.kind==="load")l={uri:y.lexicalFormBaseUri(i.sourceGraph,g)},i.destinyGraph!=null&&(l={uri:y.lexicalFormBaseUri(i.destinyGraph,g)}),h=this,this.rdfLoader.load(i.sourceGraph.value,l,function(a,e){a==!1?(console.log("Error loading graph"),console.log(e),c(!1,"error batch loading quads")):
(e=h.batchLoad(e),c(e!=null,e||"error batch loading quads"))});else if(i.kind==="drop")this._executeClearGraph(i.destinyGraph,g,c);else if(i.kind==="clear")this._executeClearGraph(i.destinyGraph,g,c);else throw Error("not supported execution unit");}};E.QueryEngine.prototype.batchLoad=function(a,c){var e=null,h=null,g=null,j=null,i=0,l=!0,r={},u,t;this.eventsOnBatchLoad&&this.callbacksBackend.startGraphModification();for(var w=0;w<a.length;w++){t=a[w];if(t.subject.uri||t.subject.token==="uri"){if(u=
this.lexicon.registerUri(t.subject.uri||t.subject.value),t.subject.uri!=null)t.subject={token:"uri",value:t.subject.uri},delete t.subject.uri}else if(t.subject.literal||t.subject.token==="literal"){if(u=this.lexicon.registerLiteral(t.subject.literal||t.subject.value),t.subject.literal!=null)t.subject=this.lexicon.parseLiteral(t.subject.literal),delete t.subject.literal}else if(u=r[t.subject.blank||t.subject.value],u==null&&(u=this.lexicon.registerBlank(t.subject.blank||t.subject.value),r[t.subject.blank||
t.subject.value]=u),t.subject.token==null)t.subject.token="blank",t.subject.value=t.subject.blank,delete t.subject.blank;e=u;if(t.predicate.uri||t.predicate.token==="uri"){if(u=this.lexicon.registerUri(t.predicate.uri||t.predicate.value),t.predicate.uri!=null)t.predicate={token:"uri",value:t.predicate.uri},delete t.subject.uri}else if(t.predicate.literal||t.predicate.token==="literal"){if(u=this.lexicon.registerLiteral(t.predicate.literal||t.predicate.value),t.predicate.literal!=null)t.predicate=
this.lexicon.parseLiteral(t.predicate.literal),delete t.predicate.literal}else if(u=r[t.predicate.blank||t.predicate.value],u==null&&(u=this.lexicon.registerBlank(t.predicate.blank||t.predicate.value),r[t.predicate.blank||t.predicate.value]=u),t.predicate.token==null)t.predicate.token="blank",t.predicate.value=t.predicate.blank,delete t.predicate.blank;h=u;if(t.object.uri||t.object.token==="uri"){if(u=this.lexicon.registerUri(t.object.uri||t.object.value),t.object.uri!=null)t.object={token:"uri",
value:t.object.uri},delete t.subject.uri}else if(t.object.literal||t.object.token==="literal"){if(u=this.lexicon.registerLiteral(t.object.literal||t.object.value),t.object.literal!=null)t.object=this.lexicon.parseLiteral(t.object.literal),delete t.object.literal}else if(u=r[t.object.blank||t.object.value],u==null&&(u=this.lexicon.registerBlank(t.object.blank||t.object.value),r[t.object.blank||t.object.value]=u),t.object.token==null)t.object.token="blank",t.object.value=t.object.blank,delete t.object.blank;
g=u;if(t.graph.uri||t.graph.token==="uri"){u=this.lexicon.registerUri(t.graph.uri||t.graph.value);if(t.graph.uri!=null)t.graph={token:"uri",value:t.graph.uri},delete t.subject.uri;this.lexicon.registerGraph(u)}else if(t.graph.literal||t.graph.token==="literal"){if(u=this.lexicon.registerLiteral(t.graph.literal||t.graph.value),t.predicate.literal!=null)t.predicate=this.lexicon.parseLiteral(t.predicate.literal),delete t.predicate.literal}else if(u=r[t.graph.blank||t.graph.value],u==null&&(u=this.lexicon.registerBlank(t.graph.blank||
t.graph.value),r[t.graph.blank||t.graph.value]=u),t.graph.token==null)t.graph.token="blank",t.graph.value=t.graph.blank,delete t.graph.blank;j=u;u=t;t={subject:e,predicate:h,object:g,graph:j};e=new S.NodeKey(t);h=this.backend.search(e);if(!h)if(h=this.backend.index(e),h==!0)this.eventsOnBatchLoad&&this.callbacksBackend.nextGraphModification(B.added,[u,t]),i+=1;else{l=!1;break}}this.lexicon.updateAfterWrite!=null&&this.lexicon.updateAfterWrite();var y=function(){l?c&&c(!0,i):c&&c(!1,null)};this.eventsOnBatchLoad?
this.callbacksBackend.endGraphModification(function(){y()}):y();return l?i:null};E.QueryEngine.prototype.computeCosts=function(a,c){for(var e=0;e<a.length;e++)a[e]._cost=this.quadCost(a[e],c);return a};E.QueryEngine.prototype._executeModifyQuery=function(a,c,e){var h=this,g=!0,j=null,i=["subject","predicate","object","graph"];a.insert=a.insert==null?[]:a.insert;a["delete"]=a["delete"]==null?[]:a["delete"];y.seq(function(e){var i=[],u=[];a["with"]!=null&&i.push(a["with"]);if(a.using!=null)for(var u=
[],t=0;t<a.using.length;t++){var w=a.using[t];w.kind==="named"?u.push(w.uri):i.push(w.uri)}a.dataset={};a.projection=[{token:"variable",kind:"*"}];h.executeSelect(a,c,i,u,function(a,i){a?(i=h.denormalizeBindingsList(i,c),i!=null?j=i:g=!1):g=!1;return e()})},function(e){var r=a["with"];if(g){for(var u=[],t=0;t<a["delete"].length;t++)for(var w=a["delete"][t],y=0;y<j.length;y++){for(var A={},B=j[y],F=0;F<i.length;F++){var C=i[F];C=="graph"&&w[C]==null?A.graph=r:A[C]=w[C].token==="var"?B[w[C].value]:
w[C]}u.push(A)}for(y=0;y<u.length;y++)A=u[y],h._executeQuadDelete(A,c)}e()},function(e){var r=a["with"];if(g){for(var u=[],t=0;t<a.insert.length;t++)for(var w=a.insert[t],y=0;y<j.length;y++){for(var A={},C=j[y],F=0;F<i.length;F++){var B=i[F];B=="graph"&&w[B]==null?A.graph=r:A[B]=w[B].token==="var"?C[w[B].value]:w[B]}u.push(A)}for(t=0;t<u.length;t++)A=u[t],h._executeQuadInsert(A,c)}e()})(function(){e(g)})};E.QueryEngine.prototype._executeQuadInsert=function(a,c){var e=this.normalizeQuad(a,c,!0);if(e!=
null){var h=new S.NodeKey(e),g=this.backend.search(h);return g?g:(g=this.backend.index(h),g==!0?(this.callbacksBackend.nextGraphModification(B.added,[a,e]),!0):(console.log("ERROR inserting quad"),!1))}else return console.log("ERROR normalizing quad"),!1};E.QueryEngine.prototype._executeQuadDelete=function(a,c){var e=this.normalizeQuad(a,c,!1);if(e!=null){var h=new S.NodeKey(e);this.backend["delete"](h);return this.lexicon.unregister(a,h)==!0?(this.callbacksBackend.nextGraphModification(B.deleted,
[a,e]),!0):(console.log("ERROR unregistering quad"),!1)}else return console.log("ERROR normalizing quad"),!1};E.QueryEngine.prototype._executeClearGraph=function(a,c,e){if(a==="default")this.execute("DELETE { ?s ?p ?o } WHERE { ?s ?p ?o }",e);else if(a==="named"){var h=this,g=this.lexicon.registeredGraphs(!0);if(g!=null){var j=!1;y.repeat(0,g.length,function(a,c){var e=g[c._i],u=arguments.callee;j?a(u,c):h.execute("DELETE { GRAPH <"+e+"> { ?s ?p ?o } } WHERE { GRAPH <"+e+"> { ?s ?p ?o } }",function(e){j=
!e;a(u,c)})},function(){e(!j)})}else e(!1,"Error deleting named graphs")}else a==="all"?(h=this,this.execute("CLEAR DEFAULT",function(a,c){a?h.execute("CLEAR NAMED",e):e(!1,c)})):a.token=="uri"?(a=y.lexicalFormBaseUri(a,c),a!=null?this.execute("DELETE { GRAPH <"+a+"> { ?s ?p ?o } } WHERE { GRAPH <"+a+"> { ?s ?p ?o } }",e):e(!1,"wrong graph URI")):e(!1,"wrong graph URI")};E.QueryEngine.prototype.checkGroupSemantics=function(a,c){if(a==="singleGroup")return!0;for(var e={},h=0;h<a.length;h++){var g=
a[h];g.token==="var"?e[g.value]=!0:g.token==="aliased_expression"&&(e[g.alias.value]=!0)}for(h=0;h<c.length;h++)if(g=c[h],g.kind==="var"){if(e[g.value.value]==null)return!1}else if(g.kind==="aliased"&&g.expression&&g.expression.primaryexpression==="var"&&e[g.expression.value.value]==null)return!1;return!0};E.QueryEngine.prototype.registerDefaultNamespace=function(a,c){this.defaultPrefixes[a]=c};var B={ANYTHING:{token:"var",value:"_"},added:"added",deleted:"deleted",eventsFlushed:"eventsFlushed",CallbacksBackend:function(a){this.aqt=
new J.AbstractQueryTree;this.engine=a;this.indexMap={};this.observersMap={};this.queriesIndexMap={};this.emptyNotificationsMap={};this.queriesList=[];this.pendingQueries=[];this.matchedQueries=[];this.updateInProgress=null;this.indices=["SPOG","GP","OGS","POG","GSP","OS"];this.componentOrders={SPOG:["subject","predicate","object","graph"],GP:["graph","predicate","subject","object"],OGS:["object","graph","subject","predicate"],POG:["predicate","object","graph","subject"],GSP:["graph","subject","predicate",
"object"],OS:["object","subject","predicate","graph"]};this.callbackCounter=0;this.callbacksMap={};this.callbacksInverseMap={};this.queryCounter=0;this.queriesMap={};this.queriesCallbacksMap={};this.queriesInverseMap={};for(a=0;a<this.indices.length;a++){var c=this.indices[a];this.indexMap[c]={};this.queriesIndexMap[c]={}}}};B.CallbacksBackend.prototype.startGraphModification=function(){this.pendingQueries=[].concat(this.queriesList);this.matchedQueries=[];if(this.updateInProgress==null)this.updateInProgress=
{added:[],deleted:[]}};B.CallbacksBackend.prototype.nextGraphModification=function(a,c){this.updateInProgress[a].push(c)};B.CallbacksBackend.prototype.endGraphModification=function(a){var c=this;if(this.updateInProgress!=null){var e=c.updateInProgress;c.updateInProgress=null;this.sendNotification(B.deleted,e[B.deleted],function(){c.sendNotification(B.added,e[B.added],function(){c.sendEmptyNotification(B.eventsFlushed,null,function(){c.dispatchQueries(function(){a(!0)})})})})}else a(!0)};B.CallbacksBackend.prototype.cancelGraphModification=
function(){this.updateInProgress=null};B.CallbacksBackend.prototype.sendNotification=function(a,c,e){for(var h={},g=0;g<c.length;g++){var j=c[g],i;for(i in this.indexMap){var l=this.indexMap[i],r=this.componentOrders[i];this._searchCallbacksInIndex(l,r,a,j,h);this.pendingQueries.length!=0&&(l=this.queriesIndexMap[i],this._searchQueriesInIndex(l,r,j))}}this.dispatchNotifications(h);e!=null&&e(!0)};B.CallbacksBackend.prototype.sendEmptyNotification=function(a,c,e){for(var h=this.emptyNotificationsMap[a]||
[],g=0;g<h.length;g++)h[g](a,c);e()};B.CallbacksBackend.prototype.dispatchNotifications=function(a){for(var c in a){var e=this.callbacksMap[c],h=a[c][B.deleted];if(h!=null)try{e(B.deleted,h)}catch(g){}for(var j in a[c])if(j!=B.deleted)try{e(j,a[c][j])}catch(i){}}};B.CallbacksBackend.prototype._searchCallbacksInIndex=function(a,c,e,h,g){for(var j=h[1],h=h[0],i=0;i<c.length+1;i++){for(var l=a._||[],r=[],u=0;u<l.length;u++){var t=l[u];this.callbacksMap[t]!=null&&(g[t]=g[t]||{},g[t][e]=g[t][e]||[],g[t][e].push(h),
r.push(t))}a._=r;l=c[i];if(a[""+j[l]]!=null)a=a[""+j[l]];else break}};B.CallbacksBackend.prototype.subscribeEmpty=function(a,c){var e=this.emptyNotificationsMap[a]||[];e.push(c);this.emptyNotificationsMap[a]=e};B.CallbacksBackend.prototype.unsubscribeEmpty=function(a,c){var e=this.emptyNotificationsMap[a];e!=null&&(e=y.remove(e,c));this.emptyNotificationsMap[a]=e};B.CallbacksBackend.prototype.subscribe=function(a,c,e,h,g,j){a=this._tokenizeComponents(a,c,e,h);c={blanks:{},outCache:{}};this.engine.registerNsInEnvironment(null,
c);a=this.engine.normalizeQuad(a,c,!0);e=this._indexForPattern(new S.Pattern(a));c=this.componentOrders[e];e=this.indexMap[e];for(h=0;h<c.length;h++){var i=a[c[h]];if(i==="_"){e._==null&&(e._=[]);this.callbackCounter++;e._.push(this.callbackCounter);this.callbacksMap[this.callbackCounter]=g;this.callbacksInverseMap[g]=this.callbackCounter;break}else h===c.length-1?(e[i]=e[i]||{_:[]},this.callbackCounter++,e[i]._.push(this.callbackCounter),this.callbacksMap[this.callbackCounter]=g,this.callbacksInverseMap[g]=
this.callbackCounter):(e[i]=e[i]||{},e=e[i])}j!=null&&j(!0)};B.CallbacksBackend.prototype.unsubscribe=function(a){var c=this.callbacksInverseMap[a];c!=null&&(delete this.callbacksInverseMap[a],delete this.callbacksMap[c])};B.CallbacksBackend.prototype._tokenizeComponents=function(a,c,e,h){var g={};g.subject=a==null?B.ANYTHING:a.indexOf("_:")==0?{token:"blank",value:a}:{token:"uri",value:a};g.predicate=c==null?B.ANYTHING:{token:"uri",value:c};g.object=e==null?B.ANYTHING:{token:"uri",value:e};g.graph=
h==null?B.ANYTHING:{token:"uri",value:h};return g};B.CallbacksBackend.prototype._indexForPattern=function(a){for(var a=a.indexKey,c=this.indices,e=0;e<c.length;e++)for(var h=c[e],g=this.componentOrders[h],j=0;j<g.length;j++){if(y.include(a,g[j])===!1)break;if(j==a.length-1)return h}return"SPOG"};B.CallbacksBackend.prototype.observeNode=function(){var a,c,e,g;arguments.length===4?(a=arguments[0],c=arguments[1],e=arguments[2],g=arguments[3]):(a=arguments[0],c=this.engine.lexicon.defaultGraphUri,e=arguments[1],
g=arguments[2]);c="CONSTRUCT { <"+a+"> ?p ?o } WHERE { GRAPH <"+c+"> { <"+a+"> ?p ?o } }";var k=this,j={blanks:{},outCache:{}};this.engine.registerNsInEnvironment(null,j);var i=[];this.engine.execute(c,function(c,r){if(c){var u=!1,t=function(a,c){if(a==="eventsFlushed"&&u){u=!1;try{e(r)}catch(g){}}else if(a!=="eventsFlushed"){u=!0;for(var h=0;h<c.length;h++){var l=c[h],t=w.buildRDFResource(l.subject,i,k.engine,j),y=w.buildRDFResource(l.predicate,i,k.engine,j),l=w.buildRDFResource(l.object,i,k.engine,
j);t!=null&&y!=null&&l!=null&&(l=new w.Triple(t,y,l),a===B.added?r.add(l):a===B.deleted&&r.remove(l))}}};k.observersMap[e]=t;k.subscribeEmpty(B.eventsFlushed,t);k.subscribe(a,null,null,null,t,function(){try{e(r)}catch(a){}g&&g(!0)})}else g&&g(!1)})};B.CallbacksBackend.prototype.stopObservingNode=function(a){return(a=this.observersMap[a])?(this.unsubscribe(a),this.unsubscribeEmpty(B.eventsFlushed,a),!0):!1};B.CallbacksBackend.prototype.observeQuery=function(a,c,e){var g=this.aqt.collectBasicTriples(this.aqt.parseSelect(this.aqt.parseQueryString(a).units[0])),
k={blanks:{},outCache:{}};this.engine.registerNsInEnvironment(null,k);var j,i,l,r=this.queryCounter;this.queryCounter++;this.queriesMap[r]=a;this.queriesInverseMap[a]=r;this.queriesList.push(r);this.queriesCallbacksMap[r]=c;for(var u=0;u<g.length;u++){i=g[u];if(i.graph==null)i.graph=this.engine.lexicon.defaultGraphUriTerm;i=this.engine.normalizeQuad(i,k,!0);j=new S.Pattern(i);l=this._indexForPattern(j);j=this.componentOrders[l];l=this.queriesIndexMap[l];for(var t=0;t<j.length;t++){var w=i[j[t]];if(typeof w===
"string"){l._==null&&(l._=[]);l._.push(r);break}else t===j.length-1?(l[w]=l[w]||{_:[]},l[w]._.push(r)):(l[w]=l[w]||{},l=l[w])}}this.engine.execute(a,function(a,e){a?c(e):console.log("ERROR in query callback "+e)});e!=null&&e()};B.CallbacksBackend.prototype.stopObservingQuery=function(a){var c=this.queriesInverseMap[a];if(c!=null)delete this.queriesInverseMap[a],delete this.queriesMap[c],this.queriesList=y.remove(this.queriesList,c)};B.CallbacksBackend.prototype._searchQueriesInIndex=function(a,c,
e){for(var e=e[1],g=0;g<c.length+1;g++){for(var k=a._||[],j=[],i=0;i<k.length;i++){var l=k[i];y.include(this.pendingQueries,l)&&(y.remove(this.pendingQueries,l),this.matchedQueries.push(l));this.queriesMap[l]!=null&&j.push(l)}a._=j;k=c[g];if(a[""+e[k]]!=null)a=a[""+e[k]];else break}};B.CallbacksBackend.prototype.dispatchQueries=function(a){var c=this,e,g,k,j,i={};y.repeat(0,this.matchedQueries.length,function(a,r){e=arguments.callee;k=c.matchedQueries[r._i];i[k]==null?(i[k]=!0,g=c.queriesMap[k],j=
c.queriesCallbacksMap[k],y.recur(function(){c.engine.execute(g,function(c,g){if(c)try{j(g)}catch(h){}a(e,r)})})):a(e,r)},function(){a()})};var L={};try{typeof Worker=="undefined"&&(Worker=null)}catch(uc){Worker=null}if(Worker)L.RDFStoreClient=function(a,c,e){console.log("trying to load "+a);this.connection=Worker.Worker?new Worker.Worker(a):new Worker(a);this.callbacksCounter=1;var g=this;this.rdf=w.rdf;console.log("The worker");console.log(this.connection);g=this;this.connection.onmessage=function(a){g.receive(a)};
this.observingCallbacks={};this.callbacks={0:{cb:function(a,c){a===!0?e(!0,g):e(!1,c)},fn:"create"}};this.connection.postMessage({fn:"create",args:c,callback:"0"})},L.RDFStoreClient.prototype.receive=function(a){a=a.data||a;if(a.fn==="workerRequest:NetworkTransport:load"){var c=this,e=a.callback,a=a.arguments.concat(function(a,g){c.connection.postMessage({fn:"workerRequestResponse",results:[a,g],callback:e})});O.load.apply(O,a)}else{var g=this.callbacks[a.callback];g&&(g.fn==="create"||g.fn==="execute"||
g.fn==="insert"||g.fn=="graph"||g.fn==="node"||g.fn==="insert"||g.fn==="delete"||g.fn==="clear"||g.fn==="load"||g.fn==="startObservingQueryEndCb"||g.fn==="registeredGraphs"?(delete this.callbacks[a.callback],g.cb(a.success,a.result)):g.fn==="startObservingQuery"?g.cb(a.result):g.fn==="startObservingNode"?g.cb(a.result):g.fn==="subscribe"&&g.cb(a.event,a.result))}},L.RDFStoreClient.prototype.registerCallback=function(a,c){var e=""+this.callbacksCounter;this.callbacks[e]={fn:a,cb:c};this.callbacksCounter++;
return e},L.RDFStoreClient.prototype.execute=function(){if(arguments.length===3)this.executeWithEnvironment(arguments[0],arguments[1],arguments[2]);else if(arguments.length===4)this.executeWithEnvironment(arguments[0],arguments[1],arguments[2],arguments[3]);else{var a,c;arguments.length===1?(a=arguments[0],c=function(){}):arguments.length===2&&(a=arguments[0],c=arguments[1]);c=this.registerCallback("execute",c);this.connection.postMessage({fn:"execute",args:[a],callback:c})}},L.RDFStoreClient.prototype.insert=
function(){var a,c,e;if(arguments.length===1)c=arguments[0],this.connection.postMessage({fn:"insert",args:[c]});else if(arguments.length===2)c=arguments[0],e=arguments[1]||function(){},e=this.registerCallback("insert",e),this.connection.postMessage({fn:"insert",args:[c],callback:e});else if(arguments.length===3)c=arguments[0],a=arguments[1],e=arguments[2]||function(){},e=this.registerCallback("insert",e),this.connection.postMessage({fn:"insert",args:[c,a],callback:e});else throw"The triples to insert, an optional graph and callback must be provided";
},L.RDFStoreClient.prototype.graph=function(){var a=null,c=null;if(arguments.length===1)c=arguments[0]||function(){};else if(arguments.length===2)c=arguments[1]||function(){},a=arguments[0];else throw"An optional graph URI and a callback function must be provided";var e=this,g=this.registerCallback("insert",function(a,g){if(a){for(var h,l=0;l<g.triples.length;l++)h=g.triples[l],g.triples[l]=new w.Triple(e.adaptJSInterface(h.subject),e.adaptJSInterface(h.predicate),e.adaptJSInterface(h.object));c(a,
e.rdf.createGraph(g.triples))}else c(a,g)});a==null?this.connection.postMessage({fn:"graph",args:[],callback:g}):this.connection.postMessage({fn:"graph",args:[a],callback:g})},L.RDFStoreClient.prototype.node=function(){var a=null,c=null,e=null;if(arguments.length===2)e=arguments[0],c=arguments[1]||function(){};else if(arguments.length===3)e=arguments[0],a=arguments[1],c=arguments[2]||function(){};else throw"An optional graph URI and a callback function must be provided";var g=this,k=this.registerCallback("insert",
function(a,e){if(a){for(var k,r=0;r<e.triples.length;r++)k=e.triples[r],e.triples[r]=new w.Triple(g.adaptJSInterface(k.subject),g.adaptJSInterface(k.predicate),g.adaptJSInterface(k.object));c(a,g.rdf.createGraph(e.triples))}else c(a,e)});a==null?this.connection.postMessage({fn:"node",args:[e],callback:k}):this.connection.postMessage({fn:"node",args:[e,a],callback:k})},L.RDFStoreClient.prototype.setPrefix=function(a,c){this.rdf.setPrefix(a,c);this.connection.postMessage({fn:"rdf/setPrefix",args:[a,
c],callback:null})},L.RDFStoreClient.prototype.setDefaultPrefix=function(a){this.rdf.setDefaultPrefix(a);this.connection.postMessage({fn:"rdf/setDefaultPrefix",args:[a],callback:null})},L.RDFStoreClient.prototype["delete"]=function(){var a,c,e;if(arguments.length===1)c=arguments[0],this.connection.postMessage({fn:"delete",args:[c]});else if(arguments.length===2)c=arguments[0],e=arguments[1]||function(){},e=this.registerCallback("delete",e),this.connection.postMessage({fn:"delete",args:[c],callback:e});
else if(arguments.length===3)c=arguments[0],a=arguments[1],e=arguments[2]||function(){},e=this.registerCallback("delete",e),this.connection.postMessage({fn:"delete",args:[c,a],callback:e});else throw"The triples to delete, an optional graph and callback must be provided";},L.RDFStoreClient.prototype.clear=function(){var a,c;if(arguments.length===1)c=arguments[0]||function(){},c=this.registerCallback("clear",c),this.connection.postMessage({fn:"clear",args:[],callback:c});else if(arguments.length===
2)a=arguments[0],c=arguments[1]||function(){},c=this.registerCallback("clear",c),this.connection.postMessage({fn:"clear",args:[a],callback:c});else throw"The optional graph and a callback must be provided";},L.RDFStoreClient.prototype.setBatchLoadEvents=function(a){this.connection.postMessage({fn:"setBatchLoadEvents",args:[a]})},L.RDFStoreClient.prototype.registerDefaultNamespace=function(a,c){this.connection.postMessage({fn:"registerDefaultNamespace",args:[a,c]})},L.RDFStoreClient.prototype.registerDefaultProfileNamespaces=
function(){this.connection.postMessage({fn:"registerDefaultProfileNamespaces",args:[]})},L.RDFStoreClient.prototype.load=function(){var a,c,e,g;if(arguments.length===3)a=arguments[0],c=arguments[1],g=arguments[2]||function(){},g=this.registerCallback("load",g),this.connection.postMessage({fn:"load",args:[a,c],callback:g});else if(arguments.length===4)a=arguments[0],c=arguments[1],e=arguments[2],g=arguments[3]||function(){},g=this.registerCallback("load",g),this.connection.postMessage({fn:"load",args:[a,
c,e],callback:g});else if(arguments.length===2)throw"The mediaType of the parser, the data a callback and an optional graph must be provided";},L.RDFStoreClient.prototype.startObservingQuery=function(a,c,e){e!=null?(c=this.registerCallback("startObservingQuery",c),this.observingCallbacks[a]=c,e=this.registerCallback("startObservingQueryEndCb",e),this.connection.postMessage({fn:"startObservingQuery",args:[a],callback:[c,e]})):(c=this.registerCallback("startObservingQuery",c),this.observingCallbacks[a]=
c,this.connection.postMessage({fn:"startObservingQuery",args:[a],callback:[c]}))},L.RDFStoreClient.prototype.stopObservingQuery=function(a){var c=this.observingCallbacks[a];delete this.observingCallbacks[a];delete this.callbacks[c];this.connection.postMessage({fn:"stopObservingQuery",args:[a],callback:[]})},L.RDFStoreClient.prototype.startObservingNode=function(){var a,c,e;if(arguments.length===2){a=arguments[0];e=arguments[1];var g=this,k=this.registerCallback("startObservingNode",function(a){for(var c,
k=0;k<a.triples.length;k++)c=a.triples[k],a.triples[k]=new w.Triple(g.adaptJSInterface(c.subject),g.adaptJSInterface(c.predicate),g.adaptJSInterface(c.object));e(g.rdf.createGraph(a.triples))});this.observingCallbacks[e]=k;this.connection.postMessage({fn:"startObservingNode",args:[a],callback:k})}else arguments.length===3&&(a=arguments[0],c=arguments[1],e=arguments[2],g=this,k=this.registerCallback("startObservingNode",function(a){for(var c,k=0;k<a.triples.length;k++)c=a.triples[k],a.triples[k]=new w.Triple(g.adaptJSInterface(c.subject),
g.adaptJSInterface(c.predicate),g.adaptJSInterface(c.object));e(g.rdf.createGraph(a.triples))}),this.observingCallbacks[e]=k,this.connection.postMessage({fn:"startObservingNode",args:[a,c],callback:k}))},L.RDFStoreClient.prototype.stopObservingNode=function(a){var c=this.observingCallbacks[a];delete this.observingCallbacks[a];delete this.callbacks[c];this.connection.postMessage({fn:"stopObservingNode",args:[c],callback:[]})},L.RDFStoreClient.prototype.subscribe=function(a,c,e,g,k){var j=this,i=this.registerCallback("subscribe",
function(a,c){for(var e,g=0;g<c.length;g++)e=c[g],c[g]=new w.Triple(j.adaptJSInterface(e.subject),j.adaptJSInterface(e.predicate),j.adaptJSInterface(e.object));k(a,c)});this.observingCallbacks[k]=i;this.connection.postMessage({fn:"subscribe",args:[a,c,e,g],callback:i})},L.RDFStoreClient.prototype.unsubscribe=function(a){var c=this.observingCallbacks[a];delete this.observingCallbacks[a];delete this.callbacks[c];this.connection.postMessage({fn:"unsubscribe",args:[c],callback:[]})},L.RDFStoreClient.prototype.registeredGraphs=
function(a){var c=this;this.connection.postMessage({fn:"registeredGraphs",args:[],callback:this.registerCallback("registeredGraphs",function(e,g){if(e)for(var k=0;k<g.length;k++)g[k]=c.adaptJSInterface(g[k]);a(e,g)})})},L.RDFStoreClient.prototype.adaptJSInterface=function(a){if(a.interfaceName==="BlankNode")return new w.BlankNode(a.bnodeId);else if(a.interfaceName==="Literal")return new w.Literal(a.nominalValue,a.language,a.datatype);else if(a.interfaceName==="NamedNode")return new w.NamedNode(a.nominalValue)},
L.RDFStoreClient.prototype.isWebWorkerConnection=!0;var G={},ob={MongodbQueryEngine:function(){throw"MongoDB backend not supported in the browser version";}};G.VERSION="0.5.13";G.connect=function(){var a,c,e;arguments.length==1&&(a=__dirname,c={},e=arguments[0]);arguments.length==2?(typeof arguments[0]==="string"?(a=arguments[0],c={}):(a=__dirname+"/index.js",c=arguments[0]),e=arguments[1]):(a=arguments[0],c=arguments[1],e=arguments[2]);try{Worker?new L.RDFStoreClient(a,c,function(a,c){e(a,c)}):G.create(c,
function(a){e(!1,a)})}catch(g){G.create(c,function(a){e(!1,a)})}};G.create=function(){return arguments.length==1?new G.Store(arguments[0]):arguments.length==2?new G.Store(arguments[0],arguments[1]):new G.Store};G.Store=function(a,c){var e=null,g=null;if(arguments.length==0)g={};else if(arguments.length==1)g={},e=a;else if(arguments.length>1)g=a,e=c;else throw"An optional argument map and a callback must be provided";g.treeOrder==null&&(g.treeOrder=15);this.functionMap={};var k=this;g.engine==="mongodb"?
(this.isMongodb=!0,this.engine=new ob.MongodbQueryEngine(g),this.engine.readConfiguration(function(){g.overwrite===!0?k.engine.clean(function(){e(k)}):e(k)})):new I.Lexicon(function(a){g.overwrite===!0&&a.clear();new U.QuadBackend(g,function(c){g.overwrite===!0&&c.clear();g.backend=c;g.lexicon=a;k.engine=new E.QueryEngine(g);e&&e(k)})},g.name)};G.Store.prototype.rdf=w.rdf;G.Store.prototype.execute=function(){if(arguments.length===3)this.executeWithEnvironment(arguments[0],arguments[1],arguments[2]);
else if(arguments.length===4)this.executeWithEnvironment(arguments[0],arguments[1],arguments[2],arguments[3]);else{var a,c;arguments.length===1?(a=arguments[0],c=function(){}):arguments.length===2&&(a=arguments[0],c=arguments[1]);this.engine.execute(a,c)}};G.Store.prototype.executeWithEnvironment=function(){var a,c,e;if(arguments.length===3){a=arguments[0];var g=function(){};c=arguments[1];e=arguments[2]}else arguments.length===4&&(a=arguments[0],g=arguments[3],c=arguments[1],e=arguments[2]);for(var k=
[],j=[],i=0;i<c.length;i++)k.push({token:"uri",value:c[i]});for(i=0;i<e.length;i++)j.push({token:"uri",value:e[i]});this.engine.execute(a,g,k,j)};G.Store.prototype.graph=function(){var a=null,c=null;if(arguments.length===1)c=arguments[0]||function(){},a=this.engine.lexicon.defaultGraphUri;else if(arguments.length===2)c=arguments[1]||function(){},a=arguments[0];else throw"An optional graph URI and a callback function must be provided";this.rdf.resolve(a)!=null&&(a=this.rdf.resolve(a));this.engine.execute("CONSTRUCT { ?s ?p ?o } WHERE { GRAPH <"+
a+"> { ?s ?p ?o } }",c)};G.Store.prototype.node=function(){var a=null,c=null,e=null;if(arguments.length===2)e=arguments[0],c=arguments[1]||function(){},a=this.engine.lexicon.defaultGraphUri;else if(arguments.length===3)e=arguments[0],a=arguments[1],c=arguments[2]||function(){};else throw"An optional graph URI, node URI and a callback function must be provided";this.rdf.resolve(a)!=null&&(a=this.rdf.resolve(a));this.rdf.resolve(e)!=null&&(e=this.rdf.resolve(e));this.engine.execute("CONSTRUCT { <"+
e+"> ?p ?o } WHERE { GRAPH <"+a+"> { <"+e+"> ?p ?o } }",c)};G.Store.prototype.startObservingNode=function(){var a,c,e;arguments.length===2?(a=arguments[0],e=arguments[1],this.engine.callbacksBackend.observeNode(a,e,function(){})):arguments.length===3&&(a=arguments[0],c=arguments[1],e=arguments[2],this.engine.callbacksBackend.observeNode(a,c,e,function(){}))};G.Store.prototype.stopObservingNode=function(a){this.engine.callbacksBackend.stopObservingNode(a)};G.Store.prototype.startObservingQuery=function(a,
c,e){e!=null?this.engine.callbacksBackend.observeQuery(a,c,e):this.engine.callbacksBackend.observeQuery(a,c,function(){})};G.Store.prototype.stopObservingQuery=function(a){this.engine.callbacksBackend.stopObservingQuery(a)};G.Store.prototype.subscribe=function(a,c,e,g,k){var j=this,i=function(a,c){for(var e=[],g={blanks:{},outCache:{}},h=[],i=0;i<c.length;i++){var y=c[i],B=w.buildRDFResource(y.subject,h,j.engine,g),C=w.buildRDFResource(y.predicate,h,j.engine,g),y=w.buildRDFResource(y.object,h,j.engine,
g);B!=null&&C!=null&&y!=null&&(y=new w.Triple(B,C,y),e.push(y))}k(a,e)};this.functionMap[k]=i;this.engine.callbacksBackend.subscribe(a,c,e,g,i,function(){})};G.Store.prototype.unsubscribe=function(a){this.engine.callbacksBackend.unsubscribe(this.functionMap[a]);delete this.functionMap[a]};G.Store.prototype.setPrefix=function(a,c){this.rdf.setPrefix(a,c)};G.Store.prototype.setDefaultPrefix=function(a){this.rdf.setDefaultPrefix(a)};G.Store.prototype.insert=function(){var a,c,e;if(arguments.length===
1)c=arguments[0];else if(arguments.length===2)a=this.rdf.createNamedNode(this.engine.lexicon.defaultGraphUri),c=arguments[0],e=arguments[1]||function(){};else if(arguments.length===3)c=arguments[0],a=this.rdf.createNamedNode(arguments[1]),e=arguments[2]||function(){};else throw"The triples to insert, an optional graph and callback must be provided";var g="",k=this;c.forEach(function(a){g=g+k._nodeToQuery(a.subject)+k._nodeToQuery(a.predicate)+k._nodeToQuery(a.object)+"."});g=a!=null?"INSERT DATA { GRAPH "+
this._nodeToQuery(a)+" { "+g+" } }":"INSERT DATA { "+this._nodeToQuery(a)+" { "+g+" }";this.engine.execute(g,e)};G.Store.prototype._nodeToQuery=function(a){if(a.interfaceName==="NamedNode"){var c=this.rdf.resolve(a.valueOf());return c!=null?"<"+c+">":"<"+a.valueOf()+">"}else{if(a.interfaceName!=="")if(a.lang!=null)return'"'+a.valueOf()+'"@'+a.lang;else if(a.datatype!=null)return'"'+a.valueOf()+'"^^<'+a.datatype+">";return a.toString()}};G.Store.prototype["delete"]=function(){var a,c,e;if(arguments.length===
1)c=arguments[0];else if(arguments.length===2)a=this.rdf.createNamedNode(this.engine.lexicon.defaultGraphUri),c=arguments[0],e=arguments[1]||function(){};else if(arguments.length===3)c=arguments[0],a=this.rdf.createNamedNode(arguments[1]),e=arguments[2]||function(){};else throw"The triples to delete, an optional graph and callback must be provided";var g="",k=this;c.forEach(function(a){g=g+k._nodeToQuery(a.subject)+k._nodeToQuery(a.predicate)+k._nodeToQuery(a.object)+"."});g=a!=null?"DELETE DATA { GRAPH "+
this._nodeToQuery(a)+" { "+g+" } }":"DELETE DATA { "+this._nodeToQuery(a)+" { "+g+" }";this.engine.execute(g,e)};G.Store.prototype.clear=function(){var a,c;if(arguments.length===0)a=this.rdf.createNamedNode(this.engine.lexicon.defaultGraphUri),c=function(){};else if(arguments.length===1)a=this.rdf.createNamedNode(this.engine.lexicon.defaultGraphUri),c=arguments[0]||function(){};else if(arguments.length===2)a=this.rdf.createNamedNode(arguments[0]),c=arguments[1]||function(){};else throw"The optional graph and a callback must be provided";
this.engine.execute("CLEAR GRAPH "+this._nodeToQuery(a),c)};G.Store.prototype.setBatchLoadEvents=function(a){this.engine.eventsOnBatchLoad=a};G.Store.prototype.registerDefaultNamespace=function(a,c){this.rdf.prefixes.set(a,c);this.engine.registerDefaultNamespace(a,c)};G.Store.prototype.registerDefaultProfileNamespaces=function(){var a=this.rdf.prefixes.values(),c;for(c in a)this.registerDefaultNamespace(c,a[c])};G.Store.prototype.load=function(){var a,c,e,g;if(arguments.length===3)e=this.rdf.createNamedNode(this.engine.lexicon.defaultGraphUri),
a=arguments[0],c=arguments[1],g=arguments[2]||function(){};else if(arguments.length===4)a=arguments[0],c=arguments[1],e=this.rdf.createNamedNode(arguments[2]),g=arguments[3]||function(){};else if(arguments.length===2)throw"The mediaType of the parser, the data a callback and an optional graph must be provided";if(a==="remote")c=this.rdf.createNamedNode(c),this.engine.execute("LOAD <"+c.valueOf()+"> INTO GRAPH <"+e.valueOf()+">",g);else if(c&&typeof c==="string"&&c.indexOf("file://")===0){a=this.engine.rdfLoader.parsers[a];
var k=this;this.engine.rdfLoader.loadFromFile(a,{token:"uri",value:e.valueOf()},c,function(a,c){a?k.engine.batchLoad(c,g):g(a,c)})}else a=this.engine.rdfLoader.parsers[a],k=this,this.engine.rdfLoader.tryToParse(a,{token:"uri",value:e.valueOf()},c,function(a,c){a?k.engine.batchLoad(c,g):g(a,c)})};G.Store.prototype.registerParser=function(a,c){this.engine.rdfLoader.registerParser(a,c)};G.Store.prototype.registeredGraphs=function(a){if(this.isMongodb)this.engine.registeredGraphs(!0,function(c){for(var e=
[],g=0;g<c.length;g++){var h=new w.NamedNode(c[g]);e.push(h)}return a(!0,e)});else{for(var c=this.engine.lexicon.registeredGraphs(!0),e=[],g=0;g<c.length;g++){var k=new w.NamedNode(c[g]);e.push(k)}return a(!0,e)}};G.Store.prototype._nodeToQuery=function(a){if(a.interfaceName==="NamedNode"){var c=this.rdf.resolve(a.valueOf());return c!=null?"<"+c+">":"<"+a.valueOf()+">"}else return a.toString()};G.Store.prototype.getNetworkTransport=function(){return O};G.Store.prototype.setNetworkTransport=function(a){O=
a};RDFStoreWorker={observingCallbacks:{},workerCallbacksCounter:0,workerCallbacks:{}};RDFStoreWorker.registerCallback=function(a){var c=""+RDFStoreWorker.workerCallbacksCounter;RDFStoreWorker.workerCallbacksCounter++;RDFStoreWorker.workerCallbacks[c]=a;return c};RDFStoreWorker.handleCreate=function(a,c){typeof O!="undefined"&&O!=null&&(O={load:function(a,c,e){var g=RDFStoreWorker.registerCallback(function(a){e.apply(e,a)});postMessage({fn:"workerRequest:NetworkTransport:load",callback:g,arguments:[a,
c]})},loadFromFile:function(){}});var e=[a];e.push(function(a){RDFStoreWorker.store=a;postMessage({callback:c,result:"created",success:!0})});G.create.apply(G,e)};RDFStoreWorker.receive=function(a){var c=a.data||a;if(c.fn==="workerRequestResponse"){var e=c.callback,g=RDFStoreWorker.workerCallbacks[e];g!=null&&(delete RDFStoreWorker.workerCallbacks[e],g(c.results))}else if(c.fn==="create"&&c.args!=null)RDFStoreWorker.handleCreate(c.args,c.callback);else if(c.fn==="setBatchLoadEvents")RDFStoreWorker.store[c.fn].apply(RDFStoreWorker.store,
c.args);else if(c.fn==="registerDefaultNamespace")RDFStoreWorker.store[c.fn].apply(RDFStoreWorker.store,c.args);else if(c.fn==="registerDefaultProfileNamespaces")RDFStoreWorker.store[c.fn].apply(RDFStoreWorker.store,c.args);else if((c.fn==="execute"||c.fn==="executeWithEnvironment"||c.fn==="graph"||c.fn==="node"||c.fn==="clear"||c.fn==="load")&&c.args!=null){c.args.push(function(a,e){c.callback!=null&&postMessage({callback:c.callback,result:e,success:a})});try{RDFStoreWorker.store[c.fn].apply(RDFStoreWorker.store,
c.args)}catch(k){console.log("Error executing method through connection"),console.log(k)}}else if((c.fn==="insert"||c.fn==="delete")&&c.args!=null)try{c.args.push(function(a,e){c.callback!=null&&postMessage({callback:c.callback,result:e,success:a})});g=c.args[0];for(a=0;a<g.triples.length;a++)e=g.triples[a],g.triples[a]=new w.Triple(RDFStoreWorker.adaptJSInterface(e.subject),RDFStoreWorker.adaptJSInterface(e.predicate),RDFStoreWorker.adaptJSInterface(e.object));c.args[1].interfaceName!=null&&(c.args[1]=
RDFStoreWorker.adaptJSInterface(c.args[1]));c.args[0]=RDFStoreWorker.store.rdf.createGraph(g.triples);RDFStoreWorker.store[c.fn].apply(RDFStoreWorker.store,c.args)}catch(j){console.log("Error executing method through connection"),console.log(j)}else c.fn==="rdf/setPrefix"&&c.args!=null?RDFStoreWorker.store.rdf.setPrefix(c.args[0],c.args[1]):c.fn==="rdf/setDefaultPrefix"&&c.args!=null?RDFStoreWorker.store.rdf.setDefaultPrefix(c.args[0]):c.fn==="startObservingQuery"&&c.args!=null?(e=function(a,e){postMessage({callback:c.callback[0],
result:e,success:a})},RDFStoreWorker.observingCallbacks[c.args[0]]=e,c.args.push(e),c.args.push(function(a,e){c.callback&&c.callback[1]!=null&&postMessage({callback:c.callback[1],result:e,success:a})}),RDFStoreWorker.store[c.fn].apply(RDFStoreWorker.store,c.args)):c.fn==="stopObservingQuery"?((e=RDFStoreWorker.observingCallbacks[c.args[0]])&&RDFStoreWorker.store[c.fn].apply(RDFStoreWorker.store,[e]),delete RDFStoreWorker.observingCallbacks[c.args[0]]):c.fn==="startObservingNode"&&c.args!=null?(e=
function(a){postMessage({callback:c.callback,result:a})},RDFStoreWorker.observingCallbacks[c.callback]=e,c.args.push(e),RDFStoreWorker.store[c.fn].apply(RDFStoreWorker.store,c.args)):c.fn==="stopObservingNode"&&c.args!=null?((e=RDFStoreWorker.observingCallbacks[c.args[0]])&&RDFStoreWorker.store[c.fn].apply(RDFStoreWorker.store,[e]),delete RDFStoreWorker.observingCallbacks[c.args[0]]):c.fn==="subscribe"&&c.args!=null?(e=function(a,e){postMessage({callback:c.callback,event:a,result:e})},RDFStoreWorker.observingCallbacks[c.callback]=
e,c.args.push(e),RDFStoreWorker.store[c.fn].apply(RDFStoreWorker.store,c.args)):c.fn==="stopObservingNode"&&c.args!=null?((e=RDFStoreWorker.observingCallbacks[c.args[0]])&&RDFStoreWorker.store[c.fn].apply(RDFStoreWorker.store,[e]),delete RDFStoreWorker.observingCallbacks[c.args[0]]):c.fn==="registeredGraphs"&&c.args!=null&&RDFStoreWorker.store[c.fn].apply(RDFStoreWorker.store,[function(a,e){c.callback!=null&&postMessage({callback:c.callback,result:e,success:a})}])};RDFStoreWorker.adaptJSInterface=
function(a){if(a.interfaceName==="BlankNode")return new w.BlankNode(a.bnodeId);else if(a.interfaceName==="Literal")return new w.Literal(a.nominalValue,a.language,a.datatype);else if(a.interfaceName==="NamedNode")return new w.NamedNode(a.nominalValue)};onmessage=RDFStoreWorker.receive;try{window.rdfstore=G}catch(vc){}})();
// Knockout JavaScript library v1.2.1
// (c) Steven Sanderson - http://knockoutjs.com/
// License: MIT (http://www.opensource.org/licenses/mit-license.php)

(function(window,undefined){
var ko=window.ko={};ko.exportSymbol=function(a,c){for(var d=a.split("."),b=window,e=0;e<d.length-1;e++)b=b[d[e]];b[d[d.length-1]]=c};ko.exportProperty=function(a,c,d){a[c]=d};
ko.utils=new function(){function a(a,b){if("INPUT"!=a.tagName||!a.type||"click"!=b.toLowerCase())return!1;var d=a.type.toLowerCase();return"checkbox"==d||"radio"==d}var c=/^(\s|\u00A0)+|(\s|\u00A0)+$/g,d=/MSIE 6/i.test(navigator.userAgent),b=/MSIE 7/i.test(navigator.userAgent),e={},f={},h=/Firefox\/2/i.test(navigator.userAgent)?"KeyboardEvent":"UIEvents";e[h]=["keyup","keydown","keypress"];e.MouseEvents="click,dblclick,mousedown,mouseup,mousemove,mouseover,mouseout,mouseenter,mouseleave".split(",");
for(var i in e)if(h=e[i],h.length)for(var g=0,j=h.length;g<j;g++)f[h[g]]=i;return{fieldsIncludedWithJsonPost:["authenticity_token",/^__RequestVerificationToken(_.*)?$/],arrayForEach:function(a,b){for(var d=0,c=a.length;d<c;d++)b(a[d])},arrayIndexOf:function(a,b){if("function"==typeof a.indexOf)return a.indexOf(b);for(var d=0,c=a.length;d<c;d++)if(a[d]===b)return d;return-1},arrayFirst:function(a,b,d){for(var c=0,e=a.length;c<e;c++)if(b.call(d,a[c]))return a[c];return null},arrayRemoveItem:function(a,
b){var d=ko.utils.arrayIndexOf(a,b);0<=d&&a.splice(d,1)},arrayGetDistinctValues:function(a){for(var a=a||[],b=[],d=0,c=a.length;d<c;d++)0>ko.utils.arrayIndexOf(b,a[d])&&b.push(a[d]);return b},arrayMap:function(a,b){for(var a=a||[],d=[],c=0,e=a.length;c<e;c++)d.push(b(a[c]));return d},arrayFilter:function(a,b){for(var a=a||[],d=[],c=0,e=a.length;c<e;c++)b(a[c])&&d.push(a[c]);return d},arrayPushAll:function(a,b){for(var d=0,c=b.length;d<c;d++)a.push(b[d])},emptyDomNode:function(a){for(;a.firstChild;)ko.removeNode(a.firstChild)},
setDomNodeChildren:function(a,b){ko.utils.emptyDomNode(a);b&&ko.utils.arrayForEach(b,function(b){a.appendChild(b)})},replaceDomNodes:function(a,b){var d=a.nodeType?[a]:a;if(0<d.length){for(var c=d[0],e=c.parentNode,g=0,f=b.length;g<f;g++)e.insertBefore(b[g],c);g=0;for(f=d.length;g<f;g++)ko.removeNode(d[g])}},setOptionNodeSelectionState:function(a,b){0<=navigator.userAgent.indexOf("MSIE 6")?a.setAttribute("selected",b):a.selected=b},getElementsHavingAttribute:function(a,b){if(!a||1!=a.nodeType)return[];
var d=[];null!==a.getAttribute(b)&&d.push(a);for(var c=a.getElementsByTagName("*"),e=0,g=c.length;e<g;e++)null!==c[e].getAttribute(b)&&d.push(c[e]);return d},stringTrim:function(a){return(a||"").replace(c,"")},stringTokenize:function(a,b){for(var d=[],c=(a||"").split(b),e=0,g=c.length;e<g;e++){var f=ko.utils.stringTrim(c[e]);""!==f&&d.push(f)}return d},stringStartsWith:function(a,b){a=a||"";return b.length>a.length?!1:a.substring(0,b.length)===b},evalWithinScope:function(a,b,d){if(void 0===b)return(new Function("return "+
a))();b.skonode=d;return(new Function("__SKO__sc","with(__SKO__sc){ var innerNode=skonode; return ("+a+") }"))(b)},domNodeIsContainedBy:function(a,b){if(b.compareDocumentPosition)return 16==(b.compareDocumentPosition(a)&16);for(;null!=a;){if(a==b)return!0;a=a.parentNode}return!1},domNodeIsAttachedToDocument:function(a){return ko.utils.domNodeIsContainedBy(a,document)},registerEventHandler:function(b,d,c){if("undefined"!=typeof jQuery){if(a(b,d))var e=c,c=function(a,b){var d=this.checked;b&&(this.checked=
!0!==b.checkedStateBeforeEvent);e.call(this,a);this.checked=d};jQuery(b).bind(d,c)}else if("function"==typeof b.addEventListener)b.addEventListener(d,c,!1);else if("undefined"!=typeof b.attachEvent)b.attachEvent("on"+d,function(a){c.call(b,a)});else throw Error("Browser doesn't support addEventListener or attachEvent");},triggerEvent:function(b,d){if(!b||!b.nodeType)throw Error("element must be a DOM node when calling triggerEvent");if("undefined"!=typeof jQuery){var c=[];a(b,d)&&c.push({checkedStateBeforeEvent:b.checked});
jQuery(b).trigger(d,c)}else if("function"==typeof document.createEvent)if("function"==typeof b.dispatchEvent)c=document.createEvent(f[d]||"HTMLEvents"),c.initEvent(d,!0,!0,window,0,0,0,0,0,!1,!1,!1,!1,0,b),b.dispatchEvent(c);else throw Error("The supplied element doesn't support dispatchEvent");else if("undefined"!=typeof b.fireEvent){if("click"==d&&"INPUT"==b.tagName&&("checkbox"==b.type.toLowerCase()||"radio"==b.type.toLowerCase()))b.checked=!0!==b.checked;b.fireEvent("on"+d)}else throw Error("Browser doesn't support triggering events");
},unwrapObservable:function(a){return ko.isObservable(a)?a():a},domNodeHasCssClass:function(a,b){var d=(a.className||"").split(/\s+/);return 0<=ko.utils.arrayIndexOf(d,b)},toggleDomNodeCssClass:function(a,b,d){var c=ko.utils.domNodeHasCssClass(a,b);if(d&&!c)a.className=(a.className||"")+" "+b;else if(c&&!d){for(var d=(a.className||"").split(/\s+/),c="",e=0;e<d.length;e++)d[e]!=b&&(c+=d[e]+" ");a.className=ko.utils.stringTrim(c)}},range:function(a,b){for(var a=ko.utils.unwrapObservable(a),b=ko.utils.unwrapObservable(b),
d=[],c=a;c<=b;c++)d.push(c);return d},makeArray:function(a){for(var b=[],d=0,c=a.length;d<c;d++)b.push(a[d]);return b},isIe6:d,isIe7:b,getFormFields:function(a,b){for(var d=ko.utils.makeArray(a.getElementsByTagName("INPUT")).concat(ko.utils.makeArray(a.getElementsByTagName("TEXTAREA"))),c="string"==typeof b?function(a){return a.name===b}:function(a){return b.test(a.name)},e=[],g=d.length-1;0<=g;g--)c(d[g])&&e.push(d[g]);return e},parseJson:function(a){return"string"==typeof a&&(a=ko.utils.stringTrim(a))?
window.JSON&&window.JSON.parse?window.JSON.parse(a):(new Function("return "+a))():null},stringifyJson:function(a){if("undefined"==typeof JSON||"undefined"==typeof JSON.stringify)throw Error("Cannot find JSON.stringify(). Some browsers (e.g., IE < 8) don't support it natively, but you can overcome this by adding a script reference to json2.js, downloadable from http://www.json.org/json2.js");return JSON.stringify(ko.utils.unwrapObservable(a))},postJson:function(a,b,d){var d=d||{},c=d.params||{},e=
d.includeFields||this.fieldsIncludedWithJsonPost,g=a;if("object"==typeof a&&"FORM"==a.tagName)for(var g=a.action,f=e.length-1;0<=f;f--)for(var i=ko.utils.getFormFields(a,e[f]),h=i.length-1;0<=h;h--)c[i[h].name]=i[h].value;var b=ko.utils.unwrapObservable(b),j=document.createElement("FORM");j.style.display="none";j.action=g;j.method="post";for(var q in b)a=document.createElement("INPUT"),a.name=q,a.value=ko.utils.stringifyJson(ko.utils.unwrapObservable(b[q])),j.appendChild(a);for(q in c)a=document.createElement("INPUT"),
a.name=q,a.value=c[q],j.appendChild(a);document.body.appendChild(j);d.submitter?d.submitter(j):j.submit();setTimeout(function(){j.parentNode.removeChild(j)},0)}}};ko.exportSymbol("ko.utils",ko.utils);ko.exportSymbol("ko.utils.arrayForEach",ko.utils.arrayForEach);ko.exportSymbol("ko.utils.arrayFirst",ko.utils.arrayFirst);ko.exportSymbol("ko.utils.arrayFilter",ko.utils.arrayFilter);ko.exportSymbol("ko.utils.arrayGetDistinctValues",ko.utils.arrayGetDistinctValues);
ko.exportSymbol("ko.utils.arrayIndexOf",ko.utils.arrayIndexOf);ko.exportSymbol("ko.utils.arrayMap",ko.utils.arrayMap);ko.exportSymbol("ko.utils.arrayPushAll",ko.utils.arrayPushAll);ko.exportSymbol("ko.utils.arrayRemoveItem",ko.utils.arrayRemoveItem);ko.exportSymbol("ko.utils.fieldsIncludedWithJsonPost",ko.utils.fieldsIncludedWithJsonPost);ko.exportSymbol("ko.utils.getElementsHavingAttribute",ko.utils.getElementsHavingAttribute);ko.exportSymbol("ko.utils.getFormFields",ko.utils.getFormFields);
ko.exportSymbol("ko.utils.postJson",ko.utils.postJson);ko.exportSymbol("ko.utils.parseJson",ko.utils.parseJson);ko.exportSymbol("ko.utils.registerEventHandler",ko.utils.registerEventHandler);ko.exportSymbol("ko.utils.stringifyJson",ko.utils.stringifyJson);ko.exportSymbol("ko.utils.range",ko.utils.range);ko.exportSymbol("ko.utils.toggleDomNodeCssClass",ko.utils.toggleDomNodeCssClass);ko.exportSymbol("ko.utils.triggerEvent",ko.utils.triggerEvent);ko.exportSymbol("ko.utils.unwrapObservable",ko.utils.unwrapObservable);
Function.prototype.bind||(Function.prototype.bind=function(a){var c=this,d=Array.prototype.slice.call(arguments),a=d.shift();return function(){return c.apply(a,d.concat(Array.prototype.slice.call(arguments)))}});
ko.utils.domData=new function(){var a=0,c="__ko__"+(new Date).getTime(),d={};return{get:function(a,d){var c=ko.utils.domData.getAll(a,!1);return void 0===c?void 0:c[d]},set:function(a,d,c){void 0===c&&void 0===ko.utils.domData.getAll(a,!1)||(ko.utils.domData.getAll(a,!0)[d]=c)},getAll:function(b,e){var f=b[c];if(!f){if(!e)return;f=b[c]="ko"+a++;d[f]={}}return d[f]},clear:function(a){var e=a[c];e&&(delete d[e],a[c]=null)}}};
ko.utils.domNodeDisposal=new function(){function a(a,c){var f=ko.utils.domData.get(a,d);void 0===f&&c&&(f=[],ko.utils.domData.set(a,d,f));return f}function c(b){sko.cleanNode(b);var d=a(b,!1);if(d)for(var d=d.slice(0),c=0;c<d.length;c++)d[c](b);ko.utils.domData.clear(b);"function"==typeof jQuery&&"function"==typeof jQuery.cleanData&&jQuery.cleanData([b])}var d="__ko_domNodeDisposal__"+(new Date).getTime();return{addDisposeCallback:function(b,d){if("function"!=typeof d)throw Error("Callback must be a function");
a(b,!0).push(d)},removeDisposeCallback:function(b,c){var f=a(b,!1);f&&(ko.utils.arrayRemoveItem(f,c),0==f.length&&ko.utils.domData.set(b,d,void 0))},cleanNode:function(a){if(!(1!=a.nodeType&&9!=a.nodeType)){c(a);var d=[];ko.utils.arrayPushAll(d,a.getElementsByTagName("*"));for(var a=0,f=d.length;a<f;a++)c(d[a])}},removeNode:function(a){ko.cleanNode(a);a.parentNode&&a.parentNode.removeChild(a)}}};ko.cleanNode=ko.utils.domNodeDisposal.cleanNode;ko.removeNode=ko.utils.domNodeDisposal.removeNode;
ko.exportSymbol("ko.cleanNode",ko.cleanNode);ko.exportSymbol("ko.removeNode",ko.removeNode);ko.exportSymbol("ko.utils.domNodeDisposal",ko.utils.domNodeDisposal);ko.exportSymbol("ko.utils.domNodeDisposal.addDisposeCallback",ko.utils.domNodeDisposal.addDisposeCallback);ko.exportSymbol("ko.utils.domNodeDisposal.removeDisposeCallback",ko.utils.domNodeDisposal.removeDisposeCallback);
(function(){ko.utils.parseHtmlFragment=function(a){if("undefined"!=typeof jQuery)a=jQuery.clean([a]);else{var c=ko.utils.stringTrim(a).toLowerCase(),d=document.createElement("div"),c=c.match(/^<(thead|tbody|tfoot)/)&&[1,"<table>","</table>"]||!c.indexOf("<tr")&&[2,"<table><tbody>","</tbody></table>"]||(!c.indexOf("<td")||!c.indexOf("<th"))&&[3,"<table><tbody><tr>","</tr></tbody></table>"]||[0,"",""];for(d.innerHTML=c[1]+a+c[2];c[0]--;)d=d.lastChild;a=ko.utils.makeArray(d.childNodes)}return a};ko.utils.setHtml=
function(a,c){ko.utils.emptyDomNode(a);if(null!==c&&void 0!==c)if("string"!=typeof c&&(c=c.toString()),"undefined"!=typeof jQuery)try{jQuery(a).html(c)}catch(d){jQuery(a).html(c.replace("<","&lt;").replace(">","&gt;"))}else for(var b=ko.utils.parseHtmlFragment(c),e=0;e<b.length;e++)a.appendChild(b[e])}})();
ko.memoization=function(){function a(){return(4294967296*(1+Math.random())|0).toString(16).substring(1)}function c(a,d){if(a)if(8==a.nodeType){var f=ko.memoization.parseMemoText(a.nodeValue);null!=f&&d.push({domNode:a,memoId:f})}else if(1==a.nodeType)for(var f=0,h=a.childNodes,i=h.length;f<i;f++)c(h[f],d)}var d={};return{memoize:function(b){if("function"!=typeof b)throw Error("You can only pass a function to ko.memoization.memoize()");var c=a()+a();d[c]=b;return"<\!--[ko_memo:"+c+"]--\>"},unmemoize:function(a,
c){var f=d[a];if(void 0===f)throw Error("Couldn't find any memo with ID "+a+". Perhaps it's already been unmemoized.");try{return f.apply(null,c||[]),!0}finally{delete d[a]}},unmemoizeDomNodeAndDescendants:function(a,d){var f=[];c(a,f);for(var h=0,i=f.length;h<i;h++){var g=f[h].domNode,j=[g];d&&ko.utils.arrayPushAll(j,d);var k=d[0];sko.traceResources(a,k,function(){sko.traceRelations(a,k,function(){try{f[h]&&(ko.memoization.unmemoize(f[h].memoId,j),g.nodeValue=""),g.parentNode&&g.parentNode.removeChild(g)}catch(a){}})})}},
parseMemoText:function(a){return(a=a.match(/^\[ko_memo\:(.*?)\]$/))?a[1]:null}}}();ko.exportSymbol("ko.memoization",ko.memoization);ko.exportSymbol("ko.memoization.memoize",ko.memoization.memoize);ko.exportSymbol("ko.memoization.unmemoize",ko.memoization.unmemoize);ko.exportSymbol("ko.memoization.parseMemoText",ko.memoization.parseMemoText);ko.exportSymbol("ko.memoization.unmemoizeDomNodeAndDescendants",ko.memoization.unmemoizeDomNodeAndDescendants);
ko.subscription=function(a,c){this.callback=a;this.dispose=function(){this.isDisposed=!0;c()}.bind(this);ko.exportProperty(this,"dispose",this.dispose)};
ko.subscribable=function(){var a=[];this.subscribe=function(c,d){var b=d?c.bind(d):c,e=new ko.subscription(b,function(){ko.utils.arrayRemoveItem(a,e)});a.push(e);return e};this.notifySubscribers=function(c){ko.utils.arrayForEach(a.slice(0),function(a){a&&!0!==a.isDisposed&&a.callback(c)})};this.getSubscriptionsCount=function(){return a.length};ko.exportProperty(this,"subscribe",this.subscribe);ko.exportProperty(this,"notifySubscribers",this.notifySubscribers);ko.exportProperty(this,"getSubscriptionsCount",
this.getSubscriptionsCount)};ko.isSubscribable=function(a){return"function"==typeof a.subscribe&&"function"==typeof a.notifySubscribers};ko.exportSymbol("ko.subscribable",ko.subscribable);ko.exportSymbol("ko.isSubscribable",ko.isSubscribable);ko.dependencyDetection=function(){var a=[];return{begin:function(){a.push([])},end:function(){return a.pop()},registerDependency:function(c){if(!ko.isSubscribable(c))throw"Only subscribable things can act as dependencies";0<a.length&&a[a.length-1].push(c)}}}();
var primitiveTypes={undefined:!0,"boolean":!0,number:!0,string:!0};function valuesArePrimitiveAndEqual(a,c){return null===a||typeof a in primitiveTypes?a===c:!1}
ko.observable=function(a){function c(){if(0<arguments.length){if(!c.equalityComparer||!c.equalityComparer(d,arguments[0]))d=arguments[0],c.notifySubscribers(d);return this}ko.dependencyDetection.registerDependency(c);return d}var d=a;c.__ko_proto__=ko.observable;c.valueHasMutated=function(){c.notifySubscribers(d)};c.equalityComparer=valuesArePrimitiveAndEqual;ko.subscribable.call(c);ko.exportProperty(c,"valueHasMutated",c.valueHasMutated);return c};
ko.isObservable=function(a){return null===a||void 0===a||void 0===a.__ko_proto__?!1:a.__ko_proto__===ko.observable?!0:ko.isObservable(a.__ko_proto__)};ko.isWriteableObservable=function(a){return"function"==typeof a&&a.__ko_proto__===ko.observable||"function"==typeof a&&a.__ko_proto__===ko.dependentObservable&&a.hasWriteFunction?!0:!1};ko.exportSymbol("ko.observable",ko.observable);ko.exportSymbol("ko.isObservable",ko.isObservable);ko.exportSymbol("ko.isWriteableObservable",ko.isWriteableObservable);
ko.observableArray=function(a){0==arguments.length&&(a=[]);if(null!==a&&void 0!==a&&!("length"in a))throw Error("The argument passed when initializing an observable array must be an array, or null, or undefined.");var c=new ko.observable(a);ko.utils.arrayForEach("pop,push,reverse,shift,sort,splice,unshift".split(","),function(a){c[a]=function(){var b=c(),b=b[a].apply(b,arguments);c.valueHasMutated();return b}});ko.utils.arrayForEach(["slice"],function(a){c[a]=function(){var b=c();return b[a].apply(b,
arguments)}});c.remove=function(a){for(var b=c(),e=[],f=[],h="function"==typeof a?a:function(b){return b===a},i=0,g=b.length;i<g;i++){var j=b[i];h(j)?f.push(j):e.push(j)}c(e);return f};c.removeAll=function(a){if(void 0===a){var b=c();c([]);return b}return!a?[]:c.remove(function(b){return 0<=ko.utils.arrayIndexOf(a,b)})};c.destroy=function(a){for(var b=c(),e="function"==typeof a?a:function(b){return b===a},f=b.length-1;0<=f;f--)e(b[f])&&(b[f]._destroy=!0);c.valueHasMutated()};c.destroyAll=function(a){return void 0===
a?c.destroy(function(){return!0}):!a?[]:c.destroy(function(b){return 0<=ko.utils.arrayIndexOf(a,b)})};c.indexOf=function(a){var b=c();return ko.utils.arrayIndexOf(b,a)};c.replace=function(a,b){var e=c.indexOf(a);0<=e&&(c()[e]=b,c.valueHasMutated())};ko.exportProperty(c,"remove",c.remove);ko.exportProperty(c,"removeAll",c.removeAll);ko.exportProperty(c,"destroy",c.destroy);ko.exportProperty(c,"destroyAll",c.destroyAll);ko.exportProperty(c,"indexOf",c.indexOf);return c};
ko.exportSymbol("ko.observableArray",ko.observableArray);
ko.dependentObservable=function(a,c,d){function b(){ko.utils.arrayForEach(l,function(a){a.dispose()});l=[]}function e(a){b();ko.utils.arrayForEach(a,function(a){l.push(a.subscribe(f))})}function f(){if(g&&"function"==typeof d.disposeWhen&&d.disposeWhen())h.dispose();else{try{ko.dependencyDetection.begin(),i=d.owner?d.read.call(d.owner):d.read()}finally{var a=ko.utils.arrayGetDistinctValues(ko.dependencyDetection.end());e(a)}h.notifySubscribers(i);g=!0}}function h(){if(0<arguments.length)if("function"===
typeof d.write){var a=arguments[0];d.owner?d.write.call(d.owner,a):d.write(a)}else throw"Cannot write a value to a dependentObservable unless you specify a 'write' option. If you wish to read the current value, don't pass any parameters.";else return g||f(),ko.dependencyDetection.registerDependency(h),i}var i,g=!1;a&&"object"==typeof a?d=a:(d=d||{},d.read=a||d.read,d.owner=c||d.owner);if("function"!=typeof d.read)throw"Pass a function that returns the value of the dependentObservable";var j="object"==
typeof d.disposeWhenNodeIsRemoved?d.disposeWhenNodeIsRemoved:null,k=null;if(j){k=function(){h.dispose()};ko.utils.domNodeDisposal.addDisposeCallback(j,k);var m=d.disposeWhen;d.disposeWhen=function(){return!ko.utils.domNodeIsAttachedToDocument(j)||"function"==typeof m&&m()}}var l=[];h.__ko_proto__=ko.dependentObservable;h.getDependenciesCount=function(){return l.length};h.hasWriteFunction="function"===typeof d.write;h.dispose=function(){j&&ko.utils.domNodeDisposal.removeDisposeCallback(j,k);b()};ko.subscribable.call(h);
!0!==d.deferEvaluation&&f();ko.exportProperty(h,"dispose",h.dispose);ko.exportProperty(h,"getDependenciesCount",h.getDependenciesCount);return h};ko.dependentObservable.__ko_proto__=ko.observable;ko.exportSymbol("ko.dependentObservable",ko.dependentObservable);
(function(){function a(b,e,f){f=f||new d;b=e(b);if(!("object"==typeof b&&null!==b&&void 0!==b))return b;var h=b instanceof Array?[]:{};f.save(b,h);c(b,function(d){var c=e(b[d]);switch(typeof c){case "boolean":case "number":case "string":case "function":h[d]=c;break;case "object":case "undefined":var j=f.get(c);h[d]=void 0!==j?j:a(c,e,f)}});return h}function c(a,d){if(a instanceof Array)for(var c=0;c<a.length;c++)d(c);else for(c in a)d(c)}function d(){var a=[],d=[];this.save=function(c,h){var i=ko.utils.arrayIndexOf(a,
c);0<=i?d[i]=h:(a.push(c),d.push(h))};this.get=function(c){c=ko.utils.arrayIndexOf(a,c);return 0<=c?d[c]:void 0}}ko.toJS=function(b){if(0==arguments.length)throw Error("When calling ko.toJS, pass the object you want to convert.");return a(b,function(a){for(var b=0;ko.isObservable(a)&&10>b;b++)a=a();return a})};ko.toJSON=function(a){a=ko.toJS(a);return ko.utils.stringifyJson(a)}})();ko.exportSymbol("ko.toJS",ko.toJS);ko.exportSymbol("ko.toJSON",ko.toJSON);
(function(){ko.selectExtensions={readValue:function(a){return"OPTION"==a.tagName?!0===a.__ko__hasDomDataOptionValue__?ko.utils.domData.get(a,ko.bindingHandlers.options.optionValueDomDataKey):a.getAttribute("value"):"SELECT"==a.tagName?0<=a.selectedIndex?ko.selectExtensions.readValue(a.options[a.selectedIndex]):void 0:a.value},writeValue:function(a,c){if("OPTION"==a.tagName)switch(typeof c){case "string":case "number":ko.utils.domData.set(a,ko.bindingHandlers.options.optionValueDomDataKey,void 0);
"__ko__hasDomDataOptionValue__"in a&&delete a.__ko__hasDomDataOptionValue__;a.value=c;break;default:ko.utils.domData.set(a,ko.bindingHandlers.options.optionValueDomDataKey,c),a.__ko__hasDomDataOptionValue__=!0,a.value=""}else if("SELECT"==a.tagName)for(var d=a.options.length-1;0<=d;d--){if(ko.selectExtensions.readValue(a.options[d])==c){a.selectedIndex=d;break}}else{if(null===c||void 0===c)c="";a.value=c}}}})();ko.exportSymbol("ko.selectExtensions",ko.selectExtensions);
ko.exportSymbol("ko.selectExtensions.readValue",ko.selectExtensions.readValue);ko.exportSymbol("ko.selectExtensions.writeValue",ko.selectExtensions.writeValue);
ko.jsonExpressionRewriting=function(){function a(a,b){return a.replace(d,function(a,d){return b[d]})}function c(a){return 0<=ko.utils.arrayIndexOf(e,ko.utils.stringTrim(a).toLowerCase())?!1:"<"==a[0]&&">"==a[a.length-1]?!0:null!==a.match(b)}var d=/\[ko_token_(\d+)\]/g,b=/^[\_$a-z][\_$a-z0-9]*(\[.*?\])*(\.[\_$a-z][\_$a-z0-9]*(\[.*?\])*)*$/i,e=["true","false"];return{parseJson:function(b){b=ko.utils.stringTrim(b);if(3>b.length)return{};for(var d=[],c=null,g,e,k="{"==b.charAt(0)?1:0;k<b.length;k++){var m=
b.charAt(k);if(null===c)switch(m){case '"':case "'":case "/":c=k;g=m;break;case "<":c=k;g=">";break;case "{":c=k;e=1;g="}";break;case "[":c=k,g="]"}else if("}"==g&&"{"==m)e++;else if("}"==g&&"}"==m&&1<e)e--;else if(m==g){m=b.substring(c,k+1);d.push(m);var l="[ko_token_"+(d.length-1)+"]",b=b.substring(0,c)+l+b.substring(k+1),k=k-(m.length-l.length),c=null}}c={};b=b.split(",");g=0;for(e=b.length;g<e;g++)m=b[g],l=m.indexOf(":"),0<l&&l<m.length-1&&(k=ko.utils.stringTrim(m.substring(0,l)),m=ko.utils.stringTrim(m.substring(l+
1)),"{"==k.charAt(0)&&(k=k.substring(1)),"}"==m.charAt(m.length-1)&&(m=m.substring(0,m.length-1)),k=ko.utils.stringTrim(a(k,d)),m=ko.utils.stringTrim(a(m,d)),c[k]=m);return c},insertPropertyAccessorsIntoJson:function(a){var b=ko.jsonExpressionRewriting.parseJson(a),d=[],g;for(g in b){var e=b[g];c(e)&&(0<d.length&&d.push(", "),d.push(g+" : function(__ko_value) { "+e+" = __ko_value; }"))}0<d.length&&(b=d.join(""),a=a+", '_ko_property_writers' : { "+b+" } ");return a},parseURIsInJSONString:function(a){for(var b=
/["']?(<|\[)[a-z:\/.#?&%]+(\]|>)['"]?/g,d="",c=b.exec(a);null!=c;){if(("'"===c[0][0]||'"'===c[0][0])&&("'"===c[0][c[0].length-1]||'"'===c[0][c[0].length-1]))a=a.split(c[0]),d=d+a[0]+c[0],a=a[1];else var e=c[0],c=c.index,d=a.substring(0,c)+"sko.current().tryProperty('"+e+"')",a=a.substring(c+e.length);c=b.exec(a)}return d+a},insertPropertyReaderWritersIntoJson:function(a){var a=ko.jsonExpressionRewriting.parseJson(a),b=[],d="",e=!0,j;for(j in a){var k=a[j],k=this.parseURIsInJSONString(k);c(k)&&(0<
b.length&&b.push(", "),"<"===k[0]&&">"===k[k.length-1]&&"about"!==j&&"rel"!==j?b.push(j+" : function(__ko_value) { sko.current = function() { return sko.currentResource(innerNode); }; sko.current().tryProperty('"+k+"') = __ko_value; }"):null!=k.match(/^\[[^,;"\]\}\{\[\.:]+:[^,;"\}\]\{\[\.:]+\]$/)&&"about"!==j&&"rel"!==j?b.push(j+" : function(__ko_value) { sko.current = function() { return sko.currentResource(innerNode); }; sko.current().tryProperty('"+k+"') = __ko_value; }"):"<"===k[0]&&">"===k[k.length-
1]&&("about"===j||"rel"===j)||"["===k[0]&&"]"===k[k.length-1]&&("about"===j||"rel"===j)||(/tryProperty\([^)]+\)$/.test(k)||/prop\([^)]+\)$/.test(k)?b.push(j+" : function(__ko_value) { sko.current = function() { return sko.currentResource(innerNode); }; "+k+"(__ko_value); }"):b.push(j+" : function(__ko_value) { sko.current = function() { return sko.currentResource(innerNode); }; "+k+" = __ko_value; }")));e?e=!1:d+=", ";d="<"===k[0]&&">"===k[k.length-1]&&"about"!==j&&"rel"!==j?d+j+": (function(){ sko.current = function() { return sko.currentResource(innerNode); }; return sko.current().tryProperty('"+
k+"') })()":null!=k.match(/^\[[^,;"\]\}\{\[\.:]+:[^,;"\}\]\{\[\.:]+\]$/)&&"about"!==j&&"rel"!==j?d+j+": (function(){ sko.current = function() { return sko.currentResource(innerNode); }; return sko.current().tryProperty('"+k+"') })()":"<"===k[0]&&">"===k[k.length-1]&&("about"===j||"rel"===j)?d+j+": '"+k.slice(1,k.length-1)+"'":null!=k.match(/^\[[^,;"\]\}\{\[\.:]+:[^,;"\}\]\{\[\.:]+\]$/)&&("about"===j||"rel"===j)?d+j+": sko.rdf.prefixes.resolve('"+k.slice(1,k.length-1)+"')":d+j+": (function(){ sko.current = function() { return sko.currentResource(innerNode); }; return "+
k+" })()"}a=d;0<b.length&&(b=b.join(""),a=a+", '_ko_property_writers' : { "+b+" } ");return a}}}();ko.exportSymbol("ko.jsonExpressionRewriting",ko.jsonExpressionRewriting);ko.exportSymbol("ko.jsonExpressionRewriting.parseJson",ko.jsonExpressionRewriting.parseJson);ko.exportSymbol("ko.jsonExpressionRewriting.insertPropertyAccessorsIntoJson",ko.jsonExpressionRewriting.insertPropertyAccessorsIntoJson);ko.exportSymbol("ko.jsonExpressionRewriting.insertPropertyReaderWritersIntoJson",ko.jsonExpressionRewriting.insertPropertyReaderWritersIntoJson);
(function(){ko.bindingHandlers={};ko.applyBindingsToNode=function(a,c,d,b){function e(a){return function(){return i[a]}}function f(){return i}var h=!0,b=b||"data-bind",i;new ko.dependentObservable(function(){var g;if("function"==typeof c){d.skonode=a;with(d)g=c()}else g=c;if(!g)a:{var j=a.getAttribute(b);try{var k=" { "+ko.jsonExpressionRewriting.insertPropertyReaderWritersIntoJson(j)+" } ";g=ko.utils.evalWithinScope(k,null===d?window:d,a);break a}catch(m){"undefined"!==typeof console&&(console.log("!!! ERROR"),
console.log(j),console.log(m))}g=void 0}i=g;if(h)for(var l in i)ko.bindingHandlers[l]&&"function"==typeof ko.bindingHandlers[l].init&&(k=e(l),(0,ko.bindingHandlers[l].init)(a,k,f,d));for(l in i)ko.bindingHandlers[l]&&"function"==typeof ko.bindingHandlers[l].update&&(k=e(l),(0,ko.bindingHandlers[l].update)(a,k,f,d))},null,{disposeWhenNodeIsRemoved:a});h=!1};ko.applyBindings=function(a,c){if(c&&void 0==c.nodeType)throw Error("ko.applyBindings: first parameter should be your view model; second parameter should be a DOM node (note: this is a breaking change since KO version 1.05)");
var c=c||window.document.body,d=ko.utils.getElementsHavingAttribute(c,"data-bind");ko.utils.arrayForEach(d,function(b){ko.applyBindingsToNode(b,null,a)})};ko.exportSymbol("ko.bindingHandlers",ko.bindingHandlers);ko.exportSymbol("ko.applyBindings",ko.applyBindings);ko.exportSymbol("ko.applyBindingsToNode",ko.applyBindingsToNode)})();var eventHandlersWithShortcuts=["click"];
ko.utils.arrayForEach(eventHandlersWithShortcuts,function(a){ko.bindingHandlers[a]={init:function(c,d,b,e){return ko.bindingHandlers.event.init.call(this,c,function(){var b={};b[a]=d();return b},b,e)}}});
ko.bindingHandlers.event={init:function(a,c,d,b){var e=c()||{},f;for(f in e)(function(){var e=f;"string"==typeof e&&ko.utils.registerEventHandler(a,e,function(a){var g,f=c()[e];if(f){var k=d();try{g=f.apply(b,arguments)}finally{!0!==g&&(a.preventDefault?a.preventDefault():a.returnValue=!1)}!1===k[e+"Bubble"]&&(a.cancelBubble=!0,a.stopPropagation&&a.stopPropagation())}})})()}};
ko.bindingHandlers.submit={init:function(a,c,d,b){if("function"!=typeof c())throw Error("The value for a submit binding must be a function to invoke on submit");ko.utils.registerEventHandler(a,"submit",function(d){var f,h=c();try{f=h.call(b,a)}finally{!0!==f&&(d.preventDefault?d.preventDefault():d.returnValue=!1)}})}};ko.bindingHandlers.visible={update:function(a,c){var d=ko.utils.unwrapObservable(c()),b="none"!=a.style.display;d&&!b?a.style.display="":!d&&b&&(a.style.display="none")}};
ko.bindingHandlers.enable={update:function(a,c){var d=ko.utils.unwrapObservable(c());d&&a.disabled?a.removeAttribute("disabled"):!d&&!a.disabled&&(a.disabled=!0)}};ko.bindingHandlers.disable={update:function(a,c){ko.bindingHandlers.enable.update(a,function(){return!ko.utils.unwrapObservable(c())})}};
ko.bindingHandlers.value={init:function(a,c,d){var b=["change"],e=d().valueUpdate;e&&("string"==typeof e&&(e=[e]),ko.utils.arrayPushAll(b,e),b=ko.utils.arrayGetDistinctValues(b));ko.utils.arrayForEach(b,function(b){var e=!1;ko.utils.stringStartsWith(b,"after")&&(e=!0,b=b.substring(5));var i=e?function(a){setTimeout(a,0)}:function(a){a()};ko.utils.registerEventHandler(a,b,function(){i(function(){var b=c(),e=ko.selectExtensions.readValue(a);ko.isWriteableObservable(b)?b(e):(b=d(),b._ko_property_writers&&
b._ko_property_writers.value&&b._ko_property_writers.value(e))})})})},update:function(a,c){var d=ko.utils.unwrapObservable(c()),b=ko.selectExtensions.readValue(a),e=d!=b;0===d&&0!==b&&"0"!==b&&(e=!0);e&&(b=function(){ko.selectExtensions.writeValue(a,d)},b(),"SELECT"==a.tagName&&setTimeout(b,0));"SELECT"==a.tagName&&(b=ko.selectExtensions.readValue(a),b!==d&&ko.utils.triggerEvent(a,"change"))}};
ko.bindingHandlers.options={update:function(a,c,d){if("SELECT"!=a.tagName)throw Error("options binding applies only to SELECT elements");var b=ko.utils.arrayMap(ko.utils.arrayFilter(a.childNodes,function(a){return a.tagName&&"OPTION"==a.tagName&&a.selected}),function(a){return ko.selectExtensions.readValue(a)||a.innerText||a.textContent}),e=a.scrollTop,f=ko.utils.unwrapObservable(c());ko.utils.emptyDomNode(a);if(f){var h=d();"number"!=typeof f.length&&(f=[f]);if(h.optionsCaption){var i=document.createElement("OPTION");
i.innerHTML=h.optionsCaption;ko.selectExtensions.writeValue(i,void 0);a.appendChild(i)}d=0;for(c=f.length;d<c;d++){var i=document.createElement("OPTION"),g="string"==typeof h.optionsValue?f[d][h.optionsValue]:f[d],g=ko.utils.unwrapObservable(g);ko.selectExtensions.writeValue(i,g);var j=h.optionsText;optionText="function"==typeof j?j(f[d]):"string"==typeof j?f[d][j]:g;if(null===optionText||void 0===optionText)optionText="";optionText=ko.utils.unwrapObservable(optionText).toString();"string"==typeof i.innerText?
i.innerText=optionText:i.textContent=optionText;a.appendChild(i)}f=a.getElementsByTagName("OPTION");d=h=0;for(c=f.length;d<c;d++)0<=ko.utils.arrayIndexOf(b,ko.selectExtensions.readValue(f[d]))&&(ko.utils.setOptionNodeSelectionState(f[d],!0),h++);e&&(a.scrollTop=e)}}};ko.bindingHandlers.options.optionValueDomDataKey="__ko.bindingHandlers.options.optionValueDomData__";
ko.bindingHandlers.selectedOptions={getSelectedValuesFromSelectNode:function(a){for(var c=[],a=a.childNodes,d=0,b=a.length;d<b;d++){var e=a[d];"OPTION"==e.tagName&&e.selected&&c.push(ko.selectExtensions.readValue(e))}return c},init:function(a,c,d){ko.utils.registerEventHandler(a,"change",function(){var a=c();ko.isWriteableObservable(a)?a(ko.bindingHandlers.selectedOptions.getSelectedValuesFromSelectNode(this)):(a=d(),a._ko_property_writers&&a._ko_property_writers.value&&a._ko_property_writers.value(ko.bindingHandlers.selectedOptions.getSelectedValuesFromSelectNode(this)))})},
update:function(a,c){if("SELECT"!=a.tagName)throw Error("values binding applies only to SELECT elements");var d=ko.utils.unwrapObservable(c());if(d&&"number"==typeof d.length)for(var b=a.childNodes,e=0,f=b.length;e<f;e++){var h=b[e];"OPTION"==h.tagName&&ko.utils.setOptionNodeSelectionState(h,0<=ko.utils.arrayIndexOf(d,ko.selectExtensions.readValue(h)))}}};
ko.bindingHandlers.text={update:function(a,c){var d=ko.utils.unwrapObservable(c());if(null===d||void 0===d)d="";"string"==typeof a.innerText?a.innerText=d:a.textContent=d}};ko.bindingHandlers.html={update:function(a,c){var d=ko.utils.unwrapObservable(c());ko.utils.setHtml(a,d)}};ko.bindingHandlers.css={update:function(a,c){var d=ko.utils.unwrapObservable(c()||{}),b;for(b in d)if("string"==typeof b){var e=ko.utils.unwrapObservable(d[b]);ko.utils.toggleDomNodeCssClass(a,b,e)}}};
ko.bindingHandlers.style={update:function(a,c){var d=ko.utils.unwrapObservable(c()||{}),b;for(b in d)if("string"==typeof b){var e=ko.utils.unwrapObservable(d[b]);a.style[b]=e||""}}};ko.bindingHandlers.uniqueName={init:function(a,c){c()&&(a.name="ko_unique_"+ ++ko.bindingHandlers.uniqueName.currentIndex,ko.utils.isIe6&&a.mergeAttributes(document.createElement("<input name='"+a.name+"'/>"),!1))}};ko.bindingHandlers.uniqueName.currentIndex=0;
ko.bindingHandlers.checked={init:function(a,c,d){ko.utils.registerEventHandler(a,"click",function(){var b;if("checkbox"==a.type)b=a.checked;else if("radio"==a.type&&a.checked)b=a.value;else return;var e=c();"checkbox"==a.type&&ko.utils.unwrapObservable(e)instanceof Array?(b=ko.utils.arrayIndexOf(ko.utils.unwrapObservable(e),a.value),a.checked&&0>b?e.push(a.value):!a.checked&&0<=b&&e.splice(b,1)):ko.isWriteableObservable(e)?e()!==b&&e(b):(e=d(),e._ko_property_writers&&e._ko_property_writers.checked&&
e._ko_property_writers.checked(b))});"radio"==a.type&&!a.name&&ko.bindingHandlers.uniqueName.init(a,function(){return!0})},update:function(a,c){var d=ko.utils.unwrapObservable(c());"checkbox"==a.type?(a.checked=d instanceof Array?0<=ko.utils.arrayIndexOf(d,a.value):d,d&&ko.utils.isIe6&&a.mergeAttributes(document.createElement("<input type='checkbox' checked='checked' />"),!1)):"radio"==a.type&&(a.checked=a.value==d,a.value==d&&(ko.utils.isIe6||ko.utils.isIe7)&&a.mergeAttributes(document.createElement("<input type='radio' checked='checked' />"),
!1))}};ko.bindingHandlers.attr={update:function(a,c){var d=ko.utils.unwrapObservable(c())||{},b;for(b in d)if("string"==typeof b){var e=ko.utils.unwrapObservable(d[b]);if(!1===e||null===e||void 0===e)a.removeAttribute(b);else var f=e.toString();f&&("<"===f[0]&&">"===f[f.length-1]&&(f=f.substring(1,f.length-1)),a.setAttribute(b,f))}}};
ko.templateEngine=function(){this.renderTemplate=function(){throw"Override renderTemplate in your ko.templateEngine subclass";};this.isTemplateRewritten=function(){throw"Override isTemplateRewritten in your ko.templateEngine subclass";};this.rewriteTemplate=function(){throw"Override rewriteTemplate in your ko.templateEngine subclass";};this.createJavaScriptEvaluatorBlock=function(){throw"Override createJavaScriptEvaluatorBlock in your ko.templateEngine subclass";}};
ko.exportSymbol("ko.templateEngine",ko.templateEngine);
ko.templateRewriting=function(){var a=/(<[a-z]+\d*(\s+(?!data-bind=)[a-z0-9\-]+(=(\"[^\"]*\"|\'[^\']*\'))?)*\s+)data-bind=(["'])([\s\S]*?)\5/gi;return{ensureTemplateIsRewritten:function(a,d){d.isTemplateRewritten(a)||d.rewriteTemplate(a,function(a){return ko.templateRewriting.memoizeBindingAttributeSyntax(a,d)})},memoizeBindingAttributeSyntax:function(c,d){return c.replace(a,function(a,c,f,h,i,g,j){a=ko.jsonExpressionRewriting.insertPropertyReaderWritersIntoJson(j);return d.createJavaScriptEvaluatorBlock("ko.templateRewriting.applyMemoizedBindingsToNextSibling(function() {                     return (function() { var innerNode=skonode; return { "+
a+" } })()                 })")+c})},applyMemoizedBindingsToNextSibling:function(a){return ko.memoization.memoize(function(d,b){d.nextSibling&&sko.traceResources(d.nextSibling,b,function(){sko.traceRelations(d.nextSibling,b,function(){ko.applyBindingsToNode(d.nextSibling,a,b)})})})}}}();ko.exportSymbol("ko.templateRewriting",ko.templateRewriting);ko.exportSymbol("ko.templateRewriting.applyMemoizedBindingsToNextSibling",ko.templateRewriting.applyMemoizedBindingsToNextSibling);
(function(){function a(a,b,e,f,h){var i=ko.utils.unwrapObservable(f),h=h||{},g=h.templateEngine||c;ko.templateRewriting.ensureTemplateIsRewritten(e,g);e=g.renderTemplate(e,i,h);if("number"!=typeof e.length||0<e.length&&"number"!=typeof e[0].nodeType)throw"Template engine must return an array of DOM nodes";switch(b){case "replaceChildren":ko.utils.setDomNodeChildren(a,e);break;case "replaceNode":ko.utils.replaceDomNodes(a,e);break;case "ignoreTargetNode":break;default:throw Error("Unknown renderMode: "+
b);}e&&ko.utils.arrayForEach(e,function(a){ko.memoization.unmemoizeDomNodeAndDescendants(a,[f])});h.afterRender&&h.afterRender(e,f);return e}var c;ko.setTemplateEngine=function(a){if(void 0!=a&&!(a instanceof ko.templateEngine))throw"templateEngine must inherit from ko.templateEngine";c=a};ko.renderTemplate=function(d,b,e,f,h){e=e||{};if(void 0==(e.templateEngine||c))throw"Set a template engine before calling renderTemplate";h=h||"replaceChildren";if(f){var i=f.nodeType?f:0<f.length?f[0]:null;return new ko.dependentObservable(function(){var c=
"function"==typeof d?d(b):d,c=a(f,h,c,b,e);"replaceNode"==h&&(f=c,i=f.nodeType?f:0<f.length?f[0]:null)},null,{disposeWhen:function(){return!i||!ko.utils.domNodeIsAttachedToDocument(i)},disposeWhenNodeIsRemoved:i&&"replaceNode"==h?i.parentNode:i})}return ko.memoization.memoize(function(a){ko.renderTemplate(d,b,e,a,"replaceNode")})};ko.renderTemplateForEach=function(d,b,c,f){return new ko.dependentObservable(function(){var h=ko.utils.unwrapObservable(b)||[];h.constructor!=Array&&(h=[h]);for(var i=0;i<
h.length;i++)if("number"===typeof h[i]||"string"===typeof h[i]){var g={$value:h[i]},j;for(j in viewModel)g[j]=viewModel[j];h[i]=g}h=ko.utils.arrayFilter(h,function(a){return c.includeDestroyed||!a._destroy});ko.utils.setDomNodeChildrenFromArrayMapping(f,h,function(b){var g="function"==typeof d?d(b):d;return a(null,"ignoreTargetNode",g,b,c)},c)},null,{disposeWhenNodeIsRemoved:f})};ko.bindingHandlers.template={update:function(a,b,c,f){b=ko.utils.unwrapObservable(b());c="string"==typeof b?b:b.name;if("undefined"!=
typeof b.foreach)f=ko.renderTemplateForEach(c,b.foreach||[],{templateOptions:b.templateOptions,afterAdd:b.afterAdd,beforeRemove:b.beforeRemove,includeDestroyed:b.includeDestroyed,afterRender:b.afterRender},a);else var h=b.data,f=ko.renderTemplate(c,"undefined"==typeof h?f:h,{templateOptions:b.templateOptions,afterRender:b.afterRender},a);(b=ko.utils.domData.get(a,"__ko__templateSubscriptionDomDataKey__"))&&"function"==typeof b.dispose&&b.dispose();ko.utils.domData.set(a,"__ko__templateSubscriptionDomDataKey__",
f)}}})();ko.exportSymbol("ko.setTemplateEngine",ko.setTemplateEngine);ko.exportSymbol("ko.renderTemplate",ko.renderTemplate);
(function(){ko.utils.compareArrays=function(a,c,d){if(void 0===d)return ko.utils.compareArrays(a,c,1)||ko.utils.compareArrays(a,c,10)||ko.utils.compareArrays(a,c,Number.MAX_VALUE);for(var a=a||[],c=c||[],b=a,e=c,f=[],h=0;h<=e.length;h++)f[h]=[];for(var h=0,i=Math.min(b.length,d);h<=i;h++)f[0][h]=h;h=1;for(i=Math.min(e.length,d);h<=i;h++)f[h][0]=h;for(var i=b.length,g,j=e.length,h=1;h<=i;h++){g=Math.max(1,h-d);for(var k=Math.min(j,h+d);g<=k;g++)f[g][h]=b[h-1]===e[g-1]?f[g-1][h-1]:Math.min(void 0===
f[g-1][h]?Number.MAX_VALUE:f[g-1][h]+1,void 0===f[g][h-1]?Number.MAX_VALUE:f[g][h-1]+1)}d=a.length;b=c.length;e=[];h=f[b][d];if(void 0===h)f=null;else{for(;0<d||0<b;){i=f[b][d];j=0<b?f[b-1][d]:h+1;k=0<d?f[b][d-1]:h+1;g=0<b&&0<d?f[b-1][d-1]:h+1;if(void 0===j||j<i-1)j=h+1;if(void 0===k||k<i-1)k=h+1;g<i-1&&(g=h+1);j<=k&&j<g?(e.push({status:"added",value:c[b-1]}),b--):(k<j&&k<g?e.push({status:"deleted",value:a[d-1]}):(e.push({status:"retained",value:a[d-1]}),b--),d--)}f=e.reverse()}return f}})();
ko.exportSymbol("ko.utils.compareArrays",ko.utils.compareArrays);
(function(){function a(a,d,b){var e=[],a=ko.dependentObservable(function(){var a=d(b)||[];0<e.length&&ko.utils.replaceDomNodes(e,a);e.splice(0,e.length);ko.utils.arrayPushAll(e,a)},null,{disposeWhenNodeIsRemoved:a,disposeWhen:function(){return 0==e.length||!ko.utils.domNodeIsAttachedToDocument(e[0])}});return{mappedNodes:e,dependentObservable:a}}ko.utils.setDomNodeChildrenFromArrayMapping=function(c,d,b,e){for(var d=d||[],e=e||{},f=void 0===ko.utils.domData.get(c,"setDomNodeChildrenFromArrayMapping_lastMappingResult"),
h=ko.utils.domData.get(c,"setDomNodeChildrenFromArrayMapping_lastMappingResult")||[],i=ko.utils.arrayMap(h,function(a){return a.arrayEntry}),g=ko.utils.compareArrays(i,d),d=[],j=0,k=[],i=[],m=null,l=0,r=g.length;l<r;l++)switch(g[l].status){case "retained":var n=h[j];d.push(n);0<n.domNodes.length&&(m=n.domNodes[n.domNodes.length-1]);j++;break;case "deleted":h[j].dependentObservable.dispose();ko.utils.arrayForEach(h[j].domNodes,function(a){k.push({element:a,index:l,value:g[l].value});m=a});j++;break;
case "added":var o=a(c,b,g[l].value),n=o.mappedNodes;d.push({arrayEntry:g[l].value,domNodes:n,dependentObservable:o.dependentObservable});for(var o=0,s=n.length;o<s;o++){var p=n[o];i.push({element:p,index:l,value:g[l].value});null==m?c.firstChild?c.insertBefore(p,c.firstChild):c.appendChild(p):m.nextSibling?c.insertBefore(p,m.nextSibling):c.appendChild(p);m=p}}ko.utils.arrayForEach(k,function(a){ko.cleanNode(a.element)});b=!1;if(!f){if(e.afterAdd)for(l=0;l<i.length;l++)e.afterAdd(i[l].element,i[l].index,
i[l].value);if(e.beforeRemove){for(l=0;l<k.length;l++)e.beforeRemove(k[l].element,k[l].index,k[l].value);b=!0}}b||ko.utils.arrayForEach(k,function(a){a.element.parentNode&&a.element.parentNode.removeChild(a.element)});ko.utils.domData.set(c,"setDomNodeChildrenFromArrayMapping_lastMappingResult",d)}})();ko.exportSymbol("ko.utils.setDomNodeChildrenFromArrayMapping",ko.utils.setDomNodeChildrenFromArrayMapping);
ko.jqueryTmplTemplateEngine=function(){var a;a="undefined"==typeof jQuery||!jQuery.tmpl?0:jQuery.tmpl.tag?jQuery.tmpl.tag.tmpl&&jQuery.tmpl.tag.tmpl.open&&0<=jQuery.tmpl.tag.tmpl.open.toString().indexOf("__")?3:2:1;this.jQueryTmplVersion=a;this.getTemplateNode=function(a){var b=document.getElementById(a);if(null==b)throw Error("Cannot find template with ID="+a);return b};var c=RegExp("__ko_apos__","g");this.renderTemplate=function(a,b,e){e=e||{};if(0==this.jQueryTmplVersion)throw Error("jquery.tmpl not detected.\nTo use KO's default template engine, reference jQuery and jquery.tmpl. See Knockout installation documentation for more details.");
if(1==this.jQueryTmplVersion)return a='<script type="text/html">'+this.getTemplateNode(a).text+"<\/script>",b=jQuery.tmpl(a,b)[0].text.replace(c,"'"),jQuery.clean([b],document);if(!(a in jQuery.template)){var f=this.getTemplateNode(a).text;jQuery.template(a,f)}b=[b];b=jQuery.tmpl(a,b,e.templateOptions);b.appendTo(document.createElement("div"));jQuery.fragments={};return b};this.isTemplateRewritten=function(a){return a in jQuery.template?!0:!0===this.getTemplateNode(a).isRewritten};this.rewriteTemplate=
function(a,b){var c=this.getTemplateNode(a),f=b(c.text);1==this.jQueryTmplVersion&&(f=ko.utils.stringTrim(f),f=f.replace(/([\s\S]*?)(\${[\s\S]*?}|{{[\=a-z][\s\S]*?}}|$)/g,function(a,b,d){return b.replace(/\'/g,"__ko_apos__")+d}));c.text=f;c.isRewritten=!0};this.createJavaScriptEvaluatorBlock=function(a){a=function(a){var d=/<\$[^>]*>/g;if(1<a.split(d).length){var c="",h=null;a.replace(d,function(a,b,d){null===h&&(h=d);b=h.split(a);c=c+b[0]+a.replace(/</,"<'+").replace(/>/,"+'>");b.shift();1===b.length?
c+=b[0]:h=b.join(a)});return c}return a}(a);return 1==this.jQueryTmplVersion?"{{= "+a+"}}":"{{ko_code ((function() { return "+a+" })()) }}"};this.addTemplate=function(a,b){document.write("<script type='text/html' id='"+a+"'>"+b+"<\/script>")};ko.exportProperty(this,"addTemplate",this.addTemplate);1<this.jQueryTmplVersion&&(jQuery.tmpl.tag.ko_code={open:(3>this.jQueryTmplVersion?"_":"__")+".push($1 || '');"})};ko.jqueryTmplTemplateEngine.prototype=new ko.templateEngine;ko.setTemplateEngine(new ko.jqueryTmplTemplateEngine);
ko.exportSymbol("ko.jqueryTmplTemplateEngine",ko.jqueryTmplTemplateEngine);Utils={stackCounterLimit:1E3,stackCounter:0};Utils.recur=function(a){Utils.stackCounter===Utils.stackCounterLimit?(Utils.stackCounter=0,setTimeout(a,0)):(Utils.stackCounter++,a())};Utils.repeat=function(a,c,d,b,e){4===arguments.length&&(e={});a<c?(e._i=a,d(function(d,e){Utils.recur(function(){Utils.repeat(a+1,c,d,b,e)})},e)):b(e)};SemanticKnockOut={};window.sko=SemanticKnockOut;sko.activeDebug=!1;
sko.log=function(a){sko.activeDebug&&"undefined"!=typeof console&&console.log&&console.log(a)};sko.VERSION="0.1.0";
sko.jsonld={coerce:function(a,c,d){null==a["@context"]&&(a["@context"]={});if(null==a["@context"]["@coerce"])a["@context"]["@coerce"]={},a["@context"]["@coerce"][d]=c;else if("string"===typeof a["@context"]["@coerce"][d]&&a["@context"]["@coerce"][d]!=c)a["@context"]["@coerce"][d]=[a["@context"]["@coerce"][d],c];else if("object"===typeof a["@context"]["@coerce"][d]){for(var b=0;b<a["@context"]["@coerce"][d].length;b++)if(a["@context"]["@coerce"][d][b]===c)return a;a["@context"]["@coerce"][d].push(c)}else a["@context"]["@coerce"][d]=
c;return a},graphToJSONLD:function(a,c){var d={};a.forEach(function(a){var b=a.subject.valueOf(),e=d[b];null==e&&(e={"@subject":b,"@context":{}},d[b]=e);var g=a.predicate.valueOf();"http://www.w3.org/1999/02/22-rdf-syntax-ns#type"===g&&(g="@type");var b=null,j=!1,b=c.prefixes.shrink(g);b!=g&&(j=!0);-1!=b.indexOf("#")?b=b.split("#")[1]:(b=b.split("/"),b=b[b.length-1]);g=a.object.valueOf();null!=e[b]?j?(a=b.split(":")[0],"object"===typeof e[b]?e[b].push(g):(g=[e[b],g],e[b]=g)):null!=e["@context"][b]||
"@"===b[0]?"object"===typeof e[b]?e[b].push(g):(g=[e[b],g],e[b]=g):(b=a.predicate.valueOf(),null==e[b]?e[b]=g:"object"===typeof e[b]?e[b].push(g):(g=[e[b],g],e[b]=g),"string"===typeof g&&(0==g.indexOf("http://")||0==g.indexOf("https://"))&&sko.jsonld.coerce(e,b,"@iri")):(e[b]=g,"@"!=b[0]&&(j?(a=b.split(":")[0],e["@context"][a]=c.prefixes[a]):e["@context"][b]=a.predicate.valueOf(),"string"===typeof g&&(0==g.indexOf("http://")||0==g.indexOf("https://"))&&sko.jsonld.coerce(e,b,"@iri")))});var b=[],e;
for(e in d)b.push(d[e]);return b}};sko.Class={};sko.Class.Clone=function(){};sko.Class.registry={};sko.Class.define=function(a,c){sko.Class.registry[sko.NTUri(a.replace(/\s*/g,""))]=c};sko.Class.instance=function(a,c){var d=sko.NTUri(a),b=c||{};sko.Class.Clone.prototype=sko.Class.registry[d];d=new sko.Class.Clone;b.extended=null;for(var e in d)null==b[e]&&(b[e]=d[e]);b.extended&&b.extended();return b};
sko.Class.check=function(a,c){var d=c||!1,b;for(b in sko.Class.registry)if(sko.log("*** IS INSTANCE OF? "+b),sko.Class.isInstance(a,b))sko.log("Y!"),(d||null==a.classes[b])&&sko.Class.instance(b,a),a.classes[b]=!0;else if(sko.log("N!"),null!=a.classes[b]){delete a.classes[b];for(var e in sko.Class.registry[b])delete a[e]}};
sko.Class.isInstance=function(a,c){if(0===c.indexOf("ObjectIntersectionOf(")){for(var d=c.slice(0,c.length-1).split("ObjectIntersectionOf(")[1].split(","),b=0;b<d.length;b++)if(sko.log("INTERSECTION CHECKING "+d[b]),!sko.Class.isInstance(a,d[b]))return!1;return!0}if(0===c.indexOf("ObjectUnionOf(")){d=c.slice(0,c.length-1).split("ObjectUnionOf(")[1].split(",");for(b=0;b<d.length;b++)if(sko.Class.isInstance(a,d[b]))return!0;return!1}if(0===c.indexOf("ObjectSomeValuesFrom(")){d=c.slice(0,c.length-1).split("ObjectSomeValuesFrom(")[1];
sko.log("CHECKIN CLASS URI: "+sko.NTUri(d));for(b in a.valuesMap)sko.log(" - "+b+" ---\> "+a.valuesMap[sko.NTUri(d)]);return null!=a.valuesMap[sko.NTUri(d)]}sko.log("CHECKIN CLASS URI: "+sko.NTUri(c));sko.log(a);for(b in a.classes)sko.log(" - "+b+" ---\> "+a.classes[b]);return!0===a.classes[sko.NTUri(c)]};
sko.ready=function(){sko.aboutResourceMap={};sko.aboutResourceSubscriptionMap={};sko.Class.registry={};sko.aboutCounter=0;sko.generatorId=0;sko.generatorsMap={};var a=null;2===arguments.length?(sko.store=arguments[0],a=arguments[1],sko.rdf=sko.store.rdf,a(!0)):(a=arguments[0],rdfstore.create(function(c){sko.store=c;sko.store.registerDefaultProfileNamespaces();sko.rdf=sko.store.rdf;a(!0)}))};sko.registerPrefix=function(a,c){sko.store.registerDefaultNamespace(a,c)};sko._blankCounter=0;
sko.nextBlankLabel=function(){var a="_:sko_"+sko._blankCounter;sko._blankCounter++;return a};sko.aboutResourceMap={};sko.aboutResourceSubscriptionMap={};sko.aboutCounter=0;
sko.about=function(a,c,d){if(null!=sko.about[a])d(a);else{var b=""+sko.aboutCounter;sko.aboutCounter++;null==a&&(a=sko.nextBlankLabel());if("string"===typeof a){var e=a;sko.store.node(sko.plainUri(e),function(a,c){if(a){sko.log("FOUND RESOURCE: "+e);sko.log(c);sko.log(" FOR "+sko.plainUri(e));sko.log(" ------------\> "+b+" : "+e);sko.aboutResourceMap[b]=new sko.Resource(b,e,c);sko.about[b]=ko.observable(e);var i=sko.about[b].subscribe(function(a){sko.log("*** OBSERVING NODE ABOT ID:"+b+" new value -> "+
a);null==a&&(sko.log(" ** NEXT URI IS NULL, GEN BLANK LABEL"),a=sko.nextBlankLabel());sko.store.node(sko.plainUri(a),function(d,c){if(d){var e=c.toArray()[0].subject.valueOf();sko.log(" ------------\> "+b+" : "+e+" 2");sko.aboutResourceMap[b].about(e)}else sko.log("*** NO RESOURCE FOR URI:"+a),sko.log(" ------------\> "+b+" : "+a+" 3"),sko.aboutResourceMap[b].about(a)})});sko.aboutResourceSubscriptionMap[b]=i}d(b)})}else sko.about[b]=ko.dependentObservable({read:function(){var d=a();sko.log("*** OBSERVABLE READING DEPENDING NODE ABOT ID:"+
b+" new value -> "+d);null==d&&(sko.log(" ** URI IS BLANK -> GEN BLANK LABEL"),d=sko.nextBlankLabel());return d},write:function(d){sko.log("*** OBSERVABLE WRITING DEPENDING NODE ABOT ID:"+b+" new value -> "+d);null==d&&(sko.log(" ** URI IS BLANK -> GEN BLANK LABEL"),d=sko.nextBlankLabel());a(d)},owner:c}),sko.store.node(sko.plainUri(sko.about[b]()),function(a,c){if(a){sko.log(" ------------\> "+b+" : "+c+" 4");sko.aboutResourceMap[b]=new sko.Resource(b,sko.about[b](),c);var e=sko.about[b].subscribe(function(a){sko.log("*** OBSERVING NODE ABOT ID:"+
b+" new value -> "+a);null!=a?sko.store.node(sko.plainUri(a),function(d,c){if(d)if(0<c.toArray().length){var e=c.toArray()[0].subject.toNT();sko.log(" ------------\> "+b+" : "+e+" 5");sko.aboutResourceMap[b].about(e)}else sko.log("*** NO RESOURCE FOR URI:"+a),sko.log(" ------------\> "+b+" : "+a+" 6"),sko.aboutResourceMap[b].about(a);else sko.log("Error updating 3 resource for URI:"+a+" in SKO about node observer"),sko.log("*** NO RESOURCE FOR URI:"+a+" NEXT ID:"+b),sko.log(" ------------\> "+b+" : "+
a+" 7"),sko.aboutResourceMap[b].about(a)}):(sko.log("*** NO RESOURCE FOR URI:"+a),sko.log(" ------------\> "+b+" : NEW BLANK  8"),sko.aboutResourceMap[b].about(sko.nextBlankLabel()))});sko.aboutResourceSubscriptionMap[b]=e}d(b)})}};
sko.rel=function(a,c,d,b){var e=""+sko.aboutCounter,f=null;sko.aboutCounter++;if("string"===typeof a){var h=sko.NTUri(a),f=h;sko.about[e]=ko.dependentObservable({read:function(){sko.log("*** OBSERVABLE READING RELATED  DEPENDING NODE ABOT ID:"+e);var a=sko.currentResource(jQuery(c).parent().toArray()[0]);sko.log(a);if(null!=a){sko.log(" ** about:"+a.about());sko.log("*** Found parent resource: "+a.about());if(a[h]){var b=a[h]();if(null!=b&&!sko.isSKOBlankNode(a[h]()))return b=sko.NTUri(b),null==sko.aboutResourceMap[e]||
sko.aboutResourceMap[e].about()!=b?(sko.log("*** found related resource: "+b),sko.store.node(sko.plainUri(b),function(a,d){sko.log("CREATED NODE FOR ID "+e+" AND URI: "+sko.plainUri(b));sko.log(d);sko.log(" ------------\> "+e+" : "+b+" 8b");sko.aboutResourceMap[e]=new sko.Resource(e,b,d)})):sko.log("*** Related resource hasn't changed"),b;if(null==b){sko.log("*** related resource is null");sko.log(" ** NEXT URI IS NULL, GEN BLANK LABEL");var d=sko.nextBlankLabel();sko.log(" ** setting parent node related resource to "+
d);a[h](d)}else sko.aboutResourceMap[e]?(sko.log("*** setting new value for related resource "+d),sko.log(" ------------\> "+e+" : "+d+" 9"),sko.aboutResourceMap[e].about(d)):sko.log("!! Should I create the new blank node?");return d}sko.log("!!! parent resource doest not link to the related resource")}else sko.log("!!! impossible to find parent resource")},write:function(a){null==a&&(sko.log(" ** NEXT URI IS NULL, GEN BLANK LABEL"),a=sko.nextBlankLabel());a=sko.NTUri(a);sko.log("*** OBSERVABLE WRITING RELATED DEPENDING NODE ABOT ID:"+
e+" URI -> "+a);var b=sko.currentResource(jQuery(c).parent().toArray()[0]);null!=b?(sko.log("*** Found parent resource: "+b.about()),b[f]?(sko.log("*** Setting new related resource in parent resource found: "+a),b[f](a)):sko.log("!!! parent resource doest not link to the related resource")):sko.log("!!! impossible to find parent resource")},owner:d});d=sko.about[e].subscribe(function(a){sko.log("*** OBSERVING RELATED NODE ABOT ID:"+e+" new value -> "+a);null==a&&(sko.log(" ** NEXT URI IS NULL, GEN BLANK LABEL"),
a=sko.nextBlankLabel());a=sko.NTUri(a);null!=sko.about[e]()?sko.plainUri(a)!==sko.plainUri(sko.about[e]())&&sko.store.node(sko.plainUri(a),function(b,d){b?(d.toArray(),sko.log(" ------------\> "+e+" : "+h+" 10"),sko.aboutResourceMap[e].about(h)):sko.log("Error updating 1 resource for URI:"+a+" in SKO about related node observer")}):sko.log("!! this resource is now null, should be removed from list of resources?")})}else sko.about[e]=ko.dependentObservable({read:function(){var b;null!=a?(b=a(),b=sko.NTUri(b),
sko.log("*** OBSERVABLE READING RELATED DEPENDING NODE ABOT ID:"+e+" URI -> "+b)):(sko.log(" ** NEXT URI IS NULL, GEN BLANK LABEL"),b=sko.nextBlankLabel());var d=sko.currentResource(jQuery(c).parent().toArray()[0]);if(null!=d){sko.log("*** Found parent resource: "+d.about());if(d[b]){var f=d[b]();sko.log("*** found related resource: "+f);sko.store.node(sko.plainUri(f),function(a,b){sko.log(" ------------\> "+e+" : "+f+" 11");sko.aboutResourceMap[e]=new sko.Resource(e,f,b)});return f}sko.log("!!! parent resource doest not link to the related resource")}else sko.log("!!! impossible to find parent resource")},
write:function(b){var b=sko.NTUri(b),d=sko.currentResource(jQuery(c).parent().toArray()[0]);sko.log("*** OBSERVABLE WRITING RELATED DEPENDING NODE ABOT ID:"+e+" URI -> "+b);null==b&&(sko.log(" ** NEXT URI IS NULL, GEN BLANK LABEL"),b=sko.nextBlankLabel());null!=d?(sko.log("*** Found parent resource: "+d.about()),d[a()]?(sko.log("*** Setting new related resource in parent resource found: "+b),d[a()](b),a(b)):sko.log("!!! parent resource doest not link to the related resource")):sko.log("!!! impossible to find parent resource")},
owner:d}),d=sko.about[e].subscribe(function(a){a=sko.NTUri(a);sko.log("*** OBSERVING RELATED NODE (F) ABOT ID:"+e+" new value -> "+a);null==a&&(sko.log(" ** NEXT URI IS NULL, GEN BLANK LABEL"),a=sko.nextBlankLabel());sko.plainUri(a)!=sko.plainUri(sko.about[e]())?sko.store.node(sko.plainUri(a),function(b,d){if(b){var c=d.toArray()[0].subject.valueOf();sko.log(" ------------\> "+e+" : "+c+" 12");sko.aboutResourceMap[e].about(c)}else sko.log("Error updating  2 resource for URI:"+a+" in SKO about related node observer")}):
sko.log("*** Related about resource hasn't changed")});sko.aboutResourceSubscriptionMap[e]=d;b(e)};sko.plainUri=function(a){if("<"===a[0]&&">"==a[a.length-1])return a.slice(1,a.length-1);if(null!=a.match(/\[[^,;"\]\}\{\[\.:]+:[^,;"\}\]\{\[\.:]+\]/)){var a=a.slice(1,a.length-1),c=sko.rdf.prefixes.resolve(a);if(null==c)throw"The CURIE "+a+" cannot be resolved";return c}return a};
sko.effectiveValue=function(a){if(null==a)return null;if(a.interfaceName&&"Literal"===a.interfaceName){if("http://www.w3.org/2001/XMLSchema#integer"==a.datatype||"http://www.w3.org/2001/XMLSchema#decimal"==a.datatype||"http://www.w3.org/2001/XMLSchema#double"==a.datatype||"http://www.w3.org/2001/XMLSchema#nonPositiveInteger"==a.datatype||"http://www.w3.org/2001/XMLSchema#negativeInteger"==a.datatype||"http://www.w3.org/2001/XMLSchema#long"==a.datatype||"http://www.w3.org/2001/XMLSchema#int"==a.datatype||
"http://www.w3.org/2001/XMLSchema#short"==a.datatype||"http://www.w3.org/2001/XMLSchema#byte"==a.datatype||"http://www.w3.org/2001/XMLSchema#nonNegativeInteger"==a.datatype||"http://www.w3.org/2001/XMLSchema#unsignedLong"==a.datatype||"http://www.w3.org/2001/XMLSchema#unsignedInt"==a.datatype||"http://www.w3.org/2001/XMLSchema#unsignedShort"==a.datatype||"http://www.w3.org/2001/XMLSchema#unsignedByte"==a.datatype||"http://www.w3.org/2001/XMLSchema#positiveInteger"==a.datatype)return parseFloat(a.valueOf());
if("http://www.w3.org/2001/XMLSchema#boolean"===a.type)return"true"===a.valueOf()||!0===a.valueOf()||"True"===a.valueOf();if("http://www.w3.org/2001/XMLSchema#string"===a.type)return a.valueOf();if("http://www.w3.org/2001/XMLSchema#dateTime"===a.type)return new Date(a.valueOf());if(null==a.type)return a.valueOf()}else return a.valueOf()};sko.defaultLanguage=ko.observable(null);
sko.Resource=function(a,c,d){this.resourceId=a;this.valuesMap={};this.subscriptions=[];this.literalLangs={};this.classes={};var b=this;this.defaultLanguage=ko.dependentObservable(function(){return sko.defaultLanguage()});c=sko.NTUri(c);d.forEach(function(a){sko.log(a);"<http://www.w3.org/1999/02/22-rdf-syntax-ns#type>"===a.predicate.toNT()&&(sko.log(" found resource class "+a.object.toNT()),b.classes[a.object.toNT()]=!0);if("NamedNode"===a.object.interfaceName)b.valuesMap[a.predicate.toNT()]=a.object.toNT(),
b[a.predicate.toNT()]=ko.observable(a.object.toNT());else if("Literal"===a.object.interfaceName)if(null!=b.defaultLanguage()){if(null==b.valuesMap[a.predicate.toNT()]||a.object.language==b.defaultLanguage()){var d=sko.effectiveValue(a.object.valueOf());b.valuesMap[a.predicate.toNT()]=d;b[a.predicate.toNT()]=ko.observable(d);b[sko.plainUri(a.predicate.toNT())]=b[a.predicate.toNT()];b.literalLangs[a.predicate.toNT()]=a.object.language}}else{if(null==b.valuesMap[a.predicate.toNT()]||null==a.object.language)d=
sko.effectiveValue(a.object.valueOf()),b.valuesMap[a.predicate.toNT()]=d,b[a.predicate.toNT()]=ko.observable(d),b[sko.plainUri(a.predicate.toNT())]=b[a.predicate.toNT()],b.literalLangs[a.predicate.toNT()]=a.object.language}else b.valuesMap[a.predicate.toNT()]=a.object.valueOf(),b[a.predicate.toNT()]=ko.observable(a.object.valueOf()),b[sko.plainUri(a.predicate.toNT())]=b[a.predicate.toNT()]});this.about=ko.observable(c);this["@"]=this.about;this.storeObserverFn=sko.Resource.storeObserver(this);sko.Class.check(this,
!0);b=this;this.subscriptions.push(this.about.subscribe(function(a){sko.log("SKO Resource new resource:"+a);sko.log("*** STOP OBSERVING NODE STORE");sko.store.stopObservingNode(b.storeObserverFn);if(null!=a&&0!=a.indexOf("_:sko"))sko.log("*** START OBSERVING NODE STORE FOR "+b.about()),sko.store.startObservingNode(sko.plainUri(a),b.storeObserverFn);else{sko.log("*** nullifying resources");for(var d in b.valuesMap)b.valuesMap[d]=null;for(d in b.valuesMap)b[d](null)}}));sko.Resource.koObserver(this);
sko.store.startObservingNode(sko.plainUri(this.about()),b.storeObserverFn)};sko.NTUri=function(a){if("["===a[0]&&"]"===a[a.length-1]){a=a.slice(1,a.length-1);resolved=sko.rdf.prefixes.resolve(a);if(null==a)throw"The CURIE "+a+" cannot be resolved";a="<"+resolved+">"}return a};sko.Resource.prototype.tryProperty=function(a){a=sko.NTUri(a);if(null==this[a]){this.valuesMap[a]=null;this[a]=ko.observable(null);var c=this;this.subscriptions.push(this[a].subscribe(function(d){c.notifyPropertyChange(a,d)}))}return this[a]};
sko.Resource.prototype.prop=function(a){return this.tryProperty(a)};sko.Resource.prototype.getProp=function(a){return this.tryProperty(a)()};sko.Resource.prototype.setProp=function(a,c){return this.tryProperty(a)(c)};
sko.Resource.prototype.notifyPropertyChange=function(a,c){sko.log("*** received KO notification for property "+a+" -> "+c);if(null==this.valuesMap[a])this.valuesMap[a]=c,0===this.about().indexOf("_:sko")||null!=c&&(0===c.indexOf("http")?sko.store.execute("INSERT DATA { "+this.about()+" "+a+" <"+c+"> }",function(){}):0===c.indexOf("<")?sko.store.execute("INSERT DATA { "+this.about()+" "+a+" "+c+" }",function(){}):sko.store.execute("INSERT DATA { "+this.about()+" "+a+' "'+c+'" }',function(){}));else if(this.valuesMap[a]!==
c&&!sko.isSKOBlankNode(c)){var d='"'+this.valuesMap[a]+'"',c='"'+c+'"';null!=this.literalLangs[a]&&(d=d+"@"+this.literalLangs[a],c=c+"@"+this.literalLangs[a]);var b="DELETE { "+this.about()+" "+a+" "+d+" }",b=b+" INSERT { "+this.about()+" "+a+" "+c+" }",b=b+" WHERE { "+this.about()+" "+a+" "+d+" }",b=b.replace(/"</g,"<").replace(/>"/g,">");this.valuesMap[a]=c;sko.log("*** updating STORE: \n  "+b);sko.store.execute(b)}};sko.isSKOBlankNode=function(a){return 0===a.indexOf("_:sko")};
sko.Resource.prototype.disconnect=function(){sko.log(" ** DISCONNECTING");sko.store.stopObservingNode(this.storeObserverFn);sko.log(" ** disconnected STORE");for(var a=0;a<this.subscriptions.length;a++)sko.log(" ** disconnecting subscription"),this.subscriptions[a].dispose();sko.log(" ** disconnecting resource map");sko.aboutResourceSubscriptionMap[this.resourceId].dispose();sko.log(" ** deleting");delete sko.aboutResourceMap[this.resourceId];delete sko.about[this.resourceId]};
sko.cleanNode=function(a){sko.log("*** CLEANING!");sko.log(a);var c=jQuery(a).attr("aboutId"),d=[];null!=c&&d.push(c);d=d.concat(sko.childrenResourceIds(a));for(a=0;a<d.length;a++)null!=sko.aboutResourceMap[d[a]]&&(sko.log("*** DISCONNECTING "+d[a]),sko.log(sko.aboutResourceMap[d[a]]),sko.aboutResourceMap[d[a]].disconnect())};
sko.Resource.koObserver=function(a){var c=function(a,d){sko.log("*** subcribing to property "+d);var c=a[d].subscribe(function(c){a.notifyPropertyChange(d,c)});a.subscriptions.push(c)},d;for(d in a.valuesMap)c(a,d)};
sko.Resource.storeObserver=function(a){return function(c){sko.log("*** received notification change from STORE in resource "+a.about());if(0!==a.about().indexOf("_:sko")){var d={},b={};sko.log("*** triples in STORE resource -> "+c.toArray().length);c.forEach(function(c){if("NamedNode"===c.object.interfaceName)sko.log(" "+c.predicate.toNT()+" -> "+c.object.toNT()),null!=d[c.predicate.toNT()]?d[c.predicate.toNT()].constructor===Array?(d[c.predicate.toNT()].push(c.object.toNT()),d[c.predicate.toNT()].sort()):
d[c.predicate.toNT()]=[d[c.predicate.toNT()],c.object.toNT()]:d[c.predicate.toNT()]=c.object.toNT();else if(null!=a.defaultLanguage()){if(null==d[c.predicate.toNT()]||c.object.language==a.defaultLanguage())null!=d[c.predicate.toNT()]?d[c.predicate.toNT()].constructor===Array?(d[c.predicate.toNT()].push(c.object.valueOf()),d[c.predicate.toNT()].sort()):b[c.predicate.toNT()]!=c.object.language?(d[c.predicate.toNT()]=c.object.valueOf(),b[c.predicate.toNT()]=c.object.language):d[c.predicate.toNT()]=[d[c.predicate.toNT()],
c.object.valueOf()]:(sko.log(" "+c.predicate.toNT()+" -> "+c.object.valueOf()),d[c.predicate.toNT()]=c.object.valueOf(),b[c.predicate.toNT()]=c.object.language)}else if(null==d[c.predicate.toNT()]||null==c.object.language)null!=d[c.predicate.toNT()]?d[c.predicate.toNT()].constructor===Array?(d[c.predicate.toNT()].push(c.object.valueOf()),d[c.predicate.toNT()].sort()):null!=b[c.predicate.toNT()]?(d[c.predicate.toNT()]=c.object.valueOf(),b[c.predicate.toNT()]=c.object.language):d[c.predicate.toNT()]=
[d[c.predicate.toNT()],c.object.valueOf()]:(sko.log(" "+c.predicate.toNT()+" -> "+c.object.valueOf()),d[c.predicate.toNT()]=c.object.valueOf(),b[c.predicate.toNT()]=c.object.language)});var e={},c=[],f=[],h=[],i;for(i in a.valuesMap)if(null!=d[i])if(e[i]=d[i],a.valuesMap[i]&&a.valuesMap[i].constructor===Array&&newValue[i].constructor===Array)a.valuesMap[i].length!=newValue[i].length&&f.push(i);else{if(a.valuesMap[i]!==d[i]&&(f.push(i),null!=b[i]||null!=a.literalLangs[i]))a.literalLangs[i]=b[i]}else c.push(i),
delete a.literalLangs[i];for(i in d)null==a.valuesMap[i]&&(h.push(i),e[i]=d[i],a.literalLangs[i]=b[i]);a.valuesMap=e;for(i=0;i<c.length;i++)sko.log("*** setting value to null "+c[i]+" -> NULL"),a[c[i]](null);for(i=0;i<f.length;i++)sko.log("*** updating value "+f[i]+" -> "+a.valuesMap[f[i]]),a[f[i]](a.valuesMap[f[i]]);for(i=0;i<h.length;i++){sko.log("*** new value "+h[i]+" -> "+a.valuesMap[h[i]]);if(null!=a[h[i]])a[h[i]](a.valuesMap[h[i]]);else a[h[i]]=ko.observable(a.valuesMap[h[i]]);a[sko.plainUri(h[i])]=
a[h[i]]}sko.Class.check(a);sko.log("*** END MODIFICATION")}}};
sko.traceResources=function(a,c,d){sko.log("** TRACING:");sko.log(a);var b=[];(jQuery(a).attr("about")||jQuery(a).attr("data-bind"))&&b.push(a);var a=jQuery(a).find("*[about], *[data-bind]").toArray(),b=b.concat(a),e=function(a,d){var i=b[d._i],g=jQuery(i).attr("about");if(null==jQuery(i).attr("aboutId")){if(null==g){var j=jQuery(i).attr("data-bind");null!=j&&-1!=j.indexOf("about:")&&(g=/s*([^ ]+)s*,?/.exec(j.split("about:")[1])[0],","===g[g.length-1]&&(g=g.slice(0,g.length-1)))}null!=g&&""!=g?("string"===
typeof g&&"<"!==g[0]&&">"!==g[g.length-1]&&"["!==g[0]&&"]"!==g[g.length-1]&&(g=c[g]),sko.about(g,c,function(b){jQuery(i).attr("aboutId",b);a(e,d)})):a(e,d)}else a(e,d)};Utils.repeat(0,b.length,e,function(){d()})};
sko.currentResource=function(a){sko.log("in current resource");sko.log(a);if(null==a)return sko.log("!!! top of DOM tree, About node not found"),null;var c=jQuery(a).attr("aboutId");sko.log("about id:"+c);if(c){a=sko.about[c]();sko.log("uri:"+a);if(null!=a)return sko.aboutResourceMap[c];sko.log("!!! current resource is null: "+c)}else return sko.log("recurring"),sko.currentResource(jQuery(a).parent().toArray()[0])};
sko.currentResourceNode=function(a){sko.log("in current resource node");sko.log(a);if(null==a)return sko.log("!!! top of DOM tree, About node not found"),null;var c=jQuery(a).attr("aboutId");sko.log("about id:"+c);if(c){var d=sko.about[c]();sko.log("uri:"+d);if(null!=d)return a;sko.log("!!! current resource is null: "+c);return null}sko.log("recurring");return sko.currentResourceNode(jQuery(a).parent().toArray()[0])};sko.childrenResourceIds=function(a){return jQuery(a).find("*[aboutId]").map(function(){return jQuery(this).attr("aboutId")})};
sko.traceRelations=function(a,c,d){sko.log("*** TRACING RELATIONS:");a=sko.currentResourceNode(a)||a;sko.log("*** FOUND ROOT NODE TO LOOK FOR RELATIONS:");sko.log(a);var b=[];(jQuery(a).attr("rel")||jQuery(a).attr("data-bind"))&&b.push(a);a=jQuery(a).find("*[rel], *[data-bind]").toArray();b=b.concat(a);sko.log(" ** NODES TO LOOK FOR RELATED RESOURCES");sko.log(b);var e=function(a,d){var i=b[d._i],g=jQuery(i).attr("rel");if(null==g){var j=jQuery(i).attr("data-bind");null!=j&&-1!=j.indexOf("rel:")&&
(g=/s*([^ ]+)s*,?/.exec(j.split("rel:")[1])[0],","===g[g.length-1]&&(g=g.slice(0,g.length-1)))}null!=g&&""!=g?("string"===typeof g&&"<"!==g[0]&&">"!==g[g.length-1]&&"["!==g[0]&&"]"!==g[g.length-1]&&(g=c[g]),null==jQuery(i).attr("aboutId")?(sko.log("*** CREATING RELATED NODE"),sko.rel(g,i,c,function(b){jQuery(i).attr("aboutId",b);a(e,d)})):(sko.log("*** NODE IS ALREADY TRACED"),a(e,d))):a(e,d)};Utils.repeat(0,b.length,e,function(){d()})};sko.generatorId=0;sko.generatorsMap={};
sko.where=function(a){var a="select ?subject where "+a,c=""+sko.generatorId;sko.generatorId++;sko.generatorsMap[c]=ko.observable([]);sko.log("*** WHERE QUERY: "+a);sko.store.startObservingQuery(a,function(a){var b=[];sko.log(" ** RESULTS!!!");for(var e=0;e<a.length;e++)sko.log(" ** ADDING VALUE "+a[e].subject.value),b.push("<"+a[e].subject.value+">");sko.log("** SETTING VALUE");sko.log(b);sko.generatorsMap[c](b)});return sko.generatorsMap[c]};
sko.applyBindings=function(a,c,d){"string"===typeof a&&(a=jQuery(a)[0]);sko.traceResources(a,c,function(){sko.traceRelations(a,c,function(){ko.applyBindings(c,a);null!=d&&d()})})};sko.resource=function(a){a=jQuery(a).toArray();if(1===a.length)return sko.currentResource(a[0]);for(var c=[],d=0;d<a.length;d++)c.push(sko.currentResource(a[d]));return c};sko.owl={};
})(window);
(function(){RDFaParser={},RDFaParser.parseResource=function(a,b,c,d){var e=jQuery.uri.base().toString();e.indexOf("#")!=-1&&(e=e.split("#")[0]);if(a.type==="uri"){if(a.value._string.indexOf(e)!=-1){var f=a.value._string.split(e)[1],g=d.toString();return f!=""&&(g=g.split("#")[0]),{uri:g+f}}return{uri:a.value._string}}if(a.type==="bnode"){var h=a.toString();return h.indexOf("_:")===0?{blank:a.value+b}:{blank:"_:"+h}}if(a.type==="literal")return{literal:a.toString()}},RDFaParser.parseQuad=function(a,b,c,d){var e={};return e.subject=RDFaParser.parseResource(b.subject,c,a,d),e.predicate=RDFaParser.parseResource(b.property,c,a,d),e.object=RDFaParser.parseResource(b.object,c,a,d),e.graph=a,e},RDFaParser.parse=function(a,b){var c=/\s*xmlns:(\w*)="([^"]+)"\s*/i,d={};d.og=jQuery.uri("http://ogp.me/ns#"),d.fb=jQuery.uri("http://www.facebook.com/2008/fbml");var e=/\s*xmlns="([^"]+)"\s*/i,f=e.exec(a);f!=null&&(window.rdfaDefaultNS=jQuery.uri(f[1]));var g=a,h=c.exec(g),i=null;while(h!=null)d[h[1]]=jQuery.uri(h[2]),g=g.slice(h.index+h[0].length,g.length),h=c.exec(g);window.globalNs=d;var j=jQuery(a).rdfa().databank.triples(),k=[],l=""+(new Date).getTime();for(var m=0;m<j.length;m++)k.push(RDFaParser.parseQuad(b,j[m],l,window.rdfaCurrentSubject));return k},RDFParser={},RDFParser.parse=function(a,b){var c=jQuery().rdf().databank.load(a).triples(),d=[],e=""+(new Date).getTime();for(var f=0;f<c.length;f++)d.push(RDFaParser.parseQuad(b,c[f],e,window.rdfaCurrentSubject));return d},NetworkTransport={},NetworkTransport.proxyUri=null,NetworkTransport.load=function(a,b,c,d){var e=jQuery;a=NetworkTransport.proxyUri+"?uri="+escape(a),e.ajax({url:a,beforeSend:function(a){a.setRequestHeader("Accept",b)},success:function(a,b,d){if((""+d.status)[0]=="2"){var e=d.getAllResponseHeaders().split("\n"),f={};for(var g=0;g<e.length;g++){var h=e[g].split(":");f[h[0]]=h[1]}c(!0,{headers:f,data:a})}},error:function(a,d,e){if((""+a.status)[0]=="3")if(redirection==0)c(!1,500);else{var f=a.getAllResponseHeaders().Location||a.getAllResponseHeaders().location;f!=null?NetworkTransport.load(f,b,c,redirection-1):c(!1,500)}else c(!1,a.statusCode())}})},jQuery.fn.center=function(){this.css("position","fixed");var a=jQuery("#rdfstore-frontend").position(),b=jQuery("#rdfstore-frontend").height(),c=jQuery("#rdfstore-frontend").width();return this.css("top",(b-a.top)/2+$(window).scrollTop()-this.height()/2+"px"),this.css("left",(c-a.left)/2+$(window).scrollLeft()-this.width()/2+"px"),this},RDFStoreFrontend=function(a,b){var c="<div id='rdfstore-frontend'>";c+="<div id='rdfstore-frontend-overlay'></div>",c+="<div id='rdfstore-window-buttons'><span data-bind='click:closeWindow, event:{mouseover: mouseOverCloseWindow, mouseout: mouseOverCloseWindow}' class='rdfstore-window-button' id='rdfstore-close-window'>x</span></div>",c+="<div id='rdfstore-frontend-menu'></div>",c+="<div id='rdfstore-frontend-query-area'></div>",c+="<div id='rdfstore-frontend-graphs-area'><div id='rdfstore-graphs-label'>GRAPHS</div></div>",c+="<div id='rdfstore-frontend-results-area'></div>",c+="<div id='rdfstore-frontend-footer'>",c+="<div class='rdfstore-footer-info' id='rdfstore-frontend-footer-current-graph' data-bind='text:selectedGraph'></div>",c+="<div class='rdfstore-footer-info' id='rdfstore-frontend-footer-next-page' data-bind='event:{ mousedown:toggleNextPage, mouseup:toggleNextPage, mouseout:maybeToggleNextPage }, click:nextResultPage'><span id='rdfstore-frontend-next-image-placeholder'>&nbsp;</span></div>",c+='<div class=\'rdfstore-footer-info\' id=\'rdfstore-frontend-footer-display-pages\' data-bind=\'text:"page "+currentResultPage()+"/"+totalResultPages()+", ("+allBindings().length+" results)"\'></div>',c+="<div class='rdfstore-footer-info' id='rdfstore-frontend-footer-prev-page' data-bind='event:{ mousedown:togglePrevPage, mouseup:togglePrevPage, mouseout:maybeTogglePrevPage }, click:prevResultPage'><span id='rdfstore-frontend-prev-image-placeholder'>&nbsp;</span></div>",c+="</div>",c+="</div>",jQuery(a).append(c),this.buildTemplates(a),this.buildQueryArea(),this.buildMenu(),this.buildGraphs(),this.buildResultsArea(),this.viewModel.application=this,this.viewModel.rootNode=a,this.viewModel.store=b,this.viewModel.bindingsVariables=ko.dependentObservable(function(){var a=new Array;if(this.bindings().length===0||this.bindings()==null)return[];var b=this.bindings()[0];for(var c in b)a.push(c);return a},this.viewModel),this.viewModel.bindingsArray=ko.dependentObservable(function(){var a=new Array;for(var b=0;b<this.bindings().length;b++){var c=this.bindings()[b],d=new Array;for(var e=0;e<this.bindingsVariables().length;e++)d.push(c[this.bindingsVariables()[e]]);a.push(d)}return a},this.viewModel),ko.applyBindings(this.viewModel,jQuery(a).get(0))},RDFStoreFrontend.prototype.buildTemplates=function(a){var b="<script id='sparql-graphs-template' type='text/html'>";b+="<ul id='rdf-store-graphs-list'>{{each graphs}} {{if selectedGraph()==$value}}",b+="<li class='rdf-store-graph-item rdf-store-selected-graph-item'><a href='#' data-bind='event: {click:selectGraph}'>${$value}</a></li>",b+="{{else}}<li class='rdf-store-graph-item'><a href='#' data-bind='event: {click:selectGraph}'>${$value}</a></li>{{/if}}{{/each}}</ul></script>",jQuery(a).append(b),b="<script id='sparql-results-template' type='text/html'><table id='sparql-results-table-headers'><thead><tr>{{each bindingsVariables}}",b+="<th scope='col'>${$value}</th>{{/each}}</tr></thead></table><div id='sparql-results-table-rows'><table><tbody>{{each bindingsArray}}",b+="<tr class='{{if $index%2==0}}sparql-result-even-row{{else}}sparql-result-odd-row{{/if}}'>{{each $value }}{{if $value.token==='uri'}}",b+="<td data-bind='click: newShowBinding, event: {mouseover: tdMouseOver}'><span class='rdfstore-data-value'>${$value.value}</span>",b+="<span class='rdfstore-data-token' style='display:none'>uri</span></td>{{else}}{{if $value.token==='literal'}}",b+="<td data-bind='click: newShowBinding, event: {mouseover: tdMouseOver}'><span class='rdfstore-data-value'>${$value.value}</span>",b+="<span class='rdfstore-data-token' style='display:none'>literal</span><span class='rdfstore-data-lang'  style='display:none'>${$value.lang}</span>",b+="<span class='rdfstore-data-type'  style='display:none'>${$value.type}</span></td>{{else}}<td data-bind='click: newShowBinding, event: {mouseover: tdMouseOver}'>",b+="<span class='rdfstore-data-value'>${$value.value}</span><span class='rdfstore-data-token' style='display:none'>blank</span></td>",b+="{{/if}}{{/if}}{{/each}}</tr>{{/each}}</tbody></table></div></script>",jQuery(a).append(b),b="<script id='sparql-template-row' type='text/html'><td>${$item.data}</td></script>",jQuery(a).append(b)},RDFStoreFrontend.prototype.buildGraphs=function(){var a="<div id='rdfstore-frontend-graph-area-graphs' data-bind='template:{name:\"sparql-graphs-template\"}'></div>";jQuery("#rdfstore-frontend-graphs-area").append(a)},RDFStoreFrontend.prototype.buildMenu=function(){var a="<div id='rdf-store-menu'>";a+="<div id='rdf-store-menu-load' class='rdf-store-menu-action'><a href='#' data-bind='click:newLoadGraphDialog'>load</a></div>",a+="<div id='rdf-store-menu-select-graph' class='rdf-store-menu-action'><a href='#' data-bind='click:displayGraph'>graphs</a></div>",a+="<div id='rdf-store-menu-hist-prev' class='rdf-store-menu-action'><a href='#' data-bind='click:displayPrevHistory'>prev</a></div>",a+="<div id='rdf-store-menu-hist-next' class='rdf-store-menu-action'><a href='#' data-bind='click:displayNextHistory'>next</a></div>",a+="<div id='rdf-store-menu-run' class='rdf-store-menu-action'><a href='#' data-bind='click:submitQuery'>run</a></div>",a+="<div id='rdf-store-menu-edit' class='rdf-store-menu-action'><a href='#' class='rdfstore-editing' data-bind='click:editQuery'>edit</a></div>",jQuery("#rdfstore-frontend-menu").append(a)},RDFStoreFrontend.prototype.buildQueryArea=function(){var a="<textarea id='sparql-query-text' data-bind='text:query, event: { keyup: queryModified }'></textarea>";jQuery("#rdfstore-frontend-query-area").append(a),jQuery("#sparql-query-text").focus(function(){jQuery(this).css("background-color","#e5fff3")}),jQuery("#sparql-query-text").blur(function(){jQuery(this).css("background-color","#ffffff")})},RDFStoreFrontend.prototype.buildResultsArea=function(){var a="<div id='rdfstore-frontend-query-results' data-bind='template:{name:\"sparql-results-template\"}'></div>";jQuery("#rdfstore-frontend-results-area").append(a)},RDFStoreFrontend.prototype.showUriDialogModel={create:function(a,b){this.value=b,this.viewModel=a,this.id="rdf-store-menu-show-uri-dialog"+(new Date).getTime();var c="<div id='"+this.id+"' class='rdf-store-dialog'>";c=c+"<div class='rdfstore-dialog-title'><p>"+b+"</p></div>",c=c+"<div class='rdfstore-dialog-row'><span>URI:</span><input id='rdf-store-show-uri-value' type='text' value='"+b+"'></input></div>",c+="<div id='rdfstore-show-uri-row-options' class='rdfstore-options-row'>",c+="<div class='rdfstore-options-row-item' id='rdf-store-dialog-browse-uri' data-bind='click: browseUri'>browse</div>",c+="<div class='rdfstore-options-row-item' id='rdf-store-dialog-browse-store' data-bind='click: storeUri'>load</div>",c+="</div>",c+="<div class='rdfstore-dialog-actions'>",c+="<input class=\"btn\" type='submit' value='cancel' style='float:none; min-width:100px' data-bind='click:closeDialog'></input>",c+="</div>",c+="</div>",jQuery(a.rootNode).append(c),jQuery("#"+this.id).css("min-height","280px").css("height","280px").center(),ko.applyBindings(this,jQuery("#"+this.id).get(0)),jQuery("#"+this.id).draggable({handle:"div.rdfstore-dialog-title"})},closeDialog:function(){jQuery("#rdfstore-frontend-overlay").hide(),jQuery("#"+this.id).remove()},browseUri:function(){window.open(this.value,"Browse: "+this.value)},storeUri:function(){this.closeDialog(),this.application.loadGraphDialogModel.create(this.viewModel,this.value),this.application.loadGraphDialogModel.application=this.application,this.application.loadGraphDialogModel.store=this.store}},RDFStoreFrontend.prototype.showLiteralDialogModel={create:function(a,b,c,d){this.value=b,this.viewModel=a,this.id="rdf-store-menu-show-literal-dialog"+(new Date).getTime();var e="<div id='"+this.id+"' class='rdf-store-dialog'>";e+="<div class='rdfstore-dialog-title'><p>Show Literal</p></div>",e=e+"<div class='rdfstore-dialog-row'><span>Type:</span><input id='rdf-store-show-literal-type' type='text' value='"+d+"'></input></div>",e=e+"<div class='rdfstore-dialog-row'><span>Language:</span><input id='rdf-store-show-literal-language' type='text' value='"+c+"'></input></div>",e=e+"<div class='rdfstore-dialog-row'><span>Value:</span><textarea id='rdf-store-show-literal-value' type='text'>"+b+"</textarea></div>",e+="<div class='rdfstore-dialog-actions' id='rdfstore-dialog-actions-show-literal'>",e+="<input class='btn' type='submit' value='cancel' style='float:none; min-width:100px' data-bind='click:closeDialog'></input>",e+="</div>",e+="</div>",jQuery(a.rootNode).append(e),jQuery("#"+this.id).css("min-height","380px").css("height","380px").center(),ko.applyBindings(this,jQuery("#"+this.id).get(0)),jQuery("#"+this.id).draggable({handle:"div.rdfstore-dialog-title"})},closeDialog:function(){jQuery("#rdfstore-frontend-overlay").hide(),jQuery("#"+this.id).remove()},browseUri:function(){window.open(this.value,"Browse: "+this.value)},storeUri:function(){this.closeDialog(),this.application.loadGraphDialogModel.create(this.viewModel,this.value),this.application.loadGraphDialogModel.application=this.application,this.application.loadGraphDialogModel.store=this.store}},RDFStoreFrontend.prototype.loadGraphDialogModel={create:function(a,b){jQuery("#rdfstore-frontend-overlay").show(),this.viewModel=a;var c="<div id='rdf-store-menu-load-dialog' class='rdf-store-dialog'>";c+="<div class='rdfstore-dialog-title'>Load remote graph</div>",b?c=c+"<div class='rdfstore-dialog-row'><span>Graph to load URI:</span><input id='rdf-store-graph-to-load' type='text' value='"+b+"'></input></div>":c+="<div class='rdfstore-dialog-row'><span>Graph to load URI:</span><input id='rdf-store-graph-to-load' type='text'></input></div>",c+="<div class='rdfstore-dialog-row'><span>Store graph URI:</span><input id='rdf-store-graph-to-store' type='text'></input></div>",c+="<div class='rdfstore-dialog-actions'>",c+="<input class='btn' type='submit' id='rdfstore-dialog-load-submit-btn' value='load' style='float:none; min-width:100px' data-bind='click:loadRemoteResource'></input>",c+="<input class='btn' type='submit' value='cancel' style='float:none; min-width:100px' data-bind='click:closeDialog'></input>",c+="</div>",c+="</div>",jQuery(a.rootNode).append(c),jQuery("#rdf-store-menu-load-dialog").css("min-height","180px").css("height","180px").center(),ko.applyBindings(this,jQuery("#rdf-store-menu-load-dialog").get(0)),jQuery("#rdf-store-menu-load-dialog").draggable({handle:"div.rdfstore-dialog-title"})},closeDialog:function(){jQuery("#rdfstore-frontend-overlay").hide(),jQuery("#rdf-store-menu-load-dialog").remove(),jQuery("#rdfstore-dialog-load-submit-btn").attr("disabled",!1)},loadRemoteResource:function(){var a=jQuery("#rdf-store-graph-to-load").val(),b=jQuery("#rdf-store-graph-to-store").val();if(b===""||b==null)b=this.store.engine.lexicon.defaultGraphUri;var c=this;window.rdfaDefaultNS=jQuery.uri(a),window.rdfaCurrentSubject=jQuery.uri(a),jQuery("#rdfstore-dialog-load-submit-btn").attr("disabled",!0),this.store.load("remote",a,b,function(a,b){jQuery("#rdfstore-dialog-load-submit-btn").attr("disabled",!1),a?c.store.registeredGraphs(function(a,d){var e=["default"];for(var f=0;f<d.length;f++)e.push(d[f].valueOf());c.viewModel.graphs(e),c.closeDialog(),alert("Graph successfully loaded: "+b+" added.")}):alert("Error loading graph: "+b)})}},RDFStoreFrontend.prototype.viewModel={rootNode:null,graphs:ko.observable(["default"]),selectedGraph:ko.observable("default"),selectGraph:function(a){var b=a.currentTarget.text;this.displayGraph(),this.selectedGraph(b)},modified:!0,lastQuery:null,queryModified:function(a){if(this.modified===!1&&this.lastQuery!=null){var b=this.prevHistory(),c=this.nextHistory();b.push(this.lastQuery),b=b.concat(c),this.prevHistory(b),this.nextHistory([]),this.modified=!0,this.lastQuery=null}},query:ko.observable("SELECT * WHERE { ?s ?p ?o }"),prevHistory:ko.observable([]),nextHistory:ko.observable([]),bindingsPerPage:ko.observable(50),allBindings:ko.observable([]),bindings:ko.observable([]),totalResultPages:ko.observable(0),currentResultPage:ko.observable(0),prevResultPage:function(){var a=jQuery("#rdfstore-frontend-query-results").height(),b=jQuery("#sparql-results-table-rows").height(),c=this.currentResultPage();if(c>1){c-=1;var d=(c-1)*this.bindingsPerPage();this.currentResultPage(c),this.bindings(this.allBindings().slice(d,d+this.bindingsPerPage())),jQuery("#rdfstore-frontend-results-area").height(a),jQuery("#rdfstore-frontend-query-results").height(a),jQuery("#sparql-results-table-rows").height(b),jQuery("#sparql-results-table-headers").width(jQuery("#sparql-results-table-rows").width()-5),jQuery("#sparql-results-table-rows").width(jQuery("#sparql-results-table-rows").width()-5),jQuery("#sparql-results-table-rows").css("margin-left","5px"),jQuery("#sparql-results-table-headers th").css("width",jQuery("#sparql-results-table-rows td").css("width"))}},toggleNextPage:function(){jQuery("#rdfstore-frontend-next-image-placeholder").attr("class")==="rdfstore-next-image-mousedown"?jQuery("#rdfstore-frontend-next-image-placeholder").attr("class",""):jQuery("#rdfstore-frontend-next-image-placeholder").attr("class","rdfstore-next-image-mousedown")},maybeToggleNextPage:function(){jQuery("#rdfstore-frontend-next-image-placeholder").attr("class")==="rdfstore-next-image-mousedown"&&jQuery("#rdfstore-frontend-next-image-placeholder").attr("class","")},togglePrevPage:function(){jQuery("#rdfstore-frontend-prev-image-placeholder").attr("class")==="rdfstore-prev-image-mousedown"?jQuery("#rdfstore-frontend-prev-image-placeholder").attr("class",""):jQuery("#rdfstore-frontend-prev-image-placeholder").attr("class","rdfstore-prev-image-mousedown")},maybeTogglePrevPage:function(){jQuery("#rdfstore-frontend-prev-image-placeholder").attr("class")==="rdfstore-prev-image-mousedown"&&jQuery("#rdfstore-frontend-prev-image-placeholder").attr("class","")},nextResultPage:function(){var a=jQuery("#rdfstore-frontend-query-results").height(),b=jQuery("#sparql-results-table-rows").height(),c=this.currentResultPage(),d=Math.ceil(this.allBindings().length/this.bindingsPerPage());if(c<d){var e=c*this.bindingsPerPage();c+=1,this.currentResultPage(c),this.bindings(this.allBindings().slice(e,e+this.bindingsPerPage())),jQuery("#rdfstore-frontend-query-results").height(a),jQuery("#rdfstore-frontend-results-area").height(a),jQuery("#sparql-results-table-rows").height(b),jQuery("#sparql-results-table-headers").width(jQuery("#sparql-results-table-rows").width()-5),jQuery("#sparql-results-table-rows").width(jQuery("#sparql-results-table-rows").width()-5),jQuery("#sparql-results-table-rows").css("margin-left","5px"),jQuery("#sparql-results-table-headers th").css("width",jQuery("#sparql-results-table-rows td").css("width"))}},displayPrevHistory:function(){var a=this.prevHistory(),b=this.nextHistory();if(a.length>0){var c=a.pop();this.lastQuery!=null&&b.unshift(this.lastQuery),jQuery("#sparql-query-text").val(c),this.prevHistory(a),this.nextHistory(b),this.lastQuery=c,this.modified=!1}},displayNextHistory:function(){var a=this.nextHistory(),b=this.prevHistory();if(a.length>0){var c=a.shift();this.lastQuery!=null&&b.push(this.lastQuery),jQuery("#sparql-query-text").val(c),this.lastQuery=c,this.modified=!1,this.prevHistory(b),this.nextHistory(a)}},displayGraph:function(){jQuery("#rdfstore-frontend-graphs-area").css("width")=="50%"?(jQuery("#rdfstore-frontend-graphs-area").css("width","0%"),setTimeout(function(){jQuery("#rdfstore-graphs-label").toggle(),jQuery("#rdfstore-frontend-graph-area-graphs").css("display")==="block"?jQuery("#rdfstore-frontend-graph-area-graphs").css("display","none"):jQuery("#rdfstore-frontend-graph-area-graphs").css("display","block")},100)):(jQuery("#rdfstore-frontend-graphs-area").css("width","50%"),setTimeout(function(){jQuery("#rdfstore-graphs-label").toggle(),jQuery("#rdfstore-frontend-graph-area-graphs").css("display")==="block"?jQuery("#rdfstore-frontend-graph-area-graphs").css("display","none"):jQuery("#rdfstore-frontend-graph-area-graphs").css("display","block")},300))},editQuery:function(){if(jQuery("#rdf-store-menu-edit a").attr("class")==="rdfstore-not-editing"){jQuery("#rdfstore-frontend-query-area").show();var a=jQuery("#rdfstore-frontend-results-area").height();jQuery("#rdfstore-frontend-results-area").height(a-120),a=jQuery("#rdfstore-frontend-graphs-area").height(),jQuery("#rdfstore-frontend-graphs-area").height(a-120),a=jQuery("#sparql-results-table-rows").height(),jQuery("#sparql-results-table-rows").height(a-120),a=jQuery("#rdfstore-frontend-query-results").height(),jQuery("#rdfstore-frontend-query-results").height(a-120),jQuery("#rdf-store-menu-edit a").attr("class","rdfstore-editing")}else{jQuery("#rdfstore-frontend-query-area").hide();var a=jQuery("#rdfstore-frontend-results-area").height();jQuery("#rdfstore-frontend-results-area").height(a+120),a=jQuery("#rdfstore-frontend-graphs-area").height(),jQuery("#rdfstore-frontend-graphs-area").height(a+120),a=jQuery("#sparql-results-table-rows").height(),jQuery("#sparql-results-table-rows").height(a+120),a=jQuery("#rdfstore-frontend-query-results").height(),jQuery("#rdfstore-frontend-query-results").height(a+120),jQuery("#rdf-store-menu-edit a").attr("class","rdfstore-not-editing")}},submitQuery:function(){var a=jQuery("#sparql-query-text").val(),b=this,c=function(c,d){c?(b.lastQuery==null&&(b.lastQuery=a,b.modified=!1),b.store.registeredGraphs(function(a,c){var d=["default"];for(var e=0;e<c.length;e++)d.push(c[e].valueOf());b.graphs(d)}),b.allBindings(d||[]),b.bindings(d.slice(0,b.bindingsPerPage())),b.totalResultPages(Math.ceil(d.length/b.bindingsPerPage())),b.currentResultPage(1),jQuery("#sparql-results-table-headers").width(jQuery("#sparql-results-table-rows").width()-5),jQuery("#sparql-results-table-rows").width(jQuery("#sparql-results-table-rows").width()-5),jQuery("#sparql-results-table-rows").css("margin-left","5px"),jQuery("#sparql-results-table-headers th").css("width",jQuery("#sparql-results-table-rows td").css("width"))):alert("Error executing query: "+d)};this.selectedGraph()==="default"?this.store.execute(a,c):this.store.execute(a,[{token:"uri",value:this.selectedGraph()}],[],c)},tdMouseOver:function(a){jQuery("td.rdfstore-td-over").attr("class",""),jQuery(a.currentTarget).attr("class","rdfstore-td-over")},mouseOverMinWindow:function(a){var b=jQuery("#rdf-store-min-window").attr("class");b.indexOf("rdfstore-window-button-over")==-1?jQuery("#rdf-store-min-window").attr("class","rdfstore-window-button rdfstore-window-button-over"):jQuery("#rdf-store-min-window").attr("class","rdfstore-window-button")},mouseOverCloseWindow:function(a){var b=jQuery("#rdfstore-close-window").attr("class");b.indexOf("rdfstore-window-button-over")==-1?jQuery("#rdfstore-close-window").attr("class","rdfstore-window-button rdfstore-window-button-over"):jQuery("#rdfstore-close-window").attr("class","rdfstore-window-button")},closeWindow:function(){jQuery("#rdfstore-frontend").remove()},newShowBinding:function(a){jQuery("#rdfstore-frontend-overlay").show();var b=jQuery(a.currentTarget).find("span.rdfstore-data-token").text(),c=jQuery(a.currentTarget).find("span.rdfstore-data-value").text();if(b==="uri")this.application.showUriDialogModel.create(this,c),this.application.showUriDialogModel.application=this.application,this.application.showUriDialogModel.store=this.store;else if(b==="literal"){var d=jQuery(a.currentTarget).find("span.rdfstore-data-lang").text(),e=jQuery(a.currentTarget).find("span.rdfstore-data-type").text();this.application.showLiteralDialogModel.create(this,c,d,e),this.application.showLiteralDialogModel.application=this.application,this.application.showLiteralDialogModel.store=this.store}else b!=="blank"},newLoadGraphDialog:function(){this.application.loadGraphDialogModel.create(this),this.application.loadGraphDialogModel.application=this.application,this.application.loadGraphDialogModel.store=this.store}},RDFStoreFrontend.rdfaParser=RDFaParser,RDFStoreFrontend.rdfParser=RDFParser,RDFStoreFrontend.ProxyNetworkTransport=NetworkTransport,window.rdfstore_frontend=RDFStoreFrontend})();// Detects if we are in the browser or in node
typeof module=="undefined"?window.module={__export:function(a){window.jsonld_macros=a}}:typeof module!="undefined"&&module.exports==null?window.module={__export:function(a){window.jsonld_macros=a}}:module.__export=function(a){module.exports=a},module.__export(function(){var JSONLDMacro={};return JSONLDMacro.VERSION="0.0.2",JSONLDMacro.behaviour="loose",JSONLDMacro.registeredFunctions={},JSONLDMacro.registeredFunctionsNS={},JSONLDMacro.evalApplyFn=function(fnText,argument,input,context){var f;return eval("f = "+fnText),f(argument,input,context)},JSONLDMacro.resolve=function(a,b){a=a.split("?")[0];var c,d;for(var e=0;e<this.apiPaths.length;e++){c=this.apiPaths[e][0],d=this.apiPaths[e][1];if(c.test(a))return this.applyTransformation(d,b)}return null},JSONLDMacro.transform=function(a,b){var c=this.buildTransformation(a);return this.applyTransformation(c,b)},JSONLDMacro.reservedPrefix="__transformation__",JSONLDMacro.applyTransformation=function(a,b){var c=0,d=JSONLDMacro.reservedPrefix+(new Date).getTime()+"__",e={},f={},g,h,i,j,k,l,m,n,o,p;for(var q=0;q<a.length;q++){h=a[q][0],l=a[q][1],j=h(b);for(var r=0;r<j.length;r++)k=j[r][d],k==null&&(j[r][d]=c,e[c]=j[r],f[c]=[],k=c,c++),f[k].push(l)}for(var s in e){g=e[s],m=f[s];for(q=0;q<m.length;q++){a=m[q],n=a["@remove"],p=a["@only"],o=a["@ns"];for(var t in a)t!=="@remove"&&t!=="@only"&&t!=="@ns"&&(i=a[t],i(g));n!=null&&n(g),p!=null&&p(g),o!=null&&o(g)}delete g[d];if(JSONLDMacro.behaviour==="loose")for(var u in g)g[u]==null&&delete g[u]}return b},JSONLDMacro.pathParser=function(a){var b=a.split(".");a[a.length-1]==="."&&b.pop();if(b[0]!=="$"&&b[0]!=="$[*]")throw"Error parsing path. Path must start with the root object '$'";return b[0]="$",function(a,c){var d,e,f,g=a.constructor===Array?a:[a],h=0;while(h<b.length){var i=b[h];switch(i){case"$":if(h!==0)throw"Wrong path. Root object in the middle of the path expression";d=g;break;case"*":d=[];for(var j=0;j<g.length;j++)for(var k in g[j])d.push(g[j][k]);break;case"":d=[];for(var j=0;j<g.length;j++)d=d.concat(JSONLDMacro._childrenRecursive(g[j]));break;default:d=[],i.indexOf("[*]")===i.length-3?(i=i.split("[*]")[0],f=!0):f=!1;for(var j=0;j<g.length;j++){e=g[j][i];if(e!==undefined){f&&e.constructor===Array?d=d.concat(e):d.push(e);if(h===b.length-1&&c!=null)if(f&&e.constructor===Array)for(var l=0;l<e.length;l++)c(vaj[l],g[j]);else c(e,g[j])}}if(h===b.length-1&&c!=null)return d}h++,g=d}if(c!=null)for(var j=0;j<g.length;j++)c(g[j],null);return g}},JSONLDMacro._childrenRecursive=function(a){var b=[],c=[a],d;while(c.length!=0){d=c.pop(),b.push(d);for(var e in d)typeof d[e]=="object"&&d[e].constructor===Object?c.push(d[e]):typeof d[e]=="object"&&d[e].constructor===Array&&(c=c.concat(d[e]))}return b},JSONLDMacro.buildTransformation=function(a){var b,c,d,e,f,g;c=[];for(var h in a){f=this.pathParser(h),d=a[h],e={};for(var i in d)g=this.buildTransformationFunction(i,d[i]),e[i]=g;c.push([f,e])}return c},JSONLDMacro.buildTransformationFunction=function(a,b){switch(a){case"@context":return this._buildContextTransformation(b);case"@id":return this._buildIDGenTransformation(b);case"@type":return this._buildTypeGenTransformation(b);case"@remove":return this._buildRemoveTransformation(b);case"@only":return this._buildOnlyTransformation(b);case"@ns":return this._buildGenNsTransformation(b);case"@transform":return this._buildTransformTransformation(b);default:throw"Unknown transformation: "+a}},JSONLDMacro._buildTransformTransformation=function(a){var b;for(var c in a){b=a[c];if(typeof b=="string")a[c]=function(a,b){return function(c){return c[a]=b,c}}(c,b);else{var d=b;typeof d=="object"&&d.constructor===Object&&(d=[d]),a[c]=function(a,b){return function(c){var d;try{for(var e=0;e<b.length;e++)if(d!=null&&d.constructor===Array)for(var f=0;f<d.length;f++)d[f]=JSONLDMacro.applyOperation(b[e],d[f],c);else d=JSONLDMacro.applyOperation(b[e],d,c)}catch(g){if(JSONLDMacro.behaviour!=="loose")throw g;typeof console!=undefined&&console.log("Error applying function at property "+a+" -> "+g),d=null}return c[a]=d,c}}(c,d)}}return function(b){var c=b;for(var d in a)c=a[d](c);return c}},JSONLDMacro._buildGenNsTransformation=function(a){var b=a["ns:default"]||"",c=a["ns:omit"]||[];delete a["ns:omit"];var d={};for(var e=0;e<c.length;e++)d[c[e]]=!0;var f=a["ns:append"];delete a["ns:append"];var g={},h;for(var i in f){h=f[i],typeof h=="string"&&(h=[h]);for(var e=0;e<h.length;e++)g[h[e]]=i}var j=a["ns:replace"];delete a["ns:replace"];var k={},l;for(var m in j)l=j[m],k[m]=l;return function(a){var c;for(var e in a){if(d[e]===!0)continue;if(e.indexOf(JSONLDMacro.reservedPrefix)===0)continue;if(e.indexOf("@")===0)continue;g[e]!=null?(c=g[e]+":"+e,a[c]==null?a[c]=a[e]:a[c].constructor===Array?a[c].push(ojb[e]):(a[c]=[a[ewp]],a[c].push(ojb[e])),delete a[e]):k[e]!=null?(c=k[e],a[c]==null?a[c]=a[e]:a[c].constructor===Array?a[c].push(a[e]):(a[c]=[a[c]],a[c].push(a[e])),delete a[e]):(c=b+":"+e,c!=e&&(a[c]==null?a[c]=a[e]:a[c].constructor===Array?a[c].push(a[e]):(a[c]=[a[c]],a[c].push(a[e])),delete a[e]))}return a}},JSONLDMacro._buildRemoveTransformation=function(a){return typeof a=="string"&&(a=[a]),function(b){for(var c=0;c<a.length;c++)delete b[a[c]];return b}},JSONLDMacro._buildOnlyTransformation=function(a){var b={};if(typeof a=="string")b[a]=!0;else for(var c=0;c<a.length;c++)b[a[c]]=!0;return function(a){var c=[];for(var d in a)d[0]!=="@"&&b[d]==null&&delete a[d];return a}},JSONLDMacro._buildTypeGenTransformation=function(a){if(typeof a=="string")return function(b){return b["@type"]=a,b};var b=a;typeof b=="object"&&b.constructor===Object&&(b=[b]);var c=!1;for(var d=0;d<b.length;d++)if(typeof b[d]=="object"){c=!0;break}return c===!0?function(a){var c;for(var d=0;d<b.length;d++)c=JSONLDMacro.applyOperation(b[d],c,a);return a["@type"]=c,a}:function(a){return a["@type"]=b,a}},JSONLDMacro._buildIDGenTransformation=function(a){if(typeof a=="string")return function(b){return b["@id"]=a,b};var b=a;return typeof b=="object"&&b.constructor===Object&&(b=[b]),function(a){try{var c;for(var d=0;d<b.length;d++)c=JSONLDMacro.applyOperation(b[d],c,a);a["@id"]=c}catch(e){if(JSONLDMacro.behaviour==="strict")throw e;typeof console!="undefined"&&console.log("Error applyting transformation for @id rule: "+e)}return a}},JSONLDMacro._buildContextTransformation=function(a){return function(b){var c,d=JSON.parse(JSON.stringify(a)),e=b["@context"]||{};if(typeof e=="string")if(typeof d=="string")b["@context"]=[e,d];else if(typeof d=="object"&&d.constructor===Array){c=!1;for(var f=0;f<d.length;f++)if(d[f]===e){c=!0;break}c||(d.push(e),b["@context"]=d)}else b["@context"]=[d,e];else if(typeof e=="object"&&e.constructor===Array)if(typeof d=="string")b["@context"]=[d,e];else if(typeof d=="object"&&d.constructor===Array){var g=null,h=null,i=[];for(var f=0;f<d.length;f++)typeof d[f]=="object"?g=d[f]:i.push(d[f]);for(var f=0;f<e.length;f++)typeof e[f]=="object"?g=e[f]:i.push(e[f]);if(g==null&&h!=null)i.push(h);else if(g!=null&&h==null)i.push(g);else if(g!=null&&h!=null){for(var j in g)h[j]=g[j];i.push(h)}b["@context"]=i}else{var k=[],l=null;for(var f=0;f<e.length;f++)if(typeof e[f]=="string")k.push(e[f]);else{l=e[f];for(var j in d)l[j]=d[j];k.push(l)}l==null&&k.push(d),b["@context"]=k}else if(typeof d=="string")b["@context"]=[d,e];else if(typeof d=="object"&&d.constructor===Array){var k=[],l=null;for(var f=0;f<d.length;f++)if(typeof d[f]=="string")k.push(d[f]);else{l=e;for(var j in d[f])l[j]=d[f][j];k.push(l)}l==null&&k.push(e),b["@context"]=k}else{var l=e;for(var j in d)l[j]=d[j];b["@context"]=l}return b}},JSONLDMacro.applyOperation=function(a,b,c){if(a["f:valueof"]!=null)return c[a["f:valueof"]];if(a["f:defaultvalue"]!=null)return a["f:defaultvalue"];if(a["f:select"]!=null)return b[a["f:select"]];if(a["f:prefix"]!=null)return a["f:prefix"]+b;if(a["f:urlencode"]!=null)return escape(b);if(a["f:apply"]!=null){var d=a["f:apply"];return(new Function("with(this) { return "+a["f:apply"]+"}")).call(b)}var e=null;for(var f in a)e=f;if(e==null)throw"Uknown operation to apply: "+JSON.stringify(a);if(e.indexOf(":")==-1)throw"Uknown operation to apply: "+JSON.stringify(a);try{var g=e.split(":"),h=JSONLDMacro.registeredFunctionsNS[g[0]],i=h+g[1],j=JSONLDMacro.registeredFunctions[i];return JSONLDMacro.evalApplyFn(j,a[f],b,c)}catch(k){throw"Error applying function "+e}},JSONLDMacro.registerFunctions=function(a){var b={};for(var c in a)if(b[c]==null&&c.indexOf(":")!=null){var d=c.split(":"),e=d[0],f=d[1],g=a[e];if(g==null)throw"Namespace "+e+" for function "+c+" not found";b[e]=g;var h=g+f;JSONLDMacro.registeredFunctionsNS[e]=g,JSONLDMacro.registeredFunctions[h]=a[c]}},JSONLDMacro.parseUrlPath=function(a){var b="[^/#]+";a=a.replace(/\*/g,b);var c=new RegExp("^"+a+"$");return c},JSONLDMacro.apiPaths=[],JSONLDMacro.registerAPI=function(a){a["@declare"]!=null&&(this.registerFunctions(a["@declare"]),delete a["@declare"]);var b,c;for(var d in a){c=this.buildTransformation(a[d]);if(d.indexOf(",")!=-1){d=d.split(",");for(var e=0;e<d.length;e++)b=this.parseUrlPath(d[e].replace(/\s/g,"")),this.apiPaths.push([b,c])}else b=this.parseUrlPath(d),this.apiPaths.push([b,c])}},JSONLDMacro.clearAPIs=function(){this.apiPaths=[]},JSONLDMacro.wrapRDFStoreJSNetworkTransport=function(a){nt=a.getNetworkTransport();var b={load:function(a,b,c){nt.load(a,b,function(b,d){if(b){var e=d.headers["Content-Type"]||d.headers["content-type"],f=d.data;if(e.indexOf("application/json")!=-1){var g=macro.resolve(a,JSON.parse(f));g!=null?(d.data=JSON.stringify(g),c(b,d)):c(b,d)}else c(b,d)}else c(b,d)})},loadFromFile:function(a,b,c,d){nt.loadFromFile(a,b,c,d)}};a.setNetworkTransport(b)},JSONLDMacro}());(function(){window.apis={},apis.github={"https://api.github.com/repos/*/*":{$:{"@id":[{"f:valueof":"url"}],"@ns":{"ns:default":"gh"},"@context":{gh:"https://api.github.com/vocabulary#"},"@type":["https://api.github.com/vocabulary#Repository"],"@only":["name","watchers","forks","description","owner","url"]},"$.owner":{"@ns":{"ns:default":"gh","ns:replace":{avatar_url:"foaf:depiction"}},"@context":{gh:"https://api.github.com/vocabulary#",foaf:"http://xmlns.com/foaf/0.1/","foaf:depiction":{"@type":"@id"}},"@type":["https://api.github.com/vocabulary#User","http://xmlns.com/foaf/0.1/Person"],"@id":[{"f:valueof":"login"},{"f:prefix":"http://geektalk.com/vocabulary/geek#"}],"@remove":["url"]}},"https://api.github.com/repos/*/*/collaborators,         https://api.github.com/repos/*/*/watchers,         https://api.github.com/users/*":{$:{"@ns":{"ns:default":"gh","ns:replace":{avatar_url:"foaf:depiction",name:"foaf:name"}},"@context":{gh:"https://api.github.com/vocabulary#",foaf:"http://xmlns.com/foaf/0.1/","foaf:depiction":{"@type":"@id"},"gh:url":{"@type":"@id"}},"@type":["https://api.github.com/vocabulary#User","http://xmlns.com/foaf/0.1/Person"],"@id":[{"f:valueof":"login"},{"f:prefix":"http://geektalk.com/vocabulary/geek#"}],"@only":["url","avatar_url","name","login","blog","company","email","followers","following","location","public_repos"]}}},apis.stackOverflow={"@declare":{gt:"http://antoniogarrote.com/geektalk/","gt:fromSODate":"function(argument, input, obj){ var d = new Date(input*1000);                                                              var pad = function(n){ return n<10 ? '0'+n : n };                                                              return d.getUTCFullYear()+'-'                                                              + pad(d.getUTCMonth()+1)+'-'                                                              + pad(d.getUTCDate())+'T'                                                              + pad(d.getUTCHours())+':'                                                              + pad(d.getUTCMinutes())+':'                                                              + pad(d.getUTCSeconds())+'Z'; }"},"http://api.stackoverflow.com/1.1/users":{$:{"@ns":{"ns:default":"so","ns:replace":{avatar_url:"foaf:depiction"}},"@context":{so:"http://api.stackoverflow.com/1.1/vocabulary#","so:github_id":{"@type":"@id"},foaf:"http://xmlns.com/foaf/0.1/","foaf:depiction":{"@type":"@id"}},"@type":["http://api.stackoverflow.com/1.1/vocabulary#User","http://xmlns.com/foaf/0.1/Person"],"@id":[{"f:valueof":"display_name"},{"f:prefix":"http://geektalk.com/vocabulary/geek#"}],"@only":["display_name","user_id","avatar_url","github_id","reputation"]}},"http://api.stackoverflow.com/1.1/users/*/answers":{$:{"@ns":{"ns:default":"so","ns:replace":{question_id:"so:question"}},"@context":{so:"http://api.stackoverflow.com/1.1/vocabulary#",xsd:"http://www.w3.org/2001/XMLSchema#","so:question":{"@type":"@id"},"so:creation_date":{"@type":"xsd:date"}},"@type":["http://api.stackoverflow.com/1.1/vocabulary#Answer"],"@id":[{"f:valueof":"answer_id"},{"f:prefix":"http://geektalk.com/vocabulary/answer#"}],"@transform":{question_id:[{"f:valueof":"question_id"},{"f:prefix":"http://geektalk.com/vocabulary/question#"}],creation_date:[{"f:valueof":"creation_date"},{"gt:fromSODate":null}]},"@only":["answer_id","question_id","score","owner","creation_date","body"]},"$.owner":{"@ns":{"ns:default":"so"},"@context":{so:"http://api.stackoverflow.com/1.1/vocabulary#"},"@id":[{"f:valueof":"display_name"},{"f:prefix":"http://geektalk.com/vocabulary/geek#"}],"@only":[]}},"http://api.stackoverflow.com/1.1/questions/*":{$:{"@ns":{"ns:default":"so"},"@context":{so:"http://api.stackoverflow.com/1.1/vocabulary#",xsd:"http://www.w3.org/2001/XMLSchema#","so:question":{"@type":"@id"},"so:creation_date":{"@type":"xsd:date"}},"@type":["http://api.stackoverflow.com/1.1/vocabulary#Question"],"@id":[{"f:valueof":"question_id"},{"f:prefix":"http://geektalk.com/vocabulary/question#"}],"@transform":{creation_date:[{"f:valueof":"creation_date"},{"gt:fromSODate":null}]},"@only":["question_id","creation_date","body","tags","title"]}}},apis.hackerNews={"@declare":{gt:"http://antoniogarrote.com/geektalk/","gt:fromHNDate":"function(argument, input, obj){ var elapsed = parseInt(input.split(\" \")[0]) * 24* 60 * 60 * 100;                                                              var millisecs = (new Date()).getTime() - elapsed;                                                              var d = new Date(millisecs);                                                              var pad = function(n){ return n<10 ? '0'+n : n };                                                              return d.getUTCFullYear()+'-'                                                              + pad(d.getUTCMonth()+1)+'-'                                                              + pad(d.getUTCDate())+'T'                                                              + pad(d.getUTCHours())+':'                                                              + pad(d.getUTCMinutes())+':'                                                              + pad(d.getUTCSeconds())+'Z'; }"},"http://api.ihackernews.com/threads/*":{$:{"@ns":{"ns:default":"hn","ns:replace":{postId:"hn:post",postedAgo:"hn:creation_date"}},"@context":{hn:"http://api.ihackernews.com/vocabulary#",xsd:"http://www.w3.org/2001/XMLSchema#","hn:post":{"@type":"@id"},"hn:owner":{"@type":"@id"},"hn:creation_date":{"@type":"xsd:date"}},"@type":["http://api.ihackernews.com/vocabulary#Answer"],"@id":[{"f:valueof":"id"},{"f:prefix":"http://geektalk.com/vocabulary/threadComment#"}],"@transform":{postId:[{"f:valueof":"postId"},{"f:prefix":"http://geektalk.com/vocabulary/post#"}],postedAgo:[{"f:valueof":"postedAgo"},{"gt:fromHNDate":null}],owner:[{"f:valueof":"owner"},{"f:prefix":"http://geektalk.com/vocabulary/geek#"}]},"@only":["id","postId","comment","postedAgo","points","owner"]}},"http://api.ihackernews.com/post/*":{$:{"@ns":{"ns:default":"hn"},"@context":{hn:"http://api.ihackernews.com/vocabulary#",xsd:"http://www.w3.org/2001/XMLSchema#","hn:creation_date":{"@type":"xsd:date"}},"@id":[{"f:valueof":"id"},{"f:prefix":"http://geektalk.com/vocabulary/post#"}],"@type":["http://api.ihackernews.com/vocabulary#Post"],"@transform":{postedAgo:[{"f:valueof":"postedAgo"},{"gt:fromHNDate":null}]},"@only":["title","text","postedAgo","points","url","id"]}}},apis.twitter={"@declare":{gt:"http://antoniogarrote.com/geektalk/","gt:fromTwitterDate":"function(argument, input, obj){ var d = new Date(input);                                                                   var pad = function(n){ return n<10 ? '0'+n : n };                                                                   return d.getUTCFullYear()+'-'                                                                   + pad(d.getUTCMonth()+1)+'-'                                                                   + pad(d.getUTCDate())+'T'                                                                   + pad(d.getUTCHours())+':'                                                                   + pad(d.getUTCMinutes())+':'                                                                   + pad(d.getUTCSeconds())+'Z'; }"},"http://api.twitter.com/1/users/show.json":{$:{"@ns":{"ns:default":"tw","ns:replace":{screen_name:"tw:owner"}},"@context":{tw:"http://api.twitter.com/1/vocabulary#",gt:"http://geektalk.com/vocabulary/","tw:owner":{"@type":"@id"}},"@transform":{screen_name:[{"f:valueof":"login"},{"f:prefix":"http://geektalk.com/vocabulary/geek#"}],postedAgo:[{"f:valueof":"created_at"},{"gt:fromTwitterDate":null}]},"@id":[{"f:valueof":"login"},{"f:prefix":"http://geektalk.com/vocabulary/microblogpost#"}],"@type":["http://api.twitter.com/1/vocabulary#MicroblogPost"],"@only":["id","text","retweeted","login","status_id","statusUrl","screen_name","created_at"]}}}})();(function(){function h(a){return j(i(k(a)))}function i(a){return m(n(l(a),a.length*8))}function j(a){try{f}catch(b){f=0}var c=f?"0123456789ABCDEF":"0123456789abcdef",d="",e;for(var g=0;g<a.length;g++)e=a.charCodeAt(g),d+=c.charAt(e>>>4&15)+c.charAt(e&15);return d}function k(a){var b="",c=-1,d,e;while(++c<a.length)d=a.charCodeAt(c),e=c+1<a.length?a.charCodeAt(c+1):0,55296<=d&&d<=56319&&56320<=e&&e<=57343&&(d=65536+((d&1023)<<10)+(e&1023),c++),d<=127?b+=String.fromCharCode(d):d<=2047?b+=String.fromCharCode(192|d>>>6&31,128|d&63):d<=65535?b+=String.fromCharCode(224|d>>>12&15,128|d>>>6&63,128|d&63):d<=2097151&&(b+=String.fromCharCode(240|d>>>18&7,128|d>>>12&63,128|d>>>6&63,128|d&63));return b}function l(a){var b=Array(a.length>>2),c;for(c=0;c<b.length;c++)b[c]=0;for(c=0;c<a.length*8;c+=8)b[c>>5]|=(a.charCodeAt(c/8)&255)<<c%32;return b}function m(a){var b="";for(var c=0;c<a.length*32;c+=8)b+=String.fromCharCode(a[c>>5]>>>c%32&255);return b}function n(a,b){a[b>>5]|=128<<b%32,a[(b+64>>>9<<4)+14]=b;var c=1732584193,d=-271733879,e=-1732584194,f=271733878;for(var g=0;g<a.length;g+=16){var h=c,i=d,j=e,k=f;c=p(c,d,e,f,a[g+0],7,-680876936),f=p(f,c,d,e,a[g+1],12,-389564586),e=p(e,f,c,d,a[g+2],17,606105819),d=p(d,e,f,c,a[g+3],22,-1044525330),c=p(c,d,e,f,a[g+4],7,-176418897),f=p(f,c,d,e,a[g+5],12,1200080426),e=p(e,f,c,d,a[g+6],17,-1473231341),d=p(d,e,f,c,a[g+7],22,-45705983),c=p(c,d,e,f,a[g+8],7,1770035416),f=p(f,c,d,e,a[g+9],12,-1958414417),e=p(e,f,c,d,a[g+10],17,-42063),d=p(d,e,f,c,a[g+11],22,-1990404162),c=p(c,d,e,f,a[g+12],7,1804603682),f=p(f,c,d,e,a[g+13],12,-40341101),e=p(e,f,c,d,a[g+14],17,-1502002290),d=p(d,e,f,c,a[g+15],22,1236535329),c=q(c,d,e,f,a[g+1],5,-165796510),f=q(f,c,d,e,a[g+6],9,-1069501632),e=q(e,f,c,d,a[g+11],14,643717713),d=q(d,e,f,c,a[g+0],20,-373897302),c=q(c,d,e,f,a[g+5],5,-701558691),f=q(f,c,d,e,a[g+10],9,38016083),e=q(e,f,c,d,a[g+15],14,-660478335),d=q(d,e,f,c,a[g+4],20,-405537848),c=q(c,d,e,f,a[g+9],5,568446438),f=q(f,c,d,e,a[g+14],9,-1019803690),e=q(e,f,c,d,a[g+3],14,-187363961),d=q(d,e,f,c,a[g+8],20,1163531501),c=q(c,d,e,f,a[g+13],5,-1444681467),f=q(f,c,d,e,a[g+2],9,-51403784),e=q(e,f,c,d,a[g+7],14,1735328473),d=q(d,e,f,c,a[g+12],20,-1926607734),c=r(c,d,e,f,a[g+5],4,-378558),f=r(f,c,d,e,a[g+8],11,-2022574463),e=r(e,f,c,d,a[g+11],16,1839030562),d=r(d,e,f,c,a[g+14],23,-35309556),c=r(c,d,e,f,a[g+1],4,-1530992060),f=r(f,c,d,e,a[g+4],11,1272893353),e=r(e,f,c,d,a[g+7],16,-155497632),d=r(d,e,f,c,a[g+10],23,-1094730640),c=r(c,d,e,f,a[g+13],4,681279174),f=r(f,c,d,e,a[g+0],11,-358537222),e=r(e,f,c,d,a[g+3],16,-722521979),d=r(d,e,f,c,a[g+6],23,76029189),c=r(c,d,e,f,a[g+9],4,-640364487),f=r(f,c,d,e,a[g+12],11,-421815835),e=r(e,f,c,d,a[g+15],16,530742520),d=r(d,e,f,c,a[g+2],23,-995338651),c=s(c,d,e,f,a[g+0],6,-198630844),f=s(f,c,d,e,a[g+7],10,1126891415),e=s(e,f,c,d,a[g+14],15,-1416354905),d=s(d,e,f,c,a[g+5],21,-57434055),c=s(c,d,e,f,a[g+12],6,1700485571),f=s(f,c,d,e,a[g+3],10,-1894986606),e=s(e,f,c,d,a[g+10],15,-1051523),d=s(d,e,f,c,a[g+1],21,-2054922799),c=s(c,d,e,f,a[g+8],6,1873313359),f=s(f,c,d,e,a[g+15],10,-30611744),e=s(e,f,c,d,a[g+6],15,-1560198380),d=s(d,e,f,c,a[g+13],21,1309151649),c=s(c,d,e,f,a[g+4],6,-145523070),f=s(f,c,d,e,a[g+11],10,-1120210379),e=s(e,f,c,d,a[g+2],15,718787259),d=s(d,e,f,c,a[g+9],21,-343485551),c=t(c,h),d=t(d,i),e=t(e,j),f=t(f,k)}return Array(c,d,e,f)}function o(a,b,c,d,e,f){return t(u(t(t(b,a),t(d,f)),e),c)}function p(a,b,c,d,e,f,g){return o(b&c|~b&d,a,b,e,f,g)}function q(a,b,c,d,e,f,g){return o(b&d|c&~d,a,b,e,f,g)}function r(a,b,c,d,e,f,g){return o(b^c^d,a,b,e,f,g)}function s(a,b,c,d,e,f,g){return o(c^(b|~d),a,b,e,f,g)}function t(a,b){var c=(a&65535)+(b&65535),d=(a>>16)+(b>>16)+(c>>16);return d<<16|c&65535}function u(a,b){return a<<b|a>>>32-b}var a={stackCounter:0};a.recur=function(b){a.stackCounter===a.stackCounterLimit?(a.stackCounter=0,setTimeout(b,0)):(a.stackCounter++,b())},a.repeat=function(b,c,d,e,f){arguments.length===4&&(f={}),b<c?(f._i=b,d(function(d,f){a.recur(function(){a.repeat(b+1,c,d,e,f)})},f)):e(f)};var b={};window.geektalk=b;var c=["#DC143C","#00CD66","#FFC125","#FF9912","#FF4500","#7D9EC0"],d=["#B0171F","#DC143C","#CD8C95","#8B5F65","#8B475D","#8B8386","#CD3278","#8B2252","#EE6AA7","#DA70D6","#8B4789","#8B7B8B","#8B668B","#8B008B","#4B0082","#483D8B","#0000FF","#191970","#3D59AB","#4169E1","#778899","#1C86EE","#4F94CD","#607B8B","#00C5CD","#00868B","#00CD66","#008B45","#2E8B57","#00CD00","#008000","#66CD00","#6E8B3D","#9ACD32","#CDCD00","#8B8B00","#FFA500","#FF7F00","#8B4500","#FF7F24","#FF8247","#FF4500","#EE5C42","#EE2C2C","#CD0000","#8E388E","#7171C6","#388E8E"];b.stack_overflow_key="FUjIgOwLo0aUoBShIIyLSg",b.one_year_ago=(new Date).getTime()-31536e6,b.three_years_ago=(new Date).getTime()-94608e6,b.MAX_COLLABORATORS_RUN=5,b.MAX_SO_RUN=10,b.viewModel={appStatus:ko.observable("project-selection"),triplesCounter:ko.observable(0),callbackCounter:0,uriBeingLoaded:ko.observable(""),jsonpRequestsConfirmations:{},projectName:ko.observable(),projectNameInline:ko.observable(),projectNameStatus:ko.observable(),projectContributorsFound:ko.observable(0),projectResourcesFound:ko.observable(0),currentProjectURI:ko.observable(),StackOverflowSelectionCriteria:ko.observable("all"),StackOverflowAllQuestions:ko.observable([]),StackOverflowSelectedQuestions:ko.observable([]),HackerNewsRequests:ko.observable(0),currentProjectCollaboratorsPage:ko.observable(0),pendingCollaborators:ko.observable(),loadedCollaborators:0,stackOverflowPagesLoaded:0,processedUsers:{},hnUsersToLoad:[],twUsersToLoad:[],triplesInVisualization:ko.observable(0)},window.viewModel=b.viewModel,b.pendingStackOverflowUsers=[],b.viewModel.showAbout=function(){jQuery("#about-modal").modal("show")},b.viewModel.hideAbout=function(){jQuery("#about-modal").modal("hide")},b.viewModel.triplesLoadedMessage=ko.dependentObservable(function(){return"Triples loaded: "+b.viewModel.triplesCounter()}),b.viewModel.uriBeingLoadedMessage=ko.dependentObservable(function(){var a=b.viewModel.uriBeingLoaded();return a===""?"Loading : --":a.length>90?"Loading : "+a.substring(0,90)+"...":"Loading : "+a}),b.viewModel.selectSection=function(a){var b={StackOverflow:"sotab",HackerNews:"hntab",Twitter:"twtab",People:"pptab",Location:"geotab",Stats:"stats"},c={StackOverflow:"answers-display",HackerNews:"discussions-display",Twitter:"status-display",People:"people-display",Location:"location-display",Stats:"stats-display"},d=b[a];jQuery(".nav-tabs li").removeClass("active"),jQuery(".nav-tabs #"+d).addClass("active");for(var e in c)e===a?(jQuery("#"+c[e]).show(),a==="Location"&&(google.maps.event.trigger(map,"resize"),map.setCenter(new google.maps.LatLng(40.26,3.43)))):jQuery("#"+c[e]).hide()},b.viewModel.randomColor=function(a){var b=Math.floor(Math.random()*d.length);return d[b]},b.viewModel.randomTitleColor=function(a){var b=Math.floor(Math.random()*c.length);return c[b]},function(){var a={},c=0,e={};b.viewModel.colorForTag=function(f){var g=a[f];if(g)return g;if(c<d.length){var h=!1,i=0;while(!h)g=b.viewModel.randomColor(),e[g]==null||i===5?(a[f]=g,e[g]=!0,h=!0):i++;return g}return g=b.viewModel.randomColor(),a[f]=g,g},b.viewModel.selectTag=function(a){var b=jQuery(a.currentTarget).text();viewModel.StackOverflowSelectionCriteria(b)},b.viewModel.unselectTag=function(){viewModel.StackOverflowSelectionCriteria("all")}}(),b.viewModel.loadProjectName=function(){viewModel.projectName()==""||viewModel.projectName()==null||viewModel.projectName().indexOf("/")===-1?(viewModel.projectNameStatus("error"),viewModel.projectNameInline("provide a valid Github's user/project name combination, e.g. rails/rails")):(viewModel.projectNameStatus("loading"),viewModel.projectNameInline("loading..."),b.loadProject())},b.viewModel.showFrontend=function(){b.frontend=new rdfstore_frontend("#frontend",sko.store)},b.viewModel.modifyQuestionState=function(a){jQuery(a.currentTarget).parent().parent().find("span").toggle(),jQuery(a.currentTarget).parent().parent().parent().parent().parent().parent().find(".question-body").toggle(),jQuery(a.currentTarget).parent().parent().parent().parent().parent().find(".answer-body").toggle()},b.viewModel.modifyPermanentQuestionState=function(a){var b=jQuery(a.currentTarget).parent().parent().parent().parent().parent().find(".question-id-marker").val(),c=viewModel["open"+b]();viewModel["open"+b](!c)},b.updateTripleCount=function(a){typeof a=="string"&&(a=parseInt(a));var b=viewModel.triplesCounter();viewModel.triplesCounter(b+a)},b.loadJSONP=function(a,c,d,e){e=e||!1;var f="jsonp"+viewModel.callbackCounter;viewModel.callbackCounter++,d==null&&(d="callback");var g=a;g.indexOf("?")===-1?g=g+"?"+d+"="+f:g=g+"&"+d+"="+f,window[f]=function(a){viewModel.uriBeingLoaded()===g&&viewModel.uriBeingLoaded(""),viewModel.jsonpRequestsConfirmations[g]=!0,c(a)},setTimeout(function(){viewModel.jsonpRequestsConfirmations[g]===!0?delete viewModel.jsonpRequestsConfirmations[g]:(console.log("(!!) JSONP error, retyring..."),console.log(a),console.log(d),delete window[f],e?c(null):b.loadJSONP(a,c,d,e))},15e3),viewModel.uriBeingLoaded(g);var h=document.createElement("script");h.setAttribute("type","text/javascript"),h.setAttribute("src",g),document.getElementsByTagName("head")[0].appendChild(h)},b.resolveAndLoad=function(a,c,d){var e=jsonld_macros.resolve(a,c);sko.store.load("application/json",e,function(a,c){a?(b.updateTripleCount(c),d(!0,e)):d(!1,null)})},b.loadProject=function(){var a="https://api.github.com/repos/"+viewModel.projectName();b.loadJSONP(a,function(a){if(a==null||a.data.message==="Not Found")viewModel.projectNameStatus("error"),viewModel.projectNameInline("provide a valid Github's user/project name combination, e.g. rails/rails"),alert("User/Project '"+viewModel.projectName()+"' not found");else{viewModel.projectNameStatus("success"),viewModel.projectNameInline("Success!"),jQuery("#stack-overflow-loader").show(),jQuery("#hacker-news-loader").show(),window.location.href.indexOf("#!")==-1&&(window.location.href="#!"+viewModel.projectName());var c="https://api.github.com/repos/"+viewModel.projectName()+"?callback=jsonp";b.resolveAndLoad(c,a.data,function(a,c){a?(viewModel.appStatus("conversations-playing"),viewModel.currentProjectURI(c["@id"]),b.loadCollaborators(),b.loadHackerNewsUsers(),b.loadTwitterUsers()):alert("Error processing Github's data (?!!)")})}})},b.loadCollaborators=function(){var a=viewModel.currentProjectCollaboratorsPage();viewModel.currentProjectCollaboratorsPage(a+1);var c="https://api.github.com/repos/"+viewModel.projectName()+"/collaborators?per_page=100&page="+a;b.loadJSONP(c,function(a){if(a!=null&&a.data!=null){viewModel.projectContributorsFound(a.data.length);var c=a.data.pop();viewModel.pendingCollaborators(a.data),b.loadCollaborator(c)}else alert("Error loading Github's data (??!)")})},b.loadCommitters=function(){var a="http://github.com/api/v2/json/commits/list/"+viewModel.projectName()+"/master",c=[],d,e;b.loadJSONP(a,function(a){c=[],d=a.commits;for(var f=0;f<d.length;f++)d[f].author.login!=null&&d[f].author.login!=""&&(e=d[f].author.login,viewModel.processedUsers[e]==null&&(c.push({url:"https://api.github.com/users/"+e}),viewModel.processedUsers[e]=!0));var g=viewModel.projectContributorsFound();viewModel.projectContributorsFound(c.length+g);var h=c.pop();viewModel.pendingCollaborators(c),h!=null&&b.loadCollaborator(h)})},b.checkIdentity=function(a,b){var c={blog:"website_url",email:"email_hash",login:"display_name"},d=null,e=0;for(var f=0;f<b.length;f++){var g=0;for(var i in c)if(i==="email"){if(a.email!=null&&b[f].email_hash!=null&&h(a.email)===b[f].email_hash)return b[f]}else b[f][c[i]]!=null&&a[i]!=null&&b[f][c[i]].split(/[\s]+/g).join("")===a[i].split(/[\s]+/g).join("")&&g++;g>e&&(d=b[f])}return g>1||g==1&&b.length==1?d:null},b.loadCollaborator=function(a){var c=a.url;b.loadJSONP(c,function(a){if(a!=null&&a.data!=null){var c=a.data,d=c.login,e={blog:c.blog,email:c.email,login:c.login,avatar_url:c.avatar_url};viewModel.processedUsers[d]=!0,viewModel.hnUsersToLoad.push(c.login),viewModel.twUsersToLoad.push(c.login),b.resolveAndLoad("https://api.github.com/repos/*/*/collaborators",c,function(a,c){var f="http://api.stackoverflow.com/1.1/users?filter="+d+"&key="+b.stack_overflow_key;b.loadJSONP(f,function(a){var c=function(){var a=viewModel.pendingCollaborators();if(a.length===0||viewModel.loadedCollaborators==b.MAX_COLLABORATORS_RUN)jQuery("#stack-overflow-loader").hide(),viewModel.loadedCollaborators=0,b.loadStackOverflowAnswers();else{var c=a.pop();viewModel.pendingCollaborators(a),b.loadCollaborator(c)}},d=b.checkIdentity(e,a.users);if(d!=null){d.github_id="http://geektalk.com/vocabulary/geek#"+e.login,d.avatar_url=e.avatar_url,viewModel.loadedCollaborators++,jQuery("#stack-overflow-loader .progress .bar").attr("style","width: "+Math.floor(viewModel.loadedCollaborators/b.MAX_COLLABORATORS_RUN*100)+"%");var g=viewModel.projectResourcesFound();g++,viewModel.projectResourcesFound(g),b.resolveAndLoad(f,d,function(a,d){b.pendingStackOverflowUsers.push(d["so:user_id"]),c()})}else c()},"jsonp")})}else alert("Error loading Github's data (??!)")})},b.loadStackOverflowAnswers=function(){if(b.pendingStackOverflowUsers.length>0){var a=encodeURIComponent(b.pendingStackOverflowUsers.join(";"));b.pendingStackOverflowUsers=[];var c=parseInt(b.three_years_ago/1e3),d="http://api.stackoverflow.com/1.1/users/"+a+"/answers?body=true&pagesize=20&order=desc&sort=votes&fromdate="+c+"&key="+b.stack_overflow_key;viewModel.stackOverflowPagesLoaded++,b.loadJSONP(d,function(a){var c=[];for(var e=0;e<a.answers.length;e++)c.push(a.answers[e].question_id);b.resolveAndLoad(d,a.answers,function(a,e){a?(d="http://api.stackoverflow.com/1.1/questions/"+encodeURIComponent(c.join(";"))+"?body=true&key="+b.stack_overflow_key,b.loadJSONP(d,function(a){b.resolveAndLoad(d,a.questions,function(a,c){if(viewModel.stackOverflowPagesLoaded<b.MAX_SO_RUN){var d=viewModel.pendingCollaborators();if(d.length===0)viewModel.loadedCollaborators=0,b.loadCommitters();else{var e=d.pop();viewModel.pendingCollaborators(d),b.loadCollaborator(e)}}})},"jsonp")):alert("Error loading data from Stack Overflow")})},"jsonp")}else b.loadCommitters()};var e=0;b.loadTwitterUsers=function(){var a=viewModel.twUsersToLoad;a.length>0&&e<15?b.loadTwitterStatus(a.pop(),function(){e++,setTimeout(b.loadTwitterUsers,500)}):setTimeout(b.loadTwitterUsers,3e3)},b.loadTwitterStatus=function(a,c){var d="http://api.twitter.com/1/users/show.json?screen_name="+a;b.loadJSONP(d,function(e){if(e!=null&&e.error==null&&e["status"]!=null){var f=viewModel.projectResourcesFound();f++,viewModel.projectResourcesFound(f),e.status_id=e.status.id,e.statusUrl="https://twitter.com/#!"+e.screen_name+"/status/"+e.status.id,e.login=a,e.text=e.status.text,e.created_at=e.status.created_at;var g=e.text.match(/@[\a-zA-Z0-9]+/g)||[];for(var h=0;h<g.length;h++)var i=g[h],j=e.text.replace(i,"<span class='tweet-ref'>"+i+"</span>");var k={"@id":"http://geektalk.com/vocabulary/geek#"+a,"http://api.twitter.com/1/vocabulary#followers":e.followers_count};sko.store.load("application/json",k,function(){b.resolveAndLoad(d,e,function(a,b){c()})})}else c()},"callback",!0)},b.loadHackerNewsUsers=function(){var a=viewModel.hnUsersToLoad;a.length>0?b.loadHackerNewsThreads(a.pop(),function(){setTimeout(b.loadHackerNewsUsers,5e3)}):setTimeout(b.loadHackerNewsUsers,5e3)},b.loadHackerNewsThreads=function(c,d){var e="http://api.ihackernews.com/threads/"+c+"?format=jsonp",f=viewModel.HackerNewsRequests();f!=null&&(f==0?f+=5:f>99?(jQuery("#hacker-news-loader-alert").show(),f=5):f+=5,jQuery("#hacker-news-loader .progress .bar").attr("style","width: "+f+"%"),viewModel.HackerNewsRequests(f)),b.loadJSONP(e,function(f){var g=f.comments;if(g.length>0){var h=viewModel.projectResourcesFound();h++,viewModel.projectResourcesFound(h);var i=g.length<10?g.length:10;a.repeat(0,i,function(a,d){var f=arguments.callee,h=d._i,i=g[h];i.owner=c;var j=viewModel.HackerNewsRequests();j!=null&&(j==0?j+=5:j>99?(jQuery("#hacker-news-loader-alert").show(),j=5):j+=5,jQuery("#hacker-news-loader .progress .bar").attr("style","width: "+j+"%"),viewModel.HackerNewsRequests(j));var k="http://api.ihackernews.com/post/"+i.postId+"?format=jsonp";setTimeout(function(){b.loadJSONP(k,function(c){viewModel.HackerNewsRequests(null),jQuery("#hacker-news-loader").hide(),b.resolveAndLoad(k,c,function(c,g){viewModel["open"+i.id]=ko.observable(!1),b.resolveAndLoad(e,i,function(b,c){a(f,d)})})})},2e3)},function(){d()})}else d()})},b.setupQuerySelectors=function(){var a="select ?subject { ?subject a so:Answer }";viewModel.currentStackOverflowSelectionQuery=a,sko.store.startObservingQuery(a,function(a){var b=[];for(var c=0;c<a.length;c++)b.push("<"+a[c].subject.value+">");viewModel.StackOverflowAllQuestions(b)}),viewModel.currentStackOVerflowSelectionFn=function(a){var b=[];for(var c=0;c<a.length;c++)b.push("<"+a[c].subject.value+">");viewModel.StackOverflowSelectedQuestions(b)},viewModel.StackoverflowFunctionselector=ko.dependentObservable(function(){viewModel.currentStackOverflowSelectionQuery!==a&&sko.store.stopObservingQuery(viewModel.currentStackOverflowSelectionQuery),viewModel.StackOverflowSelectionCriteria()==="all"?(viewModel.currentStackOverflowSelectionQuery=a,viewModel.StackOverflowSelectedQuestions(viewModel.StackOverflowAllQuestions())):(viewModel.currentStackOverflowSelectionQuery='select distinct ?subject where { ?s so:tags "'+viewModel.StackOverflowSelectionCriteria()+'" . ?subject so:question ?s }',sko.store.startObservingQuery(viewModel.currentStackOverflowSelectionQuery,viewModel.currentStackOVerflowSelectionFn))})},b.initializeMap=function(){geocoder=new google.maps.Geocoder;var a=new google.maps.LatLng(0,0),c={zoom:2,center:a,zoomControl:!0,mapTypeId:google.maps.MapTypeId.ROADMAP};map=new google.maps.Map(document.getElementById("map_canvas"),c),b.mapLocations()},b.mapLocations=function(){var a={},b={};sko.store.startObservingQuery("SELECT * WHERE { ?s gh:location ?location; foaf:depiction ?depiction }",function(c){var d=new google.maps.Size(80,80),e=new google.maps.Size(32,32),f=new google.maps.Point(0,0),g=new google.maps.Point(16,32);for(var h=0;h<c.length;h++){var i=c[h];b[i.s.value]==null&&(b[i.s.value]=!0,i.location&&i.location.value!=""&&a[i.location.value]==null&&geocoder.geocode({address:i.location.value},function(a,b){if(b==google.maps.GeocoderStatus.OK)var c=new google.maps.Marker({map:map,position:a[0].geometry.location,icon:new google.maps.MarkerImage(i.depiction.value,d,f,g,e)})}))}})},b.updateVisualizations=function(){var a=[10,50,200,500],c=0;ko.dependentObservable(function(){var d=viewModel.triplesCounter();d>a[c]&&(viewModel.triplesInVisualization(a[c]),c++,b.buildVisualizations())})},b.viewModel.queryVisualization=function(){viewModel.triplesInVisualization(viewModel.triplesCounter()),b.buildVisualizations()},b.buildVisualizations=function(){var a="SELECT distinct ?node WHERE { { ?node ?m ?n . FILTER(!ISBLANK(?node)) } UNION { ?o ?p ?node . FILTER(!ISBLANK(?node)) } }",c="SELECT * WHERE { ?source ?value ?target . FILTER(!ISBLANK(?source ) && !ISBLANK(?target)) }";jQuery("#graph-chart").empty(),sko.store.execute(a,function(a,b){var d={};for(var e=0;e<b.length;e++)d[b[e].node.value]=e,b[e].node.token=="uri"?b[e].node.group=1:b[e].node.group=2;sko.store.execute(c,function(a,c){for(var e=0;e<c.length;e++)c[e].source=d[c[e].source.value],c[e].target=d[c[e].target.value];var f=940,g=500,h=d3.scale.category10(),i=d3.select("#graph-chart").append("svg:svg").attr("width",f).attr("height",g),j=d3.layout.force().charge(-120).linkDistance(30).nodes(b).links(c).size([f,g]).start(),k=i.selectAll("link.link").data(c).enter().append("svg:line").style("stroke-width",function(a){return 1}).style("stroke","#999999").style("stroke-opacity",.6).attr("x1",function(a){return a.source.x}).attr("y1",function(a){return a.source.y}).attr("x2",function(a){return a.target.x}).attr("y2",function(a){return a.target.y}),l=i.selectAll("circle.node").data(b).enter().append("svg:circle").attr("class","node").attr("cx",function(a){return a.x}).attr("cy",function(a){return a.y}).attr("r",5).style("fill",function(a){return h(a.node.group)}).call(j.drag);l.append("svg:title").text(function(a){return a.node.value}),j.on("tick",function(){k.attr("x1",function(a){return a.source.x}).attr("y1",function(a){return a.source.y}).attr("x2",function(a){return a.target.x}).attr("y2",function(a){return a.target.y}),l.attr("cx",function(a){return a.x}).attr("cy",function(a){return a.y})})})}),jQuery("#tags-chart").empty(),jQuery("#tags-tree-map").empty(),sko.store.execute("SELECT ?tag WHERE { ?s so:tags ?tag }",function(a,c){var d={},e,f,g=[],h=[];for(var i=0;i<c.length;i++){e=c[i].tag.value;if(e&&e!=""){d[e]==null?(d[e]=1,length++):d[e]++;if(f==null||d[e]>f)f=d[e]}}for(var e in d)d[e]>1&&h.push({name:e,size:d[e]}),g.push({name:e,size:d[e]});var j=d3.select("#tags-chart").append("svg").attr("class","chart").attr("width",940).attr("height",20*h.length),k=d3.scale.linear().domain([0,f]).range([0,800]);j.selectAll("rect").data(h).enter().append("rect").attr("x",140).attr("y",function(a,b){return b*20}).attr("width",function(a){return k(a.size)}).attr("height",20).style("stroke","white").style("fill",function(a){return b.viewModel.colorForTag(a.name)}),j.selectAll("text.end_label").data(h).enter().append("text").attr("class","end_label").attr("x",function(a){return 140+k(a.size)}).attr("y",function(a,b){return b*20}).attr("dx",-3).attr("dy","1.05em").attr("text-anchor","end").style("fill","white").text(function(a){return a.name}),j.selectAll("text.start_label").data(h).enter().append("text").attr("class","start_label").attr("x",0).attr("y",function(a,b){return b*20}).attr("dy","1.05em").attr("text-anchor","start").style("fill","black").text(function(a){return a.name});var l=940,m=500,n=function(){this.style("left",function(a){return a.x+"px"}).style("top",function(a){return a.y+"px"}).style("width",function(a){return a.dx-1+"px"}).style("height",function(a){return a.dy-1+"px"}).style("position","absolute").style("color","white")},o=d3.layout.treemap().size([l,m]).sticky(!0).value(function(a){return a.size}),p=d3.select("#tags-tree-map").append("div").style("position","relative").style("width",l+"px").style("height",m+"px");p.data([{name:"tags",children:g}]).selectAll("div").data(o.nodes).enter().append("div").attr("class","cell").style("background",function(a){return a.children?null:b.viewModel.colorForTag(a.name)}).call(n).text(function(a){return a.children?null:a.name})}),jQuery("#reputation-chart").empty();var d="SELECT * WHERE { ?s gh:followers ?followers; gh:login ?login; foaf:depiction ?picture }";sko.store.execute(d,function(a,b){var c=[];for(var d=0;d<b.length;d++){var e=parseInt(b[d].followers.value),f={className:b[d].login.value,packageName:b[d].login.value,picture:b[d].picture.value,value:e};c.push(f)}if(c.length>0){var g=940,h=d3.format(",d"),i=d3.scale.category20c(),j=d3.layout.pack().sort(null).size([g,g]),k=d3.select("#reputation-chart").append("svg").style("background-color","whiteSmoke").attr("width",g).attr("class","bubble"),l=j.nodes({children:c}).filter(function(a){return!a.children}),m=k.selectAll("g.node").data(l).enter().append("g").attr("class","node").attr("transform",function(a){return"translate("+a.x+","+a.y+")"});m.append("title").text(function(a){return a.className+": "+h(a.value)}),m.append("circle").attr("r",function(a){return a.r}).style("fill",function(a){return i(a.className)}),m.append("text").attr("text-anchor","middle").attr("dy",function(a){return a.r>40?"1.5em":".3em"}).style("fill","white").text(function(a){return a.className.substring(0,a.r/3)}),m.append("image").attr("width",function(a){return a.r>40?32:0}).attr("height",function(a){return a.r>40?32:0}).attr("x","-16").attr("y","-32").attr("xlink:href",function(a){return a.picture})}})},jQuery(document).ready(function(){rdfstore.create(function(a){sko.ready(a,function(){sko.store.setBatchLoadEvents(!0),jsonld_macros.registerAPI(apis.github),jsonld_macros.registerAPI(apis.stackOverflow),jsonld_macros.registerAPI(apis.hackerNews),jsonld_macros.registerAPI(apis.twitter),a.registerDefaultProfileNamespaces(),a.registerDefaultNamespace("gt","http://geektalk.com/vocabulary/"),a.registerDefaultNamespace("gh","https://api.github.com/vocabulary#"),a.registerDefaultNamespace("hn","http://api.ihackernews.com/vocabulary#"),a.registerDefaultNamespace("tw","http://api.twitter.com/1/vocabulary#"),a.registerDefaultNamespace("so","http://api.stackoverflow.com/1.1/vocabulary#"),b.setupQuerySelectors(),b.initializeMap(),b.updateVisualizations(),sko.Class.define("[tw:MicroblogPost]",{displayDate:function(){var a=new Date(this.getProp("[tw:created_at]")),b=a.getHours()+1+":"+a.getSeconds(),c=a.getMonth()+1+"-"+a.getDate()+"-"+a.getFullYear();return c+" "+b}}),sko.applyBindings("body",viewModel,function(){if(window.location.href.indexOf("#!")!=-1){var a=window.location.href.split("#!")[1];jQuery("#stack-overflow-loader").show(),viewModel.projectName(a),viewModel.loadProjectName()}else jQuery("#project-selection").show()})})})});var f=0,g=""})();