(function(){typeof console=="undefined"&&(console={log:function(){}});var y={"extends":function(a,c){c.prototype=new a},stackCounterLimit:1E3,stackCounter:0};y.recur=function(a){y.stackCounter===y.stackCounterLimit?(y.stackCounter=0,setTimeout(a,0)):(y.stackCounter++,a())};y.clone=function(a){return JSON.parse(JSON.stringify(a))};y.shuffle=function(a){for(var c,e,h=a.length;h;c=parseInt(Math.random()*h),e=a[--h],a[h]=a[c],a[c]=e);return a};y.include=function(a,c,e){for(var h=a.length-1;h>=0;h--){var k=
!1,k=e==null?a[h]===c:e(a[h],c)===0;if(k===!0)return!0}return!1};y.remove=function(a,c){for(var e=[],h=0;h<a.length;h++)a[h]!==c&&e.push(a[h]);return e};y.repeat=function(a,c,e,h,k){arguments.length===4&&(k={});a<c?(k._i=a,e(function(j,e){y.recur(function(){y.repeat(a+1,c,j,h,e)})},k)):h(k)};y.meanwhile=function(a,c,e,h){arguments.length===3&&(h={});h._stack_counter==null&&(h._stack_counter=0);a===!0?c(function(a,c,h){h._stack_counter%40==39?(h._stack_counter+=1,setTimeout(function(){y.neanwhile(a,
c,e,h)},0)):(h._stack_counter+=1,y.meanwhile(a,c,e,h))},h):e(h)};y.seq=function(){var a=arguments;return function(c){y.repeat(0,a.length,function(c,h){var k=arguments.callee;a[h._i](function(){c(k,h)})},function(){c()})}};y.partition=function(a,c){for(var e=a.length%c,h=[],k=0;k<e;k++)h.push(null);e=[];for(k=0;k<a.length;k++)h.push(a[k]),h.length%c==0&&(e.push(h),h=[]);return e};y.keys=function(a){var c=[],e;for(e in a)c.push(e);return c};y.iso8601=function(a){function c(a){return a<10?"0"+a:a}return a.getUTCFullYear()+
"-"+c(a.getUTCMonth()+1)+"-"+c(a.getUTCDate())+"T"+c(a.getUTCHours())+":"+c(a.getUTCMinutes())+":"+c(a.getUTCSeconds())+"Z"};y.parseStrictISO8601=function(a){var c=a.match(RegExp("([0-9]{4})(-([0-9]{2})(-([0-9]{2})(T([0-9]{2}):([0-9]{2})(:([0-9]{2})(.([0-9]+))?)?(Z|(([-+])([0-9]{2}):([0-9]{2})))?)?)?)?")),a=0,e=new Date(c[1],0,1);if(c[3])e.setMonth(c[3]-1);else throw"missing ISO8061 component";if(c[5])e.setDate(c[5]);else throw"missing ISO8061 component";if(c[7])e.setHours(c[7]);else throw"missing ISO8061 component";
if(c[8])e.setMinutes(c[8]);else throw"missing ISO8061 component";if(c[10])e.setSeconds(c[10]);else throw"missing ISO8061 component";c[12]&&e.setMilliseconds(Number("0."+c[12])*1E3);c[14]&&(a=Number(c[16])*60+Number(c[17]),a*=c[15]=="-"?1:-1);a-=e.getTimezoneOffset();c=new Date;c.setTime(Number(Number(e)+a*6E4));return c};y.parseISO8601=function(a){var c=a.match(RegExp("([0-9]{4})(-([0-9]{2})(-([0-9]{2})(T([0-9]{2}):([0-9]{2})(:([0-9]{2})(.([0-9]+))?)?(Z|(([-+])([0-9]{2}):([0-9]{2})))?)?)?)?")),a=
0,e=new Date(c[1],0,1);c[3]&&e.setMonth(c[3]-1);c[5]&&e.setDate(c[5]);c[7]&&e.setHours(c[7]);c[8]&&e.setMinutes(c[8]);c[10]&&e.setSeconds(c[10]);c[12]&&e.setMilliseconds(Number("0."+c[12])*1E3);c[14]&&(a=Number(c[16])*60+Number(c[17]),a*=c[15]=="-"?1:-1);a-=e.getTimezoneOffset();c=new Date;c.setTime(Number(Number(e)+a*6E4));return c};y.parseISO8601Components=function(a){var a=a.match(RegExp("([0-9]{4})(-([0-9]{2}))(-([0-9]{2}))(T([0-9]{2}):([0-9]{2})(:([0-9]{2}))?(.([0-9]+))?)?(Z|([-+])([0-9]{2})(:([0-9]{2}))?)?")),
c,e,h,k,j,i,g,r;c=Number(a[1]);e=a[3]-1;h=Number(a[5]);k=Number(a[7]);j=Number(a[8]);i=Number(a[10]);a[12]&&(g=Number("0."+a[12])*1E3);a[13]==="Z"?r=0:a[14]?(r=0,a[17]&&(r=Number(a[17])),r+=Number(a[15])*60,r*=a[14]=="-"?-1:1):a[14]==null&&a[11]&&(r=Number(a[12])*60);return{year:isNaN(c)?null:c,month:isNaN(e)?null:e,date:isNaN(h)?null:h,hours:isNaN(k)?null:k,minutes:isNaN(j)?null:j,seconds:isNaN(i)?null:i,millisecs:isNaN(g)?null:g,timezone:isNaN(r)?null:r}};y.compareDateComponents=function(a,c){var e=
y.parseISO8601Components(a),h=y.parseISO8601Components(c);if(e.timezone==null&&h.timezone==null||e.timezone!=null&&h.timezone!=null)return e=y.parseISO8601(a),h=y.parseISO8601(c),e.getTime()==h.getTime()?0:e.getTime()<h.getTime()?-1:1;else if(e.timezone!=null&&h.timezone==null){var e=y.parseISO8601(a),h=y.parseISO8601(c),e=e.getTime(),h=h.getTime(),k=50400;return e<h&&e<h+k?-1:e>h&&e>h-k?1:null}else return e=y.parseISO8601(a),h=y.parseISO8601(c),e=e.getTime(),h=h.getTime(),k=50400,e<h&&e+k<h?-1:e>
h&&e+k>h?1:null};y.lexicalFormLiteral=function(a,c){var e=a.value,h=a.lang,k=a.type,j=null;if(e!=null&&k!=null&&typeof k!="string"){e=k.value;if(e==null)e=k.suffix,k=c.namespaces[k.prefix],a.type=k+e,e=k+e;j=e.indexOf("hexBinary")!=-1?'"'+a.value.toLowerCase()+'"^^<'+e+">":'"'+a.value+'"^^<'+e+">"}else j=h==null&&k==null?'"'+e+'"':k==null?'"'+e+'"@'+h:k.indexOf("hexBinary")!=-1?'"'+a.value.toLowerCase()+'"^^<'+k+">":'"'+a.value+'"^^<'+k+">";return j};y.lexicalFormBaseUri=function(a,c){var e=null;
if(a.value==null)var e=a.prefix,h=a.suffix,k=c.namespaces[e],e=k!=null?k+h:e+":"+h;else e=a.value;if(e===null)return null;else e.indexOf(":")==-1&&(e=(c.base||"")+e);return e};y.lexicalFormTerm=function(a,c){if(a.token==="uri")return{uri:y.lexicalFormBaseUri(a,c)};else if(a.token==="literal")return{literal:y.lexicalFormLiteral(a,c)};else if(a.token==="blank")return{blank:"_:"+a.value};else throw"Error, cannot get lexical form of unknown token: "+a.token;};y.normalizeUnicodeLiterals=function(a){for(var c=
a.match(/\\u[0-9abcdefABCDEF]{4,4}/g)||[],e={},h=0;h<c.length;h++)e[c[h]]==null&&(e[c[h]]=!0,a=a.replace(RegExp("\\"+c[h],"g"),eval("'"+c[h]+"'")));return a};y.hashTerm=function(a){try{if(a==null)return"";if(a.token==="uri")return"u"+a.value;else if(a.token==="blank")return"b"+a.value;else if(a.token==="literal"){var c="l"+a.value;c+=a.type||"";c+=a.lang||"";return c}}catch(e){if(typeof a==="object"){c="";for(p in a)c=c+p+a[p];return c}return a}};var K={Tree:function(a){if(arguments.length!=0)this.order=
a,this.root=this._allocateNode(),this.root.isLeaf=!0,this.root.level=0,this._diskWrite(this.root),this._updateRootNode(this.root),this.comparator=function(a,e){return a<e?-1:a>e?1:0},this.merger=null}};K.Tree.prototype._allocateNode=function(){return new K.Node};K.Tree.prototype._diskWrite=function(){};K.Tree.prototype._diskRead=function(a){return a};K.Tree.prototype._diskDelete=function(){};K.Tree.prototype._updateRootNode=function(a){return a};K.Tree.prototype.clear=function(){this.root=this._allocateNode();
this.root.isLeaf=!0;this.root.level=0;this._updateRootNode(this.root)};K.Tree.prototype.search=function(a,c){for(var e=!0,h=this.root;e;){for(var k=0;k<h.numberActives&&this.comparator(a,h.keys[k].key)===1;)k++;if(k<h.numberActives&&this.comparator(h.keys[k].key,a)===0)return c!=null&&c==!0?!0:h.keys[k].data;else h.isLeaf===!0?e=!1:h=this._diskRead(h.children[k])}return null};K.Tree.prototype.walk=function(a){this._walk(a,this.root)};K.Tree.prototype._walk=function(a,c){if(c.isLeaf)for(var e=0;e<
c.numberActives;e++)a(c.keys[e]);else{for(e=0;e<c.numberActives;e++)this._walk(a,this._diskRead(c.children[e])),a(c.keys[e]);this._walk(a,this._diskRead(c.children[c.numberActives]))}};K.Tree.prototype.walkNodes=function(a){this._walkNodes(a,this.root)};K.Tree.prototype._walkNodes=function(a,c){if(c.isLeaf)a(c);else{a(c);for(var e=0;e<c.numberActives;e++)this._walkNodes(a,this._diskRead(c.children[e]));this._walkNodes(a,this._diskRead(c.children[c.numberActives]))}};K.Tree.prototype._splitChild=function(a,
c,e){var h=this._allocateNode();h.isLeaf=e.isLeaf;h.level=e.level;h.numberActives=this.order-1;var k=e.keys[this.order-1];e.keys[this.order-1]=null;for(var j=0;j<this.order-1;j++)h.keys[j]=e.keys[j+this.order],e.keys[j+this.order]=null,e.isLeaf||(h.children[j]=e.children[j+this.order],e.children[j+this.order]=null);e.isLeaf||(h.children[j]=e.children[j+this.order],e.children[j+this.order]=null);e.numberActives=this.order-1;for(j=a.numberActives+1;j>c+1;j--)a.children[j]=a.children[j-1];a.children[c+
1]=h;for(j=a.numberActives;j>c;j--)a.keys[j]=a.keys[j-1];a.keys[c]=k;a.numberActives++;this._diskWrite(h);this._diskWrite(a);this._diskWrite(e)};K.Tree.prototype.insert=function(a,c){if(this.root.numberActives===2*this.order-1){var e=this._allocateNode();e.isLeaf=!1;e.level=this.root.level+1;e.numberActives=0;e.children[0]=this.root;this._splitChild(e,0,this.root);this.root=e;this._updateRootNode(this.root);this._insertNonFull(e,a,c)}else this._insertNonFull(this.root,a,c)};K.Tree.prototype._insertNonFull=
function(a,c,e){for(var h=a.numberActives-1;!a.isLeaf;){for(;h>=0&&this.comparator(c,a.keys[h].key)===-1;)h--;h++;var k=this._diskRead(a.children[h]);k.numberActives===2*this.order-1&&(this._splitChild(a,h,k),this.comparator(c,a.keys[h].key)===1&&h++);a=this._diskRead(a.children[h]);h=a.numberActives-1}for(;h>=0&&this.comparator(c,a.keys[h].key)===-1;)a.keys[h+1]=a.keys[h],h--;a.keys[h+1]={key:c,data:e};a.numberActives++;this._diskWrite(a)};K.Tree.prototype["delete"]=function(a){for(var c=this.root,
e=null,h=!0,k=null,j=null,i=null,g=!0;g===!0;){for(g=!1;h===!0;){r=0;if(c.numberActives===0)return!1;for(;r<c.numberActives&&this.comparator(a,c.keys[r].key)===1;)r++;k=r;r<c.numberActives&&this.comparator(a,c.keys[r].key)===0&&(h=!1);if(h===!0){if(c.isLeaf===!0)return!1;e=c;c=this._diskRead(c.children[r]);if(c===null)return!1;k===e.numberActives?(j=this._diskRead(e.children[k-1]),i=null):k===0?(j=null,i=this._diskRead(e.children[1])):(j=this._diskRead(e.children[k-1]),i=this._diskRead(e.children[k+
1]));c.numberActives===this.order-1&&e!=null&&(i!=null&&i.numberActives>this.order-1?this._moveKey(e,r,-1):j!=null&&j.numberActives>this.order-1?this._moveKey(e,r,1):j!=null&&j.numberActives===this.order-1?c=this._mergeSiblings(e,r,-1):i!=null&&i.numberActives===this.order-1&&(c=this._mergeSiblings(e,r,1)))}}if(c.isLeaf&&c.numberActives>this.order-1)return this._deleteKeyFromNode(c,k),!0;if(c.isLeaf&&c===this.root)return this._deleteKeyFromNode(c,k),!0;if(c.isLeaf===!1)if(e=r=null,(r=this._diskRead(c.children[k])).numberActives>
this.order-1)a=this._getMaxKeyPos(r),a=a.node.keys[a.index],c.keys[k]=a,this._diskWrite(c),c=r,a=a.key,h=g=!0;else if((r=this._diskRead(c.children[k+1])).numberActives>this.order-1)a=this._getMinKeyPos(r),a=a.node.keys[a.index],c.keys[k]=a,this._diskWrite(c),c=r,a=a.key,h=g=!0;else if((r=this._diskRead(c.children[k])).numberActives===this.order-1&&(e=this._diskRead(c.children[k+1])).numberActives===this.order-1){h=this._mergeNodes(r,c.keys[k],e);c.children[k]=h;k++;for(var r=k;r<c.numberActives;r++)c.children[r]=
c.children[r+1],c.keys[r-1]=c.keys[r];c.children[r]=null;c.keys[r-1]=null;c.numberActives--;if(c.numberActives===0&&this.root===c)this.root=h;this._diskWrite(c);c=h;h=g=!0}c.isLeaf&&c.numberActives>this.order-1&&h===!1&&this._deleteKeyFromNode(c,k);if(g===!1)return!0}};K.Tree.prototype._moveKey=function(a,c,e){e===1&&c--;var h=this._diskRead(a.children[c]),k=this._diskRead(a.children[c+1]);if(e==-1){h.keys[h.numberActives]=a.keys[c];h.children[h.numberActives+1]=k.children[0];k.children[0]=null;h.numberActives++;
a.keys[c]=k.keys[0];for(e=1;e<k.numberActives;e++)k.keys[e-1]=k.keys[e],k.children[e-1]=k.children[e];k.children[k.numberActives-1]=k.children[k.numberActives];k.numberActives--}else{k.children[k.numberActives+1]=k.children[k.numberActives];for(e=k.numberActives;e>0;e--)k.children[e]=k.children[e-1],k.keys[e]=k.keys[e-1];k.keys[0]=null;k.children[0]=null;k.children[0]=h.children[h.numberActives];k.keys[0]=a.keys[c];k.numberActives++;h.children[h.numberActives]=null;a.keys[c]=h.keys[h.numberActives-
1];h.keys[h.numberActives-1]=null;h.numberActives--}this._diskWrite(h);this._diskWrite(k);this._diskWrite(a)};K.Tree.prototype._mergeSiblings=function(a,c){var e,h,k;c===a.numberActives?(c--,h=this._diskRead(a.children[a.numberActives-1]),k=this._diskRead(a.children[a.numberActives])):(h=this._diskRead(a.children[c]),k=this._diskRead(a.children[c+1]));var j=this._allocateNode();j.isLeaf=h.isLeaf;j.level=h.level;for(e=0;e<this.order-1;e++)j.keys[e]=h.keys[e],j.children[e]=h.children[e];j.keys[this.order-
1]=a.keys[c];j.children[this.order-1]=h.children[this.order-1];for(e=0;e<this.order-1;e++)j.keys[e+this.order]=k.keys[e],j.children[e+this.order]=k.children[e];j.children[2*this.order-1]=k.children[this.order-1];a.children[c]=j;for(e=c;e<a.numberActives;e++)a.keys[e]=a.keys[e+1],a.children[e+1]=a.children[e+2];j.numberActives=h.numberActives+k.numberActives+1;a.numberActives--;for(e=a.numberActives;e<2*this.order-1;e++)a.keys[e]=null;if(a.numberActives===0&&this.root===a)this.root=j,j.isLeaf=j.level?
!1:!0;this._diskWrite(j);this.root===j&&this._updateRootNode(this.root);this._diskWrite(a);this._diskDelete(h);this._diskDelete(k);return j};K.Tree.prototype._deleteKeyFromNode=function(a,c){var e=2*this.order-1;if(a.numberActives<e)e=a.numberActives;var h;if(a.isLeaf===!1)return!1;for(h=c;h<e-1;h++)a.keys[h]=a.keys[h+1];a.keys.pop();a.numberActives--;this._diskWrite(a);return!0};K.Tree.prototype._mergeNodes=function(a,c,e){var h,k;h=this._allocateNode();h.isLeaf=!0;for(k=0;k<a.numberActives;k++)h.keys[k]=
a.keys[k],h.children[k]=a.children[k];h.children[a.numberActives]=a.children[a.numberActives];h.keys[a.numberActives]=c;for(k=0;k<e.numberActives;k++)h.keys[k+a.numberActives+1]=e.keys[k],h.children[k+a.numberActives+1]=e.children[k];h.children[2*this.order-1]=e.children[e.numberActives];h.numberActives=a.numberActives+e.numberActives+1;h.isLeaf=a.isLeaf;h.level=a.level;this._diskWrite(h);return h};K.Tree.prototype.audit=function(a){var c=[],e=[],h=this,k=function(j){for(var k=0;k<e.length;k++)if(h.comparator(e[k],
j)===0){var g=" !!! duplicated key "+j;a===!0&&console.log(g);c.push(g)}},j=null,h=this;this.walkNodes(function(i){a===!0&&(console.log("--- Node at "+i.level+" level"),console.log(" - leaf? "+i.isLeaf),console.log(" - num actives? "+i.numberActives),console.log(" - keys: "));for(var g=i.numberActives;g<i.keys.length;g++)i.keys[g]!=null&&a===!0&&(console.log(" * warning : redundant key data"),c.push(" * warning : redundant key data"));for(g=i.numberActives+1;g<i.children.length;g++)i.children[g]!=
null&&a===!0&&(console.log(" * warning : redundant children data"),c.push(" * warning : redundant key data"));if(i.isLeaf===!1)for(g=0;g<i.numberActives;g++){var r=h._diskRead(i.children[g]).keys[h._diskRead(i.children[g]).numberActives-1].key,u=h._diskRead(i.children[g+1]).keys[0].key;a===!0&&console.log("   "+i.keys[g].key+"("+r+","+u+")");if(h.comparator(i.keys[g].key,r)===-1){var t=" !!! value max left "+r+" > key "+i.keys[g].key;a===!0&&console.log(t);c.push(t)}h.comparator(i.keys[g].key,u)===
1&&(t=" !!! value min right "+u+" < key "+i.keys[g].key,a===!0&&console.log(t),c.push(t));k(i.keys[g].key);e.push(i.keys[g].key)}else{j===null?j=i.level:j!=i.level&&(t=" !!! Leaf node with wrong level value",a===!0&&console.log(t),c.push(t));for(g=0;g<i.numberActives;g++)a===!0&&console.log(" "+i.keys[g].key),k(i.keys[g].key),e.push(i.keys[g].key)}i!=h.root&&(i.numberActives>2*h.order-1&&(a===!0&&(t=" !!!! MAX num keys restriction violated "),console.log(t),c.push(t)),i.numberActives<h.order-1&&(a===
!0&&(t=" !!!! MIN num keys restriction violated "),console.log(t),c.push(t)))});return c};K.Tree.prototype._getMaxKeyPos=function(a){for(var c={};;){if(a===null)break;if(a.isLeaf===!0){c.node=a;c.index=a.numberActives-1;break}else c.node=a,c.index=a.numberActives-1,a=this._diskRead(a.children[a.numberActives])}return c};K.Tree.prototype._getMinKeyPos=function(a){for(var c={};;){if(a===null)break;if(a.isLeaf===!0){c.node=a;c.index=0;break}else c.node=a,c.index=0,a=this._diskRead(a.children[0])}return c};
K.Node=function(){this.numberActives=0;this.isLeaf=null;this.keys=[];this.children=[];this.level=0};var S={NodeKey:function(a,c){this.subject=a.subject;this.predicate=a.predicate;this.object=a.object;this.graph=a.graph;this.order=c}};S.NodeKey.prototype.comparator=function(a){for(var c=0;c<this.order.length;c++){var e=this.order[c];if(a[e]==null)break;else if(this[e]<a[e])return-1;else if(this[e]>a[e])return 1}return 0};S.Pattern=function(a){this.subject=a.subject;this.predicate=a.predicate;this.object=
a.object;this.graph=a.graph;this.indexKey=[];this.keyComponents={};for(var c=[],e=[],a=["subject","predicate","object","graph"],h=0;h<a.length;h++)typeof this[a[h]]==="string"?(e.push(a[h]),this.keyComponents[a[h]]=null):(c.push(a[h]),this.keyComponents[a[h]]=this[a[h]],this.indexKey.push(a[h]));this.order=c.concat(e);this.key=new S.NodeKey(this.keyComponents,this.order)};var X={Tree:function(a,c){if(arguments!=0)this.componentOrder=a.componentOrder,K.Tree.call(this,a.order,a.name,a.persistent,a.cacheMaxSize),
this.comparator=function(a,c){for(var k=0;k<this.componentOrder.length;k++){var j=this.componentOrder[k],i=a[j],j=c[j];if(i<j)return-1;else if(i>j)return 1}return 0},this.rangeComparator=function(a,c){for(var k=0;k<this.componentOrder.length;k++){var j=this.componentOrder[k];if(c[j]==null||a[j]==null)break;else if(a[j]<c[j])return-1;else if(a[j]>c[j])return 1}return 0},c!=null&&c(this)}};y["extends"](K.Tree,X.Tree);X.Tree.prototype.insert=function(a,c){K.Tree.prototype.insert.call(this,a,null);c&&
c(!0);return!0};X.Tree.prototype.search=function(a,c){var e=K.Tree.prototype.search.call(this,a,!0);c&&c(e);return e};X.Tree.prototype.range=function(a,c){var e=null,e=typeof this.root==="string"?this._rangeTraverse(this,this._diskRead(this.root),a):this._rangeTraverse(this,this.root,a);c&&c(e);return e};X.Tree.prototype._rangeTraverse=function(a,c,e){for(var e=e.key,h=[],k=[c],j;k.length>0;){c=k.shift();for(j=0;j<c.numberActives&&a.rangeComparator(c.keys[j].key,e)===-1;)j++;if(c.isLeaf===!0)for(;j<
c.numberActives&&a.rangeComparator(c.keys[j].key,e)===0;)h.push(c.keys[j].key),j++;else{var i=a._diskRead(c.children[j]);for(k.push(i);;)if(j<c.numberActives&&a.rangeComparator(c.keys[j].key,e)===0)h.push(c.keys[j].key),j++,i=a._diskRead(c.children[j]),k.push(i);else break}}return h};var U={QuadBackend:function(a,c){if(arguments!=0){this.indexMap={};this.treeOrder=a.treeOrder;this.indices=["SPOG","GP","OGS","POG","GSP","OS"];this.componentOrders={SPOG:["subject","predicate","object","graph"],GP:["graph",
"predicate","subject","object"],OGS:["object","graph","subject","predicate"],POG:["predicate","object","graph","subject"],GSP:["graph","subject","predicate","object"],OS:["object","subject","predicate","graph"]};for(var e=0;e<this.indices.length;e++){var h=this.indices[e];this.indexMap[h]=new X.Tree({order:this.treeOrder,componentOrder:this.componentOrders[h],persistent:a.persistent,name:(a.name||"")+h,cacheMaxSize:a.cacheMaxSize})}c&&c(this)}}};U.QuadBackend.prototype.clear=function(){for(var a=
0;a<this.indices.length;a++)this.indexMap[this.indices[a]].clear()};U.QuadBackend.prototype._indexForPattern=function(a){for(var a=a.indexKey,c=this.indices,e=0;e<c.length;e++)for(var h=c[e],k=this.componentOrders[h],j=0;j<k.length;j++){if(y.include(a,k[j])===!1)break;if(j==a.length-1)return h}return"SPOG"};U.QuadBackend.prototype.index=function(a,c){for(var e=0;e<this.indices.length;e++)this.indexMap[this.indices[e]].insert(a);c&&c(!0);return!0};U.QuadBackend.prototype.range=function(a,c){var e=
this.indexMap[this._indexForPattern(a)].range(a);c&&c(e);return e};U.QuadBackend.prototype.search=function(a,c){var e=this.indexMap[this.indices[0]].search(a);c&&c(e!=null);return e!=null};U.QuadBackend.prototype["delete"]=function(a,c){for(var e,h=0;h<this.indices.length;h++)e=this.indices[h],e=this.indexMap[e],e["delete"](a);c&&c(!0);return!0};var I={Lexicon:function(a){this.uriToOID={};this.OIDToUri={};this.literalToOID={};this.OIDToLiteral={};this.blankToOID={};this.OIDToBlank={};this.defaultGraphOid=
0;this.defaultGraphUri="https://github.com/antoniogarrote/rdfstore-js#default_graph";this.defaultGraphUriTerm={token:"uri",prefix:null,suffix:null,value:this.defaultGraphUri,oid:this.defaultGraphOid};this.oidCounter=1;this.knownGraphs={};a!=null&&a(this)}};I.Lexicon.prototype.registerGraph=function(a){a!=this.defaultGraphOid&&(this.knownGraphs[a]=!0);return!0};I.Lexicon.prototype.registeredGraphs=function(a){var c=[],e;for(e in this.knownGraphs)a===!0?c.push(this.OIDToUri["u"+e]):c.push(e);return c};
I.Lexicon.prototype.registerUri=function(a){if(a===this.defaultGraphUri)return this.defaultGraphOid;else{if(this.uriToOID[a]==null){var c=this.oidCounter;this.oidCounter++;this.uriToOID[a]=[c,0];this.OIDToUri["u"+c]=a}else{var e=this.uriToOID[a],c=e[0];this.uriToOID[a]=[c,e[1]+1]}return c}};I.Lexicon.prototype.resolveUri=function(a){return a===this.defaultGraphUri?this.defaultGraphOid:(a=this.uriToOID[a],a!=null?a[0]:-1)};I.Lexicon.prototype.resolveUriCost=function(a){return a===this.defaultGraphUri?
this.defaultGraphOid:(a=this.uriToOID[a],a!=null?a[1]:-1)};I.Lexicon.prototype.registerBlank=function(){var a=this.oidCounter;this.oidCounter++;a=""+a;this.OIDToBlank[a]=!0;return a};I.Lexicon.prototype.resolveBlank=function(){var a=this.oidCounter;this.oidCounter++;return""+a};I.Lexicon.prototype.resolveBlankCost=function(){return 0};I.Lexicon.prototype.registerLiteral=function(a){if(this.literalToOID[a]==null){var c=this.oidCounter;this.oidCounter++;this.literalToOID[a]=[c,0];this.OIDToLiteral["l"+
c]=a}else{var e=this.literalToOID[a],c=e[0];this.literalToOID[a]=[c,e[1]+1]}return c};I.Lexicon.prototype.resolveLiteral=function(a){a=this.literalToOID[a];return a!=null?a[0]:-1};I.Lexicon.prototype.resolveLiteralCost=function(a){a=this.literalToOID[a];return a!=null?a[1]:0};I.Lexicon.prototype.parseLiteral=function(a){var c=a.lastIndexOf("@");if(c!=-1&&a[c-1]==='"'&&a.substring(c,a.length).match(/^@[a-zA-Z\-]+$/g)!=null){var e=a.substring(1,c-1),a=a.substring(c+1,a.length);return{token:"literal",
value:e,lang:a}}c=a.lastIndexOf("^^");if(c!=-1&&a[c-1]==='"'&&a[c+2]==="<"&&a[a.length-1]===">")return e=a.substring(1,c-1),a=a.substring(c+3,a.length-1),{token:"literal",value:e,type:a};e=a.substring(1,a.length-1);return{token:"literal",value:e}};I.Lexicon.prototype.parseUri=function(a){return{token:"uri",value:a}};I.Lexicon.prototype.retrieve=function(a){try{if(a===this.defaultGraphOid)return{token:"uri",value:this.defaultGraphUri,prefix:null,suffix:null,defaultGraph:!0};else{var c=this.OIDToUri["u"+
a];if(c!=null)return this.parseUri(c);else{var e=this.OIDToLiteral["l"+a];if(e!=null)return this.parseLiteral(e);else if(this.OIDToBlank[""+a]!=null)return{token:"blank",value:"_:"+a};else throw"Null value for OID";}}}catch(h){throw console.log("error in lexicon retrieving OID:"),console.log(a),h.message||h.stack?(h.message&&console.log(h.message),h.stack&&console.log(h.stack)):console.log(h),Error("Unknown retrieving OID in lexicon:"+a);}};I.Lexicon.prototype.clear=function(){this.uriToOID={};this.OIDToUri=
{};this.literalToOID={};this.OIDToLiteral={};this.blankToOID={};this.OIDToBlank={}};I.Lexicon.prototype.unregister=function(a,c){try{return this.unregisterTerm(a.subject.token,c.subject),this.unregisterTerm(a.predicate.token,c.predicate),this.unregisterTerm(a.object.token,c.object),a.graph!=null&&this.unregisterTerm(a.graph.token,c.graph),!0}catch(e){return console.log("Error unregistering quad"),console.log(e.message),!1}};I.Lexicon.prototype.unregisterTerm=function(a,c){if(a==="uri"){if(c!=this.defaultGraphOid){var e=
"u"+c,h=this.OIDToUri[e],k=this.uriToOID[h],j=k[1];if(""+k[0]===""+c)j===0?(delete this.OIDToUri[e],delete this.uriToOID[h],delete this.knownGraphs[c]):this.uriToOID[h]=[c,j-1];else throw"Not matching OID : "+c+" vs "+k[0];}}else if(a==="literal")if(this.oidCounter++,e="l"+c,h=this.OIDToLiteral[e],k=this.literalToOID[h],j=k[1],""+k[0]===""+c)j===0?(delete this.OIDToLiteral[e],delete this.literalToOID[h]):this.literalToOID[h]=[c,j-1];else throw"Not matching OID : "+c+" vs "+k[0];else a==="blank"&&
delete this.OIDToBlank[""+c]};var O={};O.load=function(a,c,e){jQuery.ajax({url:a,headers:{Accept:c},success:function(a,c,j){if((""+j.status)[0]=="2"){for(var c=j.getAllResponseHeaders().split("\n"),j={},i=0;i<c.length;i++){var g=c[i].split(":");j[g[0]]=g[1]}e(!0,{headers:j,data:a})}},error:function(a){(""+a.status)[0]=="3"?redirection==0?e(!1,500):(a=a.getAllResponseHeaders().Location||a.getAllResponseHeaders().location,a!=null?O.load(a,c,e,redirection-1):e(!1,500)):e(!1,a.statusCode())}})};var ra=
null;(function(){var a=function(a,c){a.stack="";for(var j in c)a[j]=c[j]};if(typeof window!=="undefined"){var c=window.jsonld=window.jsonld||{};Exception=function(c){a(this,c)};if(!Object.keys)Object.keys=function(a){if(a!==Object(a))throw new TypeError("Object.keys called on non-object");var c=[],j;for(j in a)Object.prototype.hasOwnProperty.call(a,j)&&c.push(j);return c};if(!Array.prototype.filter)Array.prototype.filter=function(a,c){if(this==null)throw new TypeError;var j=Object(this),e=j.length>>>
0;if(typeof a!="function")throw new TypeError;for(var h=[],i=0;i<e;i++)if(i in j){var k=j[i];a.call(c,k,i,j)&&h.push(k)}return h}}else typeof module!=="undefined"&&module.exports&&(c={},Exception=function(c){a(this,c);this.stack=Error().stack});ra=c;var e={rdf:"http://www.w3.org/1999/02/22-rdf-syntax-ns#",rdfs:"http://www.w3.org/2000/01/rdf-schema#",owl:"http://www.w3.org/2002/07/owl#",xsd:"http://www.w3.org/2001/XMLSchema#",dcterms:"http://purl.org/dc/terms/",foaf:"http://xmlns.com/foaf/0.1/",cal:"http://www.w3.org/2002/12/cal/ical#",
vcard:"http://www.w3.org/2006/vcard/ns# ",geo:"http://www.w3.org/2003/01/geo/wgs84_pos#",cc:"http://creativecommons.org/ns#",sioc:"http://rdfs.org/sioc/ns#",doap:"http://usefulinc.com/ns/doap#",com:"http://purl.org/commerce#",ps:"http://purl.org/payswarm#",gr:"http://purl.org/goodrelations/v1#",sig:"http://purl.org/signature#",ccard:"http://purl.org/commerce/creditcard#"},h={xsd:"http://www.w3.org/2001/XMLSchema#"},k={"boolean":h.xsd+"boolean","double":h.xsd+"double",integer:h.xsd+"integer"},j=function(a,
c,j){c in a?a[c].constructor===Array?a[c].push(j):a[c]=[a[c],j]:a[c]=j},i=function(a){var c;if(a.constructor===Object){c={};var j=Object.keys(a).sort(),e;for(e in j){var h=j[e];c[h]=i(a[h])}}else if(a.constructor===Array)for(e in c=[],a)c[e]=i(a[e]);else c=a;return c},g=function(a){var c={"@id":"@id","@language":"@language","@literal":"@literal","@type":"@type"};if(a){var j={},e;for(e in a)a[e].constructor===String&&a[e]in c&&(j[a[e]]=e);for(e in j)c[e]=j[e]}return c},r=function(a,c){var j=null;c in
a&&(a[c].constructor===String?j=a[c]:a[c].constructor===Object&&"@id"in a[c]&&(j=a[c]["@id"]));return j},u=function(a,c,j){var e=null,h;for(h in a)if(h.length>0&&h[0]!=="@"&&c===r(a,h)){e=h;j!==null&&(j[h]=i(a[h]));break}e===null&&c==="@type"&&(e=g(a)["@type"]);if(e===null)for(h in a)if(h.length>0&&h[0]!=="@"){var k=r(a,h);if(k!==null&&c.indexOf(k)===0&&c.length>k.length){e=h+":"+c.substr(k.length);j!==null&&(j[h]=i(a[h]));break}}e===null&&(e=c);return e},t=function(a,c,j){var e=c,h=g(a),k=c.indexOf(":");
if(k!==-1)h=c.substr(0,k),h in a&&(e=r(a,h)+c.substr(k+1),j!==null&&(j[h]=i(a[h])));else if(c in a)e=r(a,c),j!==null&&(j[c]=i(a[c]));else for(var t in h)if(c===h[t]){e=t;break}return e},w=function(a){var c=!1;a!==null&&a.constructor===Object&&!("@literal"in a)&&(c=Object.keys(a).length>1||!("@id"in a));return c};c.normalize=function(a){return(new D).normalize(a)};c.expand=function(a){return(new D).expand({},null,a)};c.compact=function(a,j){var e=null;if(j!==null){var j=c.expand(j),h;j.constructor===
Array?(e=[],h=j):h=[j];a.constructor===Array&&(a=c.mergeContexts({},a));for(var k in h){var g={},l=(new D).compact(i(a),null,h[k],g);if(Object.keys(g).length>0){var t=g,g={},r=Object.keys(t).sort(),u=void 0;for(u in r){var w=r[u];g[w]=t[w]}t=Object.keys(l);t.sort();t.unshift("@context");l["@context"]=g;var g={},y;for(y in t)r=t[y],g[r]=l[r];l=g}e===null?e=l:e.push(l)}}return e};c.mergeContexts=function(a,j){a.constructor===Array&&(a=c.mergeContexts({},a));var e=i(a);if(j.constructor===Array)for(var h in j)e=
c.mergeContexts(e,j[h]);else{for(var k in j)if(k.indexOf("@")!==0)for(var g in e)if(e[g]===j[k]){delete e[g];break}for(k in j)e[k]=i(j[k])}return e};c.expandTerm=t;c.compactIri=function(a,c){return u(a,c,null)};c.frame=function(a,c,j){return(new D).frame(a,c,j)};c.toTriples=function(a,j,e){var h=null,a=c.normalize(a),e=e||null;e===null&&(h=[],e=function(a,c,e){h.push({subject:y.lexicalFormTerm(a),predicate:y.lexicalFormTerm(c),object:y.lexicalFormTerm(e),graph:j})});var i=!1,k;for(k in a){var g=a[k],
l=g["@id"],l=l[0]=="_"?{token:"blank",value:l.split(":")[1]}:{token:"uri",value:l},t;for(t in g)if(t!=="@id"){var r=g[t];r.constructor!==Array&&(r=[r]);for(var u in r)if(i=r[u],t==="@type"||t==="http://www.w3.org/1999/02/22-rdf-syntax-ns#type"?(t="http://www.w3.org/1999/02/22-rdf-syntax-ns#type",i={token:"uri",value:i}):typeof i==="string"?i={token:"literal",value:i}:i["@id"]!=null?i=i["@id"][0]=="_"?{token:"blank",value:i["@id"].split(":")[1]}:{token:"uri",value:i["@id"]}:i["@type"]!=null?i={token:"literal",
value:i["@literal"],type:i["@type"]}:i["@language"]!=null&&(i={token:"literal",value:i["@literal"],lang:i["@language"]}),i=e(l,{token:"uri",value:t},i)===!1)break;if(i)break}if(i)break}return h};c.resolve=function(a,c,j){var e={},h=function(a,c){if(a.constructor===Array)for(var j in a)h(a[j]);else if(a.constructor===Object)for(var i in a)if(i==="@context")if(a[i].constructor===Array){var k=a[i];for(j in k)k[j].constructor===String&&(c?k[j]=e[k[j]]:e[k[j]]={})}else a[i].constructor===String&&(c?a[i]=
e[a[i]]:e[a[i]]={})};h(a,!1);var i=Object.keys(e).length,k=null;if(i===0)j(a,k);else for(var g in e)c(g,function(c,l){--i;if(c===null)k=k||[],k.push({url:g,error:l});else try{e[g]=c.constructor===String?JSON.parse(c)["@context"]:c["@context"]}catch(t){k=k||[],k.push({url:g,error:t})}i===0&&(k===null&&h(a,!0),j(a,k))})};var D=function(){};D.prototype.compact=function(a,c,j,e){var h,t=g(a);if(j===null)h=null,this.getCoerceType(a,c,e);else if(j.constructor===Array){h=[];for(var r in j)h.push(this.compact(a,
c,j[r],e))}else if(j.constructor===Object&&"@id"in j&&j["@id"].constructor===Array)h={},h[t["@id"]]=this.compact(a,c,j["@id"],e);else if(w(j)){h={};for(var y in j)if(j[y]!=="@context"&&(t=u(a,y,e),t!==y||!(t in h)))h[t]=this.compact(a,y,j[y],e)}else{c=this.getCoerceType(a,c,e);r=null;j.constructor===Object?"@language"in j||(r="@type"in j?j["@type"]:"@id"in j?"@id":c):j.constructor===String&&(r=c);if(c===null&&(r===k["boolean"]||r===k.integer||r===k["double"]))c=r;if(c!==null)if(r===null)throw{message:"Cannot coerce type when a language is specified. The language information would be lost."};
else if(r!==c)throw new Exception({message:"Cannot coerce type because the type does not match.",type:r,expected:c});else j.constructor===Object?"@id"in j?h=j["@id"]:"@literal"in j&&(h=j["@literal"]):h=j,c===k["boolean"]?h=h==="true"||h!=0:c===k["double"]?h=parseFloat(h):c===k.integer&&(h=parseInt(h));else if(j.constructor===Object)for(y in h={},j)h[t[y]]=j[y];else h=i(j);r==="@id"&&(h.constructor===Object?h[t["@id"]]=u(a,h[t["@id"]],e):h=u(a,h,e))}return h};D.prototype.expand=function(a,e,h){var r;
if(h===null)r=null;else if(e===null&&h.constructor===String)r=t(a,h,null);else if(h.constructor===Array){r=[];for(var u in h)r.push(this.expand(a,e,h[u]))}else if(h.constructor===Object){"@context"in h&&(a=c.mergeContexts(a,h["@context"]));r={};for(var w in h)w==="@embed"||w==="@explicit"||w==="@default"||w==="@omitDefault"?j(r,w,i(h[w])):w!=="@context"&&j(r,t(a,w,null),this.expand(a,w,h[w]))}else{u=this.getCoerceType(a,e,null);r=g(a);if(u===null&&(h.constructor===Number||h.constructor===Boolean))u=
h.constructor===Boolean?k["boolean"]:(""+h).indexOf(".")==-1?k.integer:k["double"];e===r["@id"]||e===r["@type"]?r=t(a,h,null):u!==null?(r={},u==="@id"?r["@id"]=t(a,h,null):(r["@type"]=u,u===k["double"]&&(h=h.toExponential(6).replace(/(e(?:\+|-))([0-9])$/,"$10$2")),r["@literal"]=""+h)):r=""+h}return r};D.prototype.normalize=function(a){var c=[];if(a!==null){this.ng={tmp:null,c14n:null};var j=this.expand(e,null,a);this.nameBlankNodes(j);a={};J(null,null,j,a);for(var h in a){var j=a[h],i={},k=Object.keys(j).sort(),
g;for(g in k){var l=k[g];i[l]=j[l]}c.push(i)}this.canonicalizeBlankNodes(c);c.sort(function(a,c){return F(a["@id"],c["@id"])})}return c};D.prototype.getCoerceType=function(a,c,j){var e=null,c=t(a,c,null);c==="@id"||c==="@type"?e="@id":(c=u(a,c,null),c in a&&a[c].constructor===Object&&"@type"in a[c]&&(e=t(a,a[c]["@type"],j),j!==null&&(j[c]=i(a[c]))));return e};var A=function(a){return a.indexOf("_:")===0},C=function(a){return a.constructor===Object&&"@id"in a&&A(a["@id"])},F=function(a,c){var j=0;
if(a.constructor===Array&&c.constructor===Array)for(var e=0;e<a.length&&j===0;++e)j=F(a[e],c[e]);else j=a<c?-1:a>c?1:0;return j},E=function(a,c,j){var e=0;j in a?e=j in c?F(a[j],c[j]):-1:j in c&&(e=1);return e},B=function(a,c){var j=0;a.constructor===String?j=c.constructor!==String?-1:F(a,c):c.constructor===String?j=1:(j=E(a,c,"@literal"),j===0&&("@literal"in a?(j=E(a,c,"@type"),j===0&&(j=E(a,c,"@language"))):j=F(a["@id"],c["@id"])));return j},G=function(a,c){var j=0,e;for(e in a)if(e!=="@id"){j=
F(a[e].constructor===Array?a[e].length:1,c[e].constructor===Array?c[e].length:1);if(j===0){var h=a[e],i=c[e];h.constructor!==Array&&(h=[h],i=[i]);h=h.filter(function(a){return!C(a)});i=i.filter(function(a){return!C(a)});j=F(h.length,i.length)}if(j===0){h.sort(B);i.sort(B);for(var k=0;k<h.length&&j===0;++k)j=B(h[k],i[k])}if(j!==0)break}return j},K=function(a){var c=-1,j={next:function(){++c;return j.current()},current:function(){return"_:"+a+c},inNamespace:function(c){return c.indexOf("_:"+a)===0}};
return j},L=function(a,c,j){if(a!==null)if(a.constructor===Array)for(var e in a)L(a[e],c,j);else if(a.constructor===Object){"@id"in a?a["@id"].constructor==Array?L(a["@id"],c,j):w(a)&&(c[a["@id"]]=a):w(a)&&(!("@id"in a)||C(a))&&j.push(a);for(var h in a)L(a[h],c,j)}},J=function(a,c,j,e){var h=null;if(j!==null)if(j.constructor===Array)for(var k in j)J(a,c,j[k],e);else if(j.constructor===Object)if("@literal"in j||c==="@type")h=i(j);else if(j["@id"].constructor===Array){if(a!==null)throw{message:"Embedded graph literals cannot be flattened."};
for(var g in j["@id"])J(a,c,j["@id"][g],e)}else{j["@id"]in e?k=e[j["@id"]]:(k={"@id":j["@id"]},e[j["@id"]]=k);var h={"@id":k["@id"]},l;for(l in j)g=j[l],g!==null&&l!=="@id"&&(l in k?k[l].constructor!==Array&&(k[l]=[k[l]]):k[l]=[],J(k[l],l,g,e),k[l].length===1&&(k[l]=k[l][0]))}else h=j;h!==null&&a!==null&&(a.constructor===Array?(c=!1,h.constructor===Object&&"@id"in h&&(c=a.filter(function(a){return a.constructor===Object&&"@id"in a&&a["@id"]===h["@id"]}).length>0),c||a.push(h)):a[c]=h)};D.prototype.nameBlankNodes=
function(a){var c=this.ng.tmp=K("tmp"),j={},e=[];L(a,j,e);for(var h in e)if(a=e[h],!("@id"in a)){for(;c.next()in j;);a["@id"]=c.current();j[c.current()]=a}};D.prototype.renameBlankNode=function(a,c){var j=a["@id"];a["@id"]=c;var e=this.subjects;e[c]=e[j];delete e[j];this.edges.refs[c]=this.edges.refs[j];this.edges.props[c]=this.edges.props[j];delete this.edges.refs[j];delete this.edges.props[j];var h=this.edges.refs[c].all,i;for(i in h){var k=h[i].s;k===j&&(k=c);var g=e[k],l=this.edges.props[k].all,
r;for(r in l)if(l[r].s===j){l[r].s=c;var k=l[r].p,k=g[k].constructor===Object?[g[k]]:g[k].constructor===Array?g[k]:[],t;for(t in k)k[t].constructor===Object&&"@id"in k[t]&&k[t]["@id"]===j&&(k[t]["@id"]=c)}}l=this.edges.props[c].all;for(i in l){var k=l[i].s,h=this.edges.refs[k].all,u;for(u in h)if(h[u].s===j)h[u].s=c}};D.prototype.canonicalizeBlankNodes=function(a){this.renamed={};this.mappings={};this.serializations={};var c=this.edges={refs:{},props:{}},j=this.subjects={},e=[],h;for(h in a){var i=
a[h]["@id"];j[i]=a[h];c.refs[i]={all:[],bnodes:[]};c.props[i]={all:[],bnodes:[]};A(i)&&e.push(a[h])}this.collectEdges();var a=this.ng.c14n=K("c14n"),k=this.ng.tmp;for(h in e){var g=e[h],i=g["@id"];if(a.inNamespace(i)){for(;k.next()in j;);this.renameBlankNode(g,k.current());i=g["@id"]}this.serializations[i]={props:null,refs:null}}for(var k=!0,l=this;e.length>0;){k&&(k=!1,e.sort(function(a,c){return l.deepCompareBlankNodes(a,c)}));var g=e.shift(),i=g["@id"],g=["props","refs"],r;for(r in g){var t=g[r];
if(this.serializations[i][t]===null){var u={};u[i]="s1"}else u=this.serializations[i][t].m;var w=Object.keys(u);w.sort(function(a,c){return F(u[a],u[c])});var y=[];for(h in w){var D=w[h];!a.inNamespace(i)&&D in j&&(this.renameBlankNode(j[D],a.next()),y.push(D))}w=e;e=[];for(h in w){var D=w[h],N=D["@id"];if(!a.inNamespace(N)){for(var C in y)this.markSerializationDirty(N,y[C],t)&&(k=!0);e.push(D)}}}}for(var E in c.props)if(c.props[E].bnodes.length>0){var g=j[E],G;for(G in g)G.indexOf("@")!==0&&g[G].constructor===
Array&&g[G].sort(B)}};MappingBuilder=function(){this.count=1;this.processed={};this.mapping={};this.adj={};this.keyStack=[{keys:["s1"],idx:0}];this.done={};this.s=""};MappingBuilder.prototype.copy=function(){var a=new MappingBuilder;a.count=this.count;a.processed=i(this.processed);a.mapping=i(this.mapping);a.adj=i(this.adj);a.keyStack=i(this.keyStack);a.done=i(this.done);a.s=this.s;return a};MappingBuilder.prototype.mapNode=function(a){a in this.mapping||(this.mapping[a]=a.indexOf("_:c14n")===0?"c"+
a.substr(6):"s"+this.count++);return this.mapping[a]};MappingBuilder.prototype.serialize=function(a,c){if(this.keyStack.length>0)for(var j=this.keyStack.pop();j.idx<j.keys.length;++j.idx){var e=j.keys[j.idx];if(!(e in this.adj)){this.keyStack.push(j);break}if(e in this.done)this.s+="_"+e;else{this.done[e]=!0;var h=e,e=this.adj[e],i=e.i;if(i in a){var k=a[i],g="",l=!0,r=void 0;for(r in k)if(r!=="@id"){l?l=!1:g+="|";g+="<"+r+">";var t=k[r].constructor===Array?k[r]:[k[r]],u;for(u in t){var w=t[u];w.constructor===
Object?"@id"in w?g+=A(w["@id"])?"_:":"<"+w["@id"]+">":(g+='"'+w["@literal"]+'"',"@type"in w?g+="^^<"+w["@type"]+">":"@language"in w&&(g+="@"+w["@language"])):g+='"'+w+'"'}}h+="["+g+"]";k=!0;h+="[";var i=c.refs[i].all,y;for(y in i)k?k=!1:h+="|",h+="<"+i[y].p+">",h+=A(i[y].s)?"_:":"<"+i[y].s+">";h+="]"}h+=e.k.join("");this.s+=h;this.keyStack.push({keys:e.k,idx:0});this.serialize(a,c)}}};D.prototype.markSerializationDirty=function(a,c,j){var e=!1,a=this.serializations[a];a[j]!==null&&c in a[j].m&&(a[j]=
null,e=!0);return e};var I=function(a,c){var j=0;return j=a.length==c.length?F(a,c):a.length>c.length?F(a.substr(0,c.length),c):F(a,c.substr(0,a.length))};D.prototype.serializeCombos=function(a,c,j,e,h,k,g){if(g.length>0){k=i(k);k[e.mapNode(g[0].s)]=g[0].s;for(var l=e.copy(),g=g.slice(1),r=Math.max(1,g.length),t=0;t<r;++t){var u=t===0?e:l.copy();this.serializeCombos(a,c,j,u,h,k,g);g.unshift.apply(g,g.splice(1,g.length))}}else if(g=Object.keys(k).sort(),e.adj[j]={i:c,k:g,m:k},e.serialize(this.subjects,
this.edges),a[h]===null||I(e.s,a[h].s)<=0){for(l in g)this.serializeBlankNode(a,k[g[l]],e,h);e.serialize(this.subjects,this.edges);if(a[h]===null||I(e.s,a[h].s)<=0&&e.s.length>=a[h].s.length)a[h]={s:e.s,m:e.mapping}}};D.prototype.serializeBlankNode=function(a,c,j,e){if(!(c in j.processed)){j.processed[c]=!0;var h=j.mapNode(c),i=j.copy(),k=this.edges[e][c].bnodes,g={},l=[],r;for(r in k)k[r].s in j.mapping?g[j.mapping[k[r].s]]=k[r].s:l.push(k[r]);k=Math.max(1,l.length);for(r=0;r<k;++r){var t=r===0?
j:i.copy();this.serializeCombos(a,c,h,t,e,g,l)}}};D.prototype.deepCompareBlankNodes=function(a,c){var j=0,e=a["@id"],h=c["@id"];if(e===h)j=0;else if(j=this.shallowCompareBlankNodes(a,c),j===0)for(var k=["props","refs"],g=0;j===0&&g<k.length;++g){var j=k[g],l=this.serializations[e],r=this.serializations[h];if(l[j]===null){var t=new MappingBuilder;if(j==="refs")t.mapping=i(l.props.m),t.count=Object.keys(t.mapping).length+1;this.serializeBlankNode(l,e,t,j)}if(r[j]===null){t=new MappingBuilder;if(j===
"refs")t.mapping=i(r.props.m),t.count=Object.keys(t.mapping).length+1;this.serializeBlankNode(r,h,t,j)}j=F(l[j].s,r[j].s)}return j};D.prototype.shallowCompareBlankNodes=function(a,c){var j=0,e=Object.keys(a),h=Object.keys(c),j=F(e.length,h.length);j===0&&(j=F(e.sort(),h.sort()));j===0&&(j=G(a,c));if(j===0)var k=this.edges.refs[a["@id"]].all,i=this.edges.refs[c["@id"]].all,j=F(k.length,i.length);if(j===0)for(e=0;e<k.length&&j===0;++e)j=this.compareEdges(k[e],i[e]);return j};D.prototype.compareEdges=
function(a,c){var j=0,e=A(a.s),h=A(c.s),k=this.ng.c14n;e!=h?j=e?1:-1:(e||(j=F(a.s,c.s)),j===0&&(j=F(a.p,c.p)),j===0&&k!==null&&(e=k.inNamespace(a.s),k=k.inNamespace(c.s),e!=k?j=e?1:-1:e&&(j=F(a.s,c.s))));return j};D.prototype.collectEdges=function(){var a=this.edges.refs,c=this.edges.props,j;for(j in this.subjects){var e=this.subjects[j],h;for(h in e)if(h!=="@id"){var k=e[h],k=k.constructor!==Array?[k]:k,i;for(i in k){var g=k[i];g.constructor===Object&&"@id"in g&&g["@id"]in this.subjects&&(g=g["@id"],
a[g].all.push({s:j,p:h}),c[j].all.push({s:g,p:h}))}}}var l=this;for(j in a)a[j].all.sort(function(a,c){return l.compareEdges(a,c)}),a[j].bnodes=a[j].all.filter(function(a){return A(a.s)});for(j in c)c[j].all.sort(function(a,c){return l.compareEdges(a,c)}),c[j].bnodes=c[j].all.filter(function(a){return A(a.s)})};var O=function(a,c){var j=!1;if(!("@type"in c)){var e=Object.keys(c).filter(function(a){return a.indexOf("@")!==0});if(e.length===0)j=!0;else if(a.constructor===Object&&"@id"in a){var j=!0,
h;for(h in e)if(!(e[h]in a)){j=!1;break}}}return j},S=function(a,c,j,e,h,k,i,g){var l=c["@id"],r=l in e?e[l]:null;if(("@embed"in j&&j["@embed"]||!("@embed"in j)&&g.defaults.embedOn)&&(r===null||r.autoembed&&!h)){if(r===null)r={},e[l]=r;else if(r.parent!==null){if(r.parent[r.key].constructor===Array){var t=r.parent[r.key],u;for(u in t)if(t[u].constructor===Object&&"@id"in t[u]&&t[u]["@id"]===l){t[u]={"@id":c["@id"]};break}}else r.parent[r.key]={"@id":c["@id"]};var w=function(a){var c=Object.keys(e),
j;for(j in c)j=c[j],j in e&&e[j].parent!==null&&e[j].parent["@id"]===a&&(delete e[j],w(j))};w(l)}r.autoembed=h;r.parent=k;r.key=i;if(j["@explicit"]===!0||g.defaults.explicitOn)for(y in c)y!=="@id"&&!(y in j)&&delete c[y];h=Object.keys(c);for(u in h){var y=h[u];if(y.indexOf("@")!==0){y in j?(k=j[y],i=!1):(k=c[y].constructor===Array?[]:{},i=!0);var l=c[y],l=l.constructor===Array?l:[l],D;for(D in l)l[D].constructor===Object&&"@id"in l[D]&&l[D]["@id"]in a&&(l[D]=a[l[D]["@id"]]);c[y]=$(a,l,k,e,i,c,y,g)}}for(y in j)if(y.indexOf("@")!==
0&&(!(y in c)||c[y]===null))k=j[y],k.constructor===Array?c[y]=[]:(k.constructor===Array&&(k=k.length>0?k[0]:{}),k["@omitDefault"]===!0||g.defaults.omitDefaultOn||(c[y]="@default"in k?k["@default"]:null))}else c={"@id":c["@id"]};return c},$=function(a,c,j,e,h,k,i,g){var l=null,r=-1,t;j.constructor===Array?(l=[],t=j,t.length===0&&t.push({})):(t=[j],r=1);for(var u=[],y=0;y<t.length&&r!==0;++y){j=t[y];if(j.constructor!==Object)throw{message:"Invalid JSON-LD frame. Frame must be an object or an array.",
frame:j};u[y]=[];for(var D=0;D<c.length&&r!==0;++D){var A=c[D],F=!1,C="@type";if("@type"in j&&A.constructor===Object&&C in A)for(var E=A[C].constructor===Array?A[C]:[A[C]],B=j[C].constructor===Array?j[C]:[j[C]],G=0;G<B.length&&!F;++G){var C=B[G],K;for(K in E)if(E[K]===C){F=!0;break}}if(F||O(A,j))u[y].push(A),--r}}for(var Va in u)for(var L in u[Va])j=t[Va],c=u[Va][L],w(c)&&(c=S(a,c,j,e,h,k,i,g)),l===null?l=c:(j=c!==null&&c.constructor===Object&&"@id"in c&&Object.keys(c).length===1&&c["@id"]in e,k===
null&&j||l.push(c));return l};D.prototype.frame=function(a,j,e){var a=c.normalize(a),h=null;if("@context"in j)h=i(j["@context"]),j=c.expand(j);else if(j.constructor===Array){j.length>0&&"@context"in j[0]&&(h=i(j[0]["@context"]));var e=[],k;for(k in j)e.push(c.expand(j[k]));j=e}var e={defaults:{embedOn:!0,explicitOn:!1,omitDefaultOn:!1}},g={};for(k in a)g[a[k]["@id"]]=a[k];a=$(g,a,j,{},!1,null,null,e);h!==null&&a!==null&&(a=c.compact(h,a));return a}})();var ta={parser:{}};ta.parser.parse=function(a,
c){typeof a==="string"&&(a=JSON.parse(a));return ra.toTriples(a,c)};var Y={RDFLoader:function(a){this.precedences=["text/turtle","text/n3","application/json"];this.parsers={"text/turtle":aa.parser,"text/n3":aa.parser,"application/json":ta.parser};if(a!=null)for(var c in a.parsers)this.parsers[c]=a.parsers[c];if(a&&a.precedences!=null)for(c in this.precedences=a.precedences,a.parsers)y.include(this.precedences,c)||this.precedences.push(c);this.acceptHeaderValue="";for(a=0;a<this.precedences.length;a++)a!=
0?this.acceptHeaderValue=this.acceptHeaderValue+","+this.precedences[a]:this.acceptHeaderValue+=this.precedences[a]}};Y.RDFLoader.prototype.registerParser=function(a,c){this.parsers[a]=c;this.precedences.push(a)};Y.RDFLoader.prototype.unregisterParser=function(a){delete this.parsers[a];for(var c=[],e=0;e<this.precedences.length;e++)this.precedences[e]!=a&&c.push(this.precedences[e]);this.precedences=c};Y.RDFLoader.prototype.setAcceptHeaderPrecedence=function(a){this.precedences=a};Y.RDFLoader.prototype.load=
function(a,c,e){var h=this;O.load(a,this.acceptHeaderValue,function(k,j){if(k==!0){var i=j.headers["Content-Type"]||j.headers["content-type"],g=j.data;if(i!=null){var i=i.split(";")[0],r;for(r in h.parsers)if(r.indexOf("/")!=-1){var u=r.split("/");if(u[1]==="*"){if(i.indexOf(u[0])!=-1)return h.tryToParse(h.parsers[r],c,g,e)}else if(i.indexOf(r)!=-1)return h.tryToParse(h.parsers[r],c,g,e);else if(i.indexOf(u[1])!=-1)return h.tryToParse(h.parsers[r],c,g,e)}else if(i.indexOf(r)!=-1)return h.tryToParse(h.parsers[r],
a,c,e);e(!1,"Unknown media type : "+i)}else console.log("Unknown media type"),console.log(j.headers),e(!1,"Uknown media type")}else e(!1,"Network error: "+j)})};Y.RDFLoader.prototype.loadFromFile=function(a,c,e,h){try{var k=this;require("fs").readFile(e.split("file:/")[1],function(j,e){if(j)throw j;e=e.toString("utf8");k.tryToParse(a,c,e,h)})}catch(j){h(!1,j)}};Y.RDFLoader.prototype.tryToParse=function(a,c,e,h){try{typeof e==="string"&&(e=y.normalizeUnicodeLiterals(e));var k=a.parse(e,c);k!=null?
h(!0,k):h(!1,"parsing error")}catch(j){console.log(j.message),console.log(j.stack),h(!1,"parsing error with mime type : "+j)}};var J={AbstractQueryTree:function(){}};J.AbstractQueryTree.prototype.parseQueryString=function(a){return ga.parser.parse(a)};J.AbstractQueryTree.prototype.parseExecutableUnit=function(a){if(a.kind==="select")return this.parseSelect(a);else if(a.kind==="ask")return this.parseSelect(a);else if(a.kind==="modify")return this.parseSelect(a);else if(a.kind==="construct")return this.parseSelect(a);
else if(a.kind==="insertdata")return this.parseInsertData(a);else if(a.kind==="deletedata")return this.parseInsertData(a);else if(a.kind==="load")return a;else if(a.kind==="clear")return a;else if(a.kind==="drop")return a;else if(a.kind==="create")return a;else throw Error("unknown executable unit: "+a.kind);};J.AbstractQueryTree.prototype.parseSelect=function(a){return a==null?(console.log("error parsing query"),null):(a.pattern=this.build(a.pattern,{freshCounter:0}),a)};J.AbstractQueryTree.prototype.parseInsertData=
function(a){return a==null?(console.log("error parsing query"),null):a};J.AbstractQueryTree.prototype.build=function(a,c){if(a.token==="groupgraphpattern")return this._buildGroupGraphPattern(a,c);else if(a.token==="basicgraphpattern"){var e={kind:"BGP",value:a.triplesContext};return e=J.translatePathExpressionsInBGP(e,c)}else if(a.token==="graphunionpattern"){var e=this.build(a.value[0],c),h=this.build(a.value[1],c);return{kind:"UNION",value:[e,h]}}else if(a.token==="graphgraphpattern")return{kind:"GRAPH",
value:this.build(a.value,c),graph:a.graph};else throw Error("not supported token in query:"+a.token);};J.translatePathExpressionsInBGP=function(a,c){var e,h=[],k,j;for(j=0;j<a.value.length;j++)if(a.value[j].predicate&&a.value[j].predicate.token==="path"){e=a.value[j];k=a.value.slice(j+1);var i=J.translatePathExpression(e,c);e=null;if(i.kind==="BGP")h=h.concat(i.value);else if(i.kind==="ZERO_OR_MORE_PATH"||i.kind==="ONE_OR_MORE_PATH"){j=h.length>0?{kind:"JOIN",lvalue:{kind:"BGP",value:h},rvalue:i}:
i;if(i.kind==="ZERO_OR_MORE_PATH")if(i.y.token==="var"&&i.y.value.indexOf("fresh:")===0&&i.x.token==="var"&&i.x.value.indexOf("fresh:")===0)for(var g=0;g<a.value.length;g++){if(a.value[g].object&&a.value[g].object.token==="var"&&a.value[g].object.value===i.x.value)e=y.clone(a.value[g]),e.object=i.y}else if(i.y.token==="var"&&i.y.value.indexOf("fresh:")===0)for(g=0;g<a.value.length;g++)if(a.value[g].subject&&a.value[g].subject.token==="var"&&a.value[g].subject.value===i.y.value)e=y.clone(a.value[g]),
e.subject=i.x;return k.length>0?(i=J.translatePathExpressionsInBGP({kind:"BGP",value:k},c),e!=null?(h=h.concat([e]).concat(k),{kind:"UNION",value:[{kind:"JOIN",lvalue:j,rvalue:i},{kind:"BGP",value:h}]}):{kind:"JOIN",lvalue:j,rvalue:i}):j}else return i}else h.push(a.value[j]);a.value=h;return a};J.translatePathExpression=function(a,c){if(a.predicate.kind==="element")if(a.predicate.modifier==="+"){a.predicate.modifier=null;var e=J.translatePathExpression(a,c);return{kind:"ONE_OR_MORE_PATH",path:e,x:a.subject,
y:a.object}}else return a.predicate.modifier==="*"?(a.predicate.modifier=null,e=J.translatePathExpression(a,c),{kind:"ZERO_OR_MORE_PATH",path:e,x:a.subject,y:a.object}):(a.predicate=a.predicate.value,{kind:"BGP",value:[a]});else if(a.predicate.kind==="sequence"){for(var e=a.subject,h=a.object,k=a.graph,j,i,g=[],r=0;r<a.predicate.value.length;r++){r!=a.predicate.value.length-1?(j={token:"var",value:"fresh:"+c.freshCounter},c.freshCounter++):j=h;i={subject:e,predicate:a.predicate.value[r],object:j};
if(k!=null)i.graph=y.clone(k);g.push(i);r!=a.predicate.value.length-1&&(e=y.clone(j))}return J.translatePathExpressionsInBGP({kind:"BGP",value:g},c)}};J.AbstractQueryTree.prototype._buildGroupGraphPattern=function(a,c){for(var e=a.filters||[],h={kind:"EMPTY_PATTERN"},k=0;k<a.patterns.length;k++){var j=a.patterns[k];j.token==="optionalgraphpattern"?(j=this.build(j.value,c),h=j.kind==="FILTER"?{kind:"LEFT_JOIN",lvalue:h,rvalue:j.value,filter:j.filter}:{kind:"LEFT_JOIN",lvalue:h,rvalue:j,filter:!0}):
(j=this.build(j,c),h=h.kind=="EMPTY_PATTERN"?j:{kind:"JOIN",lvalue:h,rvalue:j})}if(e.length!=0)if(h.kind==="EMPTY_PATTERN")return{kind:"FILTER",filter:e,value:h};else if(h.kind==="LEFT_JOIN"&&h.filter===!0)return{kind:"FILTER",filter:e,value:h};else if(h.kind==="LEFT_JOIN")return{kind:"FILTER",filter:e,value:h};else if(h.kind==="JOIN")return{kind:"FILTER",filter:e,value:h};else if(h.kind==="UNION")return{kind:"FILTER",filter:e,value:h};else if(h.kind==="GRAPH")return{kind:"FILTER",filter:e,value:h};
else if(h.kind==="BGP")return{kind:"FILTER",filter:e,value:h};else throw Error("Unknow kind of algebra expression: "+h.kind);else return h};J.AbstractQueryTree.prototype.collectBasicTriples=function(a,c){c==null&&(c=[]);if(a.kind==="select")c=this.collectBasicTriples(a.pattern,c);else if(a.kind==="BGP")c=c.concat(a.value);else if(a.kind==="ZERO_OR_MORE_PATH")c=this.collectBasicTriples(a.path);else if(a.kind==="UNION")c=this.collectBasicTriples(a.value[0],c),c=this.collectBasicTriples(a.value[1],c);
else if(a.kind==="GRAPH")c=this.collectBasicTriples(a.value,c);else if(a.kind==="LEFT_JOIN"||a.kind==="JOIN")c=this.collectBasicTriples(a.lvalue,c),c=this.collectBasicTriples(a.rvalue,c);else if(a.kind==="FILTER")c=this.collectBasicTriples(a.value,c);else if(a.kind==="construct")c=this.collectBasicTriples(a.pattern,c);else if(a.kind!=="EMPTY_PATTERN")throw"Unknown pattern: "+a.kind;return c};J.AbstractQueryTree.prototype.bind=function(a,c){if(a.graph!=null&&a.graph.token&&a.graph.token==="var"&&c[a.graph.value]!=
null)a.graph=c[a.graph.value];if(a.filter!=null){for(var e=[],h=0;h<a.filter.length;h++)a.filter[h].value=this._bindFilter(a.filter[h].value,c),e.push(a.filter[h]);a.filter=e}if(a.kind==="select")a.pattern=this.bind(a.pattern,c);else if(a.kind==="BGP")a.value=this._bindTripleContext(a.value,c);else if(a.kind==="ZERO_OR_MORE_PATH"){a.path=this._bindTripleContext(a.path,c);if(a.x&&a.x.token==="var"&&c[a.x.value]!=null)a.x=c[a.x.value];if(a.y&&a.y.token==="var"&&c[a.y.value]!=null)a.y=c[a.y.value]}else if(a.kind===
"UNION")a.value[0]=this.bind(a.value[0],c),a.value[1]=this.bind(a.value[1],c);else if(a.kind==="GRAPH")a.value=this.bind(a.value,c);else if(a.kind==="LEFT_JOIN"||a.kind==="JOIN")a.lvalue=this.bind(a.lvalue,c),a.rvalue=this.bind(a.rvalue,c);else if(a.kind==="FILTER")a.filter=this._bindFilter(a.filter[h].value,c);else if(a.kind!=="EMPTY_PATTERN")throw"Unknown pattern: "+a.kind;return a};J.AbstractQueryTree.prototype._bindTripleContext=function(a,c){for(var e=0;e<a.length;e++){delete a[e].graph;delete a[e].variables;
for(var h in a[e]){var k=a[e][h];k.token==="var"&&c[k.value]!=null&&(a[e][h]=c[k.value])}}return a};J.AbstractQueryTree.prototype._bindFilter=function(a,c){if(a.expressionType!=null){var e=a.expressionType;if(e=="relationalexpression")a.op1=this._bindFilter(a.op1,c),a.op2=this._bindFilter(a.op2,c);else if(e=="conditionalor"||e=="conditionaland")for(e=0;e<a.operands.length;e++)a.operands[e]=this._bindFilter(a.operands[e],c);else if(e=="additiveexpression"){a.summand=this._bindFilter(a.summand,c);for(e=
0;e<a.summands.length;e++)a.summands[e].expression=this._bindFilter(a.summands[e].expression,c)}else if(e=="builtincall")for(e=0;e<a.args.length;e++)a.args[e]=this._bindFilter(a.args[e],c);else if(e=="multiplicativeexpression"){a.factor=this._bindFilter(a.factor,c);for(e=0;e<a.factors.length;e++)a.factors[e].expression=this._bindFilter(a.factors[e].expression,c)}else if(e=="unaryexpression")a.expression=this._bindFilter(a.expression,c);else if(e=="irireforfunction")for(e=0;e<a.factors.args;e++)a.args[e]=
this._bindFilter(a.args[e],c);else if(e=="atomic"&&a.primaryexpression=="var"&&c[a.value.value]!=null)e=c[a.value.value],a.primaryexpression=e.token==="uri"?"iri":"literal",a.value=e}return a};J.AbstractQueryTree.prototype.replace=function(a,c,e,h){if(a.graph!=null&&a.graph.token&&a.graph.token===c.token&&a.graph.value==c.value)a.graph=y.clone(e);if(a.filter!=null){for(var k=[],j=0;j<a.filter.length;j++)a.filter[j].value=this._replaceFilter(a.filter[j].value,c,e,h),k.push(a.filter[j]);a.filter=k}if(a.kind===
"select")a.pattern=this.replace(a.pattern,c,e,h);else if(a.kind==="BGP")a.value=this._replaceTripleContext(a.value,c,e,h);else if(a.kind==="ZERO_OR_MORE_PATH"){a.path=this._replaceTripleContext(a.path,c,e,h);if(a.x&&a.x.token===c.token&&a.value===c.value)a.x=y.clone(e);if(a.y&&a.y.token===c.token&&a.value===c.value)a.y=y.clone(e)}else if(a.kind==="UNION")a.value[0]=this.replace(a.value[0],c,e,h),a.value[1]=this.replace(a.value[1],c,e,h);else if(a.kind==="GRAPH")a.value=this.replace(a.value,c,e);else if(a.kind===
"LEFT_JOIN"||a.kind==="JOIN")a.lvalue=this.replace(a.lvalue,c,e,h),a.rvalue=this.replace(a.rvalue,c,e,h);else if(a.kind==="FILTER")a.value=this._replaceFilter(a.value,c,e,h);else if(a.kind!=="EMPTY_PATTERN")throw"Unknown pattern: "+a.kind;return a};J.AbstractQueryTree.prototype._replaceTripleContext=function(a,c,e,h){for(var k=0;k<a.length;k++)for(var j in a[k]){var i=a[k][j];if(i.token==="var"&&c.token==="var"&&i.value===c.value)a[k][j]=e;else if(i.token==="blank"&&c.token==="blank"&&i.value===c.value)a[k][j]=
e;else if((i.token==="literal"||i.token==="uri")&&(c.token==="literal"||c.token==="uri")&&i.token===c.token&&y.lexicalFormTerm(i,h)[i.token]===y.lexicalFormTerm(c,h)[i.token])a[k][j]=e}return a};J.AbstractQueryTree.prototype._replaceFilter=function(a,c,e,h){if(a.expressionType!=null){var k=a.expressionType;if(k=="relationalexpression")a.op1=this._replaceFilter(a.op1,c,e,h),a.op2=this._replaceFilter(a.op2,c,e,h);else if(k=="conditionalor"||k=="conditionaland")for(k=0;k<a.operands.length;k++)a.operands[k]=
this._replaceFilter(a.operands[k],c,e,h);else if(k=="additiveexpression"){a.summand=this._replaceFilter(a.summand,c,e,h);for(k=0;k<a.summands.length;k++)a.summands[k].expression=this._replaceFilter(a.summands[k].expression,c,e,h)}else if(k=="builtincall")for(k=0;k<a.args.length;k++)a.args[k]=this._replaceFilter(a.args[k],c,e,h);else if(k=="multiplicativeexpression"){a.factor=this._replaceFilter(a.factor,c,e,h);for(k=0;k<a.factors.length;k++)a.factors[k].expression=this._replaceFilter(a.factors[k].expression,
c,e,h)}else if(k=="unaryexpression")a.expression=this._replaceFilter(a.expression,c,e,h);else if(k=="irireforfunction")for(k=0;k<a.factors.args;k++)a.args[k]=this._replaceFilter(a.args[k],c,e,h);else if(k=="atomic"){h=null;if(a.primaryexpression==c.token&&a.value==c.value)h=e.value;else if(a.primaryexpression=="iri"&&c.token=="uri"&&a.value==c.value)h=e.value;if(h!=null)a.primaryexpression=e.token==="uri"?"iri":e.token,a.value=h}}return a};J.AbstractQueryTree.prototype.treeWithUnion=function(a){if(a==
null)return!1;if(a.kind==null)return!1;if(a.kind==="select")return this.treeWithUnion(a.pattern);else if(a.kind==="BGP")return this.treeWithUnion(a.value);else if(a.kind==="ZERO_OR_MORE_PATH")return!1;else if(a.kind==="UNION")if(console.log("UNION!!"),a.value[0].value!=null&&a.value[0].value.variables!=null&&a.value[1].value!=null&&a.value[1].value.variables!=null){if(console.log("COMPARING:"+a.value[0].variables.join("/")),console.log("VS "+a.values[1].variables.join("/")),a.value[0].variables.join("/")===
a.values[1].variables.join("/"))return this.treeWithUnion(a.value[0])?!0:this.treeWithUnion(a.value[1])}else return!0;else if(a.kind==="GRAPH")return!1;else if(a.kind==="LEFT_JOIN"||a.kind==="JOIN")if(this.treeWithUnion(a.lvalue))return!0;else this.treeWithUnion(a.rvalue);else return!1};var ga={};ga.parser=function(){var a={parse:function(a,e){function h(a){var b=a.charCodeAt(0);if(b<=255)var a="x",c=2;else a="u",c=4;var a="\\"+a,d=b.toString(16).toUpperCase(),b=d;c-=d.length;for(d=0;d<c;d++)b="0"+
b;return a+b}function k(a){return'"'+a.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\r/g,"\\r").replace(/\n/g,"\\n").replace(/[\x80-\uFFFF]/g,h)+'"'}function j(a){b<ua||(b>ua&&(ua=b,Xa=[]),Xa.push(a))}function i(){var a="SPARQL@"+b,c=x[a];if(c)return b=c.nextPos,c.result;c=g();c===null&&(c=Ua(),c=c!==null?c:null);x[a]={nextPos:b,result:c};return c}function g(){var a="Query@"+b,c=x[a];if(c)return b=c.nextPos,c.result;c=m;m=!1;var e=b,d=b,f=r();if(f!==null){var h=E();h===null&&(h=K(),h===null&&
(h=L(),h===null&&(h=J(),h=h!==null?h:null)));h!==null?f=[f,h]:(f=null,b=d)}else f=null,b=d;d=f!==null?{token:"query",kind:"query",prologue:f[0],units:[f[1]]}:null;d===null&&(d=null,b=e);(m=c)&&d===null&&j("[2] Query");x[a]={nextPos:b,result:d};return d}function r(){var a="Prologue@"+b,c=x[a];if(c)return b=c.nextPos,c.result;c=m;m=!1;var e=b,d=b,f=u(),f=f!==null?f:"";if(f!==null){for(var h=[],q=o();q!==null;)h.push(q),q=o();if(h!==null){for(var q=[],v=t();v!==null;)q.push(v),v=t();q!==null?f=[f,h,
q]:(f=null,b=d)}else f=null,b=d}else f=null,b=d;d=f!==null?{token:"prologue",base:f[0],prefixes:f[2]}:null;d===null&&(d=null,b=e);(m=c)&&d===null&&j("[3] Prologue");x[a]={nextPos:b,result:d};return d}function u(){var e="BaseDecl@"+b,h=x[e];if(h)return b=h.nextPos,h.result;h=m;m=!1;for(var H=b,d=b,f=[],z=o();z!==null;)f.push(z),z=o();if(f!==null)if(a.substr(b,4)==="BASE"?(z="BASE",b+=4):(z=null,m&&j('"BASE"')),z===null&&(a.substr(b,4)==="base"?(z="base",b+=4):(z=null,m&&j('"base"')),z=z!==null?z:null),
z!==null){for(var q=[],v=o();v!==null;)q.push(v),v=o();q!==null?(v=ka(),v!==null?f=[f,z,q,v]:(f=null,b=d)):(f=null,b=d)}else f=null,b=d;else f=null,b=d;d=f!==null?function(a){var b={token:"base"};b.value=a;return b}(f[3]):null;d===null&&(d=null,b=H);(m=h)&&d===null&&j("[4] BaseDecl");x[e]={nextPos:b,result:d};return d}function t(){var e="PrefixDecl@"+b,h=x[e];if(h)return b=h.nextPos,h.result;h=m;m=!1;for(var H=b,d=b,f=[],z=o();z!==null;)f.push(z),z=o();if(f!==null)if(a.substr(b,6)==="PREFIX"?(z="PREFIX",
b+=6):(z=null,m&&j('"PREFIX"')),z===null&&(a.substr(b,6)==="prefix"?(z="prefix",b+=6):(z=null,m&&j('"prefix"')),z=z!==null?z:null),z!==null){for(var q=[],v=o();v!==null;)q.push(v),v=o();if(q!==null)if(v=Aa(),v!==null){for(var n=[],k=o();k!==null;)n.push(k),k=o();n!==null?(k=ka(),k!==null?f=[f,z,q,v,n,k]:(f=null,b=d)):(f=null,b=d)}else f=null,b=d;else f=null,b=d}else f=null,b=d;else f=null,b=d;d=f!==null?function(a,b){var f={token:"prefix"};f.prefix=a;f.local=b;return f}(f[3],f[5]):null;d===null&&
(d=null,b=H);(m=h)&&d===null&&j("[5] PrefixDecl");x[e]={nextPos:b,result:d};return d}function w(){var a="TURTLE@"+b,c=x[a];if(c)return b=c.nextPos,c.result;for(var c=b,j=[],d=y();d!==null;)j.push(d),d=y();j=j!==null?j:null;j===null&&(j=null,b=c);x[a]={nextPos:b,result:j};return j}function y(){var e="statement@"+b,h=x[e];if(h)return b=h.nextPos,h.result;for(var H=h=b,d=[],f=o();f!==null;)d.push(f),f=o();if(d!==null)if(f=A(),f!==null){for(var z=[],q=o();q!==null;)z.push(q),q=o();if(z!==null)if(a.substr(b,
1)==="."?(q=".",b+=1):(q=null,m&&j('"."')),q!==null){for(var v=[],n=o();n!==null;)v.push(n),n=o();v!==null?d=[d,f,z,q,v]:(d=null,b=H)}else d=null,b=H;else d=null,b=H}else d=null,b=H;else d=null,b=H;H=d!==null?d[1]:null;H===null&&(H=null,b=h);if(H!==null)h=H;else{H=h=b;d=[];for(f=o();f!==null;)d.push(f),f=o();if(d!==null)if(f=la(),f!==null){z=[];for(q=o();q!==null;)z.push(q),q=o();z!==null?d=[d,f,z]:(d=null,b=H)}else d=null,b=H;else d=null,b=H;H=d!==null?d[1]:null;H===null&&(H=null,b=h);if(H!==null)h=
H;else{h=o();if(h!==null)for(H=[];h!==null;)H.push(h),h=o();else H=null;h=H!==null?H:null}}x[e]={nextPos:b,result:h};return h}function A(){var a="directive@"+b,c=x[a];if(c)return b=c.nextPos,c.result;c=F();c===null&&(c=C(),c=c!==null?c:null);x[a]={nextPos:b,result:c};return c}function C(){var e="base@"+b,h=x[e];if(h)return b=h.nextPos,h.result;for(var H=h=b,d=[],f=o();f!==null;)d.push(f),f=o();if(d!==null)if(a.substr(b,5)==="@base"?(f="@base",b+=5):(f=null,m&&j('"@base"')),f!==null){var z=o();if(z!==
null)for(var q=[];z!==null;)q.push(z),z=o();else q=null;q!==null?(z=ka(),z!==null?d=[d,f,q,z]:(d=null,b=H)):(d=null,b=H)}else d=null,b=H;else d=null,b=H;H=d!==null?function(a){base={token:"base"};base.value=a;return base}(d[3]):null;H===null&&(H=null,b=h);x[e]={nextPos:b,result:H};return H}function F(){var e="prefixID@"+b,h=x[e];if(h)return b=h.nextPos,h.result;for(var H=h=b,d=[],f=o();f!==null;)d.push(f),f=o();if(d!==null)if(a.substr(b,7)==="@prefix"?(f="@prefix",b+=7):(f=null,m&&j('"@prefix"')),
f!==null){var z=o();if(z!==null)for(var q=[];z!==null;)q.push(z),z=o();else q=null;if(q!==null)if(z=Ya(),z=z!==null?z:"",z!==null){if(a.substr(b,1)===":"){var v=":";b+=1}else v=null,m&&j('":"');if(v!==null){for(var n=[],k=o();k!==null;)n.push(k),k=o();n!==null?(k=ka(),k!==null?d=[d,f,q,z,v,n,k]:(d=null,b=H)):(d=null,b=H)}else d=null,b=H}else d=null,b=H;else d=null,b=H}else d=null,b=H;else d=null,b=H;H=d!==null?function(a,b){prefix={token:"prefix"};prefix.prefix=a;prefix.local=b;return prefix}(d[3],
d[6]):null;H===null&&(H=null,b=h);x[e]={nextPos:b,result:H};return H}function E(){var a="SelectQuery@"+b,c=x[a];if(c)return b=c.nextPos,c.result;c=m;m=!1;var e=b,d=b,f=B();if(f!==null){for(var h=[],q=o();q!==null;)h.push(q),q=o();if(h!==null){for(var q=[],v=I();v!==null;)q.push(v),v=I();if(q!==null){for(var v=[],n=o();n!==null;)v.push(n),n=o();if(v!==null)if(n=$(),n!==null){for(var k=[],i=o();i!==null;)k.push(i),i=o();if(k!==null)if(i=U(),i!==null){for(var g=[],l=o();l!==null;)g.push(l),l=o();g!==
null?(l=ta(),l!==null?f=[f,h,q,v,n,k,i,g,l]:(f=null,b=d)):(f=null,b=d)}else f=null,b=d;else f=null,b=d}else f=null,b=d;else f=null,b=d}else f=null,b=d}else f=null,b=d}else f=null,b=d;d=f!==null?function(a,b,f,d){for(var c={named:[],implicit:[]},j=0;j<b.length;j++){var e=b[j];e.kind==="default"?c.implicit.push(e.graph):c.named.push(e.graph)}c.named.length===0&&c.implicit.length===0&&c.implicit.push({token:"uri",prefix:null,suffix:null,value:"https://github.com/antoniogarrote/rdfstore-js#default_graph"});
b={kind:"select",token:"executableunit"};b.dataset=c;b.projection=a.vars;b.modifier=a.modifier;b.pattern=f;if(d!=null&&d.limit!=null)b.limit=d.limit;if(d!=null&&d.offset!=null)b.offset=d.offset;if(d!=null&&d.order!=null&&d.order!="")b.order=d.order;if(d!=null&&d.group!=null)b.group=d.group;return b}(f[0],f[2],f[4],f[6]):null;d===null&&(d=null,b=e);(m=c)&&d===null&&j("[6] SelectQuery");x[a]={nextPos:b,result:d};return d}function G(){var a="SubSelect@"+b,c=x[a];if(c)return b=c.nextPos,c.result;c=m;
m=!1;var e=b,d=B();if(d!==null){var f=$();if(f!==null){var h=U();h!==null?d=[d,f,h]:(d=null,b=e)}else d=null,b=e}else d=null,b=e;(m=c)&&d===null&&j("[7] SubSelect");x[a]={nextPos:b,result:d};return d}function B(){var e="SelectClause@"+b,h=x[e];if(h)return b=h.nextPos,h.result;h=m;m=!1;for(var H=b,d=b,f=[],z=o();z!==null;)f.push(z),z=o();if(f!==null)if(a.substr(b,6)==="SELECT"?(z="SELECT",b+=6):(z=null,m&&j('"SELECT"')),z===null&&(a.substr(b,6)==="select"?(z="select",b+=6):(z=null,m&&j('"select"')),
z=z!==null?z:null),z!==null){for(var q=[],v=o();v!==null;)q.push(v),v=o();if(q!==null)if(a.substr(b,8)==="DISTINCT"?(v="DISTINCT",b+=8):(v=null,m&&j('"DISTINCT"')),v===null&&(a.substr(b,8)==="distinct"?(v="distinct",b+=8):(v=null,m&&j('"distinct"')),v=v!==null?v:null),v===null&&(a.substr(b,7)==="REDUCED"?(v="REDUCED",b+=7):(v=null,m&&j('"REDUCED"')),v===null&&(a.substr(b,7)==="reduced"?(v="reduced",b+=7):(v=null,m&&j('"reduced"')),v=v!==null?v:null),v=v!==null?v:null),v=v!==null?v:"",v!==null){for(var n=
[],k=o();k!==null;)n.push(k),k=o();if(n!==null){for(var i=b,g=[],l=o();l!==null;)g.push(l),l=o();if(g!==null)if(l=P(),l!==null){for(var r=[],t=o();t!==null;)r.push(t),t=o();r!==null?g=[g,l,r]:(g=null,b=i)}else g=null,b=i;else g=null,b=i;if(g!==null)i=g;else{i=b;g=[];for(l=o();l!==null;)g.push(l),l=o();if(g!==null)if(a.substr(b,1)==="("?(l="(",b+=1):(l=null,m&&j('"("')),l!==null){r=[];for(t=o();t!==null;)r.push(t),t=o();if(r!==null)if(t=M(),t!==null){for(var u=[],w=o();w!==null;)u.push(w),w=o();if(u!==
null)if(a.substr(b,2)==="AS"?(w="AS",b+=2):(w=null,m&&j('"AS"')),w===null&&(a.substr(b,2)==="as"?(w="as",b+=2):(w=null,m&&j('"as"')),w=w!==null?w:null),w!==null){for(var y=[],D=o();D!==null;)y.push(D),D=o();if(y!==null)if(D=P(),D!==null){for(var A=[],R=o();R!==null;)A.push(R),R=o();if(A!==null)if(a.substr(b,1)===")"?(R=")",b+=1):(R=null,m&&j('")"')),R!==null){for(var N=[],F=o();F!==null;)N.push(F),F=o();N!==null?g=[g,l,r,t,u,w,y,D,A,R,N]:(g=null,b=i)}else g=null,b=i;else g=null,b=i}else g=null,b=
i;else g=null,b=i}else g=null,b=i;else g=null,b=i}else g=null,b=i;else g=null,b=i}else g=null,b=i;else g=null,b=i;i=g!==null?g:null}if(i!==null)for(k=[];i!==null;){k.push(i);i=b;g=[];for(l=o();l!==null;)g.push(l),l=o();if(g!==null)if(l=P(),l!==null){r=[];for(t=o();t!==null;)r.push(t),t=o();r!==null?g=[g,l,r]:(g=null,b=i)}else g=null,b=i;else g=null,b=i;if(g!==null)i=g;else{i=b;g=[];for(l=o();l!==null;)g.push(l),l=o();if(g!==null)if(a.substr(b,1)==="("?(l="(",b+=1):(l=null,m&&j('"("')),l!==null){r=
[];for(t=o();t!==null;)r.push(t),t=o();if(r!==null)if(t=M(),t!==null){u=[];for(w=o();w!==null;)u.push(w),w=o();if(u!==null)if(a.substr(b,2)==="AS"?(w="AS",b+=2):(w=null,m&&j('"AS"')),w===null&&(a.substr(b,2)==="as"?(w="as",b+=2):(w=null,m&&j('"as"')),w=w!==null?w:null),w!==null){y=[];for(D=o();D!==null;)y.push(D),D=o();if(y!==null)if(D=P(),D!==null){A=[];for(R=o();R!==null;)A.push(R),R=o();if(A!==null)if(a.substr(b,1)===")"?(R=")",b+=1):(R=null,m&&j('")"')),R!==null){N=[];for(F=o();F!==null;)N.push(F),
F=o();N!==null?g=[g,l,r,t,u,w,y,D,A,R,N]:(g=null,b=i)}else g=null,b=i;else g=null,b=i}else g=null,b=i;else g=null,b=i}else g=null,b=i;else g=null,b=i}else g=null,b=i;else g=null,b=i}else g=null,b=i;else g=null,b=i;i=g!==null?g:null}}else k=null;if(k===null){k=b;i=[];for(g=o();g!==null;)i.push(g),g=o();if(i!==null)if(a.substr(b,1)==="*"?(g="*",b+=1):(g=null,m&&j('"*"')),g!==null){l=[];for(r=o();r!==null;)l.push(r),r=o();l!==null?i=[i,g,l]:(i=null,b=k)}else i=null,b=k;else i=null,b=k;k=i!==null?i:null}k!==
null?f=[f,z,q,v,n,k]:(f=null,b=d)}else f=null,b=d}else f=null,b=d;else f=null,b=d}else f=null,b=d;else f=null,b=d;d=f!==null?function(a,b){var f=[];if(b.length===3&&b[1]==="*")return{vars:[{token:"variable",kind:"*"}],modifier:zb(a)};for(var d=0;d<b.length;d++){var c=b[d];c.length===3?f.push({token:"variable",kind:"var",value:c[1]}):f.push({token:"variable",kind:"aliased",expression:c[3],alias:c[7]})}return{vars:f,modifier:zb(a)}}(f[3],f[5]):null;d===null&&(d=null,b=H);(m=h)&&d===null&&j("[8] SelectClause");
x[e]={nextPos:b,result:d};return d}function K(){var e="ConstructQuery@"+b,h=x[e];if(h)return b=h.nextPos,h.result;h=m;m=!1;for(var H=b,d=b,f=[],z=o();z!==null;)f.push(z),z=o();if(f!==null)if(a.substr(b,9)==="CONSTRUCT"?(z="CONSTRUCT",b+=9):(z=null,m&&j('"CONSTRUCT"')),z===null&&(a.substr(b,9)==="construct"?(z="construct",b+=9):(z=null,m&&j('"construct"')),z=z!==null?z:null),z!==null){for(var q=[],v=o();v!==null;)q.push(v),v=o();if(q!==null)if(v=Ab(),v!==null){for(var n=[],k=o();k!==null;)n.push(k),
k=o();if(n!==null){for(var k=[],i=I();i!==null;)k.push(i),i=I();if(k!==null){for(var i=[],g=o();g!==null;)i.push(g),g=o();if(i!==null)if(g=$(),g!==null){for(var l=[],r=o();r!==null;)l.push(r),r=o();l!==null?(r=U(),r!==null?f=[f,z,q,v,n,k,i,g,l,r]:(f=null,b=d)):(f=null,b=d)}else f=null,b=d;else f=null,b=d}else f=null,b=d}else f=null,b=d}else f=null,b=d;else f=null,b=d}else f=null,b=d;else f=null,b=d;d=f!==null?function(a,b,f,d){for(var c={named:[],implicit:[]},j=0;j<b.length;j++){var e=b[j];e.kind===
"default"?c.implicit.push(e.graph):c.named.push(e.graph)}c.named.length===0&&c.implicit.length===0&&c.implicit.push({token:"uri",prefix:null,suffix:null,value:"https://github.com/antoniogarrote/rdfstore-js#default_graph"});b={kind:"construct",token:"executableunit"};b.dataset=c;b.template=a;b.pattern=f;if(d!=null&&d.limit!=null)b.limit=d.limit;if(d!=null&&d.offset!=null)b.offset=d.offset;if(d!=null&&d.order!=null&&d.order!="")b.order=d.order;return b}(f[3],f[5],f[7],f[9]):null;d===null&&(d=null,b=
H);(m=h)&&d===null&&j("[9] ConstructQuery");x[e]={nextPos:b,result:d};return d}function L(){var e="DescribeQuery@"+b,h=x[e];if(h)return b=h.nextPos,h.result;h=m;m=!1;var k=b;if(a.substr(b,8)==="DESCRIBE"){var d="DESCRIBE";b+=8}else d=null,m&&j('"DESCRIBE"');if(d!==null){var f=ha();if(f!==null)for(var z=[];f!==null;)z.push(f),f=ha();else z=null;z!==null?f=z:(a.substr(b,1)==="*"?(f="*",b+=1):(f=null,m&&j('"*"')),f=f!==null?f:null);if(f!==null){for(var z=[],q=I();q!==null;)z.push(q),q=I();if(z!==null)if(q=
$(),q=q!==null?q:"",q!==null){var v=U();v!==null?d=[d,f,z,q,v]:(d=null,b=k)}else d=null,b=k;else d=null,b=k}else d=null,b=k}else d=null,b=k;(m=h)&&d===null&&j("[10] DescribeQuery");x[e]={nextPos:b,result:d};return d}function J(){var e="AskQuery@"+b,h=x[e];if(h)return b=h.nextPos,h.result;h=m;m=!1;for(var k=b,d=b,f=[],z=o();z!==null;)f.push(z),z=o();if(f!==null)if(a.substr(b,3)==="ASK"?(z="ASK",b+=3):(z=null,m&&j('"ASK"')),z===null&&(a.substr(b,3)==="ask"?(z="ask",b+=3):(z=null,m&&j('"ask"')),z=z!==
null?z:null),z!==null){for(var q=[],v=o();v!==null;)q.push(v),v=o();if(q!==null){for(var v=[],n=I();n!==null;)v.push(n),n=I();if(v!==null){for(var n=[],i=o();i!==null;)n.push(i),i=o();n!==null?(i=$(),i!==null?f=[f,z,q,v,n,i]:(f=null,b=d)):(f=null,b=d)}else f=null,b=d}else f=null,b=d}else f=null,b=d;else f=null,b=d;d=f!==null?function(a,b){for(var f={named:[],implicit:[]},d=0;d<a.length;d++){var c=a[d];c.kind==="implicit"?f.implicit.push(c.graph):f.named.push(c.graph)}f.named.length===0&&f.implicit.length===
0&&f.implicit.push({token:"uri",prefix:null,suffix:null,value:"https://github.com/antoniogarrote/rdfstore-js#default_graph"});d={kind:"ask",token:"executableunit"};d.dataset=f;d.pattern=b;return d}(f[3],f[5]):null;d===null&&(d=null,b=k);(m=h)&&d===null&&j("[11] AskQuery");x[e]={nextPos:b,result:d};return d}function I(){var e="DatasetClause@"+b,h=x[e];if(h)return b=h.nextPos,h.result;h=m;m=!1;var k=b,d=b;if(a.substr(b,4)==="FROM"){var f="FROM";b+=4}else f=null,m&&j('"FROM"');f===null&&(a.substr(b,
4)==="from"?(f="from",b+=4):(f=null,m&&j('"from"')),f=f!==null?f:null);if(f!==null){for(var i=[],q=o();q!==null;)i.push(q),q=o();if(i!==null)if(q=O(),q===null&&(q=S(),q=q!==null?q:null),q!==null){for(var v=[],n=o();n!==null;)v.push(n),n=o();v!==null?f=[f,i,q,v]:(f=null,b=d)}else f=null,b=d;else f=null,b=d}else f=null,b=d;d=f!==null?f[2]:null;d===null&&(d=null,b=k);(m=h)&&d===null&&j("[12] DatasetClause");x[e]={nextPos:b,result:d};return d}function O(){var a="DefaultGraphClause@"+b,c=x[a];if(c)return b=
c.nextPos,c.result;c=m;m=!1;for(var e=b,d=b,f=[],h=o();h!==null;)f.push(h),h=o();f!==null?(h=Q(),h!==null?f=[f,h]:(f=null,b=d)):(f=null,b=d);d=f!==null?{graph:f[1],kind:"default",token:"graphClause"}:null;d===null&&(d=null,b=e);(m=c)&&d===null&&j("[13] DefaultGraphClause");x[a]={nextPos:b,result:d};return d}function S(){var e="NamedGraphClause@"+b,h=x[e];if(h)return b=h.nextPos,h.result;h=m;m=!1;var k=b,d=b;if(a.substr(b,5)==="NAMED"){var f="NAMED";b+=5}else f=null,m&&j('"NAMED"');f===null&&(a.substr(b,
5)==="named"?(f="named",b+=5):(f=null,m&&j('"named"')),f=f!==null?f:null);if(f!==null){for(var i=[],q=o();q!==null;)i.push(q),q=o();i!==null?(q=Q(),q!==null?f=[f,i,q]:(f=null,b=d)):(f=null,b=d)}else f=null,b=d;d=f!==null?{graph:f[2],kind:"named",token:"graphCluase"}:null;d===null&&(d=null,b=k);(m=h)&&d===null&&j("[14] NamedGraphClause");x[e]={nextPos:b,result:d};return d}function $(){var e="WhereClause@"+b,h=x[e];if(h)return b=h.nextPos,h.result;h=m;m=!1;var k=b,d=b;if(a.substr(b,5)==="WHERE"){var f=
"WHERE";b+=5}else f=null,m&&j('"WHERE"');f===null&&(a.substr(b,5)==="where"?(f="where",b+=5):(f=null,m&&j('"where"')),f=f!==null?f:null);f=f!==null?f:"";if(f!==null){for(var i=[],q=o();q!==null;)i.push(q),q=o();if(i!==null)if(q=V(),q!==null){for(var v=[],n=o();n!==null;)v.push(n),n=o();v!==null?f=[f,i,q,v]:(f=null,b=d)}else f=null,b=d;else f=null,b=d}else f=null,b=d;d=f!==null?f[2]:null;d===null&&(d=null,b=k);(m=h)&&d===null&&j("[16] WhereClause");x[e]={nextPos:b,result:d};return d}function U(){var a=
"SolutionModifier@"+b,c=x[a];if(c)return b=c.nextPos,c.result;c=m;m=!1;var e=b,d=b,f=Y(),f=f!==null?f:"";if(f!==null){var h=aa(),h=h!==null?h:"";if(h!==null){var q=ea(),q=q!==null?q:"";if(q!==null){var v=ra(),v=v!==null?v:"";v!==null?f=[f,h,q,v]:(f=null,b=d)}else f=null,b=d}else f=null,b=d}else f=null,b=d;d=f!==null?function(a,b,f){var d={};if(f!=null){if(f.limit!=null)d.limit=f.limit;if(f.offset!=null)d.offset=f.offset}if(a!=null)d.group=a;d.order=b;return d}(f[0],f[2],f[3]):null;d===null&&(d=null,
b=e);(m=c)&&d===null&&j("[17] SolutionModifier");x[a]={nextPos:b,result:d};return d}function Y(){var e="GroupClause@"+b,h=x[e];if(h)return b=h.nextPos,h.result;h=m;m=!1;var k=b,d=b;if(a.substr(b,5)==="GROUP"){var f="GROUP";b+=5}else f=null,m&&j('"GROUP"');f===null&&(a.substr(b,5)==="group"?(f="group",b+=5):(f=null,m&&j('"group"')),f=f!==null?f:null);if(f!==null){for(var i=[],q=o();q!==null;)i.push(q),q=o();if(i!==null)if(a.substr(b,2)==="BY"?(q="BY",b+=2):(q=null,m&&j('"BY"')),q===null&&(a.substr(b,
2)==="by"?(q="by",b+=2):(q=null,m&&j('"by"')),q=q!==null?q:null),q!==null){for(var v=[],n=o();n!==null;)v.push(n),n=o();if(v!==null){n=X();if(n!==null)for(var g=[];n!==null;)g.push(n),n=X();else g=null;g!==null?f=[f,i,q,v,g]:(f=null,b=d)}else f=null,b=d}else f=null,b=d;else f=null,b=d}else f=null,b=d;d=f!==null?f[4]:null;d===null&&(d=null,b=k);(m=h)&&d===null&&j("[18] GroupClause");x[e]={nextPos:b,result:d};return d}function X(){var e="GroupCondition@"+b,h=x[e];if(h)return b=h.nextPos,h.result;h=
m;m=!1;for(var k=b,d=b,f=[],i=o();i!==null;)f.push(i),i=o();if(f!==null)if(i=Ba(),i!==null){for(var q=[],v=o();v!==null;)q.push(v),v=o();q!==null?f=[f,i,q]:(f=null,b=d)}else f=null,b=d;else f=null,b=d;d=f!==null?f[1]:null;d===null&&(d=null,b=k);if(d!==null)k=d;else{d=k=b;f=[];for(i=o();i!==null;)f.push(i),i=o();if(f!==null)if(i=Za(),i!==null){q=[];for(v=o();v!==null;)q.push(v),v=o();q!==null?f=[f,i,q]:(f=null,b=d)}else f=null,b=d;else f=null,b=d;d=f!==null?f[1]:null;d===null&&(d=null,b=k);if(d!==
null)k=d;else{d=k=b;f=[];for(i=o();i!==null;)f.push(i),i=o();if(f!==null)if(a.substr(b,1)==="("?(i="(",b+=1):(i=null,m&&j('"("')),i!==null){q=[];for(v=o();v!==null;)q.push(v),v=o();if(q!==null)if(v=M(),v!==null){for(var n=[],g=o();g!==null;)n.push(g),g=o();if(n!==null){g=b;if(a.substr(b,2)==="AS"){var s="AS";b+=2}else s=null,m&&j('"AS"');s===null&&(a.substr(b,2)==="as"?(s="as",b+=2):(s=null,m&&j('"as"')),s=s!==null?s:null);if(s!==null){for(var l=[],r=o();r!==null;)l.push(r),r=o();l!==null?(r=P(),
r!==null?s=[s,l,r]:(s=null,b=g)):(s=null,b=g)}else s=null,b=g;g=s!==null?s:"";if(g!==null){s=[];for(l=o();l!==null;)s.push(l),l=o();if(s!==null)if(a.substr(b,1)===")"?(l=")",b+=1):(l=null,m&&j('")"')),l!==null){for(var r=[],t=o();t!==null;)r.push(t),t=o();r!==null?f=[f,i,q,v,n,g,s,l,r]:(f=null,b=d)}else f=null,b=d;else f=null,b=d}else f=null,b=d}else f=null,b=d}else f=null,b=d;else f=null,b=d}else f=null,b=d;else f=null,b=d;d=f!==null?f[5].length!=0?{token:"aliased_expression",expression:f[3],alias:f[5][2]}:
f[3]:null;d===null&&(d=null,b=k);if(d!==null)k=d;else{d=k=b;f=[];for(i=o();i!==null;)f.push(i),i=o();if(f!==null)if(i=P(),i!==null){q=[];for(v=o();v!==null;)q.push(v),v=o();q!==null?f=[f,i,q]:(f=null,b=d)}else f=null,b=d;else f=null,b=d;d=f!==null?f[1]:null;d===null&&(d=null,b=k);k=d!==null?d:null}}}(m=h)&&k===null&&j("[19] GroupCondition");x[e]={nextPos:b,result:k};return k}function aa(){var e="HavingClause@"+b,h=x[e];if(h)return b=h.nextPos,h.result;h=m;m=!1;var i=b;if(a.substr(b,6)==="HAVING"){var d=
"HAVING";b+=6}else d=null,m&&j('"HAVING"');if(d!==null){var f=va();if(f!==null)for(var k=[];f!==null;)k.push(f),f=va();else k=null;k!==null?d=[d,k]:(d=null,b=i)}else d=null,b=i;(m=h)&&d===null&&j("[20] HavingClause");x[e]={nextPos:b,result:d};return d}function ea(){var e="OrderClause@"+b,h=x[e];if(h)return b=h.nextPos,h.result;h=m;m=!1;var i=b,d=b;if(a.substr(b,5)==="ORDER"){var f="ORDER";b+=5}else f=null,m&&j('"ORDER"');f===null&&(a.substr(b,5)==="order"?(f="order",b+=5):(f=null,m&&j('"order"')),
f=f!==null?f:null);if(f!==null){for(var k=[],q=o();q!==null;)k.push(q),q=o();if(k!==null)if(a.substr(b,2)==="BY"?(q="BY",b+=2):(q=null,m&&j('"BY"')),q===null&&(a.substr(b,2)==="by"?(q="by",b+=2):(q=null,m&&j('"by"')),q=q!==null?q:null),q!==null){for(var v=[],n=o();n!==null;)v.push(n),n=o();if(v!==null){var g=ga();if(g!==null)for(n=[];g!==null;)n.push(g),g=ga();else n=null;if(n!==null){for(var g=[],s=o();s!==null;)g.push(s),s=o();g!==null?f=[f,k,q,v,n,g]:(f=null,b=d)}else f=null,b=d}else f=null,b=
d}else f=null,b=d;else f=null,b=d}else f=null,b=d;d=f!==null?f[4]:null;d===null&&(d=null,b=i);(m=h)&&d===null&&j("[22] OrderClause");x[e]={nextPos:b,result:d};return d}function ga(){var e="OrderCondition@"+b,h=x[e];if(h)return b=h.nextPos,h.result;h=m;m=!1;var i=b,d=b;if(a.substr(b,3)==="ASC"){var f="ASC";b+=3}else f=null,m&&j('"ASC"');f===null&&(a.substr(b,3)==="asc"?(f="asc",b+=3):(f=null,m&&j('"asc"')),f===null&&(a.substr(b,4)==="DESC"?(f="DESC",b+=4):(f=null,m&&j('"DESC"')),f===null&&(a.substr(b,
4)==="desc"?(f="desc",b+=4):(f=null,m&&j('"desc"')),f=f!==null?f:null)));if(f!==null){for(var k=[],q=o();q!==null;)k.push(q),q=o();if(k!==null)if(q=Ca(),q!==null){for(var v=[],n=o();n!==null;)v.push(n),n=o();v!==null?f=[f,k,q,v]:(f=null,b=d)}else f=null,b=d;else f=null,b=d}else f=null,b=d;d=f!==null?{direction:f[0].toUpperCase(),expression:f[2]}:null;d===null&&(d=null,b=i);if(d!==null)i=d;else{d=i=b;f=va();f===null&&(f=P(),f=f!==null?f:null);if(f!==null){k=[];for(q=o();q!==null;)k.push(q),q=o();k!==
null?f=[f,k]:(f=null,b=d)}else f=null,b=d;d=f!==null?function(a){a.token==="var"&&(a={token:"expression",expressionType:"atomic",primaryexpression:"var",value:a});return{direction:"ASC",expression:a}}(f[0]):null;d===null&&(d=null,b=i);i=d!==null?d:null}(m=h)&&i===null&&j("[23] OrderCondition");x[e]={nextPos:b,result:i};return i}function ra(){var a="LimitOffsetClauses@"+b,c=x[a];if(c)return b=c.nextPos,c.result;c=m;m=!1;var e=b,d=b,f=Sa();if(f!==null){var h=Ta(),h=h!==null?h:"";h!==null?f=[f,h]:(f=
null,b=d)}else f=null,b=d;f!==null?d=f:(d=b,f=Ta(),f!==null?(h=Sa(),h=h!==null?h:"",h!==null?f=[f,h]:(f=null,b=d)):(f=null,b=d),d=f!==null?f:null);d=d!==null?function(a){for(var b={},f=0;f<a.length;f++){var d=a[f];if(d.limit!=null)b.limit=d.limit;else if(d.offset!=null)b.offset=d.offset}return b}(d):null;d===null&&(d=null,b=e);(m=c)&&d===null&&j("[24] LimitOffsetClauses");x[a]={nextPos:b,result:d};return d}function Sa(){var e="LimitClause@"+b,h=x[e];if(h)return b=h.nextPos,h.result;h=m;m=!1;var i=
b,d=b;if(a.substr(b,5)==="LIMIT"){var f="LIMIT";b+=5}else f=null,m&&j('"LIMIT"');f===null&&(a.substr(b,5)==="limit"?(f="limit",b+=5):(f=null,m&&j('"limit"')),f=f!==null?f:null);if(f!==null){for(var k=[],q=o();q!==null;)k.push(q),q=o();if(k!==null)if(q=ba(),q!==null){for(var v=[],n=o();n!==null;)v.push(n),n=o();v!==null?f=[f,k,q,v]:(f=null,b=d)}else f=null,b=d;else f=null,b=d}else f=null,b=d;d=f!==null?{limit:parseInt(f[2].value)}:null;d===null&&(d=null,b=i);(m=h)&&d===null&&j("[25] LimitClause");
x[e]={nextPos:b,result:d};return d}function Ta(){var e="OffsetClause@"+b,h=x[e];if(h)return b=h.nextPos,h.result;h=m;m=!1;var i=b,d=b;if(a.substr(b,6)==="OFFSET"){var f="OFFSET";b+=6}else f=null,m&&j('"OFFSET"');f===null&&(a.substr(b,6)==="offset"?(f="offset",b+=6):(f=null,m&&j('"offset"')),f=f!==null?f:null);if(f!==null){for(var k=[],q=o();q!==null;)k.push(q),q=o();if(k!==null)if(q=ba(),q!==null){for(var v=[],n=o();n!==null;)v.push(n),n=o();v!==null?f=[f,k,q,v]:(f=null,b=d)}else f=null,b=d;else f=
null,b=d}else f=null,b=d;d=f!==null?{offset:parseInt(f[2].value)}:null;d===null&&(d=null,b=i);(m=h)&&d===null&&j("[26] OffsetClause");x[e]={nextPos:b,result:d};return d}function ta(){var e="BindingsClause@"+b,h=x[e];if(h)return b=h.nextPos,h.result;h=m;m=!1;var i=b;if(a.substr(b,8)==="BINDINGS"){var d="BINDINGS";b+=8}else d=null,m&&j('"BINDINGS"');if(d!==null){for(var f=[],k=P();k!==null;)f.push(k),k=P();if(f!==null)if(a.substr(b,1)==="{"?(k="{",b+=1):(k=null,m&&j('"{"')),k!==null){var q=[],v=b;if(a.substr(b,
1)==="("){var n="(";b+=1}else n=null,m&&j('"("');if(n!==null){var g=sa();if(g!==null)for(var o=[];g!==null;)o.push(g),g=sa();else o=null;o!==null?(a.substr(b,1)===")"?(g=")",b+=1):(g=null,m&&j('")"')),g!==null?n=[n,o,g]:(n=null,b=v)):(n=null,b=v)}else n=null,b=v;n!==null?v=n:(v=ia(),v=v!==null?v:null);for(;v!==null;){q.push(v);v=b;a.substr(b,1)==="("?(n="(",b+=1):(n=null,m&&j('"("'));if(n!==null){g=sa();if(g!==null)for(o=[];g!==null;)o.push(g),g=sa();else o=null;o!==null?(a.substr(b,1)===")"?(g=")",
b+=1):(g=null,m&&j('")"')),g!==null?n=[n,o,g]:(n=null,b=v)):(n=null,b=v)}else n=null,b=v;n!==null?v=n:(v=ia(),v=v!==null?v:null)}q!==null?(a.substr(b,1)==="}"?(v="}",b+=1):(v=null,m&&j('"}"')),v!==null?d=[d,f,k,q,v]:(d=null,b=i)):(d=null,b=i)}else d=null,b=i;else d=null,b=i}else d=null,b=i;i=d!==null?d:"";(m=h)&&i===null&&j("[27] BindingsClause");x[e]={nextPos:b,result:i};return i}function sa(){var e="BindingValue@"+b,h=x[e];if(h)return b=h.nextPos,h.result;h=m;m=!1;var i=Q();i===null&&(i=Da(),i===
null&&(i=Ea(),i===null&&(i=Fa(),i===null&&(a.substr(b,5)==="UNDEF"?(i="UNDEF",b+=5):(i=null,m&&j('"UNDEF"')),i=i!==null?i:null))));(m=h)&&i===null&&j("[28] BindingValue");x[e]={nextPos:b,result:i};return i}function Ua(){var e="Update@"+b,h=x[e];if(h)return b=h.nextPos,h.result;h=m;m=!1;var i=b,d=b,f=r();if(f!==null){for(var k=[],q=o();q!==null;)k.push(q),q=o();if(k!==null)if(q=pb(),q!==null){for(var v=b,n=[],g=o();g!==null;)n.push(g),g=o();if(n!==null)if(a.substr(b,1)===";"?(g=";",b+=1):(g=null,m&&
j('";"')),g!==null){for(var s=[],l=o();l!==null;)s.push(l),l=o();s!==null?(l=Ua(),l=l!==null?l:"",l!==null?n=[n,g,s,l]:(n=null,b=v)):(n=null,b=v)}else n=null,b=v;else n=null,b=v;v=n!==null?n:"";v!==null?f=[f,k,q,v]:(f=null,b=d)}else f=null,b=d;else f=null,b=d}else f=null,b=d;d=f!==null?function(a,b,f){var d={token:"query",kind:"update"};d.prologue=a;a=[b];f.length!=null&&f[3]!=null&&f[3].units!=null&&(a=a.concat(f[3].units));d.units=a;return d}(f[0],f[2],f[3]):null;d===null&&(d=null,b=i);(m=h)&&d===
null&&j("[30] Update");x[e]={nextPos:b,result:d};return d}function pb(){var a="Update1@"+b,c=x[a];if(c)return b=c.nextPos,c.result;c=m;m=!1;var e=qb();e===null&&(e=tb(),e===null&&(e=ub(),e===null&&(e=vb(),e===null&&(e=wb(),e===null&&(e=xb(),e===null&&(e=rb(),e===null&&(e=sb(),e=e!==null?e:null)))))));(m=c)&&e===null&&j("[31] Update1");x[a]={nextPos:b,result:e};return e}function qb(){var e="Load@"+b,h=x[e];if(h)return b=h.nextPos,h.result;h=m;m=!1;var i=b,d=b;if(a.substr(b,4)==="LOAD"){var f="LOAD";
b+=4}else f=null,m&&j('"LOAD"');f===null&&(a.substr(b,4)==="load"?(f="load",b+=4):(f=null,m&&j('"load"')),f=f!==null?f:null);if(f!==null){for(var k=[],q=o();q!==null;)k.push(q),q=o();if(k!==null)if(q=Q(),q!==null){for(var v=[],n=o();n!==null;)v.push(n),n=o();if(v!==null){n=b;if(a.substr(b,4)==="INTO"){var g="INTO";b+=4}else g=null,m&&j('"INTO"');g===null&&(a.substr(b,4)==="into"?(g="into",b+=4):(g=null,m&&j('"into"')),g=g!==null?g:null);if(g!==null){for(var s=[],l=o();l!==null;)s.push(l),l=o();s!==
null?(l=Ga(),l!==null?g=[g,s,l]:(g=null,b=n)):(g=null,b=n)}else g=null,b=n;n=g!==null?g:"";n!==null?f=[f,k,q,v,n]:(f=null,b=d)}else f=null,b=d}else f=null,b=d;else f=null,b=d}else f=null,b=d;d=f!==null?function(a,b){var f={kind:"load",token:"executableunit"};f.sourceGraph=a;f.destinyGraph=b[2];return f}(f[2],f[4]):null;d===null&&(d=null,b=i);(m=h)&&d===null&&j("[32] Load");x[e]={nextPos:b,result:d};return d}function tb(){var e="Clear@"+b,h=x[e];if(h)return b=h.nextPos,h.result;h=m;m=!1;var i=b,d=
b;if(a.substr(b,5)==="CLEAR"){var f="CLEAR";b+=5}else f=null,m&&j('"CLEAR"');f===null&&(a.substr(b,5)==="clear"?(f="clear",b+=5):(f=null,m&&j('"clear"')),f=f!==null?f:null);if(f!==null){for(var k=[],q=o();q!==null;)k.push(q),q=o();if(k!==null)if(a.substr(b,6)==="SILENT"?(q="SILENT",b+=6):(q=null,m&&j('"SILENT"')),q===null&&(a.substr(b,6)==="silent"?(q="silent",b+=6):(q=null,m&&j('"silent"')),q=q!==null?q:null),q=q!==null?q:"",q!==null){for(var v=[],n=o();n!==null;)v.push(n),n=o();v!==null?(n=$a(),
n!==null?f=[f,k,q,v,n]:(f=null,b=d)):(f=null,b=d)}else f=null,b=d;else f=null,b=d}else f=null,b=d;d=f!==null?function(a){var b={kind:"clear",token:"executableunit"};b.destinyGraph=a;return b}(f[4]):null;d===null&&(d=null,b=i);(m=h)&&d===null&&j("[33] Clear");x[e]={nextPos:b,result:d};return d}function ub(){var e="Drop@"+b,h=x[e];if(h)return b=h.nextPos,h.result;h=m;m=!1;var i=b,d=b;if(a.substr(b,4)==="DROP"){var f="DROP";b+=4}else f=null,m&&j('"DROP"');f===null&&(a.substr(b,4)==="drop"?(f="drop",
b+=4):(f=null,m&&j('"drop"')),f=f!==null?f:null);if(f!==null){for(var k=[],q=o();q!==null;)k.push(q),q=o();if(k!==null)if(a.substr(b,6)==="SILENT"?(q="SILENT",b+=6):(q=null,m&&j('"SILENT"')),q===null&&(a.substr(b,6)==="silent"?(q="silent",b+=6):(q=null,m&&j('"silent"')),q=q!==null?q:null),q=q!==null?q:"",q!==null){for(var v=[],n=o();n!==null;)v.push(n),n=o();v!==null?(n=$a(),n!==null?f=[f,k,q,v,n]:(f=null,b=d)):(f=null,b=d)}else f=null,b=d;else f=null,b=d}else f=null,b=d;d=f!==null?function(a){var b=
{kind:"drop",token:"executableunit"};b.destinyGraph=a;return b}(f[4]):null;d===null&&(d=null,b=i);(m=h)&&d===null&&j("[34] Drop");x[e]={nextPos:b,result:d};return d}function vb(){var e="Create@"+b,h=x[e];if(h)return b=h.nextPos,h.result;h=m;m=!1;var i=b,d=b;if(a.substr(b,6)==="CREATE"){var f="CREATE";b+=6}else f=null,m&&j('"CREATE"');f===null&&(a.substr(b,6)==="create"?(f="create",b+=6):(f=null,m&&j('"create"')),f=f!==null?f:null);if(f!==null){for(var k=[],q=o();q!==null;)k.push(q),q=o();if(k!==null)if(a.substr(b,
6)==="SILENT"?(q="SILENT",b+=6):(q=null,m&&j('"SILENT"')),q===null&&(a.substr(b,6)==="silent"?(q="silent",b+=6):(q=null,m&&j('"silent"')),q=q!==null?q:null),q=q!==null?q:"",q!==null){for(var v=[],n=o();n!==null;)v.push(n),n=o();v!==null?(n=Ga(),n!==null?f=[f,k,q,v,n]:(f=null,b=d)):(f=null,b=d)}else f=null,b=d;else f=null,b=d}else f=null,b=d;d=f!==null?function(a){var b={kind:"create",token:"executableunit"};b.destinyGraph=a;return b}(f[4]):null;d===null&&(d=null,b=i);(m=h)&&d===null&&j("[35] Create");
x[e]={nextPos:b,result:d};return d}function wb(){var e="InsertData@"+b,h=x[e];if(h)return b=h.nextPos,h.result;h=m;m=!1;var i=b,d=b;if(a.substr(b,6)==="INSERT"){var f="INSERT";b+=6}else f=null,m&&j('"INSERT"');f===null&&(a.substr(b,6)==="insert"?(f="insert",b+=6):(f=null,m&&j('"insert"')),f=f!==null?f:null);if(f!==null){for(var k=[],q=o();q!==null;)k.push(q),q=o();if(k!==null)if(a.substr(b,4)==="DATA"?(q="DATA",b+=4):(q=null,m&&j('"DATA"')),q===null&&(a.substr(b,4)==="data"?(q="data",b+=4):(q=null,
m&&j('"data"')),q=q!==null?q:null),q!==null){for(var v=[],n=o();n!==null;)v.push(n),n=o();v!==null?(n=ab(),n!==null?f=[f,k,q,v,n]:(f=null,b=d)):(f=null,b=d)}else f=null,b=d;else f=null,b=d}else f=null,b=d;d=f!==null?function(a){var b={kind:"insertdata",token:"executableunit"};b.quads=a;return b}(f[4]):null;d===null&&(d=null,b=i);(m=h)&&d===null&&j("[36] InsertData");x[e]={nextPos:b,result:d};return d}function xb(){var e="DeleteData@"+b,h=x[e];if(h)return b=h.nextPos,h.result;h=m;m=!1;var i=b,d=b;
if(a.substr(b,6)==="DELETE"){var f="DELETE";b+=6}else f=null,m&&j('"DELETE"');f===null&&(a.substr(b,6)==="delete"?(f="delete",b+=6):(f=null,m&&j('"delete"')),f=f!==null?f:null);if(f!==null){for(var k=[],q=o();q!==null;)k.push(q),q=o();if(k!==null)if(a.substr(b,4)==="DATA"?(q="DATA",b+=4):(q=null,m&&j('"DATA"')),q===null&&(a.substr(b,4)==="data"?(q="data",b+=4):(q=null,m&&j('"data"')),q=q!==null?q:null),q!==null){var v=ab();v!==null?f=[f,k,q,v]:(f=null,b=d)}else f=null,b=d;else f=null,b=d}else f=null,
b=d;d=f!==null?function(a){var b={kind:"deletedata",token:"executableunit"};b.quads=a;return b}(f[3]):null;d===null&&(d=null,b=i);(m=h)&&d===null&&j("[37] DeleteData");x[e]={nextPos:b,result:d};return d}function rb(){var e="DeleteWhere@"+b,h=x[e];if(h)return b=h.nextPos,h.result;h=m;m=!1;var i=b,d=b;if(a.substr(b,6)==="DELETE"){var f="DELETE";b+=6}else f=null,m&&j('"DELETE"');f===null&&(a.substr(b,6)==="delete"?(f="delete",b+=6):(f=null,m&&j('"delete"')),f=f!==null?f:null);if(f!==null){for(var k=
[],q=o();q!==null;)k.push(q),q=o();if(k!==null)if(a.substr(b,5)==="WHERE"?(q="WHERE",b+=5):(q=null,m&&j('"WHERE"')),q===null&&(a.substr(b,5)==="where"?(q="where",b+=5):(q=null,m&&j('"where"')),q=q!==null?q:null),q!==null){for(var v=[],n=o();n!==null;)v.push(n),n=o();v!==null?(n=V(),n!==null?f=[f,k,q,v,n]:(f=null,b=d)):(f=null,b=d)}else f=null,b=d;else f=null,b=d}else f=null,b=d;d=f!==null?function(a){var b={kind:"modify"};b.pattern=a;b["with"]=null;b.using=null;for(var f=[],a=a.patterns[0],a=a.triplesContext==
null&&a.patterns!=null?a.patterns[0].triplesContext:a.triplesContext,d=0;d<a.length;d++){var c={},j=a[d];c.subject=j.subject;c.predicate=j.predicate;c.object=j.object;c.graph=j.graph;f.push(c)}b["delete"]=f;return b}(f[4]):null;d===null&&(d=null,b=i);(m=h)&&d===null&&j("[38] DeleteWhere");x[e]={nextPos:b,result:d};return d}function sb(){var e="Modify@"+b,h=x[e];if(h)return b=h.nextPos,h.result;h=m;m=!1;var i=b,d=b,f=b;if(a.substr(b,4)==="WITH"){var k="WITH";b+=4}else k=null,m&&j('"WITH"');k===null&&
(a.substr(b,4)==="with"?(k="with",b+=4):(k=null,m&&j('"with"')),k=k!==null?k:null);if(k!==null){for(var q=[],v=o();v!==null;)q.push(v),v=o();q!==null?(v=Q(),v!==null?k=[k,q,v]:(k=null,b=f)):(k=null,b=f)}else k=null,b=f;f=k!==null?k:"";if(f!==null){k=[];for(q=o();q!==null;)k.push(q),q=o();if(k!==null){q=b;v=yb();if(v!==null){for(var n=[],g=o();g!==null;)n.push(g),g=o();n!==null?(g=Wa(),g=g!==null?g:"",g!==null?v=[v,n,g]:(v=null,b=q)):(v=null,b=q)}else v=null,b=q;v!==null?q=v:(q=Wa(),q=q!==null?q:null);
if(q!==null){v=[];for(n=o();n!==null;)v.push(n),n=o();if(v!==null){n=[];for(g=bb();g!==null;)n.push(g),g=bb();if(n!==null){for(var g=[],s=o();s!==null;)g.push(s),s=o();if(g!==null)if(a.substr(b,5)==="WHERE"?(s="WHERE",b+=5):(s=null,m&&j('"WHERE"')),s===null&&(a.substr(b,5)==="where"?(s="where",b+=5):(s=null,m&&j('"where"')),s=s!==null?s:null),s!==null){for(var l=[],r=o();r!==null;)l.push(r),r=o();if(l!==null)if(r=V(),r!==null){for(var t=[],u=o();u!==null;)t.push(u),u=o();t!==null?f=[f,k,q,v,n,g,s,
l,r,t]:(f=null,b=d)}else f=null,b=d;else f=null,b=d}else f=null,b=d;else f=null,b=d}else f=null,b=d}else f=null,b=d}else f=null,b=d}else f=null,b=d}else f=null,b=d;d=f!==null?function(a,b,f,d){var c={kind:"modify"};c["with"]=a!=""?a[2]:null;b.length===3&&b[2]===""?(c["delete"]=b[0],c.insert=null):b.length===3&&b[0].length!=null&&b[1].length!=null&&b[2].length!=null?(c["delete"]=b[0],c.insert=b[2]):(c.insert=b,c["delete"]=null);f!=""&&(c.using=f);c.pattern=d;return c}(f[0],f[2],f[4],f[8]):null;d===
null&&(d=null,b=i);(m=h)&&d===null&&j("[39] Modify");x[e]={nextPos:b,result:d};return d}function yb(){var e="DeleteClause@"+b,h=x[e];if(h)return b=h.nextPos,h.result;h=m;m=!1;var k=b,d=b;if(a.substr(b,6)==="DELETE"){var f="DELETE";b+=6}else f=null,m&&j('"DELETE"');f===null&&(a.substr(b,6)==="delete"?(f="delete",b+=6):(f=null,m&&j('"delete"')),f=f!==null?f:null);if(f!==null){var i=cb();i!==null?f=[f,i]:(f=null,b=d)}else f=null,b=d;d=f!==null?f[1]:null;d===null&&(d=null,b=k);(m=h)&&d===null&&j("[40] DeleteClause");
x[e]={nextPos:b,result:d};return d}function Wa(){var e="InsertClause@"+b,h=x[e];if(h)return b=h.nextPos,h.result;h=m;m=!1;var k=b,d=b;if(a.substr(b,6)==="INSERT"){var f="INSERT";b+=6}else f=null,m&&j('"INSERT"');f===null&&(a.substr(b,6)==="insert"?(f="insert",b+=6):(f=null,m&&j('"insert"')),f=f!==null?f:null);if(f!==null){var i=cb();i!==null?f=[f,i]:(f=null,b=d)}else f=null,b=d;d=f!==null?f[1]:null;d===null&&(d=null,b=k);(m=h)&&d===null&&j("[41] InsertClause");x[e]={nextPos:b,result:d};return d}function bb(){var e=
"UsingClause@"+b,h=x[e];if(h)return b=h.nextPos,h.result;h=m;m=!1;for(var k=b,d=b,f=[],i=o();i!==null;)f.push(i),i=o();if(f!==null)if(a.substr(b,5)==="USING"?(i="USING",b+=5):(i=null,m&&j('"USING"')),i===null&&(a.substr(b,5)==="using"?(i="using",b+=5):(i=null,m&&j('"using"')),i=i!==null?i:null),i!==null){for(var q=[],v=o();v!==null;)q.push(v),v=o();if(q!==null){v=Q();if(v===null){v=b;if(a.substr(b,5)==="NAMED"){var n="NAMED";b+=5}else n=null,m&&j('"NAMED"');n===null&&(a.substr(b,5)==="named"?(n="named",
b+=5):(n=null,m&&j('"named"')),n=n!==null?n:null);if(n!==null){for(var g=[],s=o();s!==null;)g.push(s),s=o();g!==null?(s=Q(),s!==null?n=[n,g,s]:(n=null,b=v)):(n=null,b=v)}else n=null,b=v;v=n!==null?n:null}v!==null?f=[f,i,q,v]:(f=null,b=d)}else f=null,b=d}else f=null,b=d;else f=null,b=d;d=f!==null?f[3].length!=null?{kind:"named",uri:f[3][2]}:{kind:"default",uri:f[3]}:null;d===null&&(d=null,b=k);(m=h)&&d===null&&j("[42] UsingClause");x[e]={nextPos:b,result:d};return d}function Ga(){var e="GraphRef@"+
b,h=x[e];if(h)return b=h.nextPos,h.result;h=m;m=!1;var i=b,d=b;if(a.substr(b,5)==="GRAPH"){var f="GRAPH";b+=5}else f=null,m&&j('"GRAPH"');f===null&&(a.substr(b,5)==="graph"?(f="graph",b+=5):(f=null,m&&j('"graph"')),f=f!==null?f:null);if(f!==null){for(var k=[],q=o();q!==null;)k.push(q),q=o();k!==null?(q=Q(),q!==null?f=[f,k,q]:(f=null,b=d)):(f=null,b=d)}else f=null,b=d;d=f!==null?f[2]:null;d===null&&(d=null,b=i);(m=h)&&d===null&&j("[43] GraphRef");x[e]={nextPos:b,result:d};return d}function $a(){var e=
"GraphRefAll@"+b,h=x[e];if(h)return b=h.nextPos,h.result;h=m;m=!1;var k=b,d=Ga(),d=d!==null?d:null;d===null&&(d=null,b=k);d!==null?k=d:(k=b,a.substr(b,7)==="DEFAULT"?(d="DEFAULT",b+=7):(d=null,m&&j('"DEFAULT"')),d===null&&(a.substr(b,7)==="default"?(d="default",b+=7):(d=null,m&&j('"default"')),d=d!==null?d:null),d=d!==null?"default":null,d===null&&(d=null,b=k),d!==null?k=d:(k=b,a.substr(b,5)==="NAMED"?(d="NAMED",b+=5):(d=null,m&&j('"NAMED"')),d===null&&(a.substr(b,5)==="named"?(d="named",b+=5):(d=
null,m&&j('"named"')),d=d!==null?d:null),d=d!==null?"named":null,d===null&&(d=null,b=k),d!==null?k=d:(k=b,a.substr(b,3)==="ALL"?(d="ALL",b+=3):(d=null,m&&j('"ALL"')),d===null&&(a.substr(b,3)==="all"?(d="all",b+=3):(d=null,m&&j('"all"')),d=d!==null?d:null),d=d!==null?"all":null,d===null&&(d=null,b=k),k=d!==null?d:null)));(m=h)&&k===null&&j("[44] GraphRefAll");x[e]={nextPos:b,result:k};return k}function cb(){var e="QuadPattern@"+b,h=x[e];if(h)return b=h.nextPos,h.result;h=m;m=!1;for(var k=b,d=b,f=[],
i=o();i!==null;)f.push(i),i=o();if(f!==null)if(a.substr(b,1)==="{"?(i="{",b+=1):(i=null,m&&j('"{"')),i!==null){for(var q=[],v=o();v!==null;)q.push(v),v=o();if(q!==null)if(v=db(),v!==null){for(var n=[],g=o();g!==null;)n.push(g),g=o();if(n!==null)if(a.substr(b,1)==="}"?(g="}",b+=1):(g=null,m&&j('"}"')),g!==null){for(var s=[],l=o();l!==null;)s.push(l),l=o();s!==null?f=[f,i,q,v,n,g,s]:(f=null,b=d)}else f=null,b=d;else f=null,b=d}else f=null,b=d;else f=null,b=d}else f=null,b=d;else f=null,b=d;d=f!==null?
f[3].quadsContext:null;d===null&&(d=null,b=k);(m=h)&&d===null&&j("[45] QuadPattern");x[e]={nextPos:b,result:d};return d}function ab(){var e="QuadData@"+b,h=x[e];if(h)return b=h.nextPos,h.result;h=m;m=!1;for(var k=b,d=b,f=[],i=o();i!==null;)f.push(i),i=o();if(f!==null)if(a.substr(b,1)==="{"?(i="{",b+=1):(i=null,m&&j('"{"')),i!==null){for(var q=[],v=o();v!==null;)q.push(v),v=o();if(q!==null)if(v=db(),v!==null){for(var n=[],g=o();g!==null;)n.push(g),g=o();if(n!==null)if(a.substr(b,1)==="}"?(g="}",b+=
1):(g=null,m&&j('"}"')),g!==null){for(var s=[],l=o();l!==null;)s.push(l),l=o();s!==null?f=[f,i,q,v,n,g,s]:(f=null,b=d)}else f=null,b=d;else f=null,b=d}else f=null,b=d;else f=null,b=d}else f=null,b=d;else f=null,b=d;d=f!==null?f[3].quadsContext:null;d===null&&(d=null,b=k);(m=h)&&d===null&&j("[46] QuadData");x[e]={nextPos:b,result:d};return d}function db(){var e="Quads@"+b,h=x[e];if(h)return b=h.nextPos,h.result;h=m;m=!1;var k=b,d=b,f=ma(),f=f!==null?f:"";if(f!==null){var i=[],q=b,v=eb();if(v!==null){if(a.substr(b,
1)==="."){var n=".";b+=1}else n=null,m&&j('"."');n=n!==null?n:"";if(n!==null){var g=ma(),g=g!==null?g:"";g!==null?v=[v,n,g]:(v=null,b=q)}else v=null,b=q}else v=null,b=q;for(;v!==null;)i.push(v),q=b,v=eb(),v!==null?(a.substr(b,1)==="."?(n=".",b+=1):(n=null,m&&j('"."')),n=n!==null?n:"",n!==null?(g=ma(),g=g!==null?g:"",g!==null?v=[v,n,g]:(v=null,b=q)):(v=null,b=q)):(v=null,b=q);i!==null?f=[f,i]:(f=null,b=d)}else f=null,b=d;d=f!==null?function(a,b){var f=[];if(a.triplesContext!=null&&a.triplesContext!=
null)for(var d=0;d<a.triplesContext.length;d++){var c=a.triplesContext[d];c.graph=null;f.push(c)}if(b&&b.length>0&&b[0].length>0&&(f=f.concat(b[0][0].quadsContext),b[0][2]!=null&&b[0][2].triplesContext!=null))for(d=0;d<b[0][2].triplesContext.length;d++)c=b[0][2].triplesContext[d],c.graph=null,f.push(c);return{token:"quads",quadsContext:f}}(f[0],f[1]):null;d===null&&(d=null,b=k);(m=h)&&d===null&&j("[47] Quads");x[e]={nextPos:b,result:d};return d}function eb(){var e="QuadsNotTriples@"+b,h=x[e];if(h)return b=
h.nextPos,h.result;h=m;m=!1;for(var k=b,d=b,f=[],i=o();i!==null;)f.push(i),i=o();if(f!==null)if(a.substr(b,5)==="GRAPH"?(i="GRAPH",b+=5):(i=null,m&&j('"GRAPH"')),i===null&&(a.substr(b,5)==="graph"?(i="graph",b+=5):(i=null,m&&j('"graph"')),i=i!==null?i:null),i!==null){for(var q=[],v=o();v!==null;)q.push(v),v=o();if(q!==null)if(v=ha(),v!==null){for(var n=[],g=o();g!==null;)n.push(g),g=o();if(n!==null)if(a.substr(b,1)==="{"?(g="{",b+=1):(g=null,m&&j('"{"')),g!==null){for(var s=[],l=o();l!==null;)s.push(l),
l=o();if(s!==null)if(l=ma(),l=l!==null?l:"",l!==null){for(var r=[],t=o();t!==null;)r.push(t),t=o();if(r!==null)if(a.substr(b,1)==="}"?(t="}",b+=1):(t=null,m&&j('"}"')),t!==null){for(var u=[],w=o();w!==null;)u.push(w),w=o();u!==null?f=[f,i,q,v,n,g,s,l,r,t,u]:(f=null,b=d)}else f=null,b=d;else f=null,b=d}else f=null,b=d;else f=null,b=d}else f=null,b=d;else f=null,b=d}else f=null,b=d;else f=null,b=d}else f=null,b=d;else f=null,b=d;d=f!==null?function(a,b){for(var f=[],d=0;d<b.triplesContext.length;d++){var c=
b.triplesContext[d];c.graph=a;f.push(c)}return{token:"quadsnottriples",quadsContext:f}}(f[3],f[7]):null;d===null&&(d=null,b=k);(m=h)&&d===null&&j("[48] QuadsNotTriples");x[e]={nextPos:b,result:d};return d}function ma(){var e="TriplesTemplate@"+b,h=x[e];if(h)return b=h.nextPos,h.result;h=m;m=!1;var i=b,d=b,f=fb();if(f!==null){for(var k=b,q=[],v=o();v!==null;)q.push(v),v=o();if(q!==null)if(a.substr(b,1)==="."?(v=".",b+=1):(v=null,m&&j('"."')),v!==null){for(var n=[],g=o();g!==null;)n.push(g),g=o();n!==
null?(g=ma(),g=g!==null?g:"",g!==null?q=[q,v,n,g]:(q=null,b=k)):(q=null,b=k)}else q=null,b=k;else q=null,b=k;k=q!==null?q:"";k!==null?f=[f,k]:(f=null,b=d)}else f=null,b=d;d=f!==null?function(a,b){var f=a.triplesContext;typeof b==="object"&&b.length!=null&&b[3].triplesContext!=null&&(f=f.concat(b[3].triplesContext));return{token:"triplestemplate",triplesContext:f}}(f[0],f[1]):null;d===null&&(d=null,b=i);(m=h)&&d===null&&j("[49] TriplesTemplate");x[e]={nextPos:b,result:d};return d}function V(){var e=
"GroupGraphPattern@"+b,h=x[e];if(h)return b=h.nextPos,h.result;h=m;m=!1;var i=b,d=b;if(a.substr(b,1)==="{"){var f="{";b+=1}else f=null,m&&j('"{"');if(f!==null){for(var k=[],q=o();q!==null;)k.push(q),q=o();if(k!==null)if(q=G(),q!==null){for(var v=[],n=o();n!==null;)v.push(n),n=o();v!==null?(a.substr(b,1)==="}"?(n="}",b+=1):(n=null,m&&j('"}"')),n!==null?f=[f,k,q,v,n]:(f=null,b=d)):(f=null,b=d)}else f=null,b=d;else f=null,b=d}else f=null,b=d;d=f!==null?f[2]:null;d===null&&(d=null,b=i);if(d!==null)i=
d;else{d=i=b;a.substr(b,1)==="{"?(f="{",b+=1):(f=null,m&&j('"{"'));if(f!==null){k=[];for(q=o();q!==null;)k.push(q),q=o();if(k!==null)if(q=Bb(),q!==null){v=[];for(n=o();n!==null;)v.push(n),n=o();v!==null?(a.substr(b,1)==="}"?(n="}",b+=1):(n=null,m&&j('"}"')),n!==null?f=[f,k,q,v,n]:(f=null,b=d)):(f=null,b=d)}else f=null,b=d;else f=null,b=d}else f=null,b=d;d=f!==null?f[2]:null;d===null&&(d=null,b=i);i=d!==null?d:null}(m=h)&&i===null&&j("[50] GroupGraphPattern");x[e]={nextPos:b,result:i};return i}function Bb(){var e=
"GroupGraphPatternSub@"+b,h=x[e];if(h)return b=h.nextPos,h.result;h=m;m=!1;var i=b,d=b,f=la(),f=f!==null?f:"";if(f!==null){for(var k=[],q=o();q!==null;)k.push(q),q=o();if(k!==null){var q=[],v=b,n=gb();if(n!==null){for(var g=[],s=o();s!==null;)g.push(s),s=o();if(g!==null)if(a.substr(b,1)==="."?(s=".",b+=1):(s=null,m&&j('"."')),s=s!==null?s:"",s!==null){for(var l=[],r=o();r!==null;)l.push(r),r=o();l!==null?(r=la(),r=r!==null?r:"",r!==null?n=[n,g,s,l,r]:(n=null,b=v)):(n=null,b=v)}else n=null,b=v;else n=
null,b=v}else n=null,b=v;for(;n!==null;)if(q.push(n),v=b,n=gb(),n!==null){g=[];for(s=o();s!==null;)g.push(s),s=o();if(g!==null)if(a.substr(b,1)==="."?(s=".",b+=1):(s=null,m&&j('"."')),s=s!==null?s:"",s!==null){l=[];for(r=o();r!==null;)l.push(r),r=o();l!==null?(r=la(),r=r!==null?r:"",r!==null?n=[n,g,s,l,r]:(n=null,b=v)):(n=null,b=v)}else n=null,b=v;else n=null,b=v}else n=null,b=v;q!==null?f=[f,k,q]:(f=null,b=d)}else f=null,b=d}else f=null,b=d;d=f!==null?function(a,b){var f=[];a!=null&&a!=[]&&f.push(a);
for(var d=0;d<b.length;d++)for(var c=0;c<b[d].length;c++)b[d][c].token!=null&&f.push(b[d][c]);for(var e=[],j=[],h=[],d=0;d<f.length;d++)if(f[d].token!="triplespattern"&&f[d].token!="filter"){if(j.length!=0||h.length!=0){for(var q=[],c=0;c<j.length;c++)q=q.concat(j[c].triplesContext);q.length>0&&e.push({token:"basicgraphpattern",triplesContext:q});j=[]}e.push(f[d])}else f[d].token==="triplespattern"?j.push(f[d]):h.push(f[d]);if(j.length!=0||h.length!=0){q=[];for(c=0;c<j.length;c++)q=q.concat(j[c].triplesContext);
q.length>0&&e.push({token:"basicgraphpattern",triplesContext:q})}return{token:"groupgraphpattern",patterns:e,filters:h}}(f[0],f[2]):null;d===null&&(d=null,b=i);(m=h)&&d===null&&j("[51] GroupGraphPatternSub");x[e]={nextPos:b,result:d};return d}function la(){var e="TriplesBlock@"+b,h=x[e];if(h)return b=h.nextPos,h.result;h=m;m=!1;var i=b,d=b,f=Cb();if(f!==null){for(var k=b,q=[],v=o();v!==null;)q.push(v),v=o();if(q!==null)if(a.substr(b,1)==="."?(v=".",b+=1):(v=null,m&&j('"."')),v!==null){var n=la(),
n=n!==null?n:"";n!==null?q=[q,v,n]:(q=null,b=k)}else q=null,b=k;else q=null,b=k;k=q!==null?q:"";k!==null?f=[f,k]:(f=null,b=d)}else f=null,b=d;d=f!==null?function(a,b){var f=a.triplesContext;typeof b==="object"&&b.length!=null&&b[2].triplesContext!=null&&(f=f.concat(b[2].triplesContext));return{token:"triplespattern",triplesContext:f}}(f[0],f[1]):null;d===null&&(d=null,b=i);(m=h)&&d===null&&j("[54] TriplesBlock");x[e]={nextPos:b,result:d};return d}function gb(){var a="GraphPatternNotTriples@"+b,c=
x[a];if(c)return b=c.nextPos,c.result;c=m;m=!1;var e=Db();e===null&&(e=Eb(),e===null&&(e=Fb(),e===null&&(e=Gb(),e===null&&(e=Hb(),e===null&&(e=Ib(),e=e!==null?e:null)))));(m=c)&&e===null&&j("[53] GraphPatternNotTriples");x[a]={nextPos:b,result:e};return e}function Eb(){var e="OptionalGraphPattern@"+b,h=x[e];if(h)return b=h.nextPos,h.result;h=m;m=!1;for(var k=b,d=b,f=[],i=o();i!==null;)f.push(i),i=o();if(f!==null)if(a.substr(b,8)==="OPTIONAL"?(i="OPTIONAL",b+=8):(i=null,m&&j('"OPTIONAL"')),i===null&&
(a.substr(b,8)==="optional"?(i="optional",b+=8):(i=null,m&&j('"optional"')),i=i!==null?i:null),i!==null){for(var q=[],v=o();v!==null;)q.push(v),v=o();q!==null?(v=V(),v!==null?f=[f,i,q,v]:(f=null,b=d)):(f=null,b=d)}else f=null,b=d;else f=null,b=d;d=f!==null?{token:"optionalgraphpattern",value:f[3]}:null;d===null&&(d=null,b=k);(m=h)&&d===null&&j("[54] OptionalGraphPattern");x[e]={nextPos:b,result:d};return d}function Gb(){var e="GraphGraphPattern@"+b,h=x[e];if(h)return b=h.nextPos,h.result;h=m;m=!1;
for(var i=b,d=b,f=[],k=o();k!==null;)f.push(k),k=o();if(f!==null)if(a.substr(b,5)==="GRAPH"?(k="GRAPH",b+=5):(k=null,m&&j('"GRAPH"')),k===null&&(a.substr(b,5)==="graph"?(k="graph",b+=5):(k=null,m&&j('"graph"')),k=k!==null?k:null),k!==null){for(var q=[],v=o();v!==null;)q.push(v),v=o();if(q!==null)if(v=ha(),v!==null){for(var n=[],g=o();g!==null;)n.push(g),g=o();n!==null?(g=V(),g!==null?f=[f,k,q,v,n,g]:(f=null,b=d)):(f=null,b=d)}else f=null,b=d;else f=null,b=d}else f=null,b=d;else f=null,b=d;d=f!==null?
function(a,b){for(var f=0;f<b.patterns.length;f++)for(var d=b.patterns[f],c=0;c<d.triplesContext.length;c++)d.triplesContext[c].graph=a;b.token="groupgraphpattern";return b}(f[3],f[5]):null;d===null&&(d=null,b=i);(m=h)&&d===null&&j("[55] GraphGraphPattern");x[e]={nextPos:b,result:d};return d}function Hb(){var e="ServiceGraphPattern@"+b,h=x[e];if(h)return b=h.nextPos,h.result;h=m;m=!1;var k=b,d=b;if(a.substr(b,7)==="SERVICE"){var f="SERVICE";b+=7}else f=null,m&&j('"SERVICE"');if(f!==null){var i=ha();
if(i!==null){var q=V();q!==null?f=[f,i,q]:(f=null,b=d)}else f=null,b=d}else f=null,b=d;d=f!==null?{token:"servicegraphpattern",status:"todo",value:[f[1],f[2]]}:null;d===null&&(d=null,b=k);(m=h)&&d===null&&j("[56] ServiceGraphPattern");x[e]={nextPos:b,result:d};return d}function Fb(){var e="MinusGraphPattern@"+b,h=x[e];if(h)return b=h.nextPos,h.result;h=m;m=!1;var k=b,d=b;if(a.substr(b,5)==="MINUS"){var f="MINUS";b+=5}else f=null,m&&j('"MINUS"');if(f!==null){var i=V();i!==null?f=[f,i]:(f=null,b=d)}else f=
null,b=d;d=f!==null?{token:"minusgraphpattern",status:"todo",value:f[1]}:null;d===null&&(d=null,b=k);(m=h)&&d===null&&j("[57] MinusGraphPattern");x[e]={nextPos:b,result:d};return d}function Db(){var e="GroupOrUnionGraphPattern@"+b,h=x[e];if(h)return b=h.nextPos,h.result;h=m;m=!1;var k=b,d=b,f=V();if(f!==null){for(var i=[],q=b,v=[],n=o();n!==null;)v.push(n),n=o();if(v!==null)if(a.substr(b,5)==="UNION"?(n="UNION",b+=5):(n=null,m&&j('"UNION"')),n===null&&(a.substr(b,5)==="union"?(n="union",b+=5):(n=
null,m&&j('"union"')),n=n!==null?n:null),n!==null){for(var g=[],s=o();s!==null;)g.push(s),s=o();g!==null?(s=V(),s!==null?v=[v,n,g,s]:(v=null,b=q)):(v=null,b=q)}else v=null,b=q;else v=null,b=q;for(;v!==null;){i.push(v);q=b;v=[];for(n=o();n!==null;)v.push(n),n=o();if(v!==null)if(a.substr(b,5)==="UNION"?(n="UNION",b+=5):(n=null,m&&j('"UNION"')),n===null&&(a.substr(b,5)==="union"?(n="union",b+=5):(n=null,m&&j('"union"')),n=n!==null?n:null),n!==null){g=[];for(s=o();s!==null;)g.push(s),s=o();g!==null?(s=
V(),s!==null?v=[v,n,g,s]:(v=null,b=q)):(v=null,b=q)}else v=null,b=q;else v=null,b=q}i!==null?f=[f,i]:(f=null,b=d)}else f=null,b=d;d=f!==null?function(a,b){if(b.length===0)return a;else{for(var f={token:"graphunionpattern",value:[a]},d=0;d<b.length;d++)d==b.length-1?f.value.push(b[d][3]):(f.value.push(b[d][3]),f={token:"graphunionpattern",value:[f]});return f}}(f[0],f[1]):null;d===null&&(d=null,b=k);(m=h)&&d===null&&j("[58] GroupOrUnionGraphPattern");x[e]={nextPos:b,result:d};return d}function Ib(){var e=
"Filter@"+b,h=x[e];if(h)return b=h.nextPos,h.result;h=m;m=!1;for(var i=b,d=b,f=[],k=o();k!==null;)f.push(k),k=o();if(f!==null)if(a.substr(b,6)==="FILTER"?(k="FILTER",b+=6):(k=null,m&&j('"FILTER"')),k===null&&(a.substr(b,6)==="filter"?(k="filter",b+=6):(k=null,m&&j('"filter"')),k=k!==null?k:null),k!==null){for(var q=[],v=o();v!==null;)q.push(v),v=o();q!==null?(v=va(),v!==null?f=[f,k,q,v]:(f=null,b=d)):(f=null,b=d)}else f=null,b=d;else f=null,b=d;d=f!==null?{token:"filter",value:f[3]}:null;d===null&&
(d=null,b=i);(m=h)&&d===null&&j("[59] Filter");x[e]={nextPos:b,result:d};return d}function va(){var a="Constraint@"+b,c=x[a];if(c)return b=c.nextPos,c.result;c=m;m=!1;var e=Ca();e===null&&(e=Ba(),e===null&&(e=Za(),e=e!==null?e:null));(m=c)&&e===null&&j("[60] Constraint");x[a]={nextPos:b,result:e};return e}function Za(){var a="FunctionCall@"+b,c=x[a];if(c)return b=c.nextPos,c.result;c=m;m=!1;var e=b,d=b,f=Q();if(f!==null){var h=hb();h!==null?f=[f,h]:(f=null,b=d)}else f=null,b=d;d=f!==null?function(a,
b){var f={token:"expression",expressionType:"irireforfunction"};f.iriref=a;f.args=b.value;return f}(f[0],f[1]):null;d===null&&(d=null,b=e);(m=c)&&d===null&&j("[61] FunctionCall");x[a]={nextPos:b,result:d};return d}function hb(){var e="ArgList@"+b,h=x[e];if(h)return b=h.nextPos,h.result;h=m;m=!1;var k=b,d=ia()!==null?{token:"args",value:[]}:null;d===null&&(d=null,b=k);if(d!==null)k=d;else{d=k=b;if(a.substr(b,1)==="("){var f="(";b+=1}else f=null,m&&j('"("');if(f!==null){if(a.substr(b,8)==="DISTINCT"){var i=
"DISTINCT";b+=8}else i=null,m&&j('"DISTINCT"');i===null&&(a.substr(b,8)==="distinct"?(i="distinct",b+=8):(i=null,m&&j('"distinct"')),i=i!==null?i:null);i=i!==null?i:"";if(i!==null){var q=M();if(q!==null){var v=[],g=b;if(a.substr(b,1)===","){var o=",";b+=1}else o=null,m&&j('","');if(o!==null){var s=M();s!==null?o=[o,s]:(o=null,b=g)}else o=null,b=g;for(;o!==null;)v.push(o),g=b,a.substr(b,1)===","?(o=",",b+=1):(o=null,m&&j('","')),o!==null?(s=M(),s!==null?o=[o,s]:(o=null,b=g)):(o=null,b=g);v!==null?
(a.substr(b,1)===")"?(g=")",b+=1):(g=null,m&&j('")"')),g!==null?f=[f,i,q,v,g]:(f=null,b=d)):(f=null,b=d)}else f=null,b=d}else f=null,b=d}else f=null,b=d;d=f!==null?function(a,b,f){for(var d=[],c=0;c<f.length;c++)d.push(f[c][1]);f={token:"args"};f.value=[b].concat(d);f.distinct=a!=null&&a.toUpperCase()==="DISTINCT"?!0:!1;return f}(f[1],f[2],f[3]):null;d===null&&(d=null,b=k);k=d!==null?d:null}(m=h)&&k===null&&j("[62] ArgList");x[e]={nextPos:b,result:k};return k}function Jb(){var e="ExpressionList@"+
b,h=x[e];if(h)return b=h.nextPos,h.result;h=m;m=!1;var k=b,d=ia()!==null?{token:"args",value:[]}:null;d===null&&(d=null,b=k);if(d!==null)k=d;else{d=k=b;if(a.substr(b,1)==="("){var f="(";b+=1}else f=null,m&&j('"("');if(f!==null){var i=M();if(i!==null){var q=[],v=b;if(a.substr(b,1)===","){var g=",";b+=1}else g=null,m&&j('","');if(g!==null){var o=M();o!==null?g=[g,o]:(g=null,b=v)}else g=null,b=v;for(;g!==null;)q.push(g),v=b,a.substr(b,1)===","?(g=",",b+=1):(g=null,m&&j('","')),g!==null?(o=M(),o!==null?
g=[g,o]:(g=null,b=v)):(g=null,b=v);q!==null?(a.substr(b,1)===")"?(v=")",b+=1):(v=null,m&&j('")"')),v!==null?f=[f,i,q,v]:(f=null,b=d)):(f=null,b=d)}else f=null,b=d}else f=null,b=d;d=f!==null?function(a,b){for(var f=[],d=0;d<b.length;d++)f.push(b[d][1]);d={token:"args"};d.value=[a].concat(f);return d}(f[1],f[2]):null;d===null&&(d=null,b=k);k=d!==null?d:null}(m=h)&&k===null&&j("[63] ExpressionList");x[e]={nextPos:b,result:k};return k}function Ab(){var e="ConstructTemplate@"+b,h=x[e];if(h)return b=h.nextPos,
h.result;h=m;m=!1;var k=b,d=b;if(a.substr(b,1)==="{"){var f="{";b+=1}else f=null,m&&j('"{"');if(f!==null){for(var i=[],q=o();q!==null;)i.push(q),q=o();if(i!==null)if(q=ib(),q=q!==null?q:"",q!==null){for(var g=[],n=o();n!==null;)g.push(n),n=o();g!==null?(a.substr(b,1)==="}"?(n="}",b+=1):(n=null,m&&j('"}"')),n!==null?f=[f,i,q,g,n]:(f=null,b=d)):(f=null,b=d)}else f=null,b=d;else f=null,b=d}else f=null,b=d;d=f!==null?f[2]:null;d===null&&(d=null,b=k);(m=h)&&d===null&&j("[64] ConstructTemplate");x[e]={nextPos:b,
result:d};return d}function ib(){var e="ConstructTriples@"+b,h=x[e];if(h)return b=h.nextPos,h.result;h=m;m=!1;var k=b,d=b,f=fb();if(f!==null){for(var i=b,q=[],g=o();g!==null;)q.push(g),g=o();if(q!==null)if(a.substr(b,1)==="."?(g=".",b+=1):(g=null,m&&j('"."')),g!==null){for(var n=[],l=o();l!==null;)n.push(l),l=o();n!==null?(l=ib(),l=l!==null?l:"",l!==null?q=[q,g,n,l]:(q=null,b=i)):(q=null,b=i)}else q=null,b=i;else q=null,b=i;i=q!==null?q:"";i!==null?f=[f,i]:(f=null,b=d)}else f=null,b=d;d=f!==null?
function(a,b){var f=a.triplesContext;typeof b==="object"&&b.length!=null&&b[3].triplesContext!=null&&(f=f.concat(b[3].triplesContext));return{token:"triplestemplate",triplesContext:f}}(f[0],f[1]):null;d===null&&(d=null,b=k);(m=h)&&d===null&&j("[65] ConstructTriples");x[e]={nextPos:b,result:d};return d}function fb(){var a="TriplesSameSubject@"+b,c=x[a];if(c)return b=c.nextPos,c.result;c=m;m=!1;for(var e=b,d=b,f=[],h=o();h!==null;)f.push(h),h=o();if(f!==null)if(h=Ha(),h!==null){for(var q=[],k=o();k!==
null;)q.push(k),k=o();q!==null?(k=wa(),k!==null?f=[f,h,q,k]:(f=null,b=d)):(f=null,b=d)}else f=null,b=d;else f=null,b=d;d=f!==null?function(a,b){var f=b.triplesContext;if(b.pairs)for(var d=0;d<b.pairs.length;d++){var c=b.pairs[d],e=null;c[1].length!=null&&(c[1]=c[1][0]);a.token&&a.token==="triplesnodecollection"?(e={subject:a.chainSubject[0],predicate:c[0],object:c[1]},f.push(e),f=f.concat(a.triplesContext)):(e={subject:a,predicate:c[0],object:c[1]},f.push(e))}d={token:"triplessamesubject"};d.triplesContext=
f;d.chainSubject=a;return d}(f[1],f[3]):null;d===null&&(d=null,b=e);if(d!==null)e=d;else{d=e=b;f=[];for(h=o();h!==null;)f.push(h),h=o();if(f!==null)if(h=Ia(),h!==null){q=[];for(k=o();k!==null;)q.push(k),k=o();q!==null?(k=Kb(),k!==null?f=[f,h,q,k]:(f=null,b=d)):(f=null,b=d)}else f=null,b=d;else f=null,b=d;d=f!==null?function(a,b){var f=a.triplesContext,d=a.chainSubject;if(b.pairs)for(var c=0;c<b.pairs.length;c++){var e=b.pairs[c];e[1].length!=null&&(e[1]=e[1][0]);if(a.token==="triplesnodecollection")for(var j=
0;j<d.length;j++){var h=d[j];if(h.triplesContext!=null){var q={subject:h.chainSubject,predicate:e[0],object:e[1]};f.concat(h.triplesContext)}else q={subject:d[j],predicate:e[0],object:e[1]},f.push(q)}else q={subject:d,predicate:e[0],object:e[1]},f.push(q)}c={token:"triplessamesubject"};c.triplesContext=f;c.chainSubject=d;return c}(f[1],f[3]):null;d===null&&(d=null,b=e);e=d!==null?d:null}(m=c)&&e===null&&j("[66] TriplesSameSubject");x[a]={nextPos:b,result:e};return e}function wa(){var e="PropertyListNotEmpty@"+
b,h=x[e];if(h)return b=h.nextPos,h.result;h=m;m=!1;var k=b,d=b,f=Ja();if(f!==null){for(var i=[],q=o();q!==null;)i.push(q),q=o();if(i!==null)if(q=ja(),q!==null){for(var g=[],n=b,l=[],s=o();s!==null;)l.push(s),s=o();if(l!==null)if(a.substr(b,1)===";"?(s=";",b+=1):(s=null,m&&j('";"')),s!==null){for(var r=[],t=o();t!==null;)r.push(t),t=o();if(r!==null){var t=b,u=Ja();if(u!==null){for(var w=[],y=o();y!==null;)w.push(y),y=o();w!==null?(y=ja(),y!==null?u=[u,w,y]:(u=null,b=t)):(u=null,b=t)}else u=null,b=
t;t=u!==null?u:"";t!==null?l=[l,s,r,t]:(l=null,b=n)}else l=null,b=n}else l=null,b=n;else l=null,b=n;for(;l!==null;){g.push(l);n=b;l=[];for(s=o();s!==null;)l.push(s),s=o();if(l!==null)if(a.substr(b,1)===";"?(s=";",b+=1):(s=null,m&&j('";"')),s!==null){r=[];for(t=o();t!==null;)r.push(t),t=o();if(r!==null){t=b;u=Ja();if(u!==null){w=[];for(y=o();y!==null;)w.push(y),y=o();w!==null?(y=ja(),y!==null?u=[u,w,y]:(u=null,b=t)):(u=null,b=t)}else u=null,b=t;t=u!==null?u:"";t!==null?l=[l,s,r,t]:(l=null,b=n)}else l=
null,b=n}else l=null,b=n;else l=null,b=n}g!==null?f=[f,i,q,g]:(f=null,b=d)}else f=null,b=d;else f=null,b=d}else f=null,b=d;d=f!==null?function(a,b,f){for(var d={token:"propertylist"},c=[],e=[],j=0;j<b.length;j++)b[j].triplesContext!=null?(c=c.concat(b[j].triplesContext),b[j].token==="triplesnodecollection"&&b[j].chainSubject.length!=null?e.push([a,b[j].chainSubject[0]]):e.push([a,b[j].chainSubject])):e.push([a,b[j]]);for(j=0;j<f.length;j++)for(var b=f[j][3],a=b[0],b=b[2]||[],h=0;h<b.length;h++)b[h].triplesContext!=
null?(c=c.concat(b[h].triplesContext),e.push([a,b[h].chainSubject])):e.push([a,b[h]]);d.pairs=e;d.triplesContext=c;return d}(f[0],f[2],f[3]):null;d===null&&(d=null,b=k);(m=h)&&d===null&&j("[67] PropertyListNotEmpty");x[e]={nextPos:b,result:d};return d}function Kb(){var a="PropertyList@"+b,c=x[a];if(c)return b=c.nextPos,c.result;c=m;m=!1;var e=wa(),e=e!==null?e:"";(m=c)&&e===null&&j("[68] PropertyList");x[a]={nextPos:b,result:e};return e}function ja(){var e="ObjectList@"+b,h=x[e];if(h)return b=h.nextPos,
h.result;h=m;m=!1;var k=b,d=b,f=na();if(f!==null){for(var i=[],q=o();q!==null;)i.push(q),q=o();if(i!==null){var q=[],g=b;if(a.substr(b,1)===","){var n=",";b+=1}else n=null,m&&j('","');if(n!==null){for(var l=[],s=o();s!==null;)l.push(s),s=o();l!==null?(s=na(),s!==null?n=[n,l,s]:(n=null,b=g)):(n=null,b=g)}else n=null,b=g;for(;n!==null;)if(q.push(n),g=b,a.substr(b,1)===","?(n=",",b+=1):(n=null,m&&j('","')),n!==null){l=[];for(s=o();s!==null;)l.push(s),s=o();l!==null?(s=na(),s!==null?n=[n,l,s]:(n=null,
b=g)):(n=null,b=g)}else n=null,b=g;q!==null?f=[f,i,q]:(f=null,b=d)}else f=null,b=d}else f=null,b=d;d=f!==null?function(a,b){var f=[];f.push(a);for(var d=0;d<b.length;d++)for(var c=0;c<b[d].length;c++)typeof b[d][c]=="object"&&b[d][c].token!=null&&f.push(b[d][c]);return f}(f[0],f[2]):null;d===null&&(d=null,b=k);(m=h)&&d===null&&j("[69] ObjectList");x[e]={nextPos:b,result:d};return d}function Ja(){var e="Verb@"+b,h=x[e];if(h)return b=h.nextPos,h.result;h=m;m=!1;var k=ha();if(k===null){k=b;if(a.substr(b,
1)==="a"){var d="a";b+=1}else d=null,m&&j('"a"');d=d!==null?{token:"uri",prefix:null,suffix:null,value:"http://www.w3.org/1999/02/22-rdf-syntax-ns#type"}:null;d===null&&(d=null,b=k);k=d!==null?d:null}(m=h)&&k===null&&j("[71] Verb");x[e]={nextPos:b,result:k};return k}function Cb(){var a="TriplesSameSubjectPath@"+b,c=x[a];if(c)return b=c.nextPos,c.result;c=m;m=!1;for(var e=b,d=b,f=[],h=o();h!==null;)f.push(h),h=o();if(f!==null)if(h=Ha(),h!==null){for(var k=[],i=o();i!==null;)k.push(i),i=o();k!==null?
(i=Lb(),i!==null?f=[f,h,k,i]:(f=null,b=d)):(f=null,b=d)}else f=null,b=d;else f=null,b=d;d=f!==null?function(a,b){var f=b.triplesContext;if(b.pairs)for(var d=0;d<b.pairs.length;d++){var c=b.pairs[d],e=null;c[1].length!=null&&(c[1]=c[1][0]);a.token&&a.token==="triplesnodecollection"?(e={subject:a.chainSubject[0],predicate:c[0],object:c[1]},f.push(e),f=f.concat(a.triplesContext)):(e={subject:a,predicate:c[0],object:c[1]},f.push(e))}d={token:"triplessamesubject"};d.triplesContext=f;d.chainSubject=a;return d}(f[1],
f[3]):null;d===null&&(d=null,b=e);if(d!==null)e=d;else{d=e=b;f=[];for(h=o();h!==null;)f.push(h),h=o();if(f!==null)if(h=Ia(),h!==null){k=[];for(i=o();i!==null;)k.push(i),i=o();k!==null?(i=Mb(),i!==null?f=[f,h,k,i]:(f=null,b=d)):(f=null,b=d)}else f=null,b=d;else f=null,b=d;d=f!==null?function(a,b){var f=a.triplesContext,d=a.chainSubject;if(b.pairs)for(var c=0;c<b.pairs.length;c++){var e=b.pairs[c];e[1].length!=null&&(e[1]=e[1][0]);if(a.token==="triplesnodecollection")for(var j=0;j<d.length;j++){var h=
d[j];if(h.triplesContext!=null){var k={subject:h.chainSubject,predicate:e[0],object:e[1]};f.concat(h.triplesContext)}else k={subject:d[j],predicate:e[0],object:e[1]},f.push(k)}else k={subject:d,predicate:e[0],object:e[1]},f.push(k)}c={token:"triplessamesubject"};c.triplesContext=f;c.chainSubject=d;return c}(f[1],f[3]):null;d===null&&(d=null,b=e);e=d!==null?d:null}(m=c)&&e===null&&j("[72] TriplesSameSubjectPath");x[a]={nextPos:b,result:e};return e}function Lb(){var e="PropertyListNotEmptyPath@"+b,
h=x[e];if(h)return b=h.nextPos,h.result;h=m;m=!1;var k=b,d=b,f=Ka();f===null&&(f=P(),f=f!==null?f:null);if(f!==null){for(var i=[],q=o();q!==null;)i.push(q),q=o();if(i!==null)if(q=ja(),q!==null){for(var g=[],n=b,l=[],s=o();s!==null;)l.push(s),s=o();if(l!==null)if(a.substr(b,1)===";"?(s=";",b+=1):(s=null,m&&j('";"')),s!==null){for(var r=[],t=o();t!==null;)r.push(t),t=o();if(r!==null){var t=b,u=Ka();u===null&&(u=P(),u=u!==null?u:null);if(u!==null){var w=ja();w!==null?u=[u,w]:(u=null,b=t)}else u=null,
b=t;t=u!==null?u:"";t!==null?l=[l,s,r,t]:(l=null,b=n)}else l=null,b=n}else l=null,b=n;else l=null,b=n;for(;l!==null;){g.push(l);n=b;l=[];for(s=o();s!==null;)l.push(s),s=o();if(l!==null)if(a.substr(b,1)===";"?(s=";",b+=1):(s=null,m&&j('";"')),s!==null){r=[];for(t=o();t!==null;)r.push(t),t=o();r!==null?(t=b,u=Ka(),u===null&&(u=P(),u=u!==null?u:null),u!==null?(w=ja(),w!==null?u=[u,w]:(u=null,b=t)):(u=null,b=t),t=u!==null?u:"",t!==null?l=[l,s,r,t]:(l=null,b=n)):(l=null,b=n)}else l=null,b=n;else l=null,
b=n}g!==null?f=[f,i,q,g]:(f=null,b=d)}else f=null,b=d;else f=null,b=d}else f=null,b=d;d=f!==null?function(a,b,f){token={token:"propertylist"};for(var d=[],c=[],e=0;e<b.length;e++)b[e].triplesContext!=null?(d=d.concat(b[e].triplesContext),b[e].token==="triplesnodecollection"&&b[e].chainSubject.length!=null?c.push([a,b[e].chainSubject[0]]):c.push([a,b[e].chainSubject])):c.push([a,b[e]]);for(e=0;e<f.length;e++)for(var b=f[e][3],a=b[0],b=b[1]||[],j=0;j<b.length;j++)b[j].triplesContext!=null?(d=d.concat(b[j].triplesContext),
c.push([a,b[j].chainSubject])):c.push([a,b[j]]);token.pairs=c;token.triplesContext=d;return token}(f[0],f[2],f[3]):null;d===null&&(d=null,b=k);(m=h)&&d===null&&j("[73] PropertyListNotEmptyPath");x[e]={nextPos:b,result:d};return d}function Mb(){var a="PropertyListPath@"+b,c=x[a];if(c)return b=c.nextPos,c.result;c=m;m=!1;var e=wa(),e=e!==null?e:"";(m=c)&&e===null&&j("[74] PropertyListPath");x[a]={nextPos:b,result:e};return e}function Ka(){var a="VerbPath@"+b,c=x[a];if(c)return b=c.nextPos,c.result;
c=m;m=!1;var e=b,d=jb(),d=d!==null?d:null;d===null&&(d=null,b=e);(m=c)&&d===null&&j("[75]");x[a]={nextPos:b,result:d};return d}function jb(){var e="PathAlternative@"+b,h=x[e];if(h)return b=h.nextPos,h.result;h=m;m=!1;var k=b,d=b,f=La();if(f!==null){var i=[],q=b;if(a.substr(b,1)==="|"){var g="|";b+=1}else g=null,m&&j('"|"');if(g!==null){var n=La();n!==null?g=[g,n]:(g=null,b=q)}else g=null,b=q;for(;g!==null;)i.push(g),q=b,a.substr(b,1)==="|"?(g="|",b+=1):(g=null,m&&j('"|"')),g!==null?(n=La(),n!==null?
g=[g,n]:(g=null,b=q)):(g=null,b=q);i!==null?f=[f,i]:(f=null,b=d)}else f=null,b=d;d=f!==null?function(a,b){if(b==null||b.length===0)return a;else{for(var f=[],d=0;d<b.length;d++)f.push(b[1]);d={token:"path",kind:"alternative"};d.value=f;return d}}(f[0],f[1]):null;d===null&&(d=null,b=k);(m=h)&&d===null&&j("[78] PathAlternative");x[e]={nextPos:b,result:d};return d}function La(){var e="PathSequence@"+b,h=x[e];if(h)return b=h.nextPos,h.result;h=m;m=!1;var k=b,d=b,f=Ma();if(f!==null){var i=[],q=b;if(a.substr(b,
1)==="/"){var g="/";b+=1}else g=null,m&&j('"/"');if(g!==null){var n=Ma();n!==null?g=[g,n]:(g=null,b=q)}else g=null,b=q;for(;g!==null;)i.push(g),q=b,a.substr(b,1)==="/"?(g="/",b+=1):(g=null,m&&j('"/"')),g!==null?(n=Ma(),n!==null?g=[g,n]:(g=null,b=q)):(g=null,b=q);i!==null?f=[f,i]:(f=null,b=d)}else f=null,b=d;d=f!==null?function(a,b){if(b==null||b.length===0)return a;else{for(var f=[a],d=0;d<b.length;d++)f.push(b[d][1]);d={token:"path",kind:"sequence"};d.value=f;return d}}(f[0],f[1]):null;d===null&&
(d=null,b=k);(m=h)&&d===null&&j("[79] PathSequence");x[e]={nextPos:b,result:d};return d}function kb(){var a="PathElt@"+b,c=x[a];if(c)return b=c.nextPos,c.result;c=m;m=!1;var e=b,d=b,f=Nb();if(f!==null){var h=Ob(),h=h!==null?h:"";h!==null?f=[f,h]:(f=null,b=d)}else f=null,b=d;d=f!==null?function(a,b){if(a.token&&a.token!="path"&&b=="")return a;else if(a.token&&a.token!=d&&b!=""){var d={token:"path",kind:"element"};d.value=a;d.modifier=b;return d}else return a.modifier=b,a}(f[0],f[1]):null;d===null&&
(d=null,b=e);(m=c)&&d===null&&j("[88] PathElt");x[a]={nextPos:b,result:d};return d}function Ma(){var e="PathEltOrInverse@"+b,h=x[e];if(h)return b=h.nextPos,h.result;h=m;m=!1;var k=kb();if(k===null){var d=k=b;if(a.substr(b,1)==="^"){var f="^";b+=1}else f=null,m&&j('"^"');if(f!==null){var i=kb();i!==null?f=[f,i]:(f=null,b=d)}else f=null,b=d;d=f!==null?function(a){var b={token:"path",kind:"inversePath"};b.value=a;return b}(f[1]):null;d===null&&(d=null,b=k);k=d!==null?d:null}(m=h)&&k===null&&j("[81] PathEltOrInverse");
x[e]={nextPos:b,result:k};return k}function Ob(){var e="PathMod@"+b,h=x[e];if(h)return b=h.nextPos,h.result;h=m;m=!1;if(a.substr(b,1)==="*"){var k="*";b+=1}else k=null,m&&j('"*"');if(k===null&&(a.substr(b,1)==="?"?(k="?",b+=1):(k=null,m&&j('"?"')),k===null&&(a.substr(b,1)==="+"?(k="+",b+=1):(k=null,m&&j('"+"')),k===null))){k=b;if(a.substr(b,1)==="{"){var d="{";b+=1}else d=null,m&&j('"{"');if(d!==null){var f=b,i=ba();if(i!==null){var q=b;if(a.substr(b,1)===","){var g=",";b+=1}else g=null,m&&j('","');
if(g!==null){if(a.substr(b,1)==="}"){var n="}";b+=1}else n=null,m&&j('"}"');if(n===null){var n=b,o=ba();if(o!==null){if(a.substr(b,1)==="}"){var l="}";b+=1}else l=null,m&&j('"}"');l!==null?o=[o,l]:(o=null,b=n)}else o=null,b=n;n=o!==null?o:null}n!==null?g=[g,n]:(g=null,b=q)}else g=null,b=q;g!==null?q=g:(a.substr(b,1)==="}"?(q="}",b+=1):(q=null,m&&j('"}"')),q=q!==null?q:null);q!==null?i=[i,q]:(i=null,b=f)}else i=null,b=f;i!==null?f=i:(f=b,a.substr(b,1)===","?(i=",",b+=1):(i=null,m&&j('","')),i!==null?
(q=ba(),q!==null?(a.substr(b,1)==="}"?(g="}",b+=1):(g=null,m&&j('"}"')),g!==null?i=[i,q,g]:(i=null,b=f)):(i=null,b=f)):(i=null,b=f),f=i!==null?i:null);f!==null?d=[d,f]:(d=null,b=k)}else d=null,b=k;k=d!==null?d:null}(m=h)&&k===null&&j("[82] PathMod");x[e]={nextPos:b,result:k};return k}function Nb(){var e="PathPrimary@"+b,h=x[e];if(h)return b=h.nextPos,h.result;h=m;m=!1;var k=Q();if(k===null){k=b;if(a.substr(b,1)==="a"){var d="a";b+=1}else d=null,m&&j('"a"');d=d!==null?{token:"uri",prefix:null,suffix:null,
value:"http://www.w3.org/1999/02/22-rdf-syntax-ns#type"}:null;d===null&&(d=null,b=k);if(d!==null)k=d;else{k=b;a.substr(b,1)==="!"?(d="!",b+=1):(d=null,m&&j('"!"'));if(d!==null){var f=Pb();f!==null?d=[d,f]:(d=null,b=k)}else d=null,b=k;if(d!==null)k=d;else{d=k=b;a.substr(b,1)==="("?(f="(",b+=1):(f=null,m&&j('"("'));if(f!==null){var i=jb();if(i!==null){if(a.substr(b,1)===")"){var q=")";b+=1}else q=null,m&&j('")"');q!==null?f=[f,i,q]:(f=null,b=d)}else f=null,b=d}else f=null,b=d;d=f!==null?f[1]:null;d===
null&&(d=null,b=k);k=d!==null?d:null}}}(m=h)&&k===null&&j("[83] PathPrimary");x[e]={nextPos:b,result:k};return k}function Pb(){var e="PathNegatedPropertySet@"+b,h=x[e];if(h)return b=h.nextPos,h.result;h=xa();if(h===null){h=b;if(a.substr(b,1)==="("){var k="(";b+=1}else k=null,m&&j('"("');if(k!==null){var d=b,f=xa();if(f!==null){var i=[],q=b;if(a.substr(b,1)==="|"){var g="|";b+=1}else g=null,m&&j('"|"');if(g!==null){var n=xa();n!==null?g=[g,n]:(g=null,b=q)}else g=null,b=q;for(;g!==null;)i.push(g),q=
b,a.substr(b,1)==="|"?(g="|",b+=1):(g=null,m&&j('"|"')),g!==null?(n=xa(),n!==null?g=[g,n]:(g=null,b=q)):(g=null,b=q);i!==null?f=[f,i]:(f=null,b=d)}else f=null,b=d;d=f!==null?f:"";d!==null?(a.substr(b,1)===")"?(f=")",b+=1):(f=null,m&&j('")"')),f!==null?k=[k,d,f]:(k=null,b=h)):(k=null,b=h)}else k=null,b=h;h=k!==null?k:null}x[e]={nextPos:b,result:h};return h}function xa(){var e="PathOneInPropertySet@"+b,h=x[e];if(h)return b=h.nextPos,h.result;h=m;m=!1;var k=Q();if(k===null&&(a.substr(b,1)==="a"?(k="a",
b+=1):(k=null,m&&j('"a"')),k===null)){k=b;if(a.substr(b,1)==="^"){var d="^";b+=1}else d=null,m&&j('"^"');if(d!==null){var f=Q();f===null&&(a.substr(b,1)==="a"?(f="a",b+=1):(f=null,m&&j('"a"')),f=f!==null?f:null);f!==null?d=[d,f]:(d=null,b=k)}else d=null,b=k;k=d!==null?d:null}(m=h)&&k===null&&j("[85] PathOneInPropertySet");x[e]={nextPos:b,result:k};return k}function Ia(){var a="TriplesNode@"+b,c=x[a];if(c)return b=c.nextPos,c.result;c=m;m=!1;var e=b,d=Qb(),d=d!==null?function(a){for(var b=[],d=[],
c=null,e=0;e<a.length;e++)ca++,c=null,a[e].chainSubject==null&&a[e].triplesContext==null?c=a[e]:(c=a[e].chainSubject,b=b.concat(nextSubject.triplesContext)),c={subject:{token:"blank",value:"_:"+ca},predicate:{token:"uri",prefix:null,suffix:null,value:"http://www.w3.org/1999/02/22-rdf-syntax-ns#first"},object:c},e==0&&d.push(c.subject),b.push(c),c=e===a.length-1?{subject:{token:"blank",value:"_:"+ca},predicate:{token:"uri",prefix:null,suffix:null,value:"http://www.w3.org/1999/02/22-rdf-syntax-ns#rest"},
object:{token:"uri",prefix:null,suffix:null,value:"http://www.w3.org/1999/02/22-rdf-syntax-ns#nil"}}:{subject:{token:"blank",value:"_:"+ca},predicate:{token:"uri",prefix:null,suffix:null,value:"http://www.w3.org/1999/02/22-rdf-syntax-ns#rest"},object:{token:"blank",value:"_:"+(ca+1)}},b.push(c);return{token:"triplesnodecollection",triplesContext:b,chainSubject:d}}(d):null;d===null&&(d=null,b=e);d!==null?e=d:(e=Rb(),e=e!==null?e:null);(m=c)&&e===null&&j("[87] TriplesNode");x[a]={nextPos:b,result:e};
return e}function Rb(){var e="BlankNodePropertyList@"+b,h=x[e];if(h)return b=h.nextPos,h.result;h=m;m=!1;for(var k=b,d=b,f=[],i=o();i!==null;)f.push(i),i=o();if(f!==null)if(a.substr(b,1)==="["?(i="[",b+=1):(i=null,m&&j('"["')),i!==null){for(var q=[],g=o();g!==null;)q.push(g),g=o();if(q!==null)if(g=wa(),g!==null){for(var n=[],l=o();l!==null;)n.push(l),l=o();if(n!==null)if(a.substr(b,1)==="]"?(l="]",b+=1):(l=null,m&&j('"]"')),l!==null){for(var s=[],r=o();r!==null;)s.push(r),r=o();s!==null?f=[f,i,q,
g,n,l,s]:(f=null,b=d)}else f=null,b=d;else f=null,b=d}else f=null,b=d;else f=null,b=d}else f=null,b=d;else f=null,b=d;d=f!==null?function(a){ca++;for(var b={token:"blank",value:"_:"+ca},d=[],f=0;f<a.pairs.length;f++){var c=a.pairs[f],e={};e.subject=b;e.predicate=c[0];c[1].length!=null&&(c[1]=c[1][0]);e.object=c[1];d.push(e)}return{token:"triplesnode",kind:"blanknodepropertylist",triplesContext:a.triplesContext.concat(d),chainSubject:b}}(f[3]):null;d===null&&(d=null,b=k);(m=h)&&d===null&&j("[88] BlankNodePropertyList");
x[e]={nextPos:b,result:d};return d}function Qb(){var e="Collection@"+b,h=x[e];if(h)return b=h.nextPos,h.result;h=m;m=!1;for(var k=b,d=b,f=[],i=o();i!==null;)f.push(i),i=o();if(f!==null)if(a.substr(b,1)==="("?(i="(",b+=1):(i=null,m&&j('"("')),i!==null){for(var q=[],g=o();g!==null;)q.push(g),g=o();if(q!==null){var n=na();if(n!==null)for(g=[];n!==null;)g.push(n),n=na();else g=null;if(g!==null){for(var n=[],l=o();l!==null;)n.push(l),l=o();if(n!==null)if(a.substr(b,1)===")"?(l=")",b+=1):(l=null,m&&j('")"')),
l!==null){for(var s=[],r=o();r!==null;)s.push(r),r=o();s!==null?f=[f,i,q,g,n,l,s]:(f=null,b=d)}else f=null,b=d;else f=null,b=d}else f=null,b=d}else f=null,b=d}else f=null,b=d;else f=null,b=d;d=f!==null?f[3]:null;d===null&&(d=null,b=k);(m=h)&&d===null&&j("[89] Collection");x[e]={nextPos:b,result:d};return d}function na(){var a="GraphNode@"+b,c=x[a];if(c)return b=c.nextPos,c.result;c=m;m=!1;for(var e=b,d=b,f=[],h=o();h!==null;)f.push(h),h=o();if(f!==null)if(h=Ha(),h!==null){for(var k=[],i=o();i!==null;)k.push(i),
i=o();k!==null?f=[f,h,k]:(f=null,b=d)}else f=null,b=d;else f=null,b=d;if(f!==null)d=f;else{d=b;f=[];for(h=o();h!==null;)f.push(h),h=o();if(f!==null)if(h=Ia(),h!==null){k=[];for(i=o();i!==null;)k.push(i),i=o();k!==null?f=[f,h,k]:(f=null,b=d)}else f=null,b=d;else f=null,b=d;d=f!==null?f:null}d=d!==null?d[1]:null;d===null&&(d=null,b=e);(m=c)&&d===null&&j("[90] GraphNode");x[a]={nextPos:b,result:d};return d}function Ha(){var a="VarOrTerm@"+b,c=x[a];if(c)return b=c.nextPos,c.result;c=m;m=!1;var e=P();
e===null&&(e=Sb(),e=e!==null?e:null);(m=c)&&e===null&&j("[91] VarOrTerm");x[a]={nextPos:b,result:e};return e}function ha(){var a="VarOrIRIref@"+b,c=x[a];if(c)return b=c.nextPos,c.result;c=m;m=!1;var e=P();e===null&&(e=Q(),e=e!==null?e:null);(m=c)&&e===null&&j("[92] VarOrIRIref");x[a]={nextPos:b,result:e};return e}function P(){var a="Var@"+b,c=x[a];if(c)return b=c.nextPos,c.result;c=m;m=!1;var e=b,d=Tb();d===null&&(d=Ub(),d=d!==null?d:null);d=d!==null?function(a){var b={token:"var"};b.value=a;return b}(d):
null;d===null&&(d=null,b=e);(m=c)&&d===null&&j("[93] Var");x[a]={nextPos:b,result:d};return d}function Sb(){var a="GraphTerm@"+b,c=x[a];if(c)return b=c.nextPos,c.result;c=m;m=!1;var e=Q();e===null&&(e=Da(),e===null&&(e=Ea(),e===null&&(e=Fa(),e===null&&(e=Vb(),e===null&&(e=ia(),e=e!==null?e:null)))));(m=c)&&e===null&&j("[94] GraphTerm");x[a]={nextPos:b,result:e};return e}function M(){var e="ConditionalOrExpression@"+b,h=x[e];if(h)return b=h.nextPos,h.result;h=m;m=!1;var k=b,d=b,f=Na();if(f!==null){for(var i=
[],q=b,g=[],n=o();n!==null;)g.push(n),n=o();if(g!==null)if(a.substr(b,2)==="||"?(n="||",b+=2):(n=null,m&&j('"||"')),n!==null){for(var l=[],s=o();s!==null;)l.push(s),s=o();l!==null?(s=Na(),s!==null?g=[g,n,l,s]:(g=null,b=q)):(g=null,b=q)}else g=null,b=q;else g=null,b=q;for(;g!==null;){i.push(g);q=b;g=[];for(n=o();n!==null;)g.push(n),n=o();if(g!==null)if(a.substr(b,2)==="||"?(n="||",b+=2):(n=null,m&&j('"||"')),n!==null){l=[];for(s=o();s!==null;)l.push(s),s=o();l!==null?(s=Na(),s!==null?g=[g,n,l,s]:(g=
null,b=q)):(g=null,b=q)}else g=null,b=q;else g=null,b=q}i!==null?f=[f,i]:(f=null,b=d)}else f=null,b=d;d=f!==null?function(a,b){if(b.length===0)return a;for(var d={token:"expression",expressionType:"conditionalor"},c=[a],f=0;f<b.length;f++)c.push(b[f][3]);d.operands=c;return d}(f[0],f[1]):null;d===null&&(d=null,b=k);(m=h)&&d===null&&j("[96] ConditionalOrExpression");x[e]={nextPos:b,result:d};return d}function Na(){var e="ConditionalAndExpression@"+b,h=x[e];if(h)return b=h.nextPos,h.result;h=m;m=!1;
var k=b,d=b,f=Oa();if(f!==null){for(var i=[],q=b,g=[],n=o();n!==null;)g.push(n),n=o();if(g!==null)if(a.substr(b,2)==="&&"?(n="&&",b+=2):(n=null,m&&j('"&&"')),n!==null){for(var l=[],s=o();s!==null;)l.push(s),s=o();l!==null?(s=Oa(),s!==null?g=[g,n,l,s]:(g=null,b=q)):(g=null,b=q)}else g=null,b=q;else g=null,b=q;for(;g!==null;){i.push(g);q=b;g=[];for(n=o();n!==null;)g.push(n),n=o();if(g!==null)if(a.substr(b,2)==="&&"?(n="&&",b+=2):(n=null,m&&j('"&&"')),n!==null){l=[];for(s=o();s!==null;)l.push(s),s=o();
l!==null?(s=Oa(),s!==null?g=[g,n,l,s]:(g=null,b=q)):(g=null,b=q)}else g=null,b=q;else g=null,b=q}i!==null?f=[f,i]:(f=null,b=d)}else f=null,b=d;d=f!==null?function(a,b){if(b.length===0)return a;for(var d={token:"expression",expressionType:"conditionaland"},c=[a],f=0;f<b.length;f++)c.push(b[f][3]);d.operands=c;return d}(f[0],f[1]):null;d===null&&(d=null,b=k);(m=h)&&d===null&&j("[97] ConditionalAndExpression");x[e]={nextPos:b,result:d};return d}function Oa(){var e="RelationalExpression@"+b,h=x[e];if(h)return b=
h.nextPos,h.result;h=m;m=!1;var k=b,d=b,f=T();if(f!==null){for(var i=[],q=b,g=[],n=o();n!==null;)g.push(n),n=o();if(g!==null)if(a.substr(b,1)==="="?(n="=",b+=1):(n=null,m&&j('"="')),n!==null){for(var l=[],s=o();s!==null;)l.push(s),s=o();l!==null?(s=T(),s!==null?g=[g,n,l,s]:(g=null,b=q)):(g=null,b=q)}else g=null,b=q;else g=null,b=q;if(g!==null)q=g;else{q=b;g=[];for(n=o();n!==null;)g.push(n),n=o();if(g!==null)if(a.substr(b,2)==="!="?(n="!=",b+=2):(n=null,m&&j('"!="')),n!==null){l=[];for(s=o();s!==null;)l.push(s),
s=o();l!==null?(s=T(),s!==null?g=[g,n,l,s]:(g=null,b=q)):(g=null,b=q)}else g=null,b=q;else g=null,b=q;if(g!==null)q=g;else{q=b;g=[];for(n=o();n!==null;)g.push(n),n=o();if(g!==null)if(a.substr(b,1)==="<"?(n="<",b+=1):(n=null,m&&j('"<"')),n!==null){l=[];for(s=o();s!==null;)l.push(s),s=o();l!==null?(s=T(),s!==null?g=[g,n,l,s]:(g=null,b=q)):(g=null,b=q)}else g=null,b=q;else g=null,b=q;if(g!==null)q=g;else{q=b;g=[];for(n=o();n!==null;)g.push(n),n=o();if(g!==null)if(a.substr(b,1)===">"?(n=">",b+=1):(n=
null,m&&j('">"')),n!==null){l=[];for(s=o();s!==null;)l.push(s),s=o();l!==null?(s=T(),s!==null?g=[g,n,l,s]:(g=null,b=q)):(g=null,b=q)}else g=null,b=q;else g=null,b=q;if(g!==null)q=g;else{q=b;g=[];for(n=o();n!==null;)g.push(n),n=o();if(g!==null)if(a.substr(b,2)==="<="?(n="<=",b+=2):(n=null,m&&j('"<="')),n!==null){l=[];for(s=o();s!==null;)l.push(s),s=o();l!==null?(s=T(),s!==null?g=[g,n,l,s]:(g=null,b=q)):(g=null,b=q)}else g=null,b=q;else g=null,b=q;if(g!==null)q=g;else{q=b;g=[];for(n=o();n!==null;)g.push(n),
n=o();if(g!==null)if(a.substr(b,2)===">="?(n=">=",b+=2):(n=null,m&&j('">="')),n!==null){l=[];for(s=o();s!==null;)l.push(s),s=o();l!==null?(s=T(),s!==null?g=[g,n,l,s]:(g=null,b=q)):(g=null,b=q)}else g=null,b=q;else g=null,b=q;q=g!==null?g:null}}}}}for(;q!==null;){i.push(q);q=b;g=[];for(n=o();n!==null;)g.push(n),n=o();if(g!==null)if(a.substr(b,1)==="="?(n="=",b+=1):(n=null,m&&j('"="')),n!==null){l=[];for(s=o();s!==null;)l.push(s),s=o();l!==null?(s=T(),s!==null?g=[g,n,l,s]:(g=null,b=q)):(g=null,b=q)}else g=
null,b=q;else g=null,b=q;if(g!==null)q=g;else{q=b;g=[];for(n=o();n!==null;)g.push(n),n=o();if(g!==null)if(a.substr(b,2)==="!="?(n="!=",b+=2):(n=null,m&&j('"!="')),n!==null){l=[];for(s=o();s!==null;)l.push(s),s=o();l!==null?(s=T(),s!==null?g=[g,n,l,s]:(g=null,b=q)):(g=null,b=q)}else g=null,b=q;else g=null,b=q;if(g!==null)q=g;else{q=b;g=[];for(n=o();n!==null;)g.push(n),n=o();if(g!==null)if(a.substr(b,1)==="<"?(n="<",b+=1):(n=null,m&&j('"<"')),n!==null){l=[];for(s=o();s!==null;)l.push(s),s=o();l!==null?
(s=T(),s!==null?g=[g,n,l,s]:(g=null,b=q)):(g=null,b=q)}else g=null,b=q;else g=null,b=q;if(g!==null)q=g;else{q=b;g=[];for(n=o();n!==null;)g.push(n),n=o();if(g!==null)if(a.substr(b,1)===">"?(n=">",b+=1):(n=null,m&&j('">"')),n!==null){l=[];for(s=o();s!==null;)l.push(s),s=o();l!==null?(s=T(),s!==null?g=[g,n,l,s]:(g=null,b=q)):(g=null,b=q)}else g=null,b=q;else g=null,b=q;if(g!==null)q=g;else{q=b;g=[];for(n=o();n!==null;)g.push(n),n=o();if(g!==null)if(a.substr(b,2)==="<="?(n="<=",b+=2):(n=null,m&&j('"<="')),
n!==null){l=[];for(s=o();s!==null;)l.push(s),s=o();l!==null?(s=T(),s!==null?g=[g,n,l,s]:(g=null,b=q)):(g=null,b=q)}else g=null,b=q;else g=null,b=q;if(g!==null)q=g;else{q=b;g=[];for(n=o();n!==null;)g.push(n),n=o();if(g!==null)if(a.substr(b,2)===">="?(n=">=",b+=2):(n=null,m&&j('">="')),n!==null){l=[];for(s=o();s!==null;)l.push(s),s=o();l!==null?(s=T(),s!==null?g=[g,n,l,s]:(g=null,b=q)):(g=null,b=q)}else g=null,b=q;else g=null,b=q;q=g!==null?g:null}}}}}}i!==null?f=[f,i]:(f=null,b=d)}else f=null,b=d;
d=f!==null?function(a,b){if(b.length===0)return a;else{var d={expressionType:"relationalexpression"};d.operator=b[0][1];d.op1=a;d.op2=b[0][3];d.token="expression";return d}}(f[0],f[1]):null;d===null&&(d=null,b=k);(m=h)&&d===null&&j("[99] RelationalExpression");x[e]={nextPos:b,result:d};return d}function T(){var e="AdditiveExpression@"+b,h=x[e];if(h)return b=h.nextPos,h.result;h=m;m=!1;var k=b,d=b,f=oa();if(f!==null){for(var g=[],i=b,l=[],n=o();n!==null;)l.push(n),n=o();if(l!==null)if(a.substr(b,1)===
"+"?(n="+",b+=1):(n=null,m&&j('"+"')),n!==null){for(var r=[],s=o();s!==null;)r.push(s),s=o();r!==null?(s=oa(),s!==null?l=[l,n,r,s]:(l=null,b=i)):(l=null,b=i)}else l=null,b=i;else l=null,b=i;if(l!==null)i=l;else{i=b;l=[];for(n=o();n!==null;)l.push(n),n=o();if(l!==null)if(a.substr(b,1)==="-"?(n="-",b+=1):(n=null,m&&j('"-"')),n!==null){r=[];for(s=o();s!==null;)r.push(s),s=o();r!==null?(s=oa(),s!==null?l=[l,n,r,s]:(l=null,b=i)):(l=null,b=i)}else l=null,b=i;else l=null,b=i;if(l!==null)i=l;else{i=b;l=pa();
l===null&&(l=pa(),l=l!==null?l:null);if(l!==null){n=b;r=[];for(s=o();s!==null;)r.push(s),s=o();if(r!==null)if(a.substr(b,1)==="*"?(s="*",b+=1):(s=null,m&&j('"*"')),s!==null){for(var t=[],u=o();u!==null;)t.push(u),u=o();t!==null?(u=Z(),u!==null?r=[r,s,t,u]:(r=null,b=n)):(r=null,b=n)}else r=null,b=n;else r=null,b=n;if(r!==null)n=r;else{n=b;r=[];for(s=o();s!==null;)r.push(s),s=o();if(r!==null)if(a.substr(b,1)==="/"?(s="/",b+=1):(s=null,m&&j('"/"')),s!==null){t=[];for(u=o();u!==null;)t.push(u),u=o();
t!==null?(u=Z(),u!==null?r=[r,s,t,u]:(r=null,b=n)):(r=null,b=n)}else r=null,b=n;else r=null,b=n;n=r!==null?r:null}n=n!==null?n:"";n!==null?l=[l,n]:(l=null,b=i)}else l=null,b=i;i=l!==null?l:null}}for(;i!==null;){g.push(i);i=b;l=[];for(n=o();n!==null;)l.push(n),n=o();if(l!==null)if(a.substr(b,1)==="+"?(n="+",b+=1):(n=null,m&&j('"+"')),n!==null){r=[];for(s=o();s!==null;)r.push(s),s=o();r!==null?(s=oa(),s!==null?l=[l,n,r,s]:(l=null,b=i)):(l=null,b=i)}else l=null,b=i;else l=null,b=i;if(l!==null)i=l;else{i=
b;l=[];for(n=o();n!==null;)l.push(n),n=o();if(l!==null)if(a.substr(b,1)==="-"?(n="-",b+=1):(n=null,m&&j('"-"')),n!==null){r=[];for(s=o();s!==null;)r.push(s),s=o();r!==null?(s=oa(),s!==null?l=[l,n,r,s]:(l=null,b=i)):(l=null,b=i)}else l=null,b=i;else l=null,b=i;if(l!==null)i=l;else{i=b;l=pa();l===null&&(l=pa(),l=l!==null?l:null);if(l!==null){n=b;r=[];for(s=o();s!==null;)r.push(s),s=o();if(r!==null)if(a.substr(b,1)==="*"?(s="*",b+=1):(s=null,m&&j('"*"')),s!==null){t=[];for(u=o();u!==null;)t.push(u),
u=o();t!==null?(u=Z(),u!==null?r=[r,s,t,u]:(r=null,b=n)):(r=null,b=n)}else r=null,b=n;else r=null,b=n;if(r!==null)n=r;else{n=b;r=[];for(s=o();s!==null;)r.push(s),s=o();if(r!==null)if(a.substr(b,1)==="/"?(s="/",b+=1):(s=null,m&&j('"/"')),s!==null){t=[];for(u=o();u!==null;)t.push(u),u=o();t!==null?(u=Z(),u!==null?r=[r,s,t,u]:(r=null,b=n)):(r=null,b=n)}else r=null,b=n;else r=null,b=n;n=r!==null?r:null}n=n!==null?n:"";n!==null?l=[l,n]:(l=null,b=i)}else l=null,b=i;i=l!==null?l:null}}}g!==null?f=[f,g]:
(f=null,b=d)}else f=null,b=d;d=f!==null?function(a,b){if(b.length===0)return a;var d={token:"expression",expressionType:"additiveexpression"};d.summand=a;d.summands=[];for(var c=0;c<b.length;c++){var f=b[c],e={};if(f.length==4&&typeof f[1]==="string")e.operator=f[1],e.expression=f[3];else{var f={},h=e[0],j=e[1][1],i=e[1][3],j=null;h.value<0?(e.operator="-",h.value=-h.value):e.operator="+";f.token="expression";f.expressionType="multiplicativeexpression";f.operator=h;f.factors=[{operator:j,expression:i}];
e.expression=f}d.summands.push(e)}return d}(f[0],f[1]):null;d===null&&(d=null,b=k);(m=h)&&d===null&&j("[101] AdditiveExpression");x[e]={nextPos:b,result:d};return d}function oa(){var e="MultiplicativeExpression@"+b,h=x[e];if(h)return b=h.nextPos,h.result;h=m;m=!1;var i=b,d=b,f=Z();if(f!==null){for(var k=[],g=b,l=[],n=o();n!==null;)l.push(n),n=o();if(l!==null)if(a.substr(b,1)==="*"?(n="*",b+=1):(n=null,m&&j('"*"')),n!==null){for(var r=[],s=o();s!==null;)r.push(s),s=o();r!==null?(s=Z(),s!==null?l=[l,
n,r,s]:(l=null,b=g)):(l=null,b=g)}else l=null,b=g;else l=null,b=g;if(l!==null)g=l;else{g=b;l=[];for(n=o();n!==null;)l.push(n),n=o();if(l!==null)if(a.substr(b,1)==="/"?(n="/",b+=1):(n=null,m&&j('"/"')),n!==null){r=[];for(s=o();s!==null;)r.push(s),s=o();r!==null?(s=Z(),s!==null?l=[l,n,r,s]:(l=null,b=g)):(l=null,b=g)}else l=null,b=g;else l=null,b=g;g=l!==null?l:null}for(;g!==null;){k.push(g);g=b;l=[];for(n=o();n!==null;)l.push(n),n=o();if(l!==null)if(a.substr(b,1)==="*"?(n="*",b+=1):(n=null,m&&j('"*"')),
n!==null){r=[];for(s=o();s!==null;)r.push(s),s=o();r!==null?(s=Z(),s!==null?l=[l,n,r,s]:(l=null,b=g)):(l=null,b=g)}else l=null,b=g;else l=null,b=g;if(l!==null)g=l;else{g=b;l=[];for(n=o();n!==null;)l.push(n),n=o();if(l!==null)if(a.substr(b,1)==="/"?(n="/",b+=1):(n=null,m&&j('"/"')),n!==null){r=[];for(s=o();s!==null;)r.push(s),s=o();r!==null?(s=Z(),s!==null?l=[l,n,r,s]:(l=null,b=g)):(l=null,b=g)}else l=null,b=g;else l=null,b=g;g=l!==null?l:null}}k!==null?f=[f,k]:(f=null,b=d)}else f=null,b=d;d=f!==null?
function(a,b){if(b.length===0)return a;var d={token:"expression",expressionType:"multiplicativeexpression"};d.factor=a;d.factors=[];for(var c=0;c<b.length;c++){var f=b[c],e={};e.operator=f[1];e.expression=f[3];d.factors.push(e)}return d}(f[0],f[1]):null;d===null&&(d=null,b=i);(m=h)&&d===null&&j("[102] MultiplicativeExpression");x[e]={nextPos:b,result:d};return d}function Z(){var e="UnaryExpression@"+b,h=x[e];if(h)return b=h.nextPos,h.result;h=m;m=!1;var i=b,d=b;if(a.substr(b,1)==="!"){var f="!";b+=
1}else f=null,m&&j('"!"');if(f!==null){for(var k=[],g=o();g!==null;)k.push(g),g=o();k!==null?(g=ya(),g!==null?f=[f,k,g]:(f=null,b=d)):(f=null,b=d)}else f=null,b=d;d=f!==null?function(a){var b={token:"expression",expressionType:"unaryexpression",unaryexpression:"!"};b.expression=a;return b}(f[2]):null;d===null&&(d=null,b=i);if(d!==null)i=d;else{d=i=b;a.substr(b,1)==="+"?(f="+",b+=1):(f=null,m&&j('"+"'));if(f!==null){k=[];for(g=o();g!==null;)k.push(g),g=o();k!==null?(g=ya(),g!==null?f=[f,k,g]:(f=null,
b=d)):(f=null,b=d)}else f=null,b=d;d=f!==null?function(a){var b={token:"expression",expressionType:"unaryexpression",unaryexpression:"+"};b.expression=a;return b}(f[2]):null;d===null&&(d=null,b=i);if(d!==null)i=d;else{d=i=b;a.substr(b,1)==="-"?(f="-",b+=1):(f=null,m&&j('"-"'));if(f!==null){k=[];for(g=o();g!==null;)k.push(g),g=o();k!==null?(g=ya(),g!==null?f=[f,k,g]:(f=null,b=d)):(f=null,b=d)}else f=null,b=d;d=f!==null?function(a){var b={token:"expression",expressionType:"unaryexpression",unaryexpression:"-"};
b.expression=a;return b}(f[2]):null;d===null&&(d=null,b=i);d!==null?i=d:(i=ya(),i=i!==null?i:null)}}(m=h)&&i===null&&j("[103] UnaryExpression");x[e]={nextPos:b,result:i};return i}function ya(){var a="PrimaryExpression@"+b,c=x[a];if(c)return b=c.nextPos,c.result;c=m;m=!1;var e=Ca();if(e===null&&(e=Ba(),e===null&&(e=Wb(),e===null))){var e=b,d=Da(),d=d!==null?function(a){var b={token:"expression",expressionType:"atomic",primaryexpression:"rdfliteral"};b.value=a;return b}(d):null;d===null&&(d=null,b=
e);d!==null?e=d:(e=b,d=Ea(),d=d!==null?function(a){var b={token:"expression",expressionType:"atomic",primaryexpression:"numericliteral"};b.value=a;return b}(d):null,d===null&&(d=null,b=e),d!==null?e=d:(e=b,d=Fa(),d=d!==null?function(a){var b={token:"expression",expressionType:"atomic",primaryexpression:"booleanliteral"};b.value=a;return b}(d):null,d===null&&(d=null,b=e),d!==null?e=d:(e=Xb(),e===null&&(e=b,d=P(),d=d!==null?function(a){var b={token:"expression",expressionType:"atomic",primaryexpression:"var"};
b.value=a;return b}(d):null,d===null&&(d=null,b=e),e=d!==null?d:null))))}(m=c)&&e===null&&j("[104] PrimaryExpression");x[a]={nextPos:b,result:e};return e}function Ca(){var e="BrackettedExpression@"+b,h=x[e];if(h)return b=h.nextPos,h.result;h=m;m=!1;var g=b,d=b;if(a.substr(b,1)==="("){var f="(";b+=1}else f=null,m&&j('"("');if(f!==null){for(var i=[],k=o();k!==null;)i.push(k),k=o();if(i!==null)if(k=M(),k!==null){for(var l=[],n=o();n!==null;)l.push(n),n=o();l!==null?(a.substr(b,1)===")"?(n=")",b+=1):
(n=null,m&&j('")"')),n!==null?f=[f,i,k,l,n]:(f=null,b=d)):(f=null,b=d)}else f=null,b=d;else f=null,b=d}else f=null,b=d;d=f!==null?f[2]:null;d===null&&(d=null,b=g);(m=h)&&d===null&&j("[105] BrackettedExpression");x[e]={nextPos:b,result:d};return d}function Ba(){var e="BuiltInCall@"+b,h=x[e];if(h)return b=h.nextPos,h.result;h=m;m=!1;var g=b,d=b;if(a.substr(b,3)==="STR"){var f="STR";b+=3}else f=null,m&&j('"STR"');f===null&&(a.substr(b,3)==="str"?(f="str",b+=3):(f=null,m&&j('"str"')),f=f!==null?f:null);
if(f!==null){for(var i=[],k=o();k!==null;)i.push(k),k=o();if(i!==null)if(a.substr(b,1)==="("?(k="(",b+=1):(k=null,m&&j('"("')),k!==null){for(var l=[],n=o();n!==null;)l.push(n),n=o();if(l!==null)if(n=M(),n!==null){for(var r=[],s=o();s!==null;)r.push(s),s=o();r!==null?(a.substr(b,1)===")"?(s=")",b+=1):(s=null,m&&j('")"')),s!==null?f=[f,i,k,l,n,r,s]:(f=null,b=d)):(f=null,b=d)}else f=null,b=d;else f=null,b=d}else f=null,b=d;else f=null,b=d}else f=null,b=d;d=f!==null?function(a){var b={token:"expression",
expressionType:"builtincall",builtincall:"str"};b.args=[a];return b}(f[4]):null;d===null&&(d=null,b=g);if(d!==null)g=d;else{d=g=b;a.substr(b,4)==="LANG"?(f="LANG",b+=4):(f=null,m&&j('"LANG"'));f===null&&(a.substr(b,4)==="lang"?(f="lang",b+=4):(f=null,m&&j('"lang"')),f=f!==null?f:null);if(f!==null){i=[];for(k=o();k!==null;)i.push(k),k=o();if(i!==null)if(a.substr(b,1)==="("?(k="(",b+=1):(k=null,m&&j('"("')),k!==null){l=[];for(n=o();n!==null;)l.push(n),n=o();if(l!==null)if(n=M(),n!==null){r=[];for(s=
o();s!==null;)r.push(s),s=o();r!==null?(a.substr(b,1)===")"?(s=")",b+=1):(s=null,m&&j('")"')),s!==null?f=[f,i,k,l,n,r,s]:(f=null,b=d)):(f=null,b=d)}else f=null,b=d;else f=null,b=d}else f=null,b=d;else f=null,b=d}else f=null,b=d;d=f!==null?function(a){var b={token:"expression",expressionType:"builtincall",builtincall:"lang"};b.args=[a];return b}(f[4]):null;d===null&&(d=null,b=g);if(d!==null)g=d;else{d=g=b;a.substr(b,11)==="LANGMATCHES"?(f="LANGMATCHES",b+=11):(f=null,m&&j('"LANGMATCHES"'));if(f!==
null){i=[];for(k=o();k!==null;)i.push(k),k=o();if(i!==null)if(a.substr(b,1)==="("?(k="(",b+=1):(k=null,m&&j('"("')),k!==null){l=[];for(n=o();n!==null;)l.push(n),n=o();if(l!==null)if(n=M(),n!==null){r=[];for(s=o();s!==null;)r.push(s),s=o();if(r!==null)if(a.substr(b,1)===","?(s=",",b+=1):(s=null,m&&j('","')),s!==null){for(var t=[],u=o();u!==null;)t.push(u),u=o();if(t!==null)if(u=M(),u!==null){for(var w=[],y=o();y!==null;)w.push(y),y=o();w!==null?(a.substr(b,1)===")"?(y=")",b+=1):(y=null,m&&j('")"')),
y!==null?f=[f,i,k,l,n,r,s,t,u,w,y]:(f=null,b=d)):(f=null,b=d)}else f=null,b=d;else f=null,b=d}else f=null,b=d;else f=null,b=d}else f=null,b=d;else f=null,b=d}else f=null,b=d;else f=null,b=d}else f=null,b=d;d=f!==null?function(a,b){var d={token:"expression",expressionType:"builtincall",builtincall:"langmatches"};d.args=[a,b];return d}(f[4],f[8]):null;d===null&&(d=null,b=g);if(d!==null)g=d;else{d=g=b;a.substr(b,8)==="DATATYPE"?(f="DATATYPE",b+=8):(f=null,m&&j('"DATATYPE"'));f===null&&(a.substr(b,8)===
"datatype"?(f="datatype",b+=8):(f=null,m&&j('"datatype"')),f=f!==null?f:null);if(f!==null){i=[];for(k=o();k!==null;)i.push(k),k=o();if(i!==null)if(a.substr(b,1)==="("?(k="(",b+=1):(k=null,m&&j('"("')),k!==null){l=[];for(n=o();n!==null;)l.push(n),n=o();if(l!==null)if(n=M(),n!==null){r=[];for(s=o();s!==null;)r.push(s),s=o();r!==null?(a.substr(b,1)===")"?(s=")",b+=1):(s=null,m&&j('")"')),s!==null?f=[f,i,k,l,n,r,s]:(f=null,b=d)):(f=null,b=d)}else f=null,b=d;else f=null,b=d}else f=null,b=d;else f=null,
b=d}else f=null,b=d;d=f!==null?function(a){var b={token:"expression",expressionType:"builtincall",builtincall:"datatype"};b.args=[a];return b}(f[4]):null;d===null&&(d=null,b=g);if(d!==null)g=d;else{d=g=b;a.substr(b,5)==="BOUND"?(f="BOUND",b+=5):(f=null,m&&j('"BOUND"'));if(f!==null){i=[];for(k=o();k!==null;)i.push(k),k=o();if(i!==null)if(a.substr(b,1)==="("?(k="(",b+=1):(k=null,m&&j('"("')),k!==null){l=[];for(n=o();n!==null;)l.push(n),n=o();if(l!==null)if(n=P(),n!==null){r=[];for(s=o();s!==null;)r.push(s),
s=o();r!==null?(a.substr(b,1)===")"?(s=")",b+=1):(s=null,m&&j('")"')),s!==null?f=[f,i,k,l,n,r,s]:(f=null,b=d)):(f=null,b=d)}else f=null,b=d;else f=null,b=d}else f=null,b=d;else f=null,b=d}else f=null,b=d;d=f!==null?function(a){var b={token:"expression",expressionType:"builtincall",builtincall:"bound"};b.args=[a];return b}(f[4]):null;d===null&&(d=null,b=g);if(d!==null)g=d;else{d=g=b;a.substr(b,3)==="IRI"?(f="IRI",b+=3):(f=null,m&&j('"IRI"'));if(f!==null){i=[];for(k=o();k!==null;)i.push(k),k=o();if(i!==
null)if(a.substr(b,1)==="("?(k="(",b+=1):(k=null,m&&j('"("')),k!==null){l=[];for(n=o();n!==null;)l.push(n),n=o();if(l!==null)if(n=M(),n!==null){r=[];for(s=o();s!==null;)r.push(s),s=o();r!==null?(a.substr(b,1)===")"?(s=")",b+=1):(s=null,m&&j('")"')),s!==null?f=[f,i,k,l,n,r,s]:(f=null,b=d)):(f=null,b=d)}else f=null,b=d;else f=null,b=d}else f=null,b=d;else f=null,b=d}else f=null,b=d;d=f!==null?function(a){var b={token:"expression",expressionType:"builtincall",builtincall:"iri"};b.args=[a];return b}(f[4]):
null;d===null&&(d=null,b=g);if(d!==null)g=d;else{d=g=b;a.substr(b,3)==="URI"?(f="URI",b+=3):(f=null,m&&j('"URI"'));if(f!==null){i=[];for(k=o();k!==null;)i.push(k),k=o();if(i!==null)if(a.substr(b,1)==="("?(k="(",b+=1):(k=null,m&&j('"("')),k!==null){l=[];for(n=o();n!==null;)l.push(n),n=o();if(l!==null)if(n=M(),n!==null){r=[];for(s=o();s!==null;)r.push(s),s=o();r!==null?(a.substr(b,1)===")"?(s=")",b+=1):(s=null,m&&j('")"')),s!==null?f=[f,i,k,l,n,r,s]:(f=null,b=d)):(f=null,b=d)}else f=null,b=d;else f=
null,b=d}else f=null,b=d;else f=null,b=d}else f=null,b=d;d=f!==null?function(a){var b={token:"expression",expressionType:"builtincall",builtincall:"uri"};b.args=[a];return b}(f[4]):null;d===null&&(d=null,b=g);if(d!==null)g=d;else{d=g=b;a.substr(b,5)==="BNODE"?(f="BNODE",b+=5):(f=null,m&&j('"BNODE"'));if(f!==null){i=[];for(k=o();k!==null;)i.push(k),k=o();if(i!==null){k=b;a.substr(b,1)==="("?(l="(",b+=1):(l=null,m&&j('"("'));if(l!==null){n=[];for(r=o();r!==null;)n.push(r),r=o();if(n!==null)if(r=M(),
r!==null){s=[];for(t=o();t!==null;)s.push(t),t=o();s!==null?(a.substr(b,1)===")"?(t=")",b+=1):(t=null,m&&j('")"')),t!==null?l=[l,n,r,s,t]:(l=null,b=k)):(l=null,b=k)}else l=null,b=k;else l=null,b=k}else l=null,b=k;l!==null?k=l:(k=ia(),k=k!==null?k:null);k!==null?f=[f,i,k]:(f=null,b=d)}else f=null,b=d}else f=null,b=d;d=f!==null?function(a){var b={token:"expression",expressionType:"builtincall",builtincall:"bnode"};b.args=a.length===5?[a[2]]:null;return b}(f[2]):null;d===null&&(d=null,b=g);if(d!==null)g=
d;else{d=g=b;a.substr(b,8)==="COALESCE"?(f="COALESCE",b+=8):(f=null,m&&j('"COALESCE"'));if(f!==null){i=[];for(k=o();k!==null;)i.push(k),k=o();i!==null?(k=Jb(),k!==null?f=[f,i,k]:(f=null,b=d)):(f=null,b=d)}else f=null,b=d;d=f!==null?function(a){var b={token:"expression",expressionType:"builtincall",builtincall:"coalesce"};b.args=a;return b}(f[2]):null;d===null&&(d=null,b=g);if(d!==null)g=d;else{d=g=b;a.substr(b,2)==="IF"?(f="IF",b+=2):(f=null,m&&j('"IF"'));if(f!==null){i=[];for(k=o();k!==null;)i.push(k),
k=o();if(i!==null)if(a.substr(b,1)==="("?(k="(",b+=1):(k=null,m&&j('"("')),k!==null){l=[];for(n=o();n!==null;)l.push(n),n=o();if(l!==null)if(n=M(),n!==null){r=[];for(s=o();s!==null;)r.push(s),s=o();if(r!==null)if(a.substr(b,1)===","?(s=",",b+=1):(s=null,m&&j('","')),s!==null){t=[];for(u=o();u!==null;)t.push(u),u=o();if(t!==null)if(u=M(),u!==null){w=[];for(y=o();y!==null;)w.push(y),y=o();if(w!==null)if(a.substr(b,1)===","?(y=",",b+=1):(y=null,m&&j('","')),y!==null){for(var D=[],A=o();A!==null;)D.push(A),
A=o();if(D!==null)if(A=M(),A!==null){for(var N=[],F=o();F!==null;)N.push(F),F=o();N!==null?(a.substr(b,1)===")"?(F=")",b+=1):(F=null,m&&j('")"')),F!==null?f=[f,i,k,l,n,r,s,t,u,w,y,D,A,N,F]:(f=null,b=d)):(f=null,b=d)}else f=null,b=d;else f=null,b=d}else f=null,b=d;else f=null,b=d}else f=null,b=d;else f=null,b=d}else f=null,b=d;else f=null,b=d}else f=null,b=d;else f=null,b=d}else f=null,b=d;else f=null,b=d}else f=null,b=d;d=f!==null?function(a,b,d){var c={token:"expression",expressionType:"builtincall",
builtincall:"if"};c.args=[a,b,d];return c}(f[4],f[8],f[12]):null;d===null&&(d=null,b=g);if(d!==null)g=d;else{d=g=b;a.substr(b,9)==="ISLITERAL"?(f="ISLITERAL",b+=9):(f=null,m&&j('"ISLITERAL"'));if(f!==null){i=[];for(k=o();k!==null;)i.push(k),k=o();if(i!==null)if(a.substr(b,1)==="("?(k="(",b+=1):(k=null,m&&j('"("')),k!==null){l=[];for(n=o();n!==null;)l.push(n),n=o();if(l!==null)if(n=M(),n!==null){r=[];for(s=o();s!==null;)r.push(s),s=o();r!==null?(a.substr(b,1)===")"?(s=")",b+=1):(s=null,m&&j('")"')),
s!==null?f=[f,i,k,l,n,r,s]:(f=null,b=d)):(f=null,b=d)}else f=null,b=d;else f=null,b=d}else f=null,b=d;else f=null,b=d}else f=null,b=d;d=f!==null?function(a){var b={token:"expression",expressionType:"builtincall",builtincall:"isliteral"};b.args=[a];return b}(f[4]):null;d===null&&(d=null,b=g);if(d!==null)g=d;else{d=g=b;a.substr(b,7)==="ISBLANK"?(f="ISBLANK",b+=7):(f=null,m&&j('"ISBLANK"'));if(f!==null){i=[];for(k=o();k!==null;)i.push(k),k=o();if(i!==null)if(a.substr(b,1)==="("?(k="(",b+=1):(k=null,
m&&j('"("')),k!==null){l=[];for(n=o();n!==null;)l.push(n),n=o();if(l!==null)if(n=M(),n!==null){r=[];for(s=o();s!==null;)r.push(s),s=o();r!==null?(a.substr(b,1)===")"?(s=")",b+=1):(s=null,m&&j('")"')),s!==null?f=[f,i,k,l,n,r,s]:(f=null,b=d)):(f=null,b=d)}else f=null,b=d;else f=null,b=d}else f=null,b=d;else f=null,b=d}else f=null,b=d;d=f!==null?function(a){var b={token:"expression",expressionType:"builtincall",builtincall:"isblank"};b.args=[a];return b}(f[4]):null;d===null&&(d=null,b=g);if(d!==null)g=
d;else{d=g=b;a.substr(b,8)==="SAMETERM"?(f="SAMETERM",b+=8):(f=null,m&&j('"SAMETERM"'));if(f!==null){i=[];for(k=o();k!==null;)i.push(k),k=o();if(i!==null)if(a.substr(b,1)==="("?(k="(",b+=1):(k=null,m&&j('"("')),k!==null){l=[];for(n=o();n!==null;)l.push(n),n=o();if(l!==null)if(n=M(),n!==null){r=[];for(s=o();s!==null;)r.push(s),s=o();if(r!==null)if(a.substr(b,1)===","?(s=",",b+=1):(s=null,m&&j('","')),s!==null){t=[];for(u=o();u!==null;)t.push(u),u=o();if(t!==null)if(u=M(),u!==null){w=[];for(y=o();y!==
null;)w.push(y),y=o();w!==null?(a.substr(b,1)===")"?(y=")",b+=1):(y=null,m&&j('")"')),y!==null?f=[f,i,k,l,n,r,s,t,u,w,y]:(f=null,b=d)):(f=null,b=d)}else f=null,b=d;else f=null,b=d}else f=null,b=d;else f=null,b=d}else f=null,b=d;else f=null,b=d}else f=null,b=d;else f=null,b=d}else f=null,b=d;d=f!==null?function(a,b){var d={token:"expression",expressionType:"builtincall",builtincall:"sameterm"};d.args=[a,b];return d}(f[4],f[8]):null;d===null&&(d=null,b=g);if(d!==null)g=d;else{d=g=b;a.substr(b,5)===
"ISURI"?(f="ISURI",b+=5):(f=null,m&&j('"ISURI"'));f===null&&(a.substr(b,5)==="isuri"?(f="isuri",b+=5):(f=null,m&&j('"isuri"')),f===null&&(a.substr(b,5)==="ISIRI"?(f="ISIRI",b+=5):(f=null,m&&j('"ISIRI"')),f===null&&(a.substr(b,5)==="isiri"?(f="isiri",b+=5):(f=null,m&&j('"isiri"')),f=f!==null?f:null)));if(f!==null){i=[];for(k=o();k!==null;)i.push(k),k=o();if(i!==null)if(a.substr(b,1)==="("?(k="(",b+=1):(k=null,m&&j('"("')),k!==null){l=[];for(n=o();n!==null;)l.push(n),n=o();if(l!==null)if(n=M(),n!==
null){r=[];for(s=o();s!==null;)r.push(s),s=o();r!==null?(a.substr(b,1)===")"?(s=")",b+=1):(s=null,m&&j('")"')),s!==null?f=[f,i,k,l,n,r,s]:(f=null,b=d)):(f=null,b=d)}else f=null,b=d;else f=null,b=d}else f=null,b=d;else f=null,b=d}else f=null,b=d;d=f!==null?function(a){var b={token:"expression",expressionType:"builtincall",builtincall:"isuri"};b.args=[a];return b}(f[4]):null;d===null&&(d=null,b=g);d!==null?g=d:(g=Yb(),g===null&&(g=Zb(),g===null&&(g=$b(),g=g!==null?g:null)))}}}}}}}}}}}}}(m=h)&&g===null&&
j("[106] BuiltInCall");x[e]={nextPos:b,result:g};return g}function Yb(){var e="RegexExpression@"+b,h=x[e];if(h)return b=h.nextPos,h.result;h=m;m=!1;var k=b,d=b;if(a.substr(b,5)==="REGEX"){var f="REGEX";b+=5}else f=null,m&&j('"REGEX"');f===null&&(a.substr(b,5)==="regex"?(f="regex",b+=5):(f=null,m&&j('"regex"')),f=f!==null?f:null);if(f!==null){for(var i=[],g=o();g!==null;)i.push(g),g=o();if(i!==null)if(a.substr(b,1)==="("?(g="(",b+=1):(g=null,m&&j('"("')),g!==null){for(var l=[],n=o();n!==null;)l.push(n),
n=o();if(l!==null)if(n=M(),n!==null){for(var r=[],s=o();s!==null;)r.push(s),s=o();if(r!==null)if(a.substr(b,1)===","?(s=",",b+=1):(s=null,m&&j('","')),s!==null){for(var t=[],u=o();u!==null;)t.push(u),u=o();if(t!==null)if(u=M(),u!==null){for(var w=[],y=o();y!==null;)w.push(y),y=o();if(w!==null){y=b;if(a.substr(b,1)===","){var D=",";b+=1}else D=null,m&&j('","');if(D!==null){for(var A=[],N=o();N!==null;)A.push(N),N=o();A!==null?(N=M(),N!==null?D=[D,A,N]:(D=null,b=y)):(D=null,b=y)}else D=null,b=y;y=D!==
null?D:"";if(y!==null){D=[];for(A=o();A!==null;)D.push(A),A=o();D!==null?(a.substr(b,1)===")"?(A=")",b+=1):(A=null,m&&j('")"')),A!==null?f=[f,i,g,l,n,r,s,t,u,w,y,D,A]:(f=null,b=d)):(f=null,b=d)}else f=null,b=d}else f=null,b=d}else f=null,b=d;else f=null,b=d}else f=null,b=d;else f=null,b=d}else f=null,b=d;else f=null,b=d}else f=null,b=d;else f=null,b=d}else f=null,b=d;d=f!==null?function(a,b,d){var c={token:"expression",expressionType:"regex"};c.text=a;c.pattern=b;c.flags=d[2];return c}(f[4],f[8],
f[10]):null;d===null&&(d=null,b=k);(m=h)&&d===null&&j("[107] RegexExpression");x[e]={nextPos:b,result:d};return d}function Zb(){var e="ExistsFunc@"+b,h=x[e];if(h)return b=h.nextPos,h.result;h=m;m=!1;var k=b,d=b;if(a.substr(b,6)==="EXISTS"){var f="EXISTS";b+=6}else f=null,m&&j('"EXISTS"');f===null&&(a.substr(b,6)==="exists"?(f="exists",b+=6):(f=null,m&&j('"exists"')),f=f!==null?f:null);if(f!==null){for(var g=[],i=o();i!==null;)g.push(i),i=o();g!==null?(i=V(),i!==null?f=[f,g,i]:(f=null,b=d)):(f=null,
b=d)}else f=null,b=d;d=f!==null?function(a){var b={token:"expression",expressionType:"builtincall",builtincall:"exists"};b.args=[a];return b}(f[2]):null;d===null&&(d=null,b=k);(m=h)&&d===null&&j("[108] ExistsFunc");x[e]={nextPos:b,result:d};return d}function $b(){var e="NotExistsFunc@"+b,h=x[e];if(h)return b=h.nextPos,h.result;h=m;m=!1;var k=b,d=b;if(a.substr(b,3)==="NOT"){var f="NOT";b+=3}else f=null,m&&j('"NOT"');f===null&&(a.substr(b,3)==="not"?(f="not",b+=3):(f=null,m&&j('"not"')),f=f!==null?
f:null);if(f!==null){for(var i=[],g=o();g!==null;)i.push(g),g=o();if(i!==null)if(a.substr(b,6)==="EXISTS"?(g="EXISTS",b+=6):(g=null,m&&j('"EXISTS"')),g===null&&(a.substr(b,6)==="exists"?(g="exists",b+=6):(g=null,m&&j('"exists"')),g=g!==null?g:null),g!==null){for(var l=[],n=o();n!==null;)l.push(n),n=o();l!==null?(n=V(),n!==null?f=[f,i,g,l,n]:(f=null,b=d)):(f=null,b=d)}else f=null,b=d;else f=null,b=d}else f=null,b=d;d=f!==null?function(a){var b={token:"expression",expressionType:"builtincall",builtincall:"notexists"};
b.args=[a];return b}(f[4]):null;d===null&&(d=null,b=k);(m=h)&&d===null&&j("[109] NotExistsFunc");x[e]={nextPos:b,result:d};return d}function Xb(){var e="Aggregate@"+b,h=x[e];if(h)return b=h.nextPos,h.result;h=m;m=!1;var k=b,d=b;if(a.substr(b,5)==="COUNT"){var f="COUNT";b+=5}else f=null,m&&j('"COUNT"');f===null&&(a.substr(b,5)==="count"?(f="count",b+=5):(f=null,m&&j('"count"')),f=f!==null?f:null);if(f!==null){for(var g=[],i=o();i!==null;)g.push(i),i=o();if(g!==null)if(a.substr(b,1)==="("?(i="(",b+=
1):(i=null,m&&j('"("')),i!==null){for(var l=[],n=o();n!==null;)l.push(n),n=o();if(l!==null)if(a.substr(b,8)==="DISTINCT"?(n="DISTINCT",b+=8):(n=null,m&&j('"DISTINCT"')),n===null&&(a.substr(b,8)==="distinct"?(n="distinct",b+=8):(n=null,m&&j('"distinct"')),n=n!==null?n:null),n=n!==null?n:"",n!==null){for(var r=[],s=o();s!==null;)r.push(s),s=o();if(r!==null)if(a.substr(b,1)==="*"?(s="*",b+=1):(s=null,m&&j('"*"')),s===null&&(s=M(),s=s!==null?s:null),s!==null){for(var t=[],u=o();u!==null;)t.push(u),u=
o();if(t!==null)if(a.substr(b,1)===")"?(u=")",b+=1):(u=null,m&&j('")"')),u!==null){for(var w=[],y=o();y!==null;)w.push(y),y=o();w!==null?f=[f,g,i,l,n,r,s,t,u,w]:(f=null,b=d)}else f=null,b=d;else f=null,b=d}else f=null,b=d;else f=null,b=d}else f=null,b=d;else f=null,b=d}else f=null,b=d;else f=null,b=d}else f=null,b=d;d=f!==null?function(a,b){var d={token:"expression",expressionType:"aggregate",aggregateType:"count"};d.distinct=a!=""?"DISTINCT":a;d.expression=b;return d}(f[4],f[6]):null;d===null&&(d=
null,b=k);if(d!==null)k=d;else{d=k=b;a.substr(b,3)==="SUM"?(f="SUM",b+=3):(f=null,m&&j('"SUM"'));f===null&&(a.substr(b,3)==="sum"?(f="sum",b+=3):(f=null,m&&j('"sum"')),f=f!==null?f:null);if(f!==null){g=[];for(i=o();i!==null;)g.push(i),i=o();if(g!==null)if(a.substr(b,1)==="("?(i="(",b+=1):(i=null,m&&j('"("')),i!==null){l=[];for(n=o();n!==null;)l.push(n),n=o();if(l!==null)if(a.substr(b,8)==="DISTINCT"?(n="DISTINCT",b+=8):(n=null,m&&j('"DISTINCT"')),n===null&&(a.substr(b,8)==="distinct"?(n="distinct",
b+=8):(n=null,m&&j('"distinct"')),n=n!==null?n:null),n=n!==null?n:"",n!==null){r=[];for(s=o();s!==null;)r.push(s),s=o();if(r!==null)if(s=M(),s!==null){t=[];for(u=o();u!==null;)t.push(u),u=o();if(t!==null)if(a.substr(b,1)===")"?(u=")",b+=1):(u=null,m&&j('")"')),u!==null){w=[];for(y=o();y!==null;)w.push(y),y=o();w!==null?f=[f,g,i,l,n,r,s,t,u,w]:(f=null,b=d)}else f=null,b=d;else f=null,b=d}else f=null,b=d;else f=null,b=d}else f=null,b=d;else f=null,b=d}else f=null,b=d;else f=null,b=d}else f=null,b=d;
d=f!==null?function(a,b){var d={token:"expression",expressionType:"aggregate",aggregateType:"sum"};d.distinct=a!=""?"DISTINCT":a;d.expression=b;return d}(f[4],f[6]):null;d===null&&(d=null,b=k);if(d!==null)k=d;else{d=k=b;a.substr(b,3)==="MIN"?(f="MIN",b+=3):(f=null,m&&j('"MIN"'));f===null&&(a.substr(b,3)==="min"?(f="min",b+=3):(f=null,m&&j('"min"')),f=f!==null?f:null);if(f!==null){g=[];for(i=o();i!==null;)g.push(i),i=o();if(g!==null)if(a.substr(b,1)==="("?(i="(",b+=1):(i=null,m&&j('"("')),i!==null){l=
[];for(n=o();n!==null;)l.push(n),n=o();if(l!==null)if(a.substr(b,8)==="DISTINCT"?(n="DISTINCT",b+=8):(n=null,m&&j('"DISTINCT"')),n===null&&(a.substr(b,8)==="distinct"?(n="distinct",b+=8):(n=null,m&&j('"distinct"')),n=n!==null?n:null),n=n!==null?n:"",n!==null){r=[];for(s=o();s!==null;)r.push(s),s=o();if(r!==null)if(s=M(),s!==null){t=[];for(u=o();u!==null;)t.push(u),u=o();if(t!==null)if(a.substr(b,1)===")"?(u=")",b+=1):(u=null,m&&j('")"')),u!==null){w=[];for(y=o();y!==null;)w.push(y),y=o();w!==null?
f=[f,g,i,l,n,r,s,t,u,w]:(f=null,b=d)}else f=null,b=d;else f=null,b=d}else f=null,b=d;else f=null,b=d}else f=null,b=d;else f=null,b=d}else f=null,b=d;else f=null,b=d}else f=null,b=d;d=f!==null?function(a,b){var d={token:"expression",expressionType:"aggregate",aggregateType:"min"};d.distinct=a!=""?"DISTINCT":a;d.expression=b;return d}(f[4],f[6]):null;d===null&&(d=null,b=k);if(d!==null)k=d;else{d=k=b;a.substr(b,3)==="MAX"?(f="MAX",b+=3):(f=null,m&&j('"MAX"'));f===null&&(a.substr(b,3)==="max"?(f="max",
b+=3):(f=null,m&&j('"max"')),f=f!==null?f:null);if(f!==null){g=[];for(i=o();i!==null;)g.push(i),i=o();if(g!==null)if(a.substr(b,1)==="("?(i="(",b+=1):(i=null,m&&j('"("')),i!==null){l=[];for(n=o();n!==null;)l.push(n),n=o();if(l!==null)if(a.substr(b,8)==="DISTINCT"?(n="DISTINCT",b+=8):(n=null,m&&j('"DISTINCT"')),n===null&&(a.substr(b,8)==="distinct"?(n="distinct",b+=8):(n=null,m&&j('"distinct"')),n=n!==null?n:null),n=n!==null?n:"",n!==null){r=[];for(s=o();s!==null;)r.push(s),s=o();if(r!==null)if(s=
M(),s!==null){t=[];for(u=o();u!==null;)t.push(u),u=o();if(t!==null)if(a.substr(b,1)===")"?(u=")",b+=1):(u=null,m&&j('")"')),u!==null){w=[];for(y=o();y!==null;)w.push(y),y=o();w!==null?f=[f,g,i,l,n,r,s,t,u,w]:(f=null,b=d)}else f=null,b=d;else f=null,b=d}else f=null,b=d;else f=null,b=d}else f=null,b=d;else f=null,b=d}else f=null,b=d;else f=null,b=d}else f=null,b=d;d=f!==null?function(a,b){var d={token:"expression",expressionType:"aggregate",aggregateType:"max"};d.distinct=a!=""?"DISTINCT":a;d.expression=
b;return d}(f[4],f[6]):null;d===null&&(d=null,b=k);if(d!==null)k=d;else{d=k=b;a.substr(b,3)==="AVG"?(f="AVG",b+=3):(f=null,m&&j('"AVG"'));f===null&&(a.substr(b,3)==="avg"?(f="avg",b+=3):(f=null,m&&j('"avg"')),f=f!==null?f:null);if(f!==null){g=[];for(i=o();i!==null;)g.push(i),i=o();if(g!==null)if(a.substr(b,1)==="("?(i="(",b+=1):(i=null,m&&j('"("')),i!==null){l=[];for(n=o();n!==null;)l.push(n),n=o();if(l!==null)if(a.substr(b,8)==="DISTINCT"?(n="DISTINCT",b+=8):(n=null,m&&j('"DISTINCT"')),n===null&&
(a.substr(b,8)==="distinct"?(n="distinct",b+=8):(n=null,m&&j('"distinct"')),n=n!==null?n:null),n=n!==null?n:"",n!==null){r=[];for(s=o();s!==null;)r.push(s),s=o();if(r!==null)if(s=M(),s!==null){t=[];for(u=o();u!==null;)t.push(u),u=o();if(t!==null)if(a.substr(b,1)===")"?(u=")",b+=1):(u=null,m&&j('")"')),u!==null){w=[];for(y=o();y!==null;)w.push(y),y=o();w!==null?f=[f,g,i,l,n,r,s,t,u,w]:(f=null,b=d)}else f=null,b=d;else f=null,b=d}else f=null,b=d;else f=null,b=d}else f=null,b=d;else f=null,b=d}else f=
null,b=d;else f=null,b=d}else f=null,b=d;d=f!==null?function(a,b){var d={token:"expression",expressionType:"aggregate",aggregateType:"avg"};d.distinct=a!=""?"DISTINCT":a;d.expression=b;return d}(f[4],f[6]):null;d===null&&(d=null,b=k);k=d!==null?d:null}}}}(m=h)&&k===null&&j("[110] Aggregate");x[e]={nextPos:b,result:k};return k}function Wb(){var a="IRIrefOrFunction@"+b,c=x[a];if(c)return b=c.nextPos,c.result;c=m;m=!1;var e=b,d=b,f=Q();if(f!==null){var h=hb(),h=h!==null?h:"";h!==null?f=[f,h]:(f=null,
b=d)}else f=null,b=d;d=f!==null?function(a,b){var d={token:"expression",expressionType:"irireforfunction"};d.iriref=a;d.args=b.value;return d}(f[0],f[1]):null;d===null&&(d=null,b=e);(m=c)&&d===null&&j("[117] IRIrefOrFunction");x[a]={nextPos:b,result:d};return d}function Da(){var e="RDFLiteral@"+b,h=x[e];if(h)return b=h.nextPos,h.result;h=m;m=!1;var k=b,d=b,f=ac();if(f!==null){var i=bc();if(i===null){i=b;if(a.substr(b,2)==="^^"){var g="^^";b+=2}else g=null,m&&j('"^^"');if(g!==null){var l=Q();l!==null?
g=[g,l]:(g=null,b=i)}else g=null,b=i;i=g!==null?g:null}i=i!==null?i:"";i!==null?f=[f,i]:(f=null,b=d)}else f=null,b=d;d=f!==null?function(a,b){return typeof b==="string"&&b.length>0?{token:"literal",value:a.value,lang:b.slice(1),type:null}:typeof b==="object"?(b.shift(),{token:"literal",value:a.value,lang:null,type:b[0]}):{token:"literal",value:a.value,lang:null,type:null}}(f[0],f[1]):null;d===null&&(d=null,b=k);(m=h)&&d===null&&j("[112] RDFLiteral");x[e]={nextPos:b,result:d};return d}function Ea(){var a=
"NumericLiteral@"+b,c=x[a];if(c)return b=c.nextPos,c.result;c=m;m=!1;var e=cc();e===null&&(e=dc(),e===null&&(e=pa(),e=e!==null?e:null));(m=c)&&e===null&&j("[113] NumericLiteral");x[a]={nextPos:b,result:e};return e}function cc(){var a="NumericLiteralUnsigned@"+b,c=x[a];if(c)return b=c.nextPos,c.result;c=m;m=!1;var e=Pa();e===null&&(e=Qa(),e===null&&(e=ba(),e=e!==null?e:null));(m=c)&&e===null&&j("[114] NumericLiteralUnsigned");x[a]={nextPos:b,result:e};return e}function dc(){var a="NumericLiteralPositive@"+
b,c=x[a];if(c)return b=c.nextPos,c.result;c=m;m=!1;var e=ec();e===null&&(e=fc(),e===null&&(e=gc(),e=e!==null?e:null));(m=c)&&e===null&&j("[115] NumericLiteralPositive");x[a]={nextPos:b,result:e};return e}function pa(){var a="NumericLiteralNegative@"+b,c=x[a];if(c)return b=c.nextPos,c.result;c=m;m=!1;var e=hc();e===null&&(e=ic(),e===null&&(e=jc(),e=e!==null?e:null));(m=c)&&e===null&&j("[116] NumericLiteralNegative");x[a]={nextPos:b,result:e};return e}function Fa(){var e="BooleanLiteral@"+b,h=x[e];
if(h)return b=h.nextPos,h.result;h=m;m=!1;var k=b;if(a.substr(b,4)==="TRUE"){var d="TRUE";b+=4}else d=null,m&&j('"TRUE"');d===null&&(a.substr(b,4)==="true"?(d="true",b+=4):(d=null,m&&j('"true"')),d=d!==null?d:null);d=d!==null?{token:"literal",lang:null,type:"http://www.w3.org/2001/XMLSchema#boolean",value:!0}:null;d===null&&(d=null,b=k);d!==null?k=d:(k=b,a.substr(b,5)==="FALSE"?(d="FALSE",b+=5):(d=null,m&&j('"FALSE"')),d===null&&(a.substr(b,5)==="false"?(d="false",b+=5):(d=null,m&&j('"false"')),d=
d!==null?d:null),d=d!==null?{token:"literal",lang:null,type:"http://www.w3.org/2001/XMLSchema#boolean",value:!1}:null,d===null&&(d=null,b=k),k=d!==null?d:null);(m=h)&&k===null&&j("[117] BooleanLiteral");x[e]={nextPos:b,result:k};return k}function ac(){var a="String@"+b,c=x[a];if(c)return b=c.nextPos,c.result;c=m;m=!1;var e=b,d=kc(),d=d!==null?{token:"string",value:d}:null;d===null&&(d=null,b=e);d!==null?e=d:(e=b,d=lc(),d=d!==null?{token:"string",value:d}:null,d===null&&(d=null,b=e),d!==null?e=d:(e=
b,d=mc(),d=d!==null?{token:"string",value:d}:null,d===null&&(d=null,b=e),d!==null?e=d:(e=b,d=nc(),d=d!==null?{token:"string",value:d}:null,d===null&&(d=null,b=e),e=d!==null?d:null)));(m=c)&&e===null&&j("[118] String");x[a]={nextPos:b,result:e};return e}function Q(){var a="IRIref@"+b,c=x[a];if(c)return b=c.nextPos,c.result;c=m;m=!1;var e=b,d=ka(),d=d!==null?{token:"uri",prefix:null,suffix:null,value:d}:null;d===null&&(d=null,b=e);d!==null?e=d:(e=b,d=oc(),d=d!==null?d:null,d===null&&(d=null,b=e),e=
d!==null?d:null);(m=c)&&e===null&&j("[119] IRIref");x[a]={nextPos:b,result:e};return e}function oc(){var a="PrefixedName@"+b,c=x[a];if(c)return b=c.nextPos,c.result;c=m;m=!1;var e=b,d=pc(),d=d!==null?{token:"uri",prefix:d[0],suffix:d[1],value:null}:null;d===null&&(d=null,b=e);d!==null?e=d:(e=b,d=Aa(),d=d!==null?{token:"uri",prefix:d,suffix:"",value:null}:null,d===null&&(d=null,b=e),e=d!==null?d:null);(m=c)&&e===null&&j("[120] PrefixedName");x[a]={nextPos:b,result:e};return e}function Vb(){var a="BlankNode@"+
b,c=x[a];if(c)return b=c.nextPos,c.result;c=m;m=!1;var e=b,d=qc(),d=d!==null?{token:"blank",value:d}:null;d===null&&(d=null,b=e);d!==null?e=d:(e=b,rc()!==null?(ca++,d={token:"blank",value:"_:"+ca}):d=null,d===null&&(d=null,b=e),e=d!==null?d:null);(m=c)&&e===null&&j("[121] BlankNode");x[a]={nextPos:b,result:e};return e}function ka(){var e="IRI_REF@"+b,h=x[e];if(h)return b=h.nextPos,h.result;h=m;m=!1;var k=b,d=b;if(a.substr(b,1)==="<"){var f="<";b+=1}else f=null,m&&j('"<"');if(f!==null){var i=[];if(a.substr(b).match(/^[^<>"{}|^`\\]/)!==
null){var g=a.charAt(b);b++}else g=null,m&&j('[^<>"{}|^`\\\\]');for(;g!==null;)i.push(g),a.substr(b).match(/^[^<>"{}|^`\\]/)!==null?(g=a.charAt(b),b++):(g=null,m&&j('[^<>"{}|^`\\\\]'));i!==null?(a.substr(b,1)===">"?(g=">",b+=1):(g=null,m&&j('">"')),g!==null?f=[f,i,g]:(f=null,b=d)):(f=null,b=d)}else f=null,b=d;d=f!==null?f[1].join(""):null;d===null&&(d=null,b=k);(m=h)&&d===null&&j("[122] IRI_REF");x[e]={nextPos:b,result:d};return d}function Aa(){var e="PNAME_NS@"+b,h=x[e];if(h)return b=h.nextPos,h.result;
h=m;m=!1;var k=b,d=b,f=Ya(),f=f!==null?f:"";if(f!==null){if(a.substr(b,1)===":"){var i=":";b+=1}else i=null,m&&j('":"');i!==null?f=[f,i]:(f=null,b=d)}else f=null,b=d;d=f!==null?f[0]:null;d===null&&(d=null,b=k);(m=h)&&d===null&&j("[123] PNAME_NS");x[e]={nextPos:b,result:d};return d}function pc(){var a="PNAME_LN@"+b,c=x[a];if(c)return b=c.nextPos,c.result;c=m;m=!1;var e=b,d=b,f=Aa();if(f!==null){var h=lb();h!==null?f=[f,h]:(f=null,b=d)}else f=null,b=d;d=f!==null?[f[0],f[1]]:null;d===null&&(d=null,b=
e);(m=c)&&d===null&&j("[124] PNAME_LN");x[a]={nextPos:b,result:d};return d}function qc(){var e="BLANK_NODE_LABEL@"+b,h=x[e];if(h)return b=h.nextPos,h.result;h=m;m=!1;var k=b,d=b;if(a.substr(b,2)==="_:"){var f="_:";b+=2}else f=null,m&&j('"_:"');if(f!==null){var i=lb();i!==null?f=[f,i]:(f=null,b=d)}else f=null,b=d;d=f!==null?f[1]:null;d===null&&(d=null,b=k);(m=h)&&d===null&&j("[125] BLANK_NODE_LABEL");x[e]={nextPos:b,result:d};return d}function Tb(){var e="VAR1@"+b,h=x[e];if(h)return b=h.nextPos,h.result;
h=m;m=!1;var k=b,d=b;if(a.substr(b,1)==="?"){var f="?";b+=1}else f=null,m&&j('"?"');if(f!==null){var i=mb();i!==null?f=[f,i]:(f=null,b=d)}else f=null,b=d;d=f!==null?f[1]:null;d===null&&(d=null,b=k);(m=h)&&d===null&&j("[126] VAR1");x[e]={nextPos:b,result:d};return d}function Ub(){var e="VAR2@"+b,h=x[e];if(h)return b=h.nextPos,h.result;h=m;m=!1;var k=b,d=b;if(a.substr(b,1)==="$"){var f="$";b+=1}else f=null,m&&j('"$"');if(f!==null){var i=mb();i!==null?f=[f,i]:(f=null,b=d)}else f=null,b=d;d=f!==null?
f[1]:null;d===null&&(d=null,b=k);(m=h)&&d===null&&j("[127] VAR2");x[e]={nextPos:b,result:d};return d}function bc(){var e="LANGTAG@"+b,h=x[e];if(h)return b=h.nextPos,h.result;h=m;m=!1;var k=b,d=b;if(a.substr(b,1)==="@"){var f="@";b+=1}else f=null,m&&j('"@"');if(f!==null){if(a.substr(b).match(/^[a-zA-Z]/)!==null){var i=a.charAt(b);b++}else i=null,m&&j("[a-zA-Z]");if(i!==null)for(var g=[];i!==null;)g.push(i),a.substr(b).match(/^[a-zA-Z]/)!==null?(i=a.charAt(b),b++):(i=null,m&&j("[a-zA-Z]"));else g=null;
if(g!==null){var i=[],l=b;if(a.substr(b,1)==="-"){var n="-";b+=1}else n=null,m&&j('"-"');if(n!==null){if(a.substr(b).match(/^[a-zA-Z0-9]/)!==null){var o=a.charAt(b);b++}else o=null,m&&j("[a-zA-Z0-9]");if(o!==null)for(var r=[];o!==null;)r.push(o),a.substr(b).match(/^[a-zA-Z0-9]/)!==null?(o=a.charAt(b),b++):(o=null,m&&j("[a-zA-Z0-9]"));else r=null;r!==null?n=[n,r]:(n=null,b=l)}else n=null,b=l;for(;n!==null;)if(i.push(n),l=b,a.substr(b,1)==="-"?(n="-",b+=1):(n=null,m&&j('"-"')),n!==null){a.substr(b).match(/^[a-zA-Z0-9]/)!==
null?(o=a.charAt(b),b++):(o=null,m&&j("[a-zA-Z0-9]"));if(o!==null)for(r=[];o!==null;)r.push(o),a.substr(b).match(/^[a-zA-Z0-9]/)!==null?(o=a.charAt(b),b++):(o=null,m&&j("[a-zA-Z0-9]"));else r=null;r!==null?n=[n,r]:(n=null,b=l)}else n=null,b=l;i!==null?f=[f,g,i]:(f=null,b=d)}else f=null,b=d}else f=null,b=d;d=f!==null?f[2].length===0?("@"+f[1].join("")).toLowerCase():("@"+f[1].join("")+"-"+f[2][0][1].join("")).toLowerCase():null;d===null&&(d=null,b=k);(m=h)&&d===null&&j("[128] LANGTAG");x[e]={nextPos:b,
result:d};return d}function ba(){var e="INTEGER@"+b,h=x[e];if(h)return b=h.nextPos,h.result;h=m;m=!1;var k=b;if(a.substr(b).match(/^[0-9]/)!==null){var d=a.charAt(b);b++}else d=null,m&&j("[0-9]");if(d!==null)for(var f=[];d!==null;)f.push(d),a.substr(b).match(/^[0-9]/)!==null?(d=a.charAt(b),b++):(d=null,m&&j("[0-9]"));else f=null;d=f!==null?function(a){var b={token:"literal",lang:null,type:"http://www.w3.org/2001/XMLSchema#integer"};b.value=W(a);return b}(f):null;d===null&&(d=null,b=k);(m=h)&&d===
null&&j("[129] INTEGER");x[e]={nextPos:b,result:d};return d}function Qa(){var e="DECIMAL@"+b,h=x[e];if(h)return b=h.nextPos,h.result;h=m;m=!1;var k=b,d=b;if(a.substr(b).match(/^[0-9]/)!==null){var f=a.charAt(b);b++}else f=null,m&&j("[0-9]");if(f!==null)for(var i=[];f!==null;)i.push(f),a.substr(b).match(/^[0-9]/)!==null?(f=a.charAt(b),b++):(f=null,m&&j("[0-9]"));else i=null;if(i!==null)if(a.substr(b,1)==="."?(f=".",b+=1):(f=null,m&&j('"."')),f!==null){var g=[];if(a.substr(b).match(/^[0-9]/)!==null){var l=
a.charAt(b);b++}else l=null,m&&j("[0-9]");for(;l!==null;)g.push(l),a.substr(b).match(/^[0-9]/)!==null?(l=a.charAt(b),b++):(l=null,m&&j("[0-9]"));g!==null?i=[i,f,g]:(i=null,b=d)}else i=null,b=d;else i=null,b=d;d=i!==null?function(a,b,c){var d={token:"literal",lang:null,type:"http://www.w3.org/2001/XMLSchema#decimal"};d.value=W([a,b,c]);return d}(i[0],i[1],i[2]):null;d===null&&(d=null,b=k);if(d!==null)k=d;else{d=k=b;a.substr(b,1)==="."?(i=".",b+=1):(i=null,m&&j('"."'));if(i!==null){a.substr(b).match(/^[0-9]/)!==
null?(f=a.charAt(b),b++):(f=null,m&&j("[0-9]"));if(f!==null)for(g=[];f!==null;)g.push(f),a.substr(b).match(/^[0-9]/)!==null?(f=a.charAt(b),b++):(f=null,m&&j("[0-9]"));else g=null;g!==null?i=[i,g]:(i=null,b=d)}else i=null,b=d;d=i!==null?function(a,b){var c={token:"literal",lang:null,type:"http://www.w3.org/2001/XMLSchema#decimal"};c.value=W([a,b]);return c}(i[0],i[1]):null;d===null&&(d=null,b=k);k=d!==null?d:null}(m=h)&&k===null&&j("[130] DECIMAL");x[e]={nextPos:b,result:k};return k}function Pa(){var e=
"DOUBLE@"+b,h=x[e];if(h)return b=h.nextPos,h.result;h=m;m=!1;var k=b,d=b;if(a.substr(b).match(/^[0-9]/)!==null){var f=a.charAt(b);b++}else f=null,m&&j("[0-9]");if(f!==null)for(var i=[];f!==null;)i.push(f),a.substr(b).match(/^[0-9]/)!==null?(f=a.charAt(b),b++):(f=null,m&&j("[0-9]"));else i=null;if(i!==null)if(a.substr(b,1)==="."?(f=".",b+=1):(f=null,m&&j('"."')),f!==null){var g=[];if(a.substr(b).match(/^[0-9]/)!==null){var l=a.charAt(b);b++}else l=null,m&&j("[0-9]");for(;l!==null;)g.push(l),a.substr(b).match(/^[0-9]/)!==
null?(l=a.charAt(b),b++):(l=null,m&&j("[0-9]"));g!==null?(l=Ra(),l!==null?i=[i,f,g,l]:(i=null,b=d)):(i=null,b=d)}else i=null,b=d;else i=null,b=d;d=i!==null?function(a,b,c,d){var f={token:"literal",lang:null,type:"http://www.w3.org/2001/XMLSchema#double"};f.value=W([a,b,c,d]);return f}(i[0],i[1],i[2],i[3]):null;d===null&&(d=null,b=k);if(d!==null)k=d;else{d=k=b;a.substr(b,1)==="."?(i=".",b+=1):(i=null,m&&j('"."'));if(i!==null){a.substr(b).match(/^[0-9]/)!==null?(g=a.charAt(b),b++):(g=null,m&&j("[0-9]"));
if(g!==null)for(f=[];g!==null;)f.push(g),a.substr(b).match(/^[0-9]/)!==null?(g=a.charAt(b),b++):(g=null,m&&j("[0-9]"));else f=null;f!==null?(g=Ra(),g!==null?i=[i,f,g]:(i=null,b=d)):(i=null,b=d)}else i=null,b=d;d=i!==null?function(a,b,c){var d={token:"literal",lang:null,type:"http://www.w3.org/2001/XMLSchema#double"};d.value=W([a,b,c]);return d}(i[0],i[1],i[2]):null;d===null&&(d=null,b=k);if(d!==null)k=d;else{d=k=b;a.substr(b).match(/^[0-9]/)!==null?(f=a.charAt(b),b++):(f=null,m&&j("[0-9]"));if(f!==
null)for(i=[];f!==null;)i.push(f),a.substr(b).match(/^[0-9]/)!==null?(f=a.charAt(b),b++):(f=null,m&&j("[0-9]"));else i=null;i!==null?(f=Ra(),f!==null?i=[i,f]:(i=null,b=d)):(i=null,b=d);d=i!==null?function(a,b){var c={token:"literal",lang:null,type:"http://www.w3.org/2001/XMLSchema#double"};c.value=W([a,b]);return c}(i[0],i[1]):null;d===null&&(d=null,b=k);k=d!==null?d:null}}(m=h)&&k===null&&j("[131] DOUBLE");x[e]={nextPos:b,result:k};return k}function gc(){var e="INTEGER_POSITIVE@"+b,h=x[e];if(h)return b=
h.nextPos,h.result;h=m;m=!1;var i=b,d=b;if(a.substr(b,1)==="+"){var f="+";b+=1}else f=null,m&&j('"+"');if(f!==null){var k=ba();k!==null?f=[f,k]:(f=null,b=d)}else f=null,b=d;d=f!==null?function(a){a.value="+"+a.value;return a}(f[1]):null;d===null&&(d=null,b=i);(m=h)&&d===null&&j("[132] INTEGER_POSITIVE");x[e]={nextPos:b,result:d};return d}function fc(){var e="DECIMAL_POSITIVE@"+b,h=x[e];if(h)return b=h.nextPos,h.result;h=m;m=!1;var i=b,d=b;if(a.substr(b,1)==="+"){var f="+";b+=1}else f=null,m&&j('"+"');
if(f!==null){var k=Qa();k!==null?f=[f,k]:(f=null,b=d)}else f=null,b=d;d=f!==null?function(a){a.value="+"+a.value;return a}(f[1]):null;d===null&&(d=null,b=i);(m=h)&&d===null&&j("[133] DECIMAL_POSITIVE");x[e]={nextPos:b,result:d};return d}function ec(){var e="DOUBLE_POSITIVE@"+b,h=x[e];if(h)return b=h.nextPos,h.result;h=m;m=!1;var i=b,d=b;if(a.substr(b,1)==="+"){var f="+";b+=1}else f=null,m&&j('"+"');if(f!==null){var k=Pa();k!==null?f=[f,k]:(f=null,b=d)}else f=null,b=d;d=f!==null?function(a){a.value=
"+"+a.value;return a}(f[1]):null;d===null&&(d=null,b=i);(m=h)&&d===null&&j("[134] DOUBLE_POSITIVE");x[e]={nextPos:b,result:d};return d}function jc(){var e="INTEGER_NEGATIVE@"+b,h=x[e];if(h)return b=h.nextPos,h.result;h=m;m=!1;var i=b,d=b;if(a.substr(b,1)==="-"){var f="-";b+=1}else f=null,m&&j('"-"');if(f!==null){var k=ba();k!==null?f=[f,k]:(f=null,b=d)}else f=null,b=d;d=f!==null?function(a){a.value="-"+a.value;return a}(f[1]):null;d===null&&(d=null,b=i);(m=h)&&d===null&&j("[135] INTEGER_NEGATIVE");
x[e]={nextPos:b,result:d};return d}function ic(){var e="DECIMAL_NEGATIVE@"+b,h=x[e];if(h)return b=h.nextPos,h.result;h=m;m=!1;var i=b,d=b;if(a.substr(b,1)==="-"){var f="-";b+=1}else f=null,m&&j('"-"');if(f!==null){var k=Qa();k!==null?f=[f,k]:(f=null,b=d)}else f=null,b=d;d=f!==null?function(a){a.value="-"+a.value;return a}(f[1]):null;d===null&&(d=null,b=i);(m=h)&&d===null&&j("[136] DECIMAL_NEGATIVE");x[e]={nextPos:b,result:d};return d}function hc(){var e="DOUBLE_NEGATIVE@"+b,h=x[e];if(h)return b=h.nextPos,
h.result;h=m;m=!1;var i=b,d=b;if(a.substr(b,1)==="-"){var f="-";b+=1}else f=null,m&&j('"-"');if(f!==null){var k=Pa();k!==null?f=[f,k]:(f=null,b=d)}else f=null,b=d;d=f!==null?function(a){a.value="-"+a.value;return a}(f[1]):null;d===null&&(d=null,b=i);(m=h)&&d===null&&j("[137] DOUBLE_NEGATIVE");x[e]={nextPos:b,result:d};return d}function Ra(){var e="EXPONENT@"+b,h=x[e];if(h)return b=h.nextPos,h.result;h=m;m=!1;var i=b,d=b;if(a.substr(b).match(/^[eE]/)!==null){var f=a.charAt(b);b++}else f=null,m&&j("[eE]");
if(f!==null){if(a.substr(b).match(/^[+\-]/)!==null){var k=a.charAt(b);b++}else k=null,m&&j("[+\\-]");k=k!==null?k:"";if(k!==null){if(a.substr(b).match(/^[0-9]/)!==null){var g=a.charAt(b);b++}else g=null,m&&j("[0-9]");if(g!==null)for(var l=[];g!==null;)l.push(g),a.substr(b).match(/^[0-9]/)!==null?(g=a.charAt(b),b++):(g=null,m&&j("[0-9]"));else l=null;l!==null?f=[f,k,l]:(f=null,b=d)}else f=null,b=d}else f=null,b=d;d=f!==null?W([f[0],f[1],f[2]]):null;d===null&&(d=null,b=i);(m=h)&&d===null&&j("[138] EXPONENT");
x[e]={nextPos:b,result:d};return d}function mc(){var e="STRING_LITERAL1@"+b,h=x[e];if(h)return b=h.nextPos,h.result;h=m;m=!1;var i=b,d=b;if(a.substr(b,1)==="'"){var f="'";b+=1}else f=null,m&&j('"\'"');if(f!==null){var k=[];if(a.substr(b).match(/^[^'\\\n\r]/)!==null){var g=a.charAt(b);b++}else g=null,m&&j("[^'\\\\\\n\\r]");g===null&&(g=da(),g=g!==null?g:null);for(;g!==null;)k.push(g),a.substr(b).match(/^[^'\\\n\r]/)!==null?(g=a.charAt(b),b++):(g=null,m&&j("[^'\\\\\\n\\r]")),g===null&&(g=da(),g=g!==
null?g:null);k!==null?(a.substr(b,1)==="'"?(g="'",b+=1):(g=null,m&&j('"\'"')),g!==null?f=[f,k,g]:(f=null,b=d)):(f=null,b=d)}else f=null,b=d;d=f!==null?W(f[1]):null;d===null&&(d=null,b=i);(m=h)&&d===null&&j("[139] STRING_LITERAL1");x[e]={nextPos:b,result:d};return d}function nc(){var e="STRING_LITERAL2@"+b,h=x[e];if(h)return b=h.nextPos,h.result;h=m;m=!1;var i=b,d=b;if(a.substr(b,1)==='"'){var f='"';b+=1}else f=null,m&&j('"\\""');if(f!==null){var k=[];if(a.substr(b).match(/^[^"\\\n\r]/)!==null){var g=
a.charAt(b);b++}else g=null,m&&j('[^"\\\\\\n\\r]');g===null&&(g=da(),g=g!==null?g:null);for(;g!==null;)k.push(g),a.substr(b).match(/^[^"\\\n\r]/)!==null?(g=a.charAt(b),b++):(g=null,m&&j('[^"\\\\\\n\\r]')),g===null&&(g=da(),g=g!==null?g:null);k!==null?(a.substr(b,1)==='"'?(g='"',b+=1):(g=null,m&&j('"\\""')),g!==null?f=[f,k,g]:(f=null,b=d)):(f=null,b=d)}else f=null,b=d;d=f!==null?W(f[1]):null;d===null&&(d=null,b=i);(m=h)&&d===null&&j("[140] STRING_LITERAL2");x[e]={nextPos:b,result:d};return d}function kc(){var e=
"STRING_LITERAL_LONG1@"+b,h=x[e];if(h)return b=h.nextPos,h.result;h=m;m=!1;var i=b,d=b;if(a.substr(b,3)==="'''"){var f="'''";b+=3}else f=null,m&&j("\"'''\"");if(f!==null){var k=[];if(a.substr(b).match(/^[^'\\]/)!==null){var g=a.charAt(b);b++}else g=null,m&&j("[^'\\\\]");g===null&&(g=da(),g=g!==null?g:null);for(;g!==null;)k.push(g),a.substr(b).match(/^[^'\\]/)!==null?(g=a.charAt(b),b++):(g=null,m&&j("[^'\\\\]")),g===null&&(g=da(),g=g!==null?g:null);k!==null?(a.substr(b,3)==="'''"?(g="'''",b+=3):(g=
null,m&&j("\"'''\"")),g!==null?f=[f,k,g]:(f=null,b=d)):(f=null,b=d)}else f=null,b=d;d=f!==null?W(f[1]):null;d===null&&(d=null,b=i);(m=h)&&d===null&&j("[141] STRING_LITERAL_LONG1");x[e]={nextPos:b,result:d};return d}function lc(){var e="STRING_LITERAL_LONG2@"+b,h=x[e];if(h)return b=h.nextPos,h.result;h=m;m=!1;var i=b,d=b;if(a.substr(b,3)==='"""'){var f='"""';b+=3}else f=null,m&&j('"\\"\\"\\""');if(f!==null){var k=[];if(a.substr(b).match(/^[^"\\]/)!==null){var g=a.charAt(b);b++}else g=null,m&&j('[^"\\\\]');
g===null&&(g=da(),g=g!==null?g:null);for(;g!==null;)k.push(g),a.substr(b).match(/^[^"\\]/)!==null?(g=a.charAt(b),b++):(g=null,m&&j('[^"\\\\]')),g===null&&(g=da(),g=g!==null?g:null);k!==null?(a.substr(b,3)==='"""'?(g='"""',b+=3):(g=null,m&&j('"\\"\\"\\""')),g!==null?f=[f,k,g]:(f=null,b=d)):(f=null,b=d)}else f=null,b=d;d=f!==null?W(f[1]):null;d===null&&(d=null,b=i);(m=h)&&d===null&&j("[142] STRING_LITERAL_LONG2");x[e]={nextPos:b,result:d};return d}function da(){var e="ECHAR@"+b,h=x[e];if(h)return b=
h.nextPos,h.result;h=m;m=!1;var g=b;if(a.substr(b,1)==="\\"){var d="\\";b+=1}else d=null,m&&j('"\\\\"');if(d!==null){if(a.substr(b).match(/^[tbnrf"']/)!==null){var f=a.charAt(b);b++}else f=null,m&&j("[tbnrf\"']");f!==null?d=[d,f]:(d=null,b=g)}else d=null,b=g;(m=h)&&d===null&&j("[143] ECHAR");x[e]={nextPos:b,result:d};return d}function ia(){var e="NIL@"+b,h=x[e];if(h)return b=h.nextPos,h.result;h=m;m=!1;var g=b,d=b;if(a.substr(b,1)==="("){var f="(";b+=1}else f=null,m&&j('"("');if(f!==null){for(var i=
[],k=o();k!==null;)i.push(k),k=o();i!==null?(a.substr(b,1)===")"?(k=")",b+=1):(k=null,m&&j('")"')),k!==null?f=[f,i,k]:(f=null,b=d)):(f=null,b=d)}else f=null,b=d;d=f!==null?{token:"triplesnodecollection",triplesContext:[],chainSubject:[{token:"uri",value:"http://www.w3.org/1999/02/22-rdf-syntax-ns#nil"}]}:null;d===null&&(d=null,b=g);(m=h)&&d===null&&j("[144] NIL");x[e]={nextPos:b,result:d};return d}function o(){var e="WS@"+b,h=x[e];if(h)return b=h.nextPos,h.result;h=m;m=!1;if(a.substr(b).match(/^[ ]/)!==
null){var g=a.charAt(b);b++}else g=null,m&&j("[ ]");g===null&&(a.substr(b).match(/^[\t]/)!==null?(g=a.charAt(b),b++):(g=null,m&&j("[\t]")),g===null&&(a.substr(b).match(/^[\r]/)!==null?(g=a.charAt(b),b++):(g=null,m&&j("[\\r]")),g===null&&(a.substr(b).match(/^[\n]/)!==null?(g=a.charAt(b),b++):(g=null,m&&j("[\\n]")),g===null&&(g=sc(),g=g!==null?g:null))));(m=h)&&g===null&&j("[145] WS");x[e]={nextPos:b,result:g};return g}function sc(){var e="COMMENT@"+b,h=x[e];if(h)return b=h.nextPos,h.result;h=m;m=!1;
var g=b;if(a.substr(b,1)==="#"){var d="#";b+=1}else d=null,m&&j('"#"');if(d!==null){var f=[];if(a.substr(b).match(/^[^\n\r]/)!==null){var i=a.charAt(b);b++}else i=null,m&&j("[^\\n\\r]");for(;i!==null;)f.push(i),a.substr(b).match(/^[^\n\r]/)!==null?(i=a.charAt(b),b++):(i=null,m&&j("[^\\n\\r]"));f!==null?d=[d,f]:(d=null,b=g)}else d=null,b=g;(m=h)&&d===null&&j(" COMMENT");x[e]={nextPos:b,result:d};return d}function rc(){var e="ANON@"+b,h=x[e];if(h)return b=h.nextPos,h.result;h=m;m=!1;var g=b;if(a.substr(b,
1)==="["){var d="[";b+=1}else d=null,m&&j('"["');if(d!==null){for(var f=[],i=o();i!==null;)f.push(i),i=o();f!==null?(a.substr(b,1)==="]"?(i="]",b+=1):(i=null,m&&j('"]"')),i!==null?d=[d,f,i]:(d=null,b=g)):(d=null,b=g)}else d=null,b=g;(m=h)&&d===null&&j("[146] ANON");x[e]={nextPos:b,result:d};return d}function nb(){var e="PN_CHARS_BASE@"+b,h=x[e];if(h)return b=h.nextPos,h.result;h=m;m=!1;if(a.substr(b).match(/^[A-Z]/)!==null){var g=a.charAt(b);b++}else g=null,m&&j("[A-Z]");g===null&&(a.substr(b).match(/^[a-z]/)!==
null?(g=a.charAt(b),b++):(g=null,m&&j("[a-z]")),g===null&&(a.substr(b).match(/^[\xC0-\xD6]/)!==null?(g=a.charAt(b),b++):(g=null,m&&j("[\\xC0-\\xD6]")),g===null&&(a.substr(b).match(/^[\xD8-\xF6]/)!==null?(g=a.charAt(b),b++):(g=null,m&&j("[\\xD8-\\xF6]")),g===null&&(a.substr(b).match(/^[\xF8-\u02FF]/)!==null?(g=a.charAt(b),b++):(g=null,m&&j("[\\xF8-\\u02FF]")),g===null&&(a.substr(b).match(/^[\u0370-\u037D]/)!==null?(g=a.charAt(b),b++):(g=null,m&&j("[\\u0370-\\u037D]")),g===null&&(a.substr(b).match(/^[\u037F-\u1FFF]/)!==
null?(g=a.charAt(b),b++):(g=null,m&&j("[\\u037F-\\u1FFF]")),g===null&&(a.substr(b).match(/^[\u200C-\u200D]/)!==null?(g=a.charAt(b),b++):(g=null,m&&j("[\\u200C-\\u200D]")),g===null&&(a.substr(b).match(/^[\u2070-\u218F]/)!==null?(g=a.charAt(b),b++):(g=null,m&&j("[\\u2070-\\u218F]")),g===null&&(a.substr(b).match(/^[\u2C00-\u2FEF]/)!==null?(g=a.charAt(b),b++):(g=null,m&&j("[\\u2C00-\\u2FEF]")),g===null&&(a.substr(b).match(/^[\u3001-\uD7FF]/)!==null?(g=a.charAt(b),b++):(g=null,m&&j("[\\u3001-\\uD7FF]")),
g===null&&(a.substr(b).match(/^[\uF900-\uFDCF]/)!==null?(g=a.charAt(b),b++):(g=null,m&&j("[\\uF900-\\uFDCF]")),g===null&&(a.substr(b).match(/^[\uFDF0-\uFFFD]/)!==null?(g=a.charAt(b),b++):(g=null,m&&j("[\\uFDF0-\\uFFFD]")),g===null&&(a.substr(b).match(/^[\u1000-\uEFFF]/)!==null?(g=a.charAt(b),b++):(g=null,m&&j("[\\u1000-\\uEFFF]")),g=g!==null?g:null)))))))))))));(m=h)&&g===null&&j("[147] PN_CHARS_BASE");x[e]={nextPos:b,result:g};return g}function qa(){var e="PN_CHARS_U@"+b,h=x[e];if(h)return b=h.nextPos,
h.result;h=m;m=!1;var g=nb();g===null&&(a.substr(b,1)==="_"?(g="_",b+=1):(g=null,m&&j('"_"')),g=g!==null?g:null);(m=h)&&g===null&&j("[148] PN_CHARS_U");x[e]={nextPos:b,result:g};return g}function mb(){var e="VARNAME@"+b,h=x[e];if(h)return b=h.nextPos,h.result;h=m;m=!1;var g=b,d=b,f=qa();f===null&&(a.substr(b).match(/^[0-9]/)!==null?(f=a.charAt(b),b++):(f=null,m&&j("[0-9]")),f=f!==null?f:null);if(f!==null){var i=[],k=qa();k===null&&(a.substr(b).match(/^[0-9]/)!==null?(k=a.charAt(b),b++):(k=null,m&&
j("[0-9]")),k===null&&(a.substr(b).match(/^[\xB7]/)!==null?(k=a.charAt(b),b++):(k=null,m&&j("[\\xB7]")),k===null&&(a.substr(b).match(/^[\u0300-\u036F]/)!==null?(k=a.charAt(b),b++):(k=null,m&&j("[\\u0300-\\u036F]")),k===null&&(a.substr(b).match(/^[\u203F-\u2040]/)!==null?(k=a.charAt(b),b++):(k=null,m&&j("[\\u203F-\\u2040]")),k=k!==null?k:null))));for(;k!==null;)i.push(k),k=qa(),k===null&&(a.substr(b).match(/^[0-9]/)!==null?(k=a.charAt(b),b++):(k=null,m&&j("[0-9]")),k===null&&(a.substr(b).match(/^[\xB7]/)!==
null?(k=a.charAt(b),b++):(k=null,m&&j("[\\xB7]")),k===null&&(a.substr(b).match(/^[\u0300-\u036F]/)!==null?(k=a.charAt(b),b++):(k=null,m&&j("[\\u0300-\\u036F]")),k===null&&(a.substr(b).match(/^[\u203F-\u2040]/)!==null?(k=a.charAt(b),b++):(k=null,m&&j("[\\u203F-\\u2040]")),k=k!==null?k:null))));i!==null?f=[f,i]:(f=null,b=d)}else f=null,b=d;d=f!==null?f[0]+f[1].join(""):null;d===null&&(d=null,b=g);(m=h)&&d===null&&j("[149] VARNAME");x[e]={nextPos:b,result:d};return d}function za(){var e="PN_CHARS@"+
b,h=x[e];if(h)return b=h.nextPos,h.result;h=m;m=!1;var g=qa();g===null&&(a.substr(b,1)==="-"?(g="-",b+=1):(g=null,m&&j('"-"')),g===null&&(a.substr(b).match(/^[0-9]/)!==null?(g=a.charAt(b),b++):(g=null,m&&j("[0-9]")),g===null&&(a.substr(b).match(/^[\xB7]/)!==null?(g=a.charAt(b),b++):(g=null,m&&j("[\\xB7]")),g===null&&(a.substr(b).match(/^[\u0300-\u036F]/)!==null?(g=a.charAt(b),b++):(g=null,m&&j("[\\u0300-\\u036F]")),g===null&&(a.substr(b).match(/^[\u203F-\u2040]/)!==null?(g=a.charAt(b),b++):(g=null,
m&&j("[\\u203F-\\u2040]")),g=g!==null?g:null)))));(m=h)&&g===null&&j("[150] PN_CHARS");x[e]={nextPos:b,result:g};return g}function Ya(){var e="PN_PREFIX@"+b,h=x[e];if(h)return b=h.nextPos,h.result;h=m;m=!1;var g=b,d=b,f=nb();if(f!==null){var k=[],i=za();i===null&&(a.substr(b,1)==="."?(i=".",b+=1):(i=null,m&&j('"."')),i=i!==null?i:null);for(;i!==null;)k.push(i),i=za(),i===null&&(a.substr(b,1)==="."?(i=".",b+=1):(i=null,m&&j('"."')),i=i!==null?i:null);k!==null?f=[f,k]:(f=null,b=d)}else f=null,b=d;d=
f!==null?function(a,b){if(b[b.length-1]==".")throw Error("Wrong PN_PREFIX, cannot finish with '.'");else return a+b.join("")}(f[0],f[1]):null;d===null&&(d=null,b=g);(m=h)&&d===null&&j("[151] PN_PREFIX");x[e]={nextPos:b,result:d};return d}function lb(){var e="PN_LOCAL@"+b,h=x[e];if(h)return b=h.nextPos,h.result;h=m;m=!1;var g=b,d=b,f=qa();f===null&&(a.substr(b).match(/^[0-9]/)!==null?(f=a.charAt(b),b++):(f=null,m&&j("[0-9]")),f=f!==null?f:null);if(f!==null){for(var k=[],i=za();i!==null;)k.push(i),
i=za();k!==null?f=[f,k]:(f=null,b=d)}else f=null,b=d;d=f!==null?f[0]+f[1].join(""):null;d===null&&(d=null,b=g);(m=h)&&d===null&&j("[152] PN_LOCAL");x[e]={nextPos:b,result:d};return d}function ob(){var e=function(a){a.sort();for(var b=null,c=[],e=0;e<a.length;e++)a[e]!==b&&(c.push(a[e]),b=a[e]);switch(c.length){case 0:return"end of input";case 1:return c[0];default:return c.slice(0,c.length-1).join(", ")+" or "+c[c.length-1]}}(Xa),h=Math.max(b,ua),h=h<a.length?k(a.charAt(h)):"end of input";return"Expected "+
e+" but "+h+" found."}function tc(){for(var b=1,e=1,h=!1,d=0;d<ua;d++){var f=a.charAt(d);f==="\n"?(h||b++,e=1,h=!1):f==="\r"|f==="\u2028"||f==="\u2029"?(b++,e=1,h=!0):(e++,h=!1)}return{line:b,column:e}}var fa={ANON:rc,AdditiveExpression:T,Aggregate:Xb,ArgList:hb,AskQuery:J,BLANK_NODE_LABEL:qc,BaseDecl:u,BindingValue:sa,BindingsClause:ta,BlankNode:Vb,BlankNodePropertyList:Rb,BooleanLiteral:Fa,BrackettedExpression:Ca,BuiltInCall:Ba,COMMENT:sc,Clear:tb,Collection:Qb,ConditionalAndExpression:Na,ConditionalOrExpression:M,
Constraint:va,ConstructQuery:K,ConstructTemplate:Ab,ConstructTriples:ib,Create:vb,DECIMAL:Qa,DECIMAL_NEGATIVE:ic,DECIMAL_POSITIVE:fc,DOCUMENT:function(){var a="DOCUMENT@"+b,c=x[a];if(c)return b=c.nextPos,c.result;c=i();c===null&&(c=w(),c=c!==null?c:null);x[a]={nextPos:b,result:c};return c},DOUBLE:Pa,DOUBLE_NEGATIVE:hc,DOUBLE_POSITIVE:ec,DatasetClause:I,DefaultGraphClause:O,DeleteClause:yb,DeleteData:xb,DeleteWhere:rb,DescribeQuery:L,Drop:ub,ECHAR:da,EXPONENT:Ra,ExistsFunc:Zb,ExpressionList:Jb,Filter:Ib,
FunctionCall:Za,GraphGraphPattern:Gb,GraphNode:na,GraphPatternNotTriples:gb,GraphRef:Ga,GraphRefAll:$a,GraphTerm:Sb,GroupClause:Y,GroupCondition:X,GroupGraphPattern:V,GroupGraphPatternSub:Bb,GroupOrUnionGraphPattern:Db,HavingClause:aa,INTEGER:ba,INTEGER_NEGATIVE:jc,INTEGER_POSITIVE:gc,IRI_REF:ka,IRIref:Q,IRIrefOrFunction:Wb,InsertClause:Wa,InsertData:wb,LANGTAG:bc,LimitClause:Sa,LimitOffsetClauses:ra,Load:qb,MinusGraphPattern:Fb,Modify:sb,MultiplicativeExpression:oa,NIL:ia,NamedGraphClause:S,NotExistsFunc:$b,
NumericLiteral:Ea,NumericLiteralNegative:pa,NumericLiteralPositive:dc,NumericLiteralUnsigned:cc,ObjectList:ja,OffsetClause:Ta,OptionalGraphPattern:Eb,OrderClause:ea,OrderCondition:ga,PNAME_LN:pc,PNAME_NS:Aa,PN_CHARS:za,PN_CHARS_BASE:nb,PN_CHARS_U:qa,PN_LOCAL:lb,PN_PREFIX:Ya,PathAlternative:jb,PathElt:kb,PathEltOrInverse:Ma,PathMod:Ob,PathNegatedPropertySet:Pb,PathOneInPropertySet:xa,PathPrimary:Nb,PathSequence:La,PrefixDecl:t,PrefixedName:oc,PrimaryExpression:ya,Prologue:r,PropertyList:Kb,PropertyListNotEmpty:wa,
PropertyListNotEmptyPath:Lb,PropertyListPath:Mb,QuadData:ab,QuadPattern:cb,Quads:db,QuadsNotTriples:eb,Query:g,RDFLiteral:Da,RegexExpression:Yb,RelationalExpression:Oa,SPARQL:i,STRING_LITERAL1:mc,STRING_LITERAL2:nc,STRING_LITERAL_LONG1:kc,STRING_LITERAL_LONG2:lc,SelectClause:B,SelectQuery:E,ServiceGraphPattern:Hb,SolutionModifier:U,String:ac,SubSelect:G,TURTLE:w,TriplesBlock:la,TriplesNode:Ia,TriplesSameSubject:fb,TriplesSameSubjectPath:Cb,TriplesTemplate:ma,UnaryExpression:Z,Update:Ua,Update1:pb,
UsingClause:bb,VAR1:Tb,VAR2:Ub,VARNAME:mb,Var:P,VarOrIRIref:ha,VarOrTerm:Ha,Verb:Ja,VerbPath:Ka,WS:o,WhereClause:$,base:C,directive:A,prefixID:F,statement:y};if(e!==void 0){if(fa[e]===void 0)throw Error("Invalid rule name: "+k(e)+".");}else e="DOCUMENT";var b=0,m=!0,ua=0,Xa=[],x={},W=function(a){for(var b="",c=0;c<a.length;c++)b+=typeof a[c]==="string"?a[c]:a[c].join("");return b},ca=0,zb=function(a){for(var b="",c=0;c<a.length;c++)b+=a[c];return b.toUpperCase()},fa=fa[e]();if(fa===null||b!==a.length)throw fa=
tc(),new this.SyntaxError(ob(),fa.line,fa.column);return fa},toSource:function(){return this._source},SyntaxError:function(a,e,h){this.name="SyntaxError";this.message=a;this.line=e;this.column=h}};a.SyntaxError.prototype=Error.prototype;return a}();var aa={};(new Date).getTime();aa.combined_parser=ga.parser;aa.parser={};aa.parser.parse=function(a,c){for(var e=[],h=aa.combined_parser.parse(a),g={},j={namespaces:g,base:"",blankCounter:0},i=0;i<h.length;i++){var l=h[i];if(l.token==="base")j.base=l.value;
else if(l.token==="prefix")g[l.prefix]=l.local;else if(l.token==="triples"||l.token==="triplespattern")for(var r=0;r<l.triplesContext.length;r++){var u=l.triplesContext[r],u={subject:y.lexicalFormTerm(u.subject,j),predicate:y.lexicalFormTerm(u.predicate,j),object:y.lexicalFormTerm(u.object,j),graph:c};e.push(u)}}return e};var w={defaultContext:{rdf:"http://www.w3.org/1999/02/22-rdf-syntax-ns#",rdfs:"http://www.w3.org/2000/01/rdf-schema#",owl:"http://www.w3.org/2002/07/owl#",xsd:"http://www.w3.org/2001/XMLSchema#",
dcterms:"http://purl.org/dc/terms/",foaf:"http://xmlns.com/foaf/0.1/",cal:"http://www.w3.org/2002/12/cal/ical#",vcard:"http://www.w3.org/2006/vcard/ns# ",geo:"http://www.w3.org/2003/01/geo/wgs84_pos#",cc:"http://creativecommons.org/ns#",sioc:"http://rdfs.org/sioc/ns#",doap:"http://usefulinc.com/ns/doap#",com:"http://purl.org/commerce#",ps:"http://purl.org/payswarm#",gr:"http://purl.org/goodrelations/v1#",sig:"http://purl.org/signature#",ccard:"http://purl.org/commerce/creditcard#"},UrisMap:function(){this.defaultNs=
"";this.interfaceProperties=["get","remove","set","setDefault","addAll","resolve","shrink"]}};w.UrisMap.prototype.values=function(){var a={},c;for(c in this)!y.include(this.interfaceProperties,c)&&typeof this[c]!=="function"&&c!=="defaultNs"&&c!=="interfaceProperties"&&(a[c]=this[c]);return a};w.UrisMap.prototype.get=function(a){if(a.indexOf(" ")!=-1)throw"Prefix must not contain any whitespaces";return this[a]};w.UrisMap.prototype.remove=function(a){if(a.indexOf(" ")!=-1)throw"Prefix must not contain any whitespaces";
delete this[a];return null};w.UrisMap.prototype.set=function(a,c){if(a.indexOf(" ")!=-1)throw"Prefix must not contain any whitespaces";this[a]=c};w.UrisMap.prototype.setDefault=function(a){this.defaultNs=a};w.UrisMap.prototype.addAll=function(a,c){for(var e in a)y.include(this.interfaceProperties,e)||(this[e]!=null?c===!0&&(this[e]=a[e]):this[e]=a[e]);return this};w.UrisMap.prototype.resolve=function(a){var c=a.split(":"),a=c[0],c=c[1];return a===""?this.defaultNs==null?null:this.defaultNs+c:this[a]!=
null?this[a]+c:null};w.UrisMap.prototype.shrink=function(a){for(var c in this){var e=this[c];if(a.indexOf(e)===0&&e!==""&&c!="defaultNs")return a=a.split(e)[1],c+":"+a}return a};w.Profile=function(){this.prefixes=new w.UrisMap;this.terms=new w.UrisMap};w.Profile.prototype.importProfile=function(a,c){this.prefixes.addAll(a.prefixes,c);this.terms.addAll(a.terms,c)};w.Profile.prototype.resolve=function(a){return a.indexOf(":")!=-1?this.prefixes.resolve(a):this.terms[a]!=null?this.terms.resolve(a):null};
w.Profile.prototype.setDefaultPrefix=function(a){this.prefixes.setDefault(a)};w.Profile.prototype.setDefaultVocabulary=function(a){this.terms.setDefault(a)};w.Profile.prototype.setPrefix=function(a,c){this.prefixes.set(a,c)};w.Profile.prototype.setTerm=function(a,c){this.terms.set(a,c)};w.RDFEnvironment=function(){this.blankNodeCounter=0;var a=this;this.filters={s:function(a){return function(c){return c.subject.equals(a)}},p:function(a){return function(c){return c.predicate.equals(a)}},o:function(a){return function(c){return c.object.equals(a)}},
sp:function(a,c){return function(g){return g.subject.equals(a)&&g.predicate.equals(c)}},so:function(a,c){return function(g){return g.subject.equals(a)&&g.object.equals(c)}},po:function(a,c){return function(g){return g.predicate.equals(a)&&g.object.equals(c)}},spo:function(a,c,g){return function(j){return j.subject.equals(a)&&j.predicate.equals(c)&&j.object.equals(g)}},describes:function(a){return function(c){return c.subject.equals(a)||c.object.equals(a)}},type:function(c){var h=a.resolve("rdf:type");
return function(a){return a.predicate.equals(h)&&a.object.equals(c)}}};for(var c in w.defaultContext)this.prefixes.set(c,w.defaultContext[c])};y["extends"](w.Profile,w.RDFEnvironment);w.RDFEnvironment.prototype.createBlankNode=function(){var a=new w.BlankNode(this.blankNodeCounter);this.blankNodeCounter++;return a};w.RDFEnvironment.prototype.createNamedNode=function(a){var c=this.resolve(a);return c!=null?new w.NamedNode(c):new w.NamedNode(a)};w.RDFEnvironment.prototype.createLiteral=function(a,c,
e){return e!=null?new w.Literal(a,c,e.toString()):new w.Literal(a,c,e)};w.RDFEnvironment.prototype.createTriple=function(a,c,e){return new w.Triple(a,c,e)};w.RDFEnvironment.prototype.createGraph=function(a){var c=new w.Graph;if(a!=null)for(var e=0;e<a.length;e++)c.add(a[e]);return c};w.RDFEnvironment.prototype.createAction=function(a,c){return function(e){return a(e)?c(e):e}};w.RDFEnvironment.prototype.createProfile=function(a){return a===!0?new w.RDFEnvironment.Profile:(a=new w.RDFEnvironment.Profile,
a.importProfile(this),a)};w.RDFEnvironment.prototype.createTermMap=function(a){if(a===!0)return new w.UrisMap;else{var a=this.terms.values(),c=new w.UrisMap,e;for(e in a)c[e]=a[e];return c}};w.RDFEnvironment.prototype.createPrefixMap=function(a){if(a===!0)return new w.UrisMap;else{var a=this.prefixes.values(),c=new w.UrisMap,e;for(e in a)c[e]=a[e];return c}};w.RDFNode=function(a){this.interfaceName=a;this.attributes=["interfaceName","nominalValue"]};w.RDFNode.prototype.equals=function(a){if(a.interfaceName==
null)return this.valueOf()==a;else{for(var c in this.attributes){var e=this.attributes[c];if(this[e]!=a[e])return!1}return!0}};w.BlankNode=function(a){w.RDFNode.call(this,"BlankNode");this.nominalValue="_:"+a;this.bnodeId=a};y["extends"](w.RDFNode,w.BlankNode);w.BlankNode.prototype.toString=function(){return this.nominalValue};w.BlankNode.prototype.toNT=function(){return this.nominalValue};w.BlankNode.prototype.valueOf=function(){return this.nominalValue};w.Literal=function(a,c,e){w.RDFNode.call(this,
"Literal");this.nominalValue=a;if(c!=null)this.language=c;else if(e!=null)this.datatype=e};y["extends"](w.RDFNode,w.Literal);w.Literal.prototype.toString=function(){var a='"'+this.nominalValue+'"';if(this.language!=null)a=a+"@"+this.language;else if(this.datatype!=null||this.type)a=a+"^^<"+(this.datatype||this.type)+">";return a};w.Literal.prototype.toNT=function(){return this.toString()};w.Literal.prototype.valueOf=function(){return g.effectiveTypeValue({token:"literal",type:this.type,value:this.nominalValue,
language:this.language})};w.NamedNode=function(a){w.RDFNode.call(this,"NamedNode");this.nominalValue=a.value!=null?a.value:a};y["extends"](w.RDFNode,w.NamedNode);w.NamedNode.prototype.toString=function(){return this.nominalValue};w.NamedNode.prototype.toNT=function(){return"<"+this.toString()+">"};w.NamedNode.prototype.valueOf=function(){return this.nominalValue};w.Triple=function(a,c,e){this.subject=a;this.predicate=c;this.object=e};w.Triple.prototype.equals=function(a){return this.subject.equals(a.subject)&&
this.predicate.equals(a.predicate)&&this.object.equals(a.object)};w.Triple.prototype.toString=function(){return this.subject.toNT()+" "+this.predicate.toNT()+" "+this.object.toNT()+" . \r\n"};w.Graph=function(){this.triples=[];this.duplicates={};this.actions=[]};w.Graph.prototype.add=function(a){for(var c=0;c<this.actions.length;c++)a=this.actions[c](a);c=a.subject.toString()+a.predicate.toString()+a.object.toString();this.duplicates[c]||(this.duplicates[c]=!0,this.triples.push(a));return this};w.Graph.prototype.addAction=
function(a,c){this.actions.push(a);if(c==!0)for(var e=0;e<this.triples.length;e++)this.triples[e]=a(this.triples[e]);return this};w.Graph.prototype.addAll=function(a){for(var a=a.toArray(),c=0;c<a.length;c++)this.add(a[c]);return this};w.Graph.prototype.remove=function(a){for(var c=null,e=0;e<this.triples.length;e++)if(this.triples[e].equals(a)){delete this.duplicates[a.subject.toString()+a.predicate.toString()+a.object.toString()];c=e;break}c!=null&&this.triples.splice(c,1);return this};w.Graph.prototype.toArray=
function(){return this.triples};w.Graph.prototype.some=function(a){for(var c=0;c<this.triples.length;c++)if(a(this.triples[c],this)===!0)return!0;return!1};w.Graph.prototype.every=function(a){for(var c=0;c<this.triples.length;c++)if(a(this.triples[c],this)===!1)return!1;return!0};w.Graph.prototype.filter=function(a){for(var c=new w.Graph,e=0;e<this.triples.length;e++)a(this.triples[e],this)===!0&&c.add(this.triples[e]);return c};w.Graph.prototype.forEach=function(a){for(var c=0;c<this.triples.length;c++)a(this.triples[c],
this)};w.Graph.prototype.merge=function(){for(var a=new w.Graph,c=0;c<this.triples;c++){var e=this.triples[c];a.add(e)}for(c=0;c<triples.length;c++)e=triples[c],this.add(e);return a};w.Graph.prototype.match=function(a,c,e,h){for(var g=new w.Graph,j=0,i=0;i<this.triples.length;i++){var l=this.triples[i];if(a==null||l.subject.equals(a))if(c==null||l.predicate.equals(c))if(e==null||l.object.equals(e))if(h==null||j<h)j++,g.add(l);else break}return g};w.Graph.prototype.removeMatches=function(a,c,e){for(var h=
[],g=0;g<this.triples.length;g++){var j=this.triples[g];if(a==null||j.subject.equals(a))if(c==null||j.predicate.equals(c))(e==null||j.object.equals(e))&&h.push(j)}for(g=0;g<h.length;g++)this.remove(h[g]);return this};w.Graph.prototype.toNT=function(){var a="";this.forEach(function(c){a+=c.toString()});return a};w.buildRDFResource=function(a,c,e,h){return a.token==="blank"?w.buildBlankNode(a,c,e,h):a.token==="literal"?w.buildLiteral(a,c,e,h):a.token==="uri"?w.buildNamedNode(a,c,e,h):a.token==="var"?
(a=c[a.value],a!=null?w.buildRDFResource(a,c,e,h):null):null};w.buildBlankNode=function(a){if(a.valuetmp!=null)a.value=a.valuetmp;if(a.value.indexOf("_:")===0)a.value=a.value.split("_:")[1];return new w.BlankNode(a.value)};w.buildLiteral=function(a){return new w.Literal(a.value,a.lang,a.type)};w.buildNamedNode=function(a,c,e,h){if(a.value==null&&a.prefix!=null)c=e.resolveNsInEnvironment(a.prefix,h),a.value=c+a.suffix;return new w.NamedNode(a)};w.rdf=new w.RDFEnvironment;var g={checkFilters:function(a,
c,e,h,k,j){var i=a.filter,l=[];if(i==null||a.length!=null)return c;for(a=0;a<i.length;a++){for(var c=g.run(i[a].value,c,e,h,k,j),r=[],u=0;u<c.length;u++)c[u].__nullify__!=null?l.push(c[u]):r.push(c[u]);c=r}return c.concat(l)}};g.boundVars=function(a){if(a.expressionType!=null){var c=a.expressionType;if(c=="relationalexpression")return c=a.op2,g.boundVars(a.op1)+g.boundVars(c);else if(c=="conditionalor"||c=="conditionaland"){for(var e=[],c=0;c<a.operands;c++)e=e.concat(g.boundVars(a.operands[c]));
return e}else if(c=="builtincall")if(a.args==null)return[];else{e=[];for(c=0;c<a.args.length;c++)e=e.concat(g.boundVars(a.args[c]));return e}else if(c=="multiplicativeexpression"){e=g.boundVars(a.factor);for(c=0;c<a.factors.length;c++)e=e.concat(g.boundVars(a.factors[c].expression));return e}else if(c=="additiveexpression"){e=g.boundVars(a.summand);for(c=0;c<a.summands.length;c++)e=e.concat(g.boundVars(a.summands[c].expression));return e}else if(c=="regex")return e=g.boundVars(a.expression1),e.concat(g.boundVars(a.expression2));
else if(c=="unaryexpression")return g.boundVars(a.expression);else if(c=="atomic")return a.primaryexpression=="var"?[a.value]:[]}else throw console.log("ERROR"),console.log(a),"Cannot find bound expressions in a no expression token";};g.run=function(a,c,e,h,k,j){for(var i=j.copyDenormalizedBindings(c,k.outCache),l=[],r=0;r<c.length;r++){var u=g.runFilter(a,i[r],j,h,k),u=g.ebv(u);g.isEbvError(u)?e&&(u={__nullify__:!0,bindings:c[r]},l.push(u)):u===!0?l.push(c[r]):e&&(u={__nullify__:!0,bindings:c[r]},
l.push(u))}return l};g.collect=function(a,c,e,h,k){for(var j=k.copyDenormalizedBindings(c,h.outCache),i=[],l=0;l<j.length;l++){var r=g.runFilter(a,j[l],k,e,h);i.push({binding:c[l],value:r})}return i};g.runDistinct=function(){};g.runAggregator=function(a,c,e,h,k){if(c==null||c.length===0)return g.ebvError();else if(a.token==="variable"&&a.kind=="var")return c[0][a.value.value];else if(a.token==="variable"&&a.kind==="aliased")if(a.expression.expressionType==="atomic"&&a.expression.primaryexpression===
"var")return c[0][a.expression.value.value];else if(a.expression.expressionType==="aggregate")if(a.expression.aggregateType==="max"){for(var j=null,i=0;i<c.length;i++){var l=c[i],l=g.runFilter(a.expression.expression,l,e,h,k);g.isEbvError(l)||(j===null?j=l:g.runLtFunction(j,l).value===!0&&(j=l))}return j===null?g.ebvError():j}else if(a.expression.aggregateType==="min"){j=null;for(i=0;i<c.length;i++)l=c[i],l=g.runFilter(a.expression.expression,l,e,h,k),g.isEbvError(l)||(j===null?j=l:g.runGtFunction(j,
l).value===!0&&(j=l));return j===null?g.ebvError():j}else if(a.expression.aggregateType==="count"){var j={},r=0;if(a.expression.expression==="*")if(a.expression.distinct!=null&&a.expression.distinct!="")for(i=0;i<c.length;i++){var l=c[i],u=y.hashTerm(l);j[u]==null&&(j[u]=!0,r++)}else r=c.length;else for(i=0;i<c.length;i++)l=c[i],l=g.runFilter(a.expression.expression,l,e,h,k),g.isEbvError(l)||(a.expression.distinct!=null&&a.expression.distinct!=""?(u=y.hashTerm(l),j[u]==null&&(j[u]=!0,r++)):r++);return{token:"literal",
type:"http://www.w3.org/2001/XMLSchema#integer",value:""+r}}else if(a.expression.aggregateType==="avg"){for(var j={},t={token:"literal",type:"http://www.w3.org/2001/XMLSchema#integer",value:"0"},i=r=0;i<c.length;i++)l=c[i],l=g.runFilter(a.expression.expression,l,e,h,k),g.isEbvError(l)||(a.expression.distinct!=null&&a.expression.distinct!=""?(u=y.hashTerm(l),j[u]==null&&(j[u]=!0,g.isNumeric(l)&&(t=g.runSumFunction(t,l),r++))):g.isNumeric(l)&&(t=g.runSumFunction(t,l),r++));a=g.runDivFunction(t,{token:"literal",
type:"http://www.w3.org/2001/XMLSchema#integer",value:""+r});a.value=""+a.value;return a}else if(a.expression.aggregateType==="sum"){j={};t={token:"literal",type:"http://www.w3.org/2001/XMLSchema#integer",value:"0"};for(i=0;i<c.length;i++)l=c[i],l=g.runFilter(a.expression.expression,l,e,h,k),g.isEbvError(l)||(a.expression.distinct!=null&&a.expression.distinct!=""?(u=y.hashTerm(l),j[u]==null&&(j[u]=!0,g.isNumeric(l)&&(t=g.runSumFunction(t,l)))):g.isNumeric(l)&&(t=g.runSumFunction(t,l)));t.value=""+
t.value;return t}else return l=g.runFilter(aggregate.expression,c[0],h,{blanks:{},outCache:{}})};g.runFilter=function(a,c,e,h,k){if(a.expressionType!=null){var j=a.expressionType;if(j=="relationalexpression"){var j=g.runFilter(a.op1,c,e,h,k),i=g.runFilter(a.op2,c,e,h,k);return g.runRelationalFilter(a,j,i,c,e,h,k)}else if(j=="conditionalor")return g.runOrFunction(a,c,e,h,k);else if(j=="conditionaland")return g.runAndFunction(a,c,e,h,k);else if(j=="additiveexpression")return g.runAddition(a.summand,
a.summands,c,e,h,k);else if(j=="builtincall")return g.runBuiltInCall(a.builtincall,a.args,c,e,h,k);else if(j=="multiplicativeexpression")return g.runMultiplication(a.factor,a.factors,c,e,h,k);else if(j=="unaryexpression")return g.runUnaryExpression(a.unaryexpression,a.expression,c,e,h,k);else if(j=="irireforfunction")return g.runIriRefOrFunction(a.iriref,a.args,c,e,h,k);else if(j=="regex")return g.runRegex(a.text,a.pattern,a.flags,c,e,h,k);else if(j=="atomic")if(a.primaryexpression=="var")return c[a.value.value];
else{if(typeof a.value=="object"&&!(a.value.type==null||typeof a.value.type!="object"))a.value.type=y.lexicalFormBaseUri(a.value.type,k);return a.value}else throw"Unknown filter expression type";}else throw"Cannot find bound expressions in a no expression token";};g.isRDFTerm=function(a){return a==null?!1:a.token&&a.token=="literal"||a.token&&a.token=="uri"||a.token&&a.token=="blank"?!0:!1};g.RDFTermEquality=function(a,c,e,h){return a.token==="literal"&&c.token==="literal"?a.lang==c.lang&&a.type==
c.type&&a.value==c.value?!0:a.type!=null&&c.type!=null?g.ebvError():g.isSimpleLiteral(a)&&c.type!=null?g.ebvError():g.isSimpleLiteral(c)&&a.type!=null?g.ebvError():!1:a.token==="uri"&&c.token==="uri"?y.lexicalFormBaseUri(a,h)==y.lexicalFormBaseUri(c,h):a.token==="blank"&&c.token==="blank"?a.value==c.value:!1};g.isInteger=function(a){return a==null?!1:a.token==="literal"?a.type=="http://www.w3.org/2001/XMLSchema#integer"||a.type=="http://www.w3.org/2001/XMLSchema#decimal"||a.type=="http://www.w3.org/2001/XMLSchema#double"||
a.type=="http://www.w3.org/2001/XMLSchema#nonPositiveInteger"||a.type=="http://www.w3.org/2001/XMLSchema#negativeInteger"||a.type=="http://www.w3.org/2001/XMLSchema#long"||a.type=="http://www.w3.org/2001/XMLSchema#int"||a.type=="http://www.w3.org/2001/XMLSchema#short"||a.type=="http://www.w3.org/2001/XMLSchema#byte"||a.type=="http://www.w3.org/2001/XMLSchema#nonNegativeInteger"||a.type=="http://www.w3.org/2001/XMLSchema#unsignedLong"||a.type=="http://www.w3.org/2001/XMLSchema#unsignedInt"||a.type==
"http://www.w3.org/2001/XMLSchema#unsignedShort"||a.type=="http://www.w3.org/2001/XMLSchema#unsignedByte"||a.type=="http://www.w3.org/2001/XMLSchema#positiveInteger"?!0:!1:!1};g.isFloat=function(a){return a==null?!1:a.token==="literal"?a.type=="http://www.w3.org/2001/XMLSchema#float"?!0:!1:!1};g.isDecimal=function(a){return a==null?!1:a.token==="literal"?a.type=="http://www.w3.org/2001/XMLSchema#decimal"?!0:!1:!1};g.isDouble=function(a){return a==null?!1:a.token==="literal"?a.type=="http://www.w3.org/2001/XMLSchema#double"?
!0:!1:!1};g.isNumeric=function(a){return a==null?!1:a.token==="literal"?a.type=="http://www.w3.org/2001/XMLSchema#integer"||a.type=="http://www.w3.org/2001/XMLSchema#decimal"||a.type=="http://www.w3.org/2001/XMLSchema#float"||a.type=="http://www.w3.org/2001/XMLSchema#double"||a.type=="http://www.w3.org/2001/XMLSchema#nonPositiveInteger"||a.type=="http://www.w3.org/2001/XMLSchema#negativeInteger"||a.type=="http://www.w3.org/2001/XMLSchema#long"||a.type=="http://www.w3.org/2001/XMLSchema#int"||a.type==
"http://www.w3.org/2001/XMLSchema#short"||a.type=="http://www.w3.org/2001/XMLSchema#byte"||a.type=="http://www.w3.org/2001/XMLSchema#nonNegativeInteger"||a.type=="http://www.w3.org/2001/XMLSchema#unsignedLong"||a.type=="http://www.w3.org/2001/XMLSchema#unsignedInt"||a.type=="http://www.w3.org/2001/XMLSchema#unsignedShort"||a.type=="http://www.w3.org/2001/XMLSchema#unsignedByte"||a.type=="http://www.w3.org/2001/XMLSchema#positiveInteger"?!0:!1:!1};g.isSimpleLiteral=function(a){return a&&a.token=="literal"?
a.type==null&&a.lang==null?!0:!1:!1};g.isXsdType=function(a,c){return c&&c.token=="literal"?c.type=="http://www.w3.org/2001/XMLSchema#"+a:!1};g.ebv=function(a){if(a==null||g.isEbvError(a))return g.ebvError();else if(a.token&&a.token==="literal")if(a.type=="http://www.w3.org/2001/XMLSchema#integer"||a.type=="http://www.w3.org/2001/XMLSchema#decimal"||a.type=="http://www.w3.org/2001/XMLSchema#double"||a.type=="http://www.w3.org/2001/XMLSchema#nonPositiveInteger"||a.type=="http://www.w3.org/2001/XMLSchema#negativeInteger"||
a.type=="http://www.w3.org/2001/XMLSchema#long"||a.type=="http://www.w3.org/2001/XMLSchema#int"||a.type=="http://www.w3.org/2001/XMLSchema#short"||a.type=="http://www.w3.org/2001/XMLSchema#byte"||a.type=="http://www.w3.org/2001/XMLSchema#nonNegativeInteger"||a.type=="http://www.w3.org/2001/XMLSchema#unsignedLong"||a.type=="http://www.w3.org/2001/XMLSchema#unsignedInt"||a.type=="http://www.w3.org/2001/XMLSchema#unsignedShort"||a.type=="http://www.w3.org/2001/XMLSchema#unsignedByte"||a.type=="http://www.w3.org/2001/XMLSchema#positiveInteger"){var c=
parseFloat(a.value);return isNaN(c)?!1:parseFloat(a.value)!=0}else return a.type==="http://www.w3.org/2001/XMLSchema#boolean"?a.value==="true"||a.value===!0||a.value==="True":a.type==="http://www.w3.org/2001/XMLSchema#string"?a.value!="":a.type==="http://www.w3.org/2001/XMLSchema#dateTime"?new Date(a.value)!=null:g.isEbvError(a)?a:a.type==null?a.value!=""?!0:!1:g.ebvError();else return a.value===!0};g.ebvTrue=function(){return{token:"literal",type:"http://www.w3.org/2001/XMLSchema#boolean",value:!0}};
g.ebvFalse=function(){return{token:"literal",type:"http://www.w3.org/2001/XMLSchema#boolean",value:!1}};g.ebvError=function(){return{token:"literal",type:"https://github.com/antoniogarrote/js-tools/types#error",value:null}};g.isEbvError=function(a){return typeof a=="object"&&a!=null?a.type==="https://github.com/antoniogarrote/js-tools/types#error":!1};g.ebvBoolean=function(a){return g.isEbvError(a)?a:a===!0?g.ebvTrue():g.ebvFalse()};g.runRelationalFilter=function(a,c,e,h,k,j,i){a=a.operator;if(a===
"=")return g.runEqualityFunction(c,e,h,k,j,i);else if(a==="!="){c=g.runEqualityFunction(c,e,h,k,j,i);if(!g.isEbvError(c))c.value=!c.value;return c}else if(a==="<")return g.runLtFunction(c,e,h);else if(a===">")return g.runGtFunction(c,e,h);else if(a==="<=")return g.runLtEqFunction(c,e,h);else if(a===">=")return g.runGtEqFunction(c,e,h);else throw"Error applying relational filter, unknown operator";};g.effectiveTypeValue=function(a){if(a.token=="literal")if(a.type=="http://www.w3.org/2001/XMLSchema#integer")return a=
parseInt(a.value);else if(a.type=="http://www.w3.org/2001/XMLSchema#decimal")return a=parseFloat(a.value);else if(a.type=="http://www.w3.org/2001/XMLSchema#float")return a=parseFloat(a.value);else if(a.type=="http://www.w3.org/2001/XMLSchema#double")return a=parseFloat(a.value);else if(a.type=="http://www.w3.org/2001/XMLSchema#nonPositiveInteger")return a=parseFloat(a.value);else if(a.type=="http://www.w3.org/2001/XMLSchema#negativeInteger")return a=parseInt(a.value);else if(a.type=="http://www.w3.org/2001/XMLSchema#long")return a=
parseInt(a.value);else if(a.type=="http://www.w3.org/2001/XMLSchema#int")return a=parseInt(a.value);else if(a.type=="http://www.w3.org/2001/XMLSchema#short")return a=parseInt(a.value);else if(a.type=="http://www.w3.org/2001/XMLSchema#byte")return a=parseInt(a.value);else if(a.type=="http://www.w3.org/2001/XMLSchema#nonNegativeInteger")return a=parseInt(a.value);else if(a.type=="http://www.w3.org/2001/XMLSchema#unsignedLong")return a=parseInt(a.value);else if(a.type=="http://www.w3.org/2001/XMLSchema#unsignedInt")return a=
parseInt(a.value);else if(a.type=="http://www.w3.org/2001/XMLSchema#unsignedShort")return a=parseInt(a.value);else if(a.type=="http://www.w3.org/2001/XMLSchema#unsignedByte")return a=parseInt(a.value);else if(a.type=="http://www.w3.org/2001/XMLSchema#positiveInteger")return a=parseInt(a.value);else if(a.type=="http://www.w3.org/2001/XMLSchema#date"||a.type=="http://www.w3.org/2001/XMLSchema#dateTime")try{return y.parseISO8601(a.value)}catch(c){return null}else return a.type=="http://www.w3.org/2001/XMLSchema#boolean"?
a.value===!0||a.value==="true"||a.value==="1"||a.value===1||a.value===!0?!0:a.value===!1||a.value==="false"||a.value==="0"||a.value===0||a.value===!1?!1:void 0:a.type=="http://www.w3.org/2001/XMLSchema#string"?a.value===null||a.value===void 0?void 0:""+a.value:a.value;else throw console.log("not implemented yet"),"value not supported in operations yet";};g.runOrFunction=function(a,c,e,h,k){for(var j=null,i=0;i<a.operands.length;i++){var l=g.runFilter(a.operands[i],c,e,h,k);g.isEbvError(l)==!1&&(l=
g.ebv(l));j==null?j=l:g.isEbvError(l)?j=g.isEbvError(j)?g.ebvError():j===!0?!0:g.ebvError():l===!0?j=!0:g.isEbvError(j)&&(j=g.ebvError())}return g.ebvBoolean(j)};g.runAndFunction=function(a,c,e,h,k){for(var j=null,i=0;i<a.operands.length;i++){var l=g.runFilter(a.operands[i],c,e,h,k);g.isEbvError(l)==!1&&(l=g.ebv(l));j==null?j=l:g.isEbvError(l)?j=g.isEbvError(j)?g.ebvError():j===!0?g.ebvError():!1:l===!0?g.isEbvError(j)&&(j=g.ebvError()):j=!1}return g.ebvBoolean(j)};g.runEqualityFunction=function(a,
c,e,h,k,j){if(g.isEbvError(a)||g.isEbvError(c))return g.ebvError();if(g.isNumeric(a)&&g.isNumeric(c))return e=g.effectiveTypeValue(a),k=g.effectiveTypeValue(c),isNaN(e)||isNaN(k)?g.ebvBoolean(g.RDFTermEquality(a,c,h,j)):g.ebvBoolean(e==k);else if((g.isSimpleLiteral(a)||g.isXsdType("string",a))&&(g.isSimpleLiteral(c)||g.isXsdType("string",c)))return g.ebvBoolean(g.effectiveTypeValue(a)==g.effectiveTypeValue(c));else if(g.isXsdType("boolean",a)&&g.isXsdType("boolean",c))return g.ebvBoolean(g.effectiveTypeValue(a)==
g.effectiveTypeValue(c));else if((g.isXsdType("dateTime",a)||g.isXsdType("date",a))&&(g.isXsdType("dateTime",c)||g.isXsdType("date",c))){if(g.isXsdType("dateTime",a)&&g.isXsdType("date",c))return g.ebvFalse();if(g.isXsdType("date",a)&&g.isXsdType("dateTime",c))return g.ebvFalse();a=y.compareDateComponents(a.value,c.value);return a!=null?a==0?g.ebvTrue():g.ebvFalse():g.ebvError()}else return g.isRDFTerm(a)&&g.isRDFTerm(c)?g.ebvBoolean(g.RDFTermEquality(a,c,h,j)):g.ebvFalse()};g.runGtFunction=function(a,
c){if(g.isEbvError(a)||g.isEbvError(c))return g.ebvError();if(g.isNumeric(a)&&g.isNumeric(c))return g.ebvBoolean(g.effectiveTypeValue(a)>g.effectiveTypeValue(c));else if(g.isSimpleLiteral(a)&&g.isSimpleLiteral(c))return g.ebvBoolean(g.effectiveTypeValue(a)>g.effectiveTypeValue(c));else if(g.isXsdType("string",a)&&g.isXsdType("string",c))return g.ebvBoolean(g.effectiveTypeValue(a)>g.effectiveTypeValue(c));else if(g.isXsdType("boolean",a)&&g.isXsdType("boolean",c))return g.ebvBoolean(g.effectiveTypeValue(a)>
g.effectiveTypeValue(c));else if((g.isXsdType("dateTime",a)||g.isXsdType("date",a))&&(g.isXsdType("dateTime",c)||g.isXsdType("date",c))){if(g.isXsdType("dateTime",a)&&g.isXsdType("date",c))return g.ebvFalse();if(g.isXsdType("date",a)&&g.isXsdType("dateTime",c))return g.ebvFalse();var e=y.compareDateComponents(a.value,c.value);return e!=null?e==1?g.ebvTrue():g.ebvFalse():g.ebvError()}else return g.ebvFalse()};g.runTotalGtFunction=function(a,c){return g.isEbvError(a)||g.isEbvError(c)?g.ebvError():g.isNumeric(a)&&
g.isNumeric(c)||g.isSimpleLiteral(a)&&g.isSimpleLiteral(c)||g.isXsdType("string",a)&&g.isSimpleLiteral("string",c)||g.isXsdType("boolean",a)&&g.isSimpleLiteral("boolean",c)||g.isXsdType("dateTime",a)&&g.isSimpleLiteral("dateTime",c)?g.runGtFunction(a,c,[]):a.token&&a.token==="uri"&&c.token&&c.token==="uri"?g.ebvBoolean(a.value>c.value):a.token&&a.token==="literal"&&c.token&&c.token==="literal"?g.ebvBoolean(""+a.value+a.type+a.lang>""+c.value+c.type+c.lang):a.token&&a.token==="blank"&&c.token&&c.token===
"blank"?g.ebvBoolean(a.value>c.value):a.value&&c.value?g.ebvBoolean(a.value>c.value):g.ebvTrue()};g.runLtFunction=function(a,c){if(g.isEbvError(a)||g.isEbvError(c))return g.ebvError();if(g.isNumeric(a)&&g.isNumeric(c))return g.ebvBoolean(g.effectiveTypeValue(a)<g.effectiveTypeValue(c));else if(g.isSimpleLiteral(a)&&g.isSimpleLiteral(c))return g.ebvBoolean(g.effectiveTypeValue(a)<g.effectiveTypeValue(c));else if(g.isXsdType("string",a)&&g.isXsdType("string",c))return g.ebvBoolean(g.effectiveTypeValue(a)<
g.effectiveTypeValue(c));else if(g.isXsdType("boolean",a)&&g.isXsdType("boolean",c))return g.ebvBoolean(g.effectiveTypeValue(a)<g.effectiveTypeValue(c));else if((g.isXsdType("dateTime",a)||g.isXsdType("date",a))&&(g.isXsdType("dateTime",c)||g.isXsdType("date",c))){if(g.isXsdType("dateTime",a)&&g.isXsdType("date",c))return g.ebvFalse();if(g.isXsdType("date",a)&&g.isXsdType("dateTime",c))return g.ebvFalse();var e=y.compareDateComponents(a.value,c.value);return e!=null?e==-1?g.ebvTrue():g.ebvFalse():
g.ebvError()}else return g.ebvFalse()};g.runGtEqFunction=function(a,c){if(g.isEbvError(a)||g.isEbvError(c))return g.ebvError();if(g.isNumeric(a)&&g.isNumeric(c))return g.ebvBoolean(g.effectiveTypeValue(a)>=g.effectiveTypeValue(c));else if(g.isSimpleLiteral(a)&&g.isSimpleLiteral(c))return g.ebvBoolean(g.effectiveTypeValue(a)>=g.effectiveTypeValue(c));else if(g.isXsdType("string",a)&&g.isXsdType("string",c))return g.ebvBoolean(g.effectiveTypeValue(a)>=g.effectiveTypeValue(c));else if(g.isXsdType("boolean",
a)&&g.isXsdType("boolean",c))return g.ebvBoolean(g.effectiveTypeValue(a)>=g.effectiveTypeValue(c));else if((g.isXsdType("dateTime",a)||g.isXsdType("date",a))&&(g.isXsdType("dateTime",c)||g.isXsdType("date",c))){if(g.isXsdType("dateTime",a)&&g.isXsdType("date",c))return g.ebvFalse();if(g.isXsdType("date",a)&&g.isXsdType("dateTime",c))return g.ebvFalse();var e=y.compareDateComponents(a.value,c.value);return e!=null?e!=-1?g.ebvTrue():g.ebvFalse():g.ebvError()}else return g.ebvFalse()};g.runLtEqFunction=
function(a,c){if(g.isEbvError(a)||g.isEbvError(c))return g.ebvError();if(g.isNumeric(a)&&g.isNumeric(c))return g.ebvBoolean(g.effectiveTypeValue(a)<=g.effectiveTypeValue(c));else if(g.isSimpleLiteral(a)&&g.isSimpleLiteral(c))return g.ebvBoolean(g.effectiveTypeValue(a)<=g.effectiveTypeValue(c));else if(g.isXsdType("string",a)&&g.isXsdType("string",c))return g.ebvBoolean(g.effectiveTypeValue(a)<=g.effectiveTypeValue(c));else if(g.isXsdType("boolean",a)&&g.isXsdType("boolean",c))return g.ebvBoolean(g.effectiveTypeValue(a)<=
g.effectiveTypeValue(c));else if((g.isXsdType("dateTime",a)||g.isXsdType("date",a))&&(g.isXsdType("dateTime",c)||g.isXsdType("date",c))){if(g.isXsdType("dateTime",a)&&g.isXsdType("date",c))return g.ebvFalse();if(g.isXsdType("date",a)&&g.isXsdType("dateTime",c))return g.ebvFalse();var e=y.compareDateComponents(a.value,c.value);return e!=null?e!=1?g.ebvTrue():g.ebvFalse():g.ebvError()}else return g.ebvFalse()};g.runAddition=function(a,c,e,h,k,j){var i=g.runFilter(a,e,h,k,j);if(g.isEbvError(i))return g.ebvError();
a=i;if(g.isNumeric(i)){for(i=0;i<c.length;i++){var l=g.runFilter(c[i].expression,e,h,k,j);if(g.isNumeric(l))c[i].operator==="+"?a=g.runSumFunction(a,l):c[i].operator==="-"&&(a=g.runSubFunction(a,l));else return g.ebvFalse()}return a}else return g.ebvFalse()};g.runSumFunction=function(a,c){if(g.isEbvError(a)||g.isEbvError(c))return g.ebvError();var e=g.effectiveTypeValue(a)+g.effectiveTypeValue(c);return g.isDouble(a)||g.isDouble(c)?{token:"literal",type:"http://www.w3.org/2001/XMLSchema#double",value:e}:
g.isFloat(a)||g.isFloat(c)?{token:"literal",type:"http://www.w3.org/2001/XMLSchema#float",value:e}:g.isDecimal(a)||g.isDecimal(c)?{token:"literal",type:"http://www.w3.org/2001/XMLSchema#decimal",value:e}:{token:"literal",type:"http://www.w3.org/2001/XMLSchema#integer",value:e}};g.runSubFunction=function(a,c){if(g.isEbvError(a)||g.isEbvError(c))return g.ebvError();var e=g.effectiveTypeValue(a)-g.effectiveTypeValue(c);return g.isDouble(a)||g.isDouble(c)?{token:"literal",type:"http://www.w3.org/2001/XMLSchema#double",
value:e}:g.isFloat(a)||g.isFloat(c)?{token:"literal",type:"http://www.w3.org/2001/XMLSchema#float",value:e}:g.isDecimal(a)||g.isDecimal(c)?{token:"literal",type:"http://www.w3.org/2001/XMLSchema#decimal",value:e}:{token:"literal",type:"http://www.w3.org/2001/XMLSchema#integer",value:e}};g.runMultiplication=function(a,c,e,h,k,j){a=g.runFilter(a,e,h,k,j);if(g.isEbvError(a))return a;var i=a;if(g.isNumeric(a)){for(var l=0;l<c.length;l++){var r=g.runFilter(c[l].expression,e,h,k,j);if(g.isEbvError(r))return a;
if(g.isNumeric(r))c[l].operator==="*"?i=g.runMulFunction(i,r):c[l].operator==="/"&&(i=g.runDivFunction(i,r));else return g.ebvFalse()}return i}else return g.ebvFalse()};g.runMulFunction=function(a,c){if(g.isEbvError(a)||g.isEbvError(c))return g.ebvError();var e=g.effectiveTypeValue(a)*g.effectiveTypeValue(c);return g.isDouble(a)||g.isDouble(c)?{token:"literal",type:"http://www.w3.org/2001/XMLSchema#double",value:e}:g.isFloat(a)||g.isFloat(c)?{token:"literal",type:"http://www.w3.org/2001/XMLSchema#float",
value:e}:g.isDecimal(a)||g.isDecimal(c)?{token:"literal",type:"http://www.w3.org/2001/XMLSchema#decimal",value:e}:{token:"literal",type:"http://www.w3.org/2001/XMLSchema#integer",value:e}};g.runDivFunction=function(a,c){if(g.isEbvError(a)||g.isEbvError(c))return g.ebvError();var e=g.effectiveTypeValue(a)/g.effectiveTypeValue(c);return g.isDouble(a)||g.isDouble(c)?{token:"literal",type:"http://www.w3.org/2001/XMLSchema#double",value:e}:g.isFloat(a)||g.isFloat(c)?{token:"literal",type:"http://www.w3.org/2001/XMLSchema#float",
value:e}:g.isDecimal(a)||g.isDecimal(c)?{token:"literal",type:"http://www.w3.org/2001/XMLSchema#decimal",value:e}:{token:"literal",type:"http://www.w3.org/2001/XMLSchema#integer",value:e}};g.runBuiltInCall=function(a,c,e,h,k,j){if(a==="notexists"||a==="exists"){var i=JSON.parse(JSON.stringify(c[0])),i=h.abstractQueryTree.parseSelect({pattern:i},e),i=h.abstractQueryTree.bind(i.pattern,e),e=h.executeSelectUnit([{kind:"*"}],k,i,j);return a==="exists"?g.ebvBoolean(e.length!==0):g.ebvBoolean(e.length===
0)}else{for(var i=[],l=0;l<c.length;l++)if(c[l].token==="var")i.push(c[l]);else{var r=g.runFilter(c[l],e,h,k,j);if(g.isEbvError(r))return r;i.push(r)}if(a==="str")return i[0].token==="literal"?{token:"literal",type:null,value:""+i[0].value}:i[0].token==="uri"?{token:"literal",type:null,value:i[0].value}:g.ebvFalse();else if(a==="lang")return i[0].token==="literal"?i[0].lang!=null?{token:"literal",value:""+i[0].lang}:{token:"literal",value:""}:g.ebvError();else if(a==="datatype")return i[0].token===
"literal"?(a=i[0],a.type!=null?typeof a.type==="string"?{token:"uri",value:a.type,prefix:null,suffix:null}:a.type:a.lang==null?{token:"uri",value:"http://www.w3.org/2001/XMLSchema#string",prefix:null,suffix:null}:g.ebvError()):g.ebvError();else if(a==="isliteral")return i[0].token==="literal"?g.ebvTrue():g.ebvFalse();else if(a==="isblank")return i[0].token==="blank"?g.ebvTrue():g.ebvFalse();else if(a==="isuri"||a==="isiri")return i[0].token==="uri"?g.ebvTrue():g.ebvFalse();else if(a==="sameterm")return a=
g.RDFTermEquality(i[0],i[1],h,j),g.isEbvError(a)&&(a=!1),g.ebvBoolean(a);else if(a==="langmatches")return a=i[0],e=i[1],a.token==="literal"&&e.token==="literal"?e.value==="*"&&a.value!=""?g.ebvTrue():g.ebvBoolean(a.value.toLowerCase().indexOf(e.value.toLowerCase())===0):g.ebvError();else if(a==="bound")return a=i[0].value,a==null?g.ebvError():e[a]!=null?g.ebvTrue():g.ebvFalse();else throw"Builtin call "+a+" not implemented yet";}};g.runUnaryExpression=function(a,c,e,h,k,j){c=g.runFilter(c,e,h,k,j);
if(g.isEbvError(c))return c;if(a==="!"){var i=g.ebv(c);return g.isEbvError(i)?g.ebvFalse():g.ebvBoolean(!i)}else if(a==="+")return g.isNumeric(c)?c:g.ebvError();else if(a==="-")if(g.isNumeric(c)){a={};for(i in c)a[i]=c[i];a.value=-a.value;return a}else return g.ebvError()};g.runRegex=function(a,c,e,h,k,j,i){if(a!=null)a=g.runFilter(a,h,k,j,i);else return g.ebvError();if(c!=null)c=g.runFilter(c,h,k,j,i);else return g.ebvError();e!=null&&(e=g.runFilter(e,h,k,j,i));if(c!=null&&c.token==="literal"&&(e==
null||e.token==="literal"))c=c.value,e=e==null?null:e.value;else return g.ebvError();if(a!=null&&a.token=="var")if(h[a.value]!=null)a=h[a.value];else return g.ebvError();else if(a!=null&&a.token==="literal")if(a.type==null||g.isXsdType("string",a))a=a.value;else return g.ebvError();else return g.ebvError();return(e==null?RegExp(c):RegExp(c,e.toLowerCase())).exec(a)?g.ebvTrue():g.ebvFalse()};g.normalizeLiteralDatatype=function(a,c,e){if(!(a.value.type==null||typeof a.value.type!="object"))a.value.type=
y.lexicalFormBaseUri(a.value.type,e);return a};g.runIriRefOrFunction=function(a,c,e,h,k,j){if(c==null)return a;else{for(var i=[],l=0;l<c.length;l++)i.push(g.runFilter(c[l],e,h,k,j));a=y.lexicalFormBaseUri(a,j);if(a=="http://www.w3.org/2001/XMLSchema#integer"||a=="http://www.w3.org/2001/XMLSchema#decimal"||a=="http://www.w3.org/2001/XMLSchema#double"||a=="http://www.w3.org/2001/XMLSchema#nonPositiveInteger"||a=="http://www.w3.org/2001/XMLSchema#negativeInteger"||a=="http://www.w3.org/2001/XMLSchema#long"||
a=="http://www.w3.org/2001/XMLSchema#int"||a=="http://www.w3.org/2001/XMLSchema#short"||a=="http://www.w3.org/2001/XMLSchema#byte"||a=="http://www.w3.org/2001/XMLSchema#nonNegativeInteger"||a=="http://www.w3.org/2001/XMLSchema#unsignedLong"||a=="http://www.w3.org/2001/XMLSchema#unsignedInt"||a=="http://www.w3.org/2001/XMLSchema#unsignedShort"||a=="http://www.w3.org/2001/XMLSchema#unsignedByte"||a=="http://www.w3.org/2001/XMLSchema#positiveInteger")if(i=i[0],i.token==="literal")if(i=g.normalizeLiteralDatatype(i,
h,j),i.type=="http://www.w3.org/2001/XMLSchema#integer"||i.type=="http://www.w3.org/2001/XMLSchema#decimal"||i.type=="http://www.w3.org/2001/XMLSchema#double"||i.type=="http://www.w3.org/2001/XMLSchema#nonPositiveInteger"||i.type=="http://www.w3.org/2001/XMLSchema#negativeInteger"||i.type=="http://www.w3.org/2001/XMLSchema#long"||i.type=="http://www.w3.org/2001/XMLSchema#int"||i.type=="http://www.w3.org/2001/XMLSchema#short"||i.type=="http://www.w3.org/2001/XMLSchema#byte"||i.type=="http://www.w3.org/2001/XMLSchema#nonNegativeInteger"||
i.type=="http://www.w3.org/2001/XMLSchema#unsignedLong"||i.type=="http://www.w3.org/2001/XMLSchema#unsignedInt"||i.type=="http://www.w3.org/2001/XMLSchema#unsignedShort"||i.type=="http://www.w3.org/2001/XMLSchema#unsignedByte"||i.type=="http://www.w3.org/2001/XMLSchema#positiveInteger")return i.type=a,i;else if(i.type=="http://www.w3.org/2001/XMLSchema#boolean")return g.ebv(i)==!0?(i.type=a,i.value=1):(i.type=a,i.value=0),i;else if(i.type=="http://www.w3.org/2001/XMLSchema#float"||i.type=="http://www.w3.org/2001/XMLSchema#double")return i.type=
a,i.value=parseInt(i.value),i;else if(i.type=="http://www.w3.org/2001/XMLSchema#string"||i.type==null){if(i.value.split(".").length>2)return g.ebvError();else if(i.value.split("-").length>2)return g.ebvError();else if(i.value.split("/").length>2)return g.ebvError();else if(i.value.split("+").length>2)return g.ebvError();if(a=="http://www.w3.org/2001/XMLSchema#decimal"&&(i.value.indexOf("e")!=-1||i.value.indexOf("E")!=-1))return g.ebvError();if(a=="http://www.w3.org/2001/XMLSchema#int"||a=="http://www.w3.org/2001/XMLSchema#integer")if(i.value.indexOf("e")!=
-1||i.value.indexOf("E")!=-1||i.value.indexOf(".")!=-1)return g.ebvError();try{return i.value=parseInt(parseFloat(i.value)),isNaN(i.value)?g.ebvError():(i.type=a,i)}catch(r){return g.ebvError()}}else return g.ebvError();else return g.ebvError();else if(a=="http://www.w3.org/2001/XMLSchema#boolean")return i=i[0],i.token==="literal"&&i.type==null?i.value==="true"||i.value==="1"?g.ebvTrue():i.value==="false"||i.value==="0"?g.ebvFalse():g.ebvError():i.token==="literal"?g.isEbvError(i)?i:g.ebvBoolean(i):
g.ebvError();else if(a=="http://www.w3.org/2001/XMLSchema#string")if(i=i[0],i.token==="literal")if(i=g.normalizeLiteralDatatype(i,h,j),i.type=="http://www.w3.org/2001/XMLSchema#integer"||i.type=="http://www.w3.org/2001/XMLSchema#decimal"||i.type=="http://www.w3.org/2001/XMLSchema#double"||i.type=="http://www.w3.org/2001/XMLSchema#nonPositiveInteger"||i.type=="http://www.w3.org/2001/XMLSchema#negativeInteger"||i.type=="http://www.w3.org/2001/XMLSchema#long"||i.type=="http://www.w3.org/2001/XMLSchema#int"||
i.type=="http://www.w3.org/2001/XMLSchema#short"||i.type=="http://www.w3.org/2001/XMLSchema#byte"||i.type=="http://www.w3.org/2001/XMLSchema#nonNegativeInteger"||i.type=="http://www.w3.org/2001/XMLSchema#unsignedLong"||i.type=="http://www.w3.org/2001/XMLSchema#unsignedInt"||i.type=="http://www.w3.org/2001/XMLSchema#unsignedShort"||i.type=="http://www.w3.org/2001/XMLSchema#unsignedByte"||i.type=="http://www.w3.org/2001/XMLSchema#positiveInteger"||i.type=="http://www.w3.org/2001/XMLSchema#float")return i.type=
a,i.value=""+i.value,i;else if(i.type=="http://www.w3.org/2001/XMLSchema#string")return i;else if(i.type=="http://www.w3.org/2001/XMLSchema#boolean")return g.ebv(i)?(i.type=a,i.value="true"):(i.type=a,i.value="false"),i;else if(i.type=="http://www.w3.org/2001/XMLSchema#dateTime"||i.type=="http://www.w3.org/2001/XMLSchema#date"){i.type=a;if(typeof i.value!="string")i.value=y.iso8601(i.value);return i}else return i.type==null?(i.value=""+i.value,i.type=a,i):g.ebvError();else return i.token==="uri"?
{token:"literal",value:y.lexicalFormBaseUri(i,j),type:a,lang:null}:g.ebvError();else if(a=="http://www.w3.org/2001/XMLSchema#dateTime"||a=="http://www.w3.org/2001/XMLSchema#date")if(i=i[0],i.type=="http://www.w3.org/2001/XMLSchema#dateTime"||i.type=="http://www.w3.org/2001/XMLSchema#date")return i;else if(i.type=="http://www.w3.org/2001/XMLSchema#string"||i.type==null)try{return i.value=y.iso8601(y.parseStrictISO8601(i.value)),i.type=a,i}catch(u){return g.ebvError()}else return g.ebvError();else if(a==
"http://www.w3.org/2001/XMLSchema#float")if(i=i[0],i.token==="literal")if(i=g.normalizeLiteralDatatype(i,h,j),i.type=="http://www.w3.org/2001/XMLSchema#decimal"||i.type=="http://www.w3.org/2001/XMLSchema#int")return i.type=a,i.value=parseFloat(i.value),i;else if(i.type=="http://www.w3.org/2001/XMLSchema#boolean")return g.ebv(i)==!0?(i.type=a,i.value=1):(i.type=a,i.value=0),i;else if(i.type=="http://www.w3.org/2001/XMLSchema#float"||i.type=="http://www.w3.org/2001/XMLSchema#double")return i.type=a,
i.value=parseFloat(i.value),i;else if(i.type=="http://www.w3.org/2001/XMLSchema#string")try{return i.value=parseFloat(i.value),isNaN(i.value)?g.ebvError():(i.type=a,i)}catch(t){return g.ebvError()}else if(i.type==null){if(i.value.split(".").length>2)return g.ebvError();else if(i.value.split("-").length>2)return g.ebvError();else if(i.value.split("/").length>2)return g.ebvError();else if(i.value.split("+").length>2)return g.ebvError();try{return i.value=parseFloat(i.value),isNaN(i.value)?g.ebvError():
(i.type=a,i)}catch(w){return g.ebvError()}}else return g.ebvError();else return g.ebvError();else return g.ebvError()}};var C={variablesInBGP:function(a){var c=a.variables;if(c)return c;var e=a.value||a,c=[],h;for(h in e)e[h]&&e[h].token==="var"?c.push(e[h].value):e[h]&&e[h].token==="blank"&&c.push("blank:"+e[h].value);return a.variables=c},connected:function(a,c){for(var e="/"+a.vars.join("/")+"/",h=0;h<c.vars.length;h++)if(e.indexOf("/"+c.vars[h]+"/")!=-1)return!0;return!1},variablesIntersectionBGP:function(a,
c){for(var e=C.variablesInBGP(a).sort(),h=C.variablesInBGP(c).sort(),g=0,j=0,i=[];g<e.length&&j<h.length;)e[g]===h[j]?(i.push(e[g]),g++,j++):e[g]<h[j]?g++:j++;return i},executeAndBGPsGroups:function(a){for(var c={},e={},h=0,g=0;g<a.length;g++){var j=a[g],i=[],l;for(l in j)l!="_cost"&&(j[l].token==="var"?i.push(j[l].value):j[l].token==="blank"&&i.push(j[l].value));var r=!1,u;for(u in e){for(var t=e[u],w=0;w<i.length;w++)if(t.indexOf("/"+i[w]+"/")!=-1){c[u].push(j);e[u]=t+i.join("/")+"/";r=!0;break}if(r)break}r||
(c[h]=[j],e[h]="/"+i.join("/")+"/",h++)}a=[];for(h in c)a.push(c[h]);return a},intersectionSize:function(a,c){for(var e=c.i.split("_"),h=0;h<e.length;h++)if(e[h]!=""&&a.i.indexOf("_"+e[h]+"_")!=-1)return 1;return 0},createJoinTree:function(a,c){for(var e="/"+a.vars.join("/")+"/",h=a.vars.concat([]),g=[],j=0;j<c.vars.length;j++)e.indexOf("/"+c.vars[j]+"/")!=-1?c.vars[j].indexOf("_:")==0?g.push("blank:"+c.vars[j]):g.push(c.vars[j]):h.push(c.vars[j]);for(var i=c.i.split("_"),l=a.i.split("_"),e={},j=
0;j<i.length;j++)i[j]!=""&&(e[i[j]]=!0);for(j=0;j<l.length;j++)l[j]!=""&&(e[l[j]]=!0);var j=[],r;for(r in e)j.push(r);return{left:a,right:c,cost:a.cost+c.cost,i:"_"+j.sort().join("_")+"_",vars:h,join:g}}};C.executeBushyTree=function(a,c,e,h){if(a.left==null)return C.executeEmptyJoinBGP(a.right,c,e,h);else if(a.right==null)return C.executeEmptyJoinBGP(a.left,c,e,h);else{var g=C.executeBushyTree(a.left,c,e,h);if(g!=null)return c=C.executeBushyTree(a.right,c,e,h),c!=null?C.joinBindings2(a.join,g,c):
null}};C.executeAndBGPsDPSize=function(a,c,e,h){for(var g=C.executeAndBGPsGroups(a),a=[],j=0;j<g.length;j++){var i=g[j];e.computeCosts(i,h);var l={},r={},u={},t=1,w=null,y={};u["1"]=[];for(var A=0;A<i.length;A++){var t=[],E;for(E in i[A])E!="_cost"&&(i[A][E].token==="var"?t.push(i[A][E].value):i[A][E].token==="blank"&&t.push(i[A][E].value));r["_"+A+"_"]={left:i[A],right:null,cost:i[A]._cost,i:"_"+A+"_",vars:t};t={left:i[A],right:null,cost:i[A]._cost,i:"_"+A+"_",vars:t};l["_"+A+"_"]=t;delete i[A]._cost;
y["_"+A+"_"]=!0;u["1"].push("_"+A+"_");if(w==null||w.cost>t.cost)w=t}for(var F=2;F<=i.length;F++)for(var B=1;B<F;B++)for(var G=u[""+B]||[],K=u[""+(F-B)]||[],A=0;A<G.length;A++)for(var L=0;L<K.length;L++)if(G[A]!==K[L]){var J=r[G[A]],I=r[K[L]];if(C.intersectionSize(J,I)==0&&C.connected(J,I)&&(t=F,I=C.createJoinTree(l[J.i],l[I.i]),!y[I.i])){y[I.i]=!0;var O=I.cost+1;if(l[I.i]!=null)O=l[I.i].cost;J=u[F]||[];J.push(I.i);r[I.i]=I;u[F]=J;O>I.cost&&(t===F&&(w=I),l[I.i]=I)}}a.push(w)}J=null;for(j=0;j<a.length;j++)E=
C.executeBushyTree(a[j],c,e,h),J=J==null?E:C.crossProductBindings(J,E);return J};C.executeEmptyJoinBGP=function(a,c,e,h){return C.executeBGPDatasets(a,c,e,h)};C.executeBGPDatasets=function(a,c,e,h){var g={};if(a.graph==null){for(var j=[],i=0;i<c.implicit.length;i++)if(g[c.implicit[i].oid]==null){g[c.implicit[i].oid]=!0;a.graph=c.implicit[i];var l=e.rangeQuery(a,h),l=C.buildBindingsFromRange(l,a);j.push(l)}return a=C.unionManyBindings(j)}else if(a.graph.token==="var"){for(var r=a.graph.value,j=[],
i=0;i<c.named.length;i++)if(g[c.named[i].oid]==null)if(g[c.named[i].oid]=!0,a.graph=c.named[i],l=e.rangeQuery(a,h),l!=null){for(var l=C.buildBindingsFromRange(l,a),u=0;u<l.length;u++)l[u][r]=c.named[i].oid;j.push(l)}else return null;return a=C.unionManyBindings(j||[])}else return l=e.rangeQuery(a,h),l!=null?l=C.buildBindingsFromRange(l,a):null};C.buildBindingsFromRange=function(a,c){C.variablesInBGP(c);var e={},h=c.value||c,e={};for(l in h)h[l]&&h[l].token==="var"?e[l]=h[l].value:h[l]&&h[l].token===
"blank"&&(e[l]="blank:"+h[l].value);h=[];if(a!=null)for(var g=0;g<a.length;g++){var j={},i=a[g],l;for(l in e)j[e[l]]=i[l];h.push(j)}return h};C.areCompatibleBindings=function(a,c){for(var e in a)if(c[e]!=null&&c[e]!=a[e])return!1;return!0};C.mergeBindings=function(a,c){var e={},h;for(h in a)e[h]=a[h];for(h in c)e[h]=c[h];return e};C.joinBindings2=function(a,c,e){for(var h={},g,j,i,l,r=[],u=0;u<c.length;u++){g=c[u];l=h;for(var t=0;t<a.length;t++)j=a[t],j=g[j],t==a.length-1?(i=l[j]||[],i.push(g),l[j]=
i):(i=l[j]||{},l=l[j]=i)}for(u=0;u<e.length;u++){g=e[u];l=h;for(t=0;t<a.length;t++)if(j=a[t],j=g[j],l[j]!=null)if(t==a.length-1)for(c=0;c<l[j].length;c++)r.push(C.mergeBindings(l[j][c],g));else l=l[j]}return r};C.joinBindings=function(a,c){for(var e=[],h=0;h<a.length;h++)for(var g=a[h],j=0;j<c.length;j++){var i=c[j];C.areCompatibleBindings(g,i)&&e.push(C.mergeBindings(g,i))}return e};C.augmentMissingBindings=function(a,c){for(var e in c)a[e]==null&&(a[e]=null);return a};C.leftOuterJoinBindings=function(a,
c){for(var e=[],h=0;h<a.length;h++){for(var g=a[h],j=!1,i=0;i<c.length;i++){var l=c[i];C.areCompatibleBindings(g,l)&&(j=!0,e.push(C.mergeBindings(g,l)))}j===!1&&(C.augmentMissingBindings(g,l),e.push(g))}return e};C.crossProductBindings=function(a,c){for(var e=[],h=0;h<a.length;h++)for(var g=a[h],j=0;j<c.length;j++)e.push(C.mergeBindings(g,c[j]));return e};C.unionBindings=function(a,c){return a.concat(c)};C.unionManyBindings=function(a){for(var c=[],e=0;e<a.length;e++)c=C.unionBindings(c,a[e]);return c};
var E={},ea=C;E.QueryEngine=function(a){if(arguments.length!=0)this.backend=a.backend,this.lexicon=a.lexicon,this.eventsOnBatchLoad=a.eventsOnBatchLoad||!1,this.defaultPrefixes={},this.abstractQueryTree=new J.AbstractQueryTree,this.rdfLoader=new Y.RDFLoader(a.communication),this.callbacksBackend=new B.CallbacksBackend(this)};E.QueryEngine.prototype.registerNsInEnvironment=function(a,c){var e=[];if(a!=null&&a.prefixes!=null)e=a.prefixes;var h={},g;for(g in this.defaultPrefixes)h[g]=this.defaultPrefixes[g];
for(g=0;g<e.length;g++){var j=e[g];if(j.token==="prefix")h[j.prefix]=j.local}c.namespaces=h;c.base=a!=null&&a.base&&typeof a.base==="object"?a.base.value:null};E.QueryEngine.prototype.applyModifier=function(a,c){if(a=="DISTINCT"){for(var e={},h=[],g=0;g<c.length;g++){var j=c[g],i="",l;for(l in j){var r=j[l];r==null?i=i+l+"null":r.token=="literal"?(r.value!=null&&(i+=r.value),r.lang!=null&&(i+=r.lang),r.type!=null&&(i+=r.type)):i=r.value?i+l+r.value:i+l+r}e[i]==null&&(h.push(j),e[i]=!0)}return h}else return c};
E.QueryEngine.prototype.applyLimitOffset=function(a,c,e){if(c==null&&a==null)return e;a==null&&(a=0);c=c==null?e.length:a+c;return e.slice(a,c)};E.QueryEngine.prototype.applySingleOrderBy=function(a,c,e,h){for(var k=[],j=0;j<a.length;j++){var i=g.collect(a[j].expression,[c],e,h,this);k.push(i[0].value)}return{binding:c,value:k}};E.QueryEngine.prototype.applyOrderBy=function(a,c,e,h){var g=this,j=[];if(a!=null&&a.length>0){for(var i=0;i<c.length;i++){var l=g.applySingleOrderBy(a,c[i],e,h);j.push(l)}j.sort(function(c,
e){return g.compareFilteredBindings(c,e,a,h)});c=[];for(i=0;i<j.length;i++)c.push(j[i].binding)}return c};E.QueryEngine.prototype.compareFilteredBindings=function(a,c,e,h){for(var k=0;;){if(k==a.value.length)return 0;var j=e[k].direction;if(a.value[k]==null&&c.value[k]==null)k++;else{if(a.value[k]==null)a={value:!1};else if(c.value[k]==null)a={value:!0};else if(a.value[k].token==="blank"&&c.value[k].token==="blank"){k++;continue}else if(a.value[k].token==="blank")a={value:!1};else if(c.value[k].token===
"blank")a={value:!0};else if(a.value[k].token==="uri"&&c.value[k].token==="uri")if(g.runEqualityFunction(a.value[k],c.value[k],[],this,h).value==!0){k++;continue}else a=g.runTotalGtFunction(a.value[k],c.value[k],[]);else if(a.value[k].token==="uri")a={value:!1};else if(c.value[k].token==="uri")a={value:!0};else if(a.value[k].token==="literal"&&c.value[k].token==="literal"&&a.value[k].type==null&&c.value[k].type==null)if(g.runEqualityFunction(a.value[k],c.value[k],[],this,h).value==!0){k++;continue}else a=
g.runTotalGtFunction(a.value[k],c.value[k],[]);else if(a.value[k].token==="literal"&&a.value[k].type==null)a={value:!1};else if(c.value[k].token==="literal"&&c.value[k].type==null)a={value:!0};else if(g.runEqualityFunction(a.value[k],c.value[k],[],this,h).value==!0){k++;continue}else a=g.runTotalGtFunction(a.value[k],c.value[k],[]);return a.value==!0?j==="ASC"?1:-1:j==="ASC"?-1:1}}};E.QueryEngine.prototype.removeDefaultGraphBindings=function(a,c){for(var e=[],h={},g=0;g<c.named.length;g++)h[c.named[g].oid]=
!0;for(g=0;g<c.implicit.length;g++)h[c.implicit[g].oid]==null&&e.push(c.implicit[g].oid);e=[];for(g=0;g<a.length;g++){var j=a[g],i=!1,l;for(l in j){for(var r=0;r<h.length;r++)if(j[l]===h[r]){i=!0;break}if(i)break}i||e.push(j)}return e};E.QueryEngine.prototype.aggregateBindings=function(a,c,e,h){for(var c=this.copyDenormalizedBindings(c,h.outCache),k={},j=0;j<a.length;j++){var i=g.runAggregator(a[j],c,this,e,h);a[j].alias?k[a[j].alias.value]=i:k[a[j].value.value]=i}return k};E.QueryEngine.prototype.projectBindings=
function(a,c,e){if(a[0].kind==="*")return c;else{for(var h=[],k=0;k<c.length;k++){for(var j=c[k],i={},l=!0,r=0;r<a.length;r++)if(a[r].token=="variable"&&a[r].kind!="aliased")i[a[r].value.value]=j[a[r].value.value];else if(a[r].token=="variable"&&a[r].kind=="aliased"){var u=g.runFilter(a[r].expression,j,this,e,{blanks:{},outCache:{}});if(g.isEbvError(u)){l=!1;break}else i[a[r].alias.value]=u}l===!0&&h.push(i)}return h}};E.QueryEngine.prototype.resolveNsInEnvironment=function(a,c){return c.namespaces[a]};
E.QueryEngine.prototype.termCost=function(a,c){if(a.token==="uri"){var e=y.lexicalFormBaseUri(a,c);return e==null?0:this.lexicon.resolveUriCost(e)}else return a.token==="literal"?this.lexicon.resolveLiteralCost(y.lexicalFormLiteral(a,c)):a.token==="blank"?this.lexicon.resolveBlankCost(a.value):a.token==="var"?this.lexicon.oidCounter/3:null};E.QueryEngine.prototype.normalizeTerm=function(a,c,e){if(a.token==="uri")return c=y.lexicalFormBaseUri(a,c),c==null?null:e?this.lexicon.registerUri(c):this.lexicon.resolveUri(c);
else if(a.token==="literal")return c=y.lexicalFormLiteral(a,c),a=e?this.lexicon.registerLiteral(c):this.lexicon.resolveLiteral(c);else if(a.token==="blank"){var h=a.value,a=c.blanks[h];a==null&&(a=e?this.lexicon.registerBlank(h):this.lexicon.resolveBlank(h),c.blanks[h]=a);return a}else return a.token==="var"?a.value:null};E.QueryEngine.prototype.normalizeDatasets=function(a,c){for(var e=0;e<a.length;e++){var h=a[e];if(h.value===this.lexicon.defaultGraphUri)h.oid=this.lexicon.defaultGraphOid;else{var g=
this.normalizeTerm(h,c,!1);if(g!=null)h.oid=g;else return null}}return!0};E.QueryEngine.prototype.normalizeQuad=function(a,c,e){var h=null,g=null,j=h=null,i;if(a.graph==null)j=0;else if(i=this.normalizeTerm(a.graph,c,e),i!=null)j=i,e===!0&&a.graph.token!="var"&&this.lexicon.registerGraph(i);else return null;i=this.normalizeTerm(a.subject,c,e);if(i!=null)h=i;else return null;i=this.normalizeTerm(a.predicate,c,e);if(i!=null)g=i;else return null;i=this.normalizeTerm(a.object,c,e);return i==null?null:
{subject:h,predicate:g,object:i,graph:j}};E.QueryEngine.prototype.quadCost=function(a,c){var e=null,h=null,g=null,j=null,j=a.graph==null?this.lexicon.oidCounter/4:this.termCost(a.graph,c),e=this.termCost(a.subject,c),h=this.termCost(a.predicate,c),g=this.termCost(a.object,c);return j+e+h+g};E.QueryEngine.prototype.denormalizeBindingsList=function(a,c){for(var e=[],h=0;h<a.length;h++){var g=this.denormalizeBindings(a[h],c);e.push(g)}return e};E.QueryEngine.prototype.copyDenormalizedBindings=function(a,
c){for(var e=[],h=0;h<a.length;h++){for(var g={},j=a[h],i=y.keys(j),l=0;l<i.length;l++){var r=j[i[l]];if(r==null)g[i[l]]=null;else if(typeof r==="object")g[i[l]]=r;else{var u=c[r];u==null&&(u=this.lexicon.retrieve(r),c[r]=u);g[i[l]]=u}}e.push(g)}return e};E.QueryEngine.prototype.denormalizeBindings=function(a,c){for(var e=y.keys(a),h=c.outCache,g=0;g<e.length;g++){var j=a[e[g]];if(j==null)a[e[g]]=null;else if(h[j]!=null)a[e[g]]=h[j];else{var i=this.lexicon.retrieve(j);a[e[g]]=i;i.token==="blank"&&
(c.blanks[i.value]=j)}}return a};E.QueryEngine.prototype.execute=function(a,c,e,h){a=y.normalizeUnicodeLiterals(a);a=this.abstractQueryTree.parseQueryString(a);if(a==null)c(!1,"Error parsing query string");else if(a.token==="query"&&a.kind=="update"){this.callbacksBackend.startGraphModification();var g=this;this.executeUpdate(a,function(a,e){g.lexicon.updateAfterWrite&&g.lexicon.updateAfterWrite();a?g.callbacksBackend.endGraphModification(function(){c(a,e)}):(g.callbacksBackend.cancelGraphModification(),
c(a,e))})}else a.token==="query"&&a.kind=="query"&&this.executeQuery(a,c,e,h)};E.QueryEngine.prototype.executeQuery=function(a,c,e,h){var g=a.units,j=this,i={blanks:{},outCache:{}};this.registerNsInEnvironment(a.prologue,i);var l=j.abstractQueryTree.parseExecutableUnit(g[0]);if(l.kind==="select")this.executeSelect(l,i,e,h,function(a,e){a?typeof e==="object"&&e.denorm===!0?c(!0,e.bindings):(e=j.denormalizeBindingsList(e,i),e!=null?c(!0,e):c(!1,e)):c(!1,e)});else if(l.kind==="ask")l.projection=[{token:"variable",
kind:"*"}],this.executeSelect(l,i,e,h,function(a,e){a?a?e.length>0?c(!0,!0):c(!0,!1):c(!1,e):c(!1,e)});else if(l.kind==="construct")l.projection=[{token:"variable",kind:"*"}],j=this,this.executeSelect(l,i,e,h,function(a,e){if(a)if(a)if(e=j.denormalizeBindingsList(e,i),e!=null){var h=new w.Graph;if(l.template==null)l.template={triplesContext:l.pattern};for(var g=1,k=[],y=0;y<e.length;y++){for(var E=e[y],F=0;F<k.length;F++)delete k[F].valuetmp;for(F=0;F<l.template.triplesContext.length;F++){for(var C=
["subject","predicate","object"],B=l.template.triplesContext[F],G=0;G<C.length;G++){var I=C[G];if(B[I].token==="blank"&&!(B[I].valuetmp&&B[I].valuetmp!=null)){var J="_:b"+g;g++;B[I].valuetmp=J;k.push(B[I])}}C=w.buildRDFResource(B.subject,E,j,i);G=w.buildRDFResource(B.predicate,E,j,i);B=w.buildRDFResource(B.object,E,j,i);C!=null&&G!=null&&B!=null&&(G=new w.Triple(C,G,B),h.add(G))}}c(!0,h)}else c(!1,e);else c(!1,e);else c(!1,e)})};E.QueryEngine.prototype.executeSelect=function(a,c,e,h,g){if(a.kind===
"select"||a.kind==="ask"||a.kind==="construct"||a.kind==="modify"){var j=a.projection,i=a.dataset,l=a.modifier,r=a.limit,u=a.offset,t=a.order;if(e!=null||h!=null)i.implicit=e||[],i.named=h||[];i.implicit!=null&&i.implicit.length===0&&i.named!=null&&i.named.length===0&&i.implicit.push(this.lexicon.defaultGraphUriTerm);if(this.normalizeDatasets(i.implicit.concat(i.named),c)!=null)if(h=this.executeSelectUnit(j,i,a.pattern,c),h!=null){if(a.group!=null&&a.group===""){for(var w=!1,e=0;e<a.projection.length;e++)if(a.projection[e].expression!=
null&&a.projection[e].expression.expressionType==="aggregate"){w=!0;break}if(w===!0)a.group="singleGroup"}if(a.group&&a.group!="")if(this.checkGroupSemantics(a.group,j)){r=this.groupSolution(h,a.group,i,c);u=[];for(e=0;e<r.length;e++)l=this.aggregateBindings(j,r[e],i,c),u.push(l);g(!0,{bindings:u,denorm:!0})}else g(!1,"Incompatible Group and Projection variables");else c=this.applyOrderBy(t,h,i,c),j=this.projectBindings(j,c,i),j=this.applyModifier(l,j),i=this.removeDefaultGraphBindings(this.applyLimitOffset(u,
r,j),i),g(!0,i)}else g(!1,h);else g(!1,"Error normalizing datasets")}else g(!1,"Cannot execute "+a.kind+" query as a select query")};E.QueryEngine.prototype.groupSolution=function(a,c,e,h){var k=[],j=[],i=!1;if(c==="singleGroup")return[a];else{for(var l=0;l<a.length;l++){for(var r=a[l],u=!0,t=0;t<c.length;t++){var w=c[t],y=null;if(w.token==="var")y=w.value,i==!1&&k.push(y);else if(w.token==="aliased_expression")if(y=w.alias.value,i==!1&&k.push(y),w.expression.primaryexpression==="var")r[w.alias.value]=
r[w.expression.value.value];else if(y=this.copyDenormalizedBindings([r],h.outCache),y=g.runFilter(w.expression,y[0],this,e,h),g.isEbvError(y))u=!1;else{if(y.value!=null)y.value=""+y.value;r[w.alias.value]=y}else y=this.copyDenormalizedBindings([r],h.outCache),y=g.runFilter(w,y[0],this,h),g.isEbvError(y)?u=!1:(r["groupCondition"+env._i]=y,y="groupCondition"+env._i,i==!1&&k.push(y))}i==!1&&(i=!0);u===!0&&j.push(r)}a={};for(l=0;l<j.length;l++){c=j[l];e="";for(t=0;t<k.length;t++)h=c[k[t]],e+=typeof h===
"object"?h.value:h;a[e]==null?a[e]=[c]:a[e].push(c)}var k=[],A;for(A in a)k.push(a[A]);return k}};E.QueryEngine.prototype.executeSelectUnit=function(a,c,e,h){return e.kind==="BGP"?this.executeAndBGP(a,c,e,h):e.kind==="UNION"?this.executeUNION(a,c,e.value,h):e.kind==="JOIN"?this.executeJOIN(a,c,e,h):e.kind==="LEFT_JOIN"?this.executeLEFT_JOIN(a,c,e,h):e.kind==="FILTER"?(a=this.executeSelectUnit(a,c,e.value,h),a!=null?a=g.checkFilters(e,a,!1,c,h,this):[]):e.kind==="EMPTY_PATTERN"?[]:e.kind==="ZERO_OR_MORE_PATH"||
e.kind==="ONE_OR_MORE_PATH"?this.executeZeroOrMorePath(e,c,h):(console.log("Cannot execute query pattern "+e.kind+". Not implemented yet."),null)};E.QueryEngine.prototype.executeZeroOrMorePath=function(a,c,e){var h=[];a.x.token==="var"&&h.push({token:"variable",kind:"var",value:a.x.value});a.y.token==="var"&&h.push({token:"variable",kind:"var",value:a.y.value});h.length===0&&h.push({token:"variable",kind:"*"});if(a.x.token==="var"&&a.y.token==="var"){var g=this.executeAndBGP(h,c,a.path,e),j={},h=
[],i,l,r,u,t=a.x.value;l=a.x;for(var w=a.path,D=0;D<g.length;D++)if(i=g[D][t],j[i]==null){u=this.lexicon.retrieve(i);a.x=u;a.path=this.abstractQueryTree.replace(w,l,u,e);w=y.clone(a.path);l=this.executeZeroOrMorePath(a,c,e);for(var A=0;A<l.length;A++)r=l[A],r[t]=i,h.push(r);l=u}return h}else if(a.x.token!=="var"&&a.y.token==="var"){j={};i=!0;u=[];for(t=[];i==!0||u.length!==0;){i===!0?(g=this.executeAndBGP(h,c,a.path,e),l=a.x,i=!1):(w=this.lexicon.retrieve(u.pop()),g=a.path,g=this.abstractQueryTree.replace(g,
l,w,e),g=this.executeAndBGP(h,c,g,e),l=w);for(D=0;D<g.length;D++)w=g[D][a.y.value],j[w]!==!0&&(r={},r[a.y.value]=w,t.push(r),j[w]=!0,u.push(w))}return t}else throw"Kind of path not supported!";};E.QueryEngine.prototype.executeUNION=function(a,c,e,h){var k=e[0],j=e[1],i=null,l=null;if(e.length!=2)throw"SPARQL algebra UNION with more than two components";i=this.executeSelectUnit(a,c,k,h);if(i==null)return null;l=this.executeSelectUnit(a,c,j,h);if(l==null)return null;a=ea.unionBindings(i,l);return a=
g.checkFilters(e,a,!1,c,h,this)};E.QueryEngine.prototype.executeAndBGP=function(a,c,e,h){a=ea.executeAndBGPsDPSize(e.value,c,this,h);return a!=null?g.checkFilters(e,a,!1,c,h,this):null};E.QueryEngine.prototype.executeLEFT_JOIN=function(a,c,e,h){var k=e.rvalue,j=null,i=null,j=this.executeSelectUnit(a,c,e.lvalue,h);if(j==null)return null;i=this.executeSelectUnit(a,c,k,h);if(i==null)return null;a=ea.leftOuterJoinBindings(j,i);c=g.checkFilters(e,a,!0,c,h,this);if(j.length>1&&i.length>1){var e=[],h={},
l;for(l in j[0])h[l]=!0;for(l in i[0])h[l]!=!0&&e.push(l);j=[];i={};for(h=0;h<c.length;h++)if(c[h].__nullify__===!0){for(k=0;k<e.length;k++)c[h].bindings[e[k]]=null;k=[];a=[];for(l in c[h].bindings)c[h].bindings[l]!=null&&(k.push(l+c[h].bindings[l]),k.sort(),a.push(k.join("")));if(i[k.join("")]==null){for(k=0;k<a.length;k++)i[a[k]]=!0;j.push(c[h].bindings)}}else for(l in j.push(c[h]),k=[],c[h])k.push(l+c[h][l]),k.sort(),i[k.join("")]=!0;return j}else return c};E.QueryEngine.prototype.executeJOIN=
function(a,c,e,h){var k=e.lvalue,j=e.rvalue,i=null,l=null,i=this.executeSelectUnit(a,c,k,h);if(i==null)return null;l=this.executeSelectUnit(a,c,j,h);if(l==null)return null;a=null;if(i.length===0||l.length===0)a=[];else{var a={},r=[],u;for(u in i[0])a[u]=!1;for(u in l[0])a[u]===!1&&r.push(u);a=r.length==0?ea.joinBindings(i,l):this.abstractQueryTree.treeWithUnion(k)||this.abstractQueryTree.treeWithUnion(j)?ea.joinBindings(i,l):ea.joinBindings2(r,i,l)}return a=g.checkFilters(e,a,!1,c,h,this)};E.QueryEngine.prototype.rangeQuery=
function(a,c){var e=this.normalizeQuad(a,c,!1);return e!=null?(e=this.backend.range(new S.Pattern(e)),e==null||e.length==0?[]:e):(console.log("ERROR normalizing quad"),null)};E.QueryEngine.prototype.executeUpdate=function(a,c){var e=a.units,h=this,g={blanks:{},outCache:{}};this.registerNsInEnvironment(a.prologue,g);for(var j=0;j<e.length;j++){var i=h.abstractQueryTree.parseExecutableUnit(e[j]);if(i.kind==="insertdata"){for(var l=0;l<i.quads.length;l++){var r=i.quads[l];if(h._executeQuadInsert(r,g)!==
!0)return c(!1,error)}c(!0)}else if(i.kind==="deletedata"){for(l=0;l<i.quads.length;l++)r=i.quads[l],this._executeQuadDelete(r,g);c(!0)}else if(i.kind==="modify")this._executeModifyQuery(i,g,c);else if(i.kind==="create")c(!0);else if(i.kind==="load")l={uri:y.lexicalFormBaseUri(i.sourceGraph,g)},i.destinyGraph!=null&&(l={uri:y.lexicalFormBaseUri(i.destinyGraph,g)}),h=this,this.rdfLoader.load(i.sourceGraph.value,l,function(a,e){a==!1?(console.log("Error loading graph"),console.log(e),c(!1,"error batch loading quads")):
(e=h.batchLoad(e),c(e!=null,e||"error batch loading quads"))});else if(i.kind==="drop")this._executeClearGraph(i.destinyGraph,g,c);else if(i.kind==="clear")this._executeClearGraph(i.destinyGraph,g,c);else throw Error("not supported execution unit");}};E.QueryEngine.prototype.batchLoad=function(a,c){var e=null,h=null,g=null,j=null,i=0,l=!0,r={},u,t;this.eventsOnBatchLoad&&this.callbacksBackend.startGraphModification();for(var w=0;w<a.length;w++){t=a[w];if(t.subject.uri||t.subject.token==="uri"){if(u=
this.lexicon.registerUri(t.subject.uri||t.subject.value),t.subject.uri!=null)t.subject={token:"uri",value:t.subject.uri},delete t.subject.uri}else if(t.subject.literal||t.subject.token==="literal"){if(u=this.lexicon.registerLiteral(t.subject.literal||t.subject.value),t.subject.literal!=null)t.subject=this.lexicon.parseLiteral(t.subject.literal),delete t.subject.literal}else if(u=r[t.subject.blank||t.subject.value],u==null&&(u=this.lexicon.registerBlank(t.subject.blank||t.subject.value),r[t.subject.blank||
t.subject.value]=u),t.subject.token==null)t.subject.token="blank",t.subject.value=t.subject.blank,delete t.subject.blank;e=u;if(t.predicate.uri||t.predicate.token==="uri"){if(u=this.lexicon.registerUri(t.predicate.uri||t.predicate.value),t.predicate.uri!=null)t.predicate={token:"uri",value:t.predicate.uri},delete t.subject.uri}else if(t.predicate.literal||t.predicate.token==="literal"){if(u=this.lexicon.registerLiteral(t.predicate.literal||t.predicate.value),t.predicate.literal!=null)t.predicate=
this.lexicon.parseLiteral(t.predicate.literal),delete t.predicate.literal}else if(u=r[t.predicate.blank||t.predicate.value],u==null&&(u=this.lexicon.registerBlank(t.predicate.blank||t.predicate.value),r[t.predicate.blank||t.predicate.value]=u),t.predicate.token==null)t.predicate.token="blank",t.predicate.value=t.predicate.blank,delete t.predicate.blank;h=u;if(t.object.uri||t.object.token==="uri"){if(u=this.lexicon.registerUri(t.object.uri||t.object.value),t.object.uri!=null)t.object={token:"uri",
value:t.object.uri},delete t.subject.uri}else if(t.object.literal||t.object.token==="literal"){if(u=this.lexicon.registerLiteral(t.object.literal||t.object.value),t.object.literal!=null)t.object=this.lexicon.parseLiteral(t.object.literal),delete t.object.literal}else if(u=r[t.object.blank||t.object.value],u==null&&(u=this.lexicon.registerBlank(t.object.blank||t.object.value),r[t.object.blank||t.object.value]=u),t.object.token==null)t.object.token="blank",t.object.value=t.object.blank,delete t.object.blank;
g=u;if(t.graph.uri||t.graph.token==="uri"){u=this.lexicon.registerUri(t.graph.uri||t.graph.value);if(t.graph.uri!=null)t.graph={token:"uri",value:t.graph.uri},delete t.subject.uri;this.lexicon.registerGraph(u)}else if(t.graph.literal||t.graph.token==="literal"){if(u=this.lexicon.registerLiteral(t.graph.literal||t.graph.value),t.predicate.literal!=null)t.predicate=this.lexicon.parseLiteral(t.predicate.literal),delete t.predicate.literal}else if(u=r[t.graph.blank||t.graph.value],u==null&&(u=this.lexicon.registerBlank(t.graph.blank||
t.graph.value),r[t.graph.blank||t.graph.value]=u),t.graph.token==null)t.graph.token="blank",t.graph.value=t.graph.blank,delete t.graph.blank;j=u;u=t;t={subject:e,predicate:h,object:g,graph:j};e=new S.NodeKey(t);h=this.backend.search(e);if(!h)if(h=this.backend.index(e),h==!0)this.eventsOnBatchLoad&&this.callbacksBackend.nextGraphModification(B.added,[u,t]),i+=1;else{l=!1;break}}this.lexicon.updateAfterWrite!=null&&this.lexicon.updateAfterWrite();var y=function(){l?c&&c(!0,i):c&&c(!1,null)};this.eventsOnBatchLoad?
this.callbacksBackend.endGraphModification(function(){y()}):y();return l?i:null};E.QueryEngine.prototype.computeCosts=function(a,c){for(var e=0;e<a.length;e++)a[e]._cost=this.quadCost(a[e],c);return a};E.QueryEngine.prototype._executeModifyQuery=function(a,c,e){var h=this,g=!0,j=null,i=["subject","predicate","object","graph"];a.insert=a.insert==null?[]:a.insert;a["delete"]=a["delete"]==null?[]:a["delete"];y.seq(function(e){var i=[],u=[];a["with"]!=null&&i.push(a["with"]);if(a.using!=null)for(var u=
[],t=0;t<a.using.length;t++){var w=a.using[t];w.kind==="named"?u.push(w.uri):i.push(w.uri)}a.dataset={};a.projection=[{token:"variable",kind:"*"}];h.executeSelect(a,c,i,u,function(a,i){a?(i=h.denormalizeBindingsList(i,c),i!=null?j=i:g=!1):g=!1;return e()})},function(e){var r=a["with"];if(g){for(var u=[],t=0;t<a["delete"].length;t++)for(var w=a["delete"][t],y=0;y<j.length;y++){for(var A={},B=j[y],F=0;F<i.length;F++){var C=i[F];C=="graph"&&w[C]==null?A.graph=r:A[C]=w[C].token==="var"?B[w[C].value]:
w[C]}u.push(A)}for(y=0;y<u.length;y++)A=u[y],h._executeQuadDelete(A,c)}e()},function(e){var r=a["with"];if(g){for(var u=[],t=0;t<a.insert.length;t++)for(var w=a.insert[t],y=0;y<j.length;y++){for(var A={},C=j[y],F=0;F<i.length;F++){var B=i[F];B=="graph"&&w[B]==null?A.graph=r:A[B]=w[B].token==="var"?C[w[B].value]:w[B]}u.push(A)}for(t=0;t<u.length;t++)A=u[t],h._executeQuadInsert(A,c)}e()})(function(){e(g)})};E.QueryEngine.prototype._executeQuadInsert=function(a,c){var e=this.normalizeQuad(a,c,!0);if(e!=
null){var h=new S.NodeKey(e),g=this.backend.search(h);return g?g:(g=this.backend.index(h),g==!0?(this.callbacksBackend.nextGraphModification(B.added,[a,e]),!0):(console.log("ERROR inserting quad"),!1))}else return console.log("ERROR normalizing quad"),!1};E.QueryEngine.prototype._executeQuadDelete=function(a,c){var e=this.normalizeQuad(a,c,!1);if(e!=null){var h=new S.NodeKey(e);this.backend["delete"](h);return this.lexicon.unregister(a,h)==!0?(this.callbacksBackend.nextGraphModification(B.deleted,
[a,e]),!0):(console.log("ERROR unregistering quad"),!1)}else return console.log("ERROR normalizing quad"),!1};E.QueryEngine.prototype._executeClearGraph=function(a,c,e){if(a==="default")this.execute("DELETE { ?s ?p ?o } WHERE { ?s ?p ?o }",e);else if(a==="named"){var h=this,g=this.lexicon.registeredGraphs(!0);if(g!=null){var j=!1;y.repeat(0,g.length,function(a,c){var e=g[c._i],u=arguments.callee;j?a(u,c):h.execute("DELETE { GRAPH <"+e+"> { ?s ?p ?o } } WHERE { GRAPH <"+e+"> { ?s ?p ?o } }",function(e){j=
!e;a(u,c)})},function(){e(!j)})}else e(!1,"Error deleting named graphs")}else a==="all"?(h=this,this.execute("CLEAR DEFAULT",function(a,c){a?h.execute("CLEAR NAMED",e):e(!1,c)})):a.token=="uri"?(a=y.lexicalFormBaseUri(a,c),a!=null?this.execute("DELETE { GRAPH <"+a+"> { ?s ?p ?o } } WHERE { GRAPH <"+a+"> { ?s ?p ?o } }",e):e(!1,"wrong graph URI")):e(!1,"wrong graph URI")};E.QueryEngine.prototype.checkGroupSemantics=function(a,c){if(a==="singleGroup")return!0;for(var e={},h=0;h<a.length;h++){var g=
a[h];g.token==="var"?e[g.value]=!0:g.token==="aliased_expression"&&(e[g.alias.value]=!0)}for(h=0;h<c.length;h++)if(g=c[h],g.kind==="var"){if(e[g.value.value]==null)return!1}else if(g.kind==="aliased"&&g.expression&&g.expression.primaryexpression==="var"&&e[g.expression.value.value]==null)return!1;return!0};E.QueryEngine.prototype.registerDefaultNamespace=function(a,c){this.defaultPrefixes[a]=c};var B={ANYTHING:{token:"var",value:"_"},added:"added",deleted:"deleted",eventsFlushed:"eventsFlushed",CallbacksBackend:function(a){this.aqt=
new J.AbstractQueryTree;this.engine=a;this.indexMap={};this.observersMap={};this.queriesIndexMap={};this.emptyNotificationsMap={};this.queriesList=[];this.pendingQueries=[];this.matchedQueries=[];this.updateInProgress=null;this.indices=["SPOG","GP","OGS","POG","GSP","OS"];this.componentOrders={SPOG:["subject","predicate","object","graph"],GP:["graph","predicate","subject","object"],OGS:["object","graph","subject","predicate"],POG:["predicate","object","graph","subject"],GSP:["graph","subject","predicate",
"object"],OS:["object","subject","predicate","graph"]};this.callbackCounter=0;this.callbacksMap={};this.callbacksInverseMap={};this.queryCounter=0;this.queriesMap={};this.queriesCallbacksMap={};this.queriesInverseMap={};for(a=0;a<this.indices.length;a++){var c=this.indices[a];this.indexMap[c]={};this.queriesIndexMap[c]={}}}};B.CallbacksBackend.prototype.startGraphModification=function(){this.pendingQueries=[].concat(this.queriesList);this.matchedQueries=[];if(this.updateInProgress==null)this.updateInProgress=
{added:[],deleted:[]}};B.CallbacksBackend.prototype.nextGraphModification=function(a,c){this.updateInProgress[a].push(c)};B.CallbacksBackend.prototype.endGraphModification=function(a){var c=this;if(this.updateInProgress!=null){var e=c.updateInProgress;c.updateInProgress=null;this.sendNotification(B.deleted,e[B.deleted],function(){c.sendNotification(B.added,e[B.added],function(){c.sendEmptyNotification(B.eventsFlushed,null,function(){c.dispatchQueries(function(){a(!0)})})})})}else a(!0)};B.CallbacksBackend.prototype.cancelGraphModification=
function(){this.updateInProgress=null};B.CallbacksBackend.prototype.sendNotification=function(a,c,e){for(var h={},g=0;g<c.length;g++){var j=c[g],i;for(i in this.indexMap){var l=this.indexMap[i],r=this.componentOrders[i];this._searchCallbacksInIndex(l,r,a,j,h);this.pendingQueries.length!=0&&(l=this.queriesIndexMap[i],this._searchQueriesInIndex(l,r,j))}}this.dispatchNotifications(h);e!=null&&e(!0)};B.CallbacksBackend.prototype.sendEmptyNotification=function(a,c,e){for(var h=this.emptyNotificationsMap[a]||
[],g=0;g<h.length;g++)h[g](a,c);e()};B.CallbacksBackend.prototype.dispatchNotifications=function(a){for(var c in a){var e=this.callbacksMap[c],h=a[c][B.deleted];if(h!=null)try{e(B.deleted,h)}catch(g){}for(var j in a[c])if(j!=B.deleted)try{e(j,a[c][j])}catch(i){}}};B.CallbacksBackend.prototype._searchCallbacksInIndex=function(a,c,e,h,g){for(var j=h[1],h=h[0],i=0;i<c.length+1;i++){for(var l=a._||[],r=[],u=0;u<l.length;u++){var t=l[u];this.callbacksMap[t]!=null&&(g[t]=g[t]||{},g[t][e]=g[t][e]||[],g[t][e].push(h),
r.push(t))}a._=r;l=c[i];if(a[""+j[l]]!=null)a=a[""+j[l]];else break}};B.CallbacksBackend.prototype.subscribeEmpty=function(a,c){var e=this.emptyNotificationsMap[a]||[];e.push(c);this.emptyNotificationsMap[a]=e};B.CallbacksBackend.prototype.unsubscribeEmpty=function(a,c){var e=this.emptyNotificationsMap[a];e!=null&&(e=y.remove(e,c));this.emptyNotificationsMap[a]=e};B.CallbacksBackend.prototype.subscribe=function(a,c,e,h,g,j){a=this._tokenizeComponents(a,c,e,h);c={blanks:{},outCache:{}};this.engine.registerNsInEnvironment(null,
c);a=this.engine.normalizeQuad(a,c,!0);e=this._indexForPattern(new S.Pattern(a));c=this.componentOrders[e];e=this.indexMap[e];for(h=0;h<c.length;h++){var i=a[c[h]];if(i==="_"){e._==null&&(e._=[]);this.callbackCounter++;e._.push(this.callbackCounter);this.callbacksMap[this.callbackCounter]=g;this.callbacksInverseMap[g]=this.callbackCounter;break}else h===c.length-1?(e[i]=e[i]||{_:[]},this.callbackCounter++,e[i]._.push(this.callbackCounter),this.callbacksMap[this.callbackCounter]=g,this.callbacksInverseMap[g]=
this.callbackCounter):(e[i]=e[i]||{},e=e[i])}j!=null&&j(!0)};B.CallbacksBackend.prototype.unsubscribe=function(a){var c=this.callbacksInverseMap[a];c!=null&&(delete this.callbacksInverseMap[a],delete this.callbacksMap[c])};B.CallbacksBackend.prototype._tokenizeComponents=function(a,c,e,h){var g={};g.subject=a==null?B.ANYTHING:a.indexOf("_:")==0?{token:"blank",value:a}:{token:"uri",value:a};g.predicate=c==null?B.ANYTHING:{token:"uri",value:c};g.object=e==null?B.ANYTHING:{token:"uri",value:e};g.graph=
h==null?B.ANYTHING:{token:"uri",value:h};return g};B.CallbacksBackend.prototype._indexForPattern=function(a){for(var a=a.indexKey,c=this.indices,e=0;e<c.length;e++)for(var h=c[e],g=this.componentOrders[h],j=0;j<g.length;j++){if(y.include(a,g[j])===!1)break;if(j==a.length-1)return h}return"SPOG"};B.CallbacksBackend.prototype.observeNode=function(){var a,c,e,g;arguments.length===4?(a=arguments[0],c=arguments[1],e=arguments[2],g=arguments[3]):(a=arguments[0],c=this.engine.lexicon.defaultGraphUri,e=arguments[1],
g=arguments[2]);c="CONSTRUCT { <"+a+"> ?p ?o } WHERE { GRAPH <"+c+"> { <"+a+"> ?p ?o } }";var k=this,j={blanks:{},outCache:{}};this.engine.registerNsInEnvironment(null,j);var i=[];this.engine.execute(c,function(c,r){if(c){var u=!1,t=function(a,c){if(a==="eventsFlushed"&&u){u=!1;try{e(r)}catch(g){}}else if(a!=="eventsFlushed"){u=!0;for(var h=0;h<c.length;h++){var l=c[h],t=w.buildRDFResource(l.subject,i,k.engine,j),y=w.buildRDFResource(l.predicate,i,k.engine,j),l=w.buildRDFResource(l.object,i,k.engine,
j);t!=null&&y!=null&&l!=null&&(l=new w.Triple(t,y,l),a===B.added?r.add(l):a===B.deleted&&r.remove(l))}}};k.observersMap[e]=t;k.subscribeEmpty(B.eventsFlushed,t);k.subscribe(a,null,null,null,t,function(){try{e(r)}catch(a){}g&&g(!0)})}else g&&g(!1)})};B.CallbacksBackend.prototype.stopObservingNode=function(a){return(a=this.observersMap[a])?(this.unsubscribe(a),this.unsubscribeEmpty(B.eventsFlushed,a),!0):!1};B.CallbacksBackend.prototype.observeQuery=function(a,c,e){var g=this.aqt.collectBasicTriples(this.aqt.parseSelect(this.aqt.parseQueryString(a).units[0])),
k={blanks:{},outCache:{}};this.engine.registerNsInEnvironment(null,k);var j,i,l,r=this.queryCounter;this.queryCounter++;this.queriesMap[r]=a;this.queriesInverseMap[a]=r;this.queriesList.push(r);this.queriesCallbacksMap[r]=c;for(var u=0;u<g.length;u++){i=g[u];if(i.graph==null)i.graph=this.engine.lexicon.defaultGraphUriTerm;i=this.engine.normalizeQuad(i,k,!0);j=new S.Pattern(i);l=this._indexForPattern(j);j=this.componentOrders[l];l=this.queriesIndexMap[l];for(var t=0;t<j.length;t++){var w=i[j[t]];if(typeof w===
"string"){l._==null&&(l._=[]);l._.push(r);break}else t===j.length-1?(l[w]=l[w]||{_:[]},l[w]._.push(r)):(l[w]=l[w]||{},l=l[w])}}this.engine.execute(a,function(a,e){a?c(e):console.log("ERROR in query callback "+e)});e!=null&&e()};B.CallbacksBackend.prototype.stopObservingQuery=function(a){var c=this.queriesInverseMap[a];if(c!=null)delete this.queriesInverseMap[a],delete this.queriesMap[c],this.queriesList=y.remove(this.queriesList,c)};B.CallbacksBackend.prototype._searchQueriesInIndex=function(a,c,
e){for(var e=e[1],g=0;g<c.length+1;g++){for(var k=a._||[],j=[],i=0;i<k.length;i++){var l=k[i];y.include(this.pendingQueries,l)&&(y.remove(this.pendingQueries,l),this.matchedQueries.push(l));this.queriesMap[l]!=null&&j.push(l)}a._=j;k=c[g];if(a[""+e[k]]!=null)a=a[""+e[k]];else break}};B.CallbacksBackend.prototype.dispatchQueries=function(a){var c=this,e,g,k,j,i={};y.repeat(0,this.matchedQueries.length,function(a,r){e=arguments.callee;k=c.matchedQueries[r._i];i[k]==null?(i[k]=!0,g=c.queriesMap[k],j=
c.queriesCallbacksMap[k],y.recur(function(){c.engine.execute(g,function(c,g){if(c)try{j(g)}catch(h){}a(e,r)})})):a(e,r)},function(){a()})};var L={};try{typeof Worker=="undefined"&&(Worker=null)}catch(uc){Worker=null}if(Worker)L.RDFStoreClient=function(a,c,e){console.log("trying to load "+a);this.connection=Worker.Worker?new Worker.Worker(a):new Worker(a);this.callbacksCounter=1;var g=this;this.rdf=w.rdf;console.log("The worker");console.log(this.connection);g=this;this.connection.onmessage=function(a){g.receive(a)};
this.observingCallbacks={};this.callbacks={0:{cb:function(a,c){a===!0?e(!0,g):e(!1,c)},fn:"create"}};this.connection.postMessage({fn:"create",args:c,callback:"0"})},L.RDFStoreClient.prototype.receive=function(a){a=a.data||a;if(a.fn==="workerRequest:NetworkTransport:load"){var c=this,e=a.callback,a=a.arguments.concat(function(a,g){c.connection.postMessage({fn:"workerRequestResponse",results:[a,g],callback:e})});O.load.apply(O,a)}else{var g=this.callbacks[a.callback];g&&(g.fn==="create"||g.fn==="execute"||
g.fn==="insert"||g.fn=="graph"||g.fn==="node"||g.fn==="insert"||g.fn==="delete"||g.fn==="clear"||g.fn==="load"||g.fn==="startObservingQueryEndCb"||g.fn==="registeredGraphs"?(delete this.callbacks[a.callback],g.cb(a.success,a.result)):g.fn==="startObservingQuery"?g.cb(a.result):g.fn==="startObservingNode"?g.cb(a.result):g.fn==="subscribe"&&g.cb(a.event,a.result))}},L.RDFStoreClient.prototype.registerCallback=function(a,c){var e=""+this.callbacksCounter;this.callbacks[e]={fn:a,cb:c};this.callbacksCounter++;
return e},L.RDFStoreClient.prototype.execute=function(){if(arguments.length===3)this.executeWithEnvironment(arguments[0],arguments[1],arguments[2]);else if(arguments.length===4)this.executeWithEnvironment(arguments[0],arguments[1],arguments[2],arguments[3]);else{var a,c;arguments.length===1?(a=arguments[0],c=function(){}):arguments.length===2&&(a=arguments[0],c=arguments[1]);c=this.registerCallback("execute",c);this.connection.postMessage({fn:"execute",args:[a],callback:c})}},L.RDFStoreClient.prototype.insert=
function(){var a,c,e;if(arguments.length===1)c=arguments[0],this.connection.postMessage({fn:"insert",args:[c]});else if(arguments.length===2)c=arguments[0],e=arguments[1]||function(){},e=this.registerCallback("insert",e),this.connection.postMessage({fn:"insert",args:[c],callback:e});else if(arguments.length===3)c=arguments[0],a=arguments[1],e=arguments[2]||function(){},e=this.registerCallback("insert",e),this.connection.postMessage({fn:"insert",args:[c,a],callback:e});else throw"The triples to insert, an optional graph and callback must be provided";
},L.RDFStoreClient.prototype.graph=function(){var a=null,c=null;if(arguments.length===1)c=arguments[0]||function(){};else if(arguments.length===2)c=arguments[1]||function(){},a=arguments[0];else throw"An optional graph URI and a callback function must be provided";var e=this,g=this.registerCallback("insert",function(a,g){if(a){for(var h,l=0;l<g.triples.length;l++)h=g.triples[l],g.triples[l]=new w.Triple(e.adaptJSInterface(h.subject),e.adaptJSInterface(h.predicate),e.adaptJSInterface(h.object));c(a,
e.rdf.createGraph(g.triples))}else c(a,g)});a==null?this.connection.postMessage({fn:"graph",args:[],callback:g}):this.connection.postMessage({fn:"graph",args:[a],callback:g})},L.RDFStoreClient.prototype.node=function(){var a=null,c=null,e=null;if(arguments.length===2)e=arguments[0],c=arguments[1]||function(){};else if(arguments.length===3)e=arguments[0],a=arguments[1],c=arguments[2]||function(){};else throw"An optional graph URI and a callback function must be provided";var g=this,k=this.registerCallback("insert",
function(a,e){if(a){for(var k,r=0;r<e.triples.length;r++)k=e.triples[r],e.triples[r]=new w.Triple(g.adaptJSInterface(k.subject),g.adaptJSInterface(k.predicate),g.adaptJSInterface(k.object));c(a,g.rdf.createGraph(e.triples))}else c(a,e)});a==null?this.connection.postMessage({fn:"node",args:[e],callback:k}):this.connection.postMessage({fn:"node",args:[e,a],callback:k})},L.RDFStoreClient.prototype.setPrefix=function(a,c){this.rdf.setPrefix(a,c);this.connection.postMessage({fn:"rdf/setPrefix",args:[a,
c],callback:null})},L.RDFStoreClient.prototype.setDefaultPrefix=function(a){this.rdf.setDefaultPrefix(a);this.connection.postMessage({fn:"rdf/setDefaultPrefix",args:[a],callback:null})},L.RDFStoreClient.prototype["delete"]=function(){var a,c,e;if(arguments.length===1)c=arguments[0],this.connection.postMessage({fn:"delete",args:[c]});else if(arguments.length===2)c=arguments[0],e=arguments[1]||function(){},e=this.registerCallback("delete",e),this.connection.postMessage({fn:"delete",args:[c],callback:e});
else if(arguments.length===3)c=arguments[0],a=arguments[1],e=arguments[2]||function(){},e=this.registerCallback("delete",e),this.connection.postMessage({fn:"delete",args:[c,a],callback:e});else throw"The triples to delete, an optional graph and callback must be provided";},L.RDFStoreClient.prototype.clear=function(){var a,c;if(arguments.length===1)c=arguments[0]||function(){},c=this.registerCallback("clear",c),this.connection.postMessage({fn:"clear",args:[],callback:c});else if(arguments.length===
2)a=arguments[0],c=arguments[1]||function(){},c=this.registerCallback("clear",c),this.connection.postMessage({fn:"clear",args:[a],callback:c});else throw"The optional graph and a callback must be provided";},L.RDFStoreClient.prototype.setBatchLoadEvents=function(a){this.connection.postMessage({fn:"setBatchLoadEvents",args:[a]})},L.RDFStoreClient.prototype.registerDefaultNamespace=function(a,c){this.connection.postMessage({fn:"registerDefaultNamespace",args:[a,c]})},L.RDFStoreClient.prototype.registerDefaultProfileNamespaces=
function(){this.connection.postMessage({fn:"registerDefaultProfileNamespaces",args:[]})},L.RDFStoreClient.prototype.load=function(){var a,c,e,g;if(arguments.length===3)a=arguments[0],c=arguments[1],g=arguments[2]||function(){},g=this.registerCallback("load",g),this.connection.postMessage({fn:"load",args:[a,c],callback:g});else if(arguments.length===4)a=arguments[0],c=arguments[1],e=arguments[2],g=arguments[3]||function(){},g=this.registerCallback("load",g),this.connection.postMessage({fn:"load",args:[a,
c,e],callback:g});else if(arguments.length===2)throw"The mediaType of the parser, the data a callback and an optional graph must be provided";},L.RDFStoreClient.prototype.startObservingQuery=function(a,c,e){e!=null?(c=this.registerCallback("startObservingQuery",c),this.observingCallbacks[a]=c,e=this.registerCallback("startObservingQueryEndCb",e),this.connection.postMessage({fn:"startObservingQuery",args:[a],callback:[c,e]})):(c=this.registerCallback("startObservingQuery",c),this.observingCallbacks[a]=
c,this.connection.postMessage({fn:"startObservingQuery",args:[a],callback:[c]}))},L.RDFStoreClient.prototype.stopObservingQuery=function(a){var c=this.observingCallbacks[a];delete this.observingCallbacks[a];delete this.callbacks[c];this.connection.postMessage({fn:"stopObservingQuery",args:[a],callback:[]})},L.RDFStoreClient.prototype.startObservingNode=function(){var a,c,e;if(arguments.length===2){a=arguments[0];e=arguments[1];var g=this,k=this.registerCallback("startObservingNode",function(a){for(var c,
k=0;k<a.triples.length;k++)c=a.triples[k],a.triples[k]=new w.Triple(g.adaptJSInterface(c.subject),g.adaptJSInterface(c.predicate),g.adaptJSInterface(c.object));e(g.rdf.createGraph(a.triples))});this.observingCallbacks[e]=k;this.connection.postMessage({fn:"startObservingNode",args:[a],callback:k})}else arguments.length===3&&(a=arguments[0],c=arguments[1],e=arguments[2],g=this,k=this.registerCallback("startObservingNode",function(a){for(var c,k=0;k<a.triples.length;k++)c=a.triples[k],a.triples[k]=new w.Triple(g.adaptJSInterface(c.subject),
g.adaptJSInterface(c.predicate),g.adaptJSInterface(c.object));e(g.rdf.createGraph(a.triples))}),this.observingCallbacks[e]=k,this.connection.postMessage({fn:"startObservingNode",args:[a,c],callback:k}))},L.RDFStoreClient.prototype.stopObservingNode=function(a){var c=this.observingCallbacks[a];delete this.observingCallbacks[a];delete this.callbacks[c];this.connection.postMessage({fn:"stopObservingNode",args:[c],callback:[]})},L.RDFStoreClient.prototype.subscribe=function(a,c,e,g,k){var j=this,i=this.registerCallback("subscribe",
function(a,c){for(var e,g=0;g<c.length;g++)e=c[g],c[g]=new w.Triple(j.adaptJSInterface(e.subject),j.adaptJSInterface(e.predicate),j.adaptJSInterface(e.object));k(a,c)});this.observingCallbacks[k]=i;this.connection.postMessage({fn:"subscribe",args:[a,c,e,g],callback:i})},L.RDFStoreClient.prototype.unsubscribe=function(a){var c=this.observingCallbacks[a];delete this.observingCallbacks[a];delete this.callbacks[c];this.connection.postMessage({fn:"unsubscribe",args:[c],callback:[]})},L.RDFStoreClient.prototype.registeredGraphs=
function(a){var c=this;this.connection.postMessage({fn:"registeredGraphs",args:[],callback:this.registerCallback("registeredGraphs",function(e,g){if(e)for(var k=0;k<g.length;k++)g[k]=c.adaptJSInterface(g[k]);a(e,g)})})},L.RDFStoreClient.prototype.adaptJSInterface=function(a){if(a.interfaceName==="BlankNode")return new w.BlankNode(a.bnodeId);else if(a.interfaceName==="Literal")return new w.Literal(a.nominalValue,a.language,a.datatype);else if(a.interfaceName==="NamedNode")return new w.NamedNode(a.nominalValue)},
L.RDFStoreClient.prototype.isWebWorkerConnection=!0;var G={},ob={MongodbQueryEngine:function(){throw"MongoDB backend not supported in the browser version";}};G.VERSION="0.5.13";G.connect=function(){var a,c,e;arguments.length==1&&(a=__dirname,c={},e=arguments[0]);arguments.length==2?(typeof arguments[0]==="string"?(a=arguments[0],c={}):(a=__dirname+"/index.js",c=arguments[0]),e=arguments[1]):(a=arguments[0],c=arguments[1],e=arguments[2]);try{Worker?new L.RDFStoreClient(a,c,function(a,c){e(a,c)}):G.create(c,
function(a){e(!1,a)})}catch(g){G.create(c,function(a){e(!1,a)})}};G.create=function(){return arguments.length==1?new G.Store(arguments[0]):arguments.length==2?new G.Store(arguments[0],arguments[1]):new G.Store};G.Store=function(a,c){var e=null,g=null;if(arguments.length==0)g={};else if(arguments.length==1)g={},e=a;else if(arguments.length>1)g=a,e=c;else throw"An optional argument map and a callback must be provided";g.treeOrder==null&&(g.treeOrder=15);this.functionMap={};var k=this;g.engine==="mongodb"?
(this.isMongodb=!0,this.engine=new ob.MongodbQueryEngine(g),this.engine.readConfiguration(function(){g.overwrite===!0?k.engine.clean(function(){e(k)}):e(k)})):new I.Lexicon(function(a){g.overwrite===!0&&a.clear();new U.QuadBackend(g,function(c){g.overwrite===!0&&c.clear();g.backend=c;g.lexicon=a;k.engine=new E.QueryEngine(g);e&&e(k)})},g.name)};G.Store.prototype.rdf=w.rdf;G.Store.prototype.execute=function(){if(arguments.length===3)this.executeWithEnvironment(arguments[0],arguments[1],arguments[2]);
else if(arguments.length===4)this.executeWithEnvironment(arguments[0],arguments[1],arguments[2],arguments[3]);else{var a,c;arguments.length===1?(a=arguments[0],c=function(){}):arguments.length===2&&(a=arguments[0],c=arguments[1]);this.engine.execute(a,c)}};G.Store.prototype.executeWithEnvironment=function(){var a,c,e;if(arguments.length===3){a=arguments[0];var g=function(){};c=arguments[1];e=arguments[2]}else arguments.length===4&&(a=arguments[0],g=arguments[3],c=arguments[1],e=arguments[2]);for(var k=
[],j=[],i=0;i<c.length;i++)k.push({token:"uri",value:c[i]});for(i=0;i<e.length;i++)j.push({token:"uri",value:e[i]});this.engine.execute(a,g,k,j)};G.Store.prototype.graph=function(){var a=null,c=null;if(arguments.length===1)c=arguments[0]||function(){},a=this.engine.lexicon.defaultGraphUri;else if(arguments.length===2)c=arguments[1]||function(){},a=arguments[0];else throw"An optional graph URI and a callback function must be provided";this.rdf.resolve(a)!=null&&(a=this.rdf.resolve(a));this.engine.execute("CONSTRUCT { ?s ?p ?o } WHERE { GRAPH <"+
a+"> { ?s ?p ?o } }",c)};G.Store.prototype.node=function(){var a=null,c=null,e=null;if(arguments.length===2)e=arguments[0],c=arguments[1]||function(){},a=this.engine.lexicon.defaultGraphUri;else if(arguments.length===3)e=arguments[0],a=arguments[1],c=arguments[2]||function(){};else throw"An optional graph URI, node URI and a callback function must be provided";this.rdf.resolve(a)!=null&&(a=this.rdf.resolve(a));this.rdf.resolve(e)!=null&&(e=this.rdf.resolve(e));this.engine.execute("CONSTRUCT { <"+
e+"> ?p ?o } WHERE { GRAPH <"+a+"> { <"+e+"> ?p ?o } }",c)};G.Store.prototype.startObservingNode=function(){var a,c,e;arguments.length===2?(a=arguments[0],e=arguments[1],this.engine.callbacksBackend.observeNode(a,e,function(){})):arguments.length===3&&(a=arguments[0],c=arguments[1],e=arguments[2],this.engine.callbacksBackend.observeNode(a,c,e,function(){}))};G.Store.prototype.stopObservingNode=function(a){this.engine.callbacksBackend.stopObservingNode(a)};G.Store.prototype.startObservingQuery=function(a,
c,e){e!=null?this.engine.callbacksBackend.observeQuery(a,c,e):this.engine.callbacksBackend.observeQuery(a,c,function(){})};G.Store.prototype.stopObservingQuery=function(a){this.engine.callbacksBackend.stopObservingQuery(a)};G.Store.prototype.subscribe=function(a,c,e,g,k){var j=this,i=function(a,c){for(var e=[],g={blanks:{},outCache:{}},h=[],i=0;i<c.length;i++){var y=c[i],B=w.buildRDFResource(y.subject,h,j.engine,g),C=w.buildRDFResource(y.predicate,h,j.engine,g),y=w.buildRDFResource(y.object,h,j.engine,
g);B!=null&&C!=null&&y!=null&&(y=new w.Triple(B,C,y),e.push(y))}k(a,e)};this.functionMap[k]=i;this.engine.callbacksBackend.subscribe(a,c,e,g,i,function(){})};G.Store.prototype.unsubscribe=function(a){this.engine.callbacksBackend.unsubscribe(this.functionMap[a]);delete this.functionMap[a]};G.Store.prototype.setPrefix=function(a,c){this.rdf.setPrefix(a,c)};G.Store.prototype.setDefaultPrefix=function(a){this.rdf.setDefaultPrefix(a)};G.Store.prototype.insert=function(){var a,c,e;if(arguments.length===
1)c=arguments[0];else if(arguments.length===2)a=this.rdf.createNamedNode(this.engine.lexicon.defaultGraphUri),c=arguments[0],e=arguments[1]||function(){};else if(arguments.length===3)c=arguments[0],a=this.rdf.createNamedNode(arguments[1]),e=arguments[2]||function(){};else throw"The triples to insert, an optional graph and callback must be provided";var g="",k=this;c.forEach(function(a){g=g+k._nodeToQuery(a.subject)+k._nodeToQuery(a.predicate)+k._nodeToQuery(a.object)+"."});g=a!=null?"INSERT DATA { GRAPH "+
this._nodeToQuery(a)+" { "+g+" } }":"INSERT DATA { "+this._nodeToQuery(a)+" { "+g+" }";this.engine.execute(g,e)};G.Store.prototype._nodeToQuery=function(a){if(a.interfaceName==="NamedNode"){var c=this.rdf.resolve(a.valueOf());return c!=null?"<"+c+">":"<"+a.valueOf()+">"}else{if(a.interfaceName!=="")if(a.lang!=null)return'"'+a.valueOf()+'"@'+a.lang;else if(a.datatype!=null)return'"'+a.valueOf()+'"^^<'+a.datatype+">";return a.toString()}};G.Store.prototype["delete"]=function(){var a,c,e;if(arguments.length===
1)c=arguments[0];else if(arguments.length===2)a=this.rdf.createNamedNode(this.engine.lexicon.defaultGraphUri),c=arguments[0],e=arguments[1]||function(){};else if(arguments.length===3)c=arguments[0],a=this.rdf.createNamedNode(arguments[1]),e=arguments[2]||function(){};else throw"The triples to delete, an optional graph and callback must be provided";var g="",k=this;c.forEach(function(a){g=g+k._nodeToQuery(a.subject)+k._nodeToQuery(a.predicate)+k._nodeToQuery(a.object)+"."});g=a!=null?"DELETE DATA { GRAPH "+
this._nodeToQuery(a)+" { "+g+" } }":"DELETE DATA { "+this._nodeToQuery(a)+" { "+g+" }";this.engine.execute(g,e)};G.Store.prototype.clear=function(){var a,c;if(arguments.length===0)a=this.rdf.createNamedNode(this.engine.lexicon.defaultGraphUri),c=function(){};else if(arguments.length===1)a=this.rdf.createNamedNode(this.engine.lexicon.defaultGraphUri),c=arguments[0]||function(){};else if(arguments.length===2)a=this.rdf.createNamedNode(arguments[0]),c=arguments[1]||function(){};else throw"The optional graph and a callback must be provided";
this.engine.execute("CLEAR GRAPH "+this._nodeToQuery(a),c)};G.Store.prototype.setBatchLoadEvents=function(a){this.engine.eventsOnBatchLoad=a};G.Store.prototype.registerDefaultNamespace=function(a,c){this.rdf.prefixes.set(a,c);this.engine.registerDefaultNamespace(a,c)};G.Store.prototype.registerDefaultProfileNamespaces=function(){var a=this.rdf.prefixes.values(),c;for(c in a)this.registerDefaultNamespace(c,a[c])};G.Store.prototype.load=function(){var a,c,e,g;if(arguments.length===3)e=this.rdf.createNamedNode(this.engine.lexicon.defaultGraphUri),
a=arguments[0],c=arguments[1],g=arguments[2]||function(){};else if(arguments.length===4)a=arguments[0],c=arguments[1],e=this.rdf.createNamedNode(arguments[2]),g=arguments[3]||function(){};else if(arguments.length===2)throw"The mediaType of the parser, the data a callback and an optional graph must be provided";if(a==="remote")c=this.rdf.createNamedNode(c),this.engine.execute("LOAD <"+c.valueOf()+"> INTO GRAPH <"+e.valueOf()+">",g);else if(c&&typeof c==="string"&&c.indexOf("file://")===0){a=this.engine.rdfLoader.parsers[a];
var k=this;this.engine.rdfLoader.loadFromFile(a,{token:"uri",value:e.valueOf()},c,function(a,c){a?k.engine.batchLoad(c,g):g(a,c)})}else a=this.engine.rdfLoader.parsers[a],k=this,this.engine.rdfLoader.tryToParse(a,{token:"uri",value:e.valueOf()},c,function(a,c){a?k.engine.batchLoad(c,g):g(a,c)})};G.Store.prototype.registerParser=function(a,c){this.engine.rdfLoader.registerParser(a,c)};G.Store.prototype.registeredGraphs=function(a){if(this.isMongodb)this.engine.registeredGraphs(!0,function(c){for(var e=
[],g=0;g<c.length;g++){var h=new w.NamedNode(c[g]);e.push(h)}return a(!0,e)});else{for(var c=this.engine.lexicon.registeredGraphs(!0),e=[],g=0;g<c.length;g++){var k=new w.NamedNode(c[g]);e.push(k)}return a(!0,e)}};G.Store.prototype._nodeToQuery=function(a){if(a.interfaceName==="NamedNode"){var c=this.rdf.resolve(a.valueOf());return c!=null?"<"+c+">":"<"+a.valueOf()+">"}else return a.toString()};G.Store.prototype.getNetworkTransport=function(){return O};G.Store.prototype.setNetworkTransport=function(a){O=
a};RDFStoreWorker={observingCallbacks:{},workerCallbacksCounter:0,workerCallbacks:{}};RDFStoreWorker.registerCallback=function(a){var c=""+RDFStoreWorker.workerCallbacksCounter;RDFStoreWorker.workerCallbacksCounter++;RDFStoreWorker.workerCallbacks[c]=a;return c};RDFStoreWorker.handleCreate=function(a,c){typeof O!="undefined"&&O!=null&&(O={load:function(a,c,e){var g=RDFStoreWorker.registerCallback(function(a){e.apply(e,a)});postMessage({fn:"workerRequest:NetworkTransport:load",callback:g,arguments:[a,
c]})},loadFromFile:function(){}});var e=[a];e.push(function(a){RDFStoreWorker.store=a;postMessage({callback:c,result:"created",success:!0})});G.create.apply(G,e)};RDFStoreWorker.receive=function(a){var c=a.data||a;if(c.fn==="workerRequestResponse"){var e=c.callback,g=RDFStoreWorker.workerCallbacks[e];g!=null&&(delete RDFStoreWorker.workerCallbacks[e],g(c.results))}else if(c.fn==="create"&&c.args!=null)RDFStoreWorker.handleCreate(c.args,c.callback);else if(c.fn==="setBatchLoadEvents")RDFStoreWorker.store[c.fn].apply(RDFStoreWorker.store,
c.args);else if(c.fn==="registerDefaultNamespace")RDFStoreWorker.store[c.fn].apply(RDFStoreWorker.store,c.args);else if(c.fn==="registerDefaultProfileNamespaces")RDFStoreWorker.store[c.fn].apply(RDFStoreWorker.store,c.args);else if((c.fn==="execute"||c.fn==="executeWithEnvironment"||c.fn==="graph"||c.fn==="node"||c.fn==="clear"||c.fn==="load")&&c.args!=null){c.args.push(function(a,e){c.callback!=null&&postMessage({callback:c.callback,result:e,success:a})});try{RDFStoreWorker.store[c.fn].apply(RDFStoreWorker.store,
c.args)}catch(k){console.log("Error executing method through connection"),console.log(k)}}else if((c.fn==="insert"||c.fn==="delete")&&c.args!=null)try{c.args.push(function(a,e){c.callback!=null&&postMessage({callback:c.callback,result:e,success:a})});g=c.args[0];for(a=0;a<g.triples.length;a++)e=g.triples[a],g.triples[a]=new w.Triple(RDFStoreWorker.adaptJSInterface(e.subject),RDFStoreWorker.adaptJSInterface(e.predicate),RDFStoreWorker.adaptJSInterface(e.object));c.args[1].interfaceName!=null&&(c.args[1]=
RDFStoreWorker.adaptJSInterface(c.args[1]));c.args[0]=RDFStoreWorker.store.rdf.createGraph(g.triples);RDFStoreWorker.store[c.fn].apply(RDFStoreWorker.store,c.args)}catch(j){console.log("Error executing method through connection"),console.log(j)}else c.fn==="rdf/setPrefix"&&c.args!=null?RDFStoreWorker.store.rdf.setPrefix(c.args[0],c.args[1]):c.fn==="rdf/setDefaultPrefix"&&c.args!=null?RDFStoreWorker.store.rdf.setDefaultPrefix(c.args[0]):c.fn==="startObservingQuery"&&c.args!=null?(e=function(a,e){postMessage({callback:c.callback[0],
result:e,success:a})},RDFStoreWorker.observingCallbacks[c.args[0]]=e,c.args.push(e),c.args.push(function(a,e){c.callback&&c.callback[1]!=null&&postMessage({callback:c.callback[1],result:e,success:a})}),RDFStoreWorker.store[c.fn].apply(RDFStoreWorker.store,c.args)):c.fn==="stopObservingQuery"?((e=RDFStoreWorker.observingCallbacks[c.args[0]])&&RDFStoreWorker.store[c.fn].apply(RDFStoreWorker.store,[e]),delete RDFStoreWorker.observingCallbacks[c.args[0]]):c.fn==="startObservingNode"&&c.args!=null?(e=
function(a){postMessage({callback:c.callback,result:a})},RDFStoreWorker.observingCallbacks[c.callback]=e,c.args.push(e),RDFStoreWorker.store[c.fn].apply(RDFStoreWorker.store,c.args)):c.fn==="stopObservingNode"&&c.args!=null?((e=RDFStoreWorker.observingCallbacks[c.args[0]])&&RDFStoreWorker.store[c.fn].apply(RDFStoreWorker.store,[e]),delete RDFStoreWorker.observingCallbacks[c.args[0]]):c.fn==="subscribe"&&c.args!=null?(e=function(a,e){postMessage({callback:c.callback,event:a,result:e})},RDFStoreWorker.observingCallbacks[c.callback]=
e,c.args.push(e),RDFStoreWorker.store[c.fn].apply(RDFStoreWorker.store,c.args)):c.fn==="stopObservingNode"&&c.args!=null?((e=RDFStoreWorker.observingCallbacks[c.args[0]])&&RDFStoreWorker.store[c.fn].apply(RDFStoreWorker.store,[e]),delete RDFStoreWorker.observingCallbacks[c.args[0]]):c.fn==="registeredGraphs"&&c.args!=null&&RDFStoreWorker.store[c.fn].apply(RDFStoreWorker.store,[function(a,e){c.callback!=null&&postMessage({callback:c.callback,result:e,success:a})}])};RDFStoreWorker.adaptJSInterface=
function(a){if(a.interfaceName==="BlankNode")return new w.BlankNode(a.bnodeId);else if(a.interfaceName==="Literal")return new w.Literal(a.nominalValue,a.language,a.datatype);else if(a.interfaceName==="NamedNode")return new w.NamedNode(a.nominalValue)};onmessage=RDFStoreWorker.receive;try{window.rdfstore=G}catch(vc){}})();
